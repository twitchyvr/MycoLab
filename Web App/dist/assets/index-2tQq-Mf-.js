function jf(e,t){for(var s=0;s<t.length;s++){const n=t[s];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in e)){const a=Object.getOwnPropertyDescriptor(n,i);a&&Object.defineProperty(e,i,a.get?a:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function s(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=s(i);fetch(i.href,a)}})();var Es=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Oh(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function wi(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var s=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};s.prototype=t.prototype}else s={};return Object.defineProperty(s,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(s,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}),s}var Th={exports:{}},oo={},Dh={exports:{}},me={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ji=Symbol.for("react.element"),Sf=Symbol.for("react.portal"),Nf=Symbol.for("react.fragment"),kf=Symbol.for("react.strict_mode"),_f=Symbol.for("react.profiler"),Cf=Symbol.for("react.provider"),zf=Symbol.for("react.context"),Af=Symbol.for("react.forward_ref"),Ef=Symbol.for("react.suspense"),If=Symbol.for("react.memo"),Of=Symbol.for("react.lazy"),Od=Symbol.iterator;function Tf(e){return e===null||typeof e!="object"?null:(e=Od&&e[Od]||e["@@iterator"],typeof e=="function"?e:null)}var Rh={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Ph=Object.assign,Lh={};function bn(e,t,s){this.props=e,this.context=t,this.refs=Lh,this.updater=s||Rh}bn.prototype.isReactComponent={};bn.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};bn.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Mh(){}Mh.prototype=bn.prototype;function Sc(e,t,s){this.props=e,this.context=t,this.refs=Lh,this.updater=s||Rh}var Nc=Sc.prototype=new Mh;Nc.constructor=Sc;Ph(Nc,bn.prototype);Nc.isPureReactComponent=!0;var Td=Array.isArray,$h=Object.prototype.hasOwnProperty,kc={current:null},Bh={key:!0,ref:!0,__self:!0,__source:!0};function Fh(e,t,s){var n,i={},a=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(a=""+t.key),t)$h.call(t,n)&&!Bh.hasOwnProperty(n)&&(i[n]=t[n]);var l=arguments.length-2;if(l===1)i.children=s;else if(1<l){for(var d=Array(l),c=0;c<l;c++)d[c]=arguments[c+2];i.children=d}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)i[n]===void 0&&(i[n]=l[n]);return{$$typeof:ji,type:e,key:a,ref:o,props:i,_owner:kc.current}}function Df(e,t){return{$$typeof:ji,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function _c(e){return typeof e=="object"&&e!==null&&e.$$typeof===ji}function Rf(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(s){return t[s]})}var Dd=/\/+/g;function Io(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Rf(""+e.key):t.toString(36)}function ca(e,t,s,n,i){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(a){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case ji:case Sf:o=!0}}if(o)return o=e,i=i(o),e=n===""?"."+Io(o,0):n,Td(i)?(s="",e!=null&&(s=e.replace(Dd,"$&/")+"/"),ca(i,t,s,"",function(c){return c})):i!=null&&(_c(i)&&(i=Df(i,s+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(Dd,"$&/")+"/")+e)),t.push(i)),1;if(o=0,n=n===""?".":n+":",Td(e))for(var l=0;l<e.length;l++){a=e[l];var d=n+Io(a,l);o+=ca(a,t,s,d,i)}else if(d=Tf(e),typeof d=="function")for(e=d.call(e),l=0;!(a=e.next()).done;)a=a.value,d=n+Io(a,l++),o+=ca(a,t,s,d,i);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function Ei(e,t,s){if(e==null)return e;var n=[],i=0;return ca(e,n,"","",function(a){return t.call(s,a,i++)}),n}function Pf(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(s){(e._status===0||e._status===-1)&&(e._status=1,e._result=s)},function(s){(e._status===0||e._status===-1)&&(e._status=2,e._result=s)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var lt={current:null},da={transition:null},Lf={ReactCurrentDispatcher:lt,ReactCurrentBatchConfig:da,ReactCurrentOwner:kc};function Uh(){throw Error("act(...) is not supported in production builds of React.")}me.Children={map:Ei,forEach:function(e,t,s){Ei(e,function(){t.apply(this,arguments)},s)},count:function(e){var t=0;return Ei(e,function(){t++}),t},toArray:function(e){return Ei(e,function(t){return t})||[]},only:function(e){if(!_c(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};me.Component=bn;me.Fragment=Nf;me.Profiler=_f;me.PureComponent=Sc;me.StrictMode=kf;me.Suspense=Ef;me.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Lf;me.act=Uh;me.cloneElement=function(e,t,s){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Ph({},e.props),i=e.key,a=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,o=kc.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(d in t)$h.call(t,d)&&!Bh.hasOwnProperty(d)&&(n[d]=t[d]===void 0&&l!==void 0?l[d]:t[d])}var d=arguments.length-2;if(d===1)n.children=s;else if(1<d){l=Array(d);for(var c=0;c<d;c++)l[c]=arguments[c+2];n.children=l}return{$$typeof:ji,type:e.type,key:i,ref:a,props:n,_owner:o}};me.createContext=function(e){return e={$$typeof:zf,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Cf,_context:e},e.Consumer=e};me.createElement=Fh;me.createFactory=function(e){var t=Fh.bind(null,e);return t.type=e,t};me.createRef=function(){return{current:null}};me.forwardRef=function(e){return{$$typeof:Af,render:e}};me.isValidElement=_c;me.lazy=function(e){return{$$typeof:Of,_payload:{_status:-1,_result:e},_init:Pf}};me.memo=function(e,t){return{$$typeof:If,type:e,compare:t===void 0?null:t}};me.startTransition=function(e){var t=da.transition;da.transition={};try{e()}finally{da.transition=t}};me.unstable_act=Uh;me.useCallback=function(e,t){return lt.current.useCallback(e,t)};me.useContext=function(e){return lt.current.useContext(e)};me.useDebugValue=function(){};me.useDeferredValue=function(e){return lt.current.useDeferredValue(e)};me.useEffect=function(e,t){return lt.current.useEffect(e,t)};me.useId=function(){return lt.current.useId()};me.useImperativeHandle=function(e,t,s){return lt.current.useImperativeHandle(e,t,s)};me.useInsertionEffect=function(e,t){return lt.current.useInsertionEffect(e,t)};me.useLayoutEffect=function(e,t){return lt.current.useLayoutEffect(e,t)};me.useMemo=function(e,t){return lt.current.useMemo(e,t)};me.useReducer=function(e,t,s){return lt.current.useReducer(e,t,s)};me.useRef=function(e){return lt.current.useRef(e)};me.useState=function(e){return lt.current.useState(e)};me.useSyncExternalStore=function(e,t,s){return lt.current.useSyncExternalStore(e,t,s)};me.useTransition=function(){return lt.current.useTransition()};me.version="18.3.1";Dh.exports=me;var b=Dh.exports;const Cc=Oh(b);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mf=b,$f=Symbol.for("react.element"),Bf=Symbol.for("react.fragment"),Ff=Object.prototype.hasOwnProperty,Uf=Mf.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Wf={key:!0,ref:!0,__self:!0,__source:!0};function Wh(e,t,s){var n,i={},a=null,o=null;s!==void 0&&(a=""+s),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)Ff.call(t,n)&&!Wf.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:$f,type:e,key:a,ref:o,props:i,_owner:Uf.current}}oo.Fragment=Bf;oo.jsx=Wh;oo.jsxs=Wh;Th.exports=oo;var r=Th.exports,ml={},Hh={exports:{}},Ot={},Vh={exports:{}},Gh={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(B,D){var $=B.length;B.push(D);e:for(;0<$;){var Y=$-1>>>1,le=B[Y];if(0<i(le,D))B[Y]=D,B[$]=le,$=Y;else break e}}function s(B){return B.length===0?null:B[0]}function n(B){if(B.length===0)return null;var D=B[0],$=B.pop();if($!==D){B[0]=$;e:for(var Y=0,le=B.length,Q=le>>>1;Y<Q;){var O=2*(Y+1)-1,U=B[O],re=O+1,pe=B[re];if(0>i(U,$))re<le&&0>i(pe,U)?(B[Y]=pe,B[re]=$,Y=re):(B[Y]=U,B[O]=$,Y=O);else if(re<le&&0>i(pe,$))B[Y]=pe,B[re]=$,Y=re;else break e}}return D}function i(B,D){var $=B.sortIndex-D.sortIndex;return $!==0?$:B.id-D.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var d=[],c=[],p=1,m=null,g=3,f=!1,v=!1,j=!1,S=typeof setTimeout=="function"?setTimeout:null,u=typeof clearTimeout=="function"?clearTimeout:null,h=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(B){for(var D=s(c);D!==null;){if(D.callback===null)n(c);else if(D.startTime<=B)n(c),D.sortIndex=D.expirationTime,t(d,D);else break;D=s(c)}}function _(B){if(j=!1,x(B),!v)if(s(d)!==null)v=!0,M(N);else{var D=s(c);D!==null&&oe(_,D.startTime-B)}}function N(B,D){v=!1,j&&(j=!1,u(y),y=-1),f=!0;var $=g;try{for(x(D),m=s(d);m!==null&&(!(m.expirationTime>D)||B&&!H());){var Y=m.callback;if(typeof Y=="function"){m.callback=null,g=m.priorityLevel;var le=Y(m.expirationTime<=D);D=e.unstable_now(),typeof le=="function"?m.callback=le:m===s(d)&&n(d),x(D)}else n(d);m=s(d)}if(m!==null)var Q=!0;else{var O=s(c);O!==null&&oe(_,O.startTime-D),Q=!1}return Q}finally{m=null,g=$,f=!1}}var w=!1,C=null,y=-1,L=5,G=-1;function H(){return!(e.unstable_now()-G<L)}function J(){if(C!==null){var B=e.unstable_now();G=B;var D=!0;try{D=C(!0,B)}finally{D?se():(w=!1,C=null)}}else w=!1}var se;if(typeof h=="function")se=function(){h(J)};else if(typeof MessageChannel<"u"){var ge=new MessageChannel,k=ge.port2;ge.port1.onmessage=J,se=function(){k.postMessage(null)}}else se=function(){S(J,0)};function M(B){C=B,w||(w=!0,se())}function oe(B,D){y=S(function(){B(e.unstable_now())},D)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(B){B.callback=null},e.unstable_continueExecution=function(){v||f||(v=!0,M(N))},e.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<B?Math.floor(1e3/B):5},e.unstable_getCurrentPriorityLevel=function(){return g},e.unstable_getFirstCallbackNode=function(){return s(d)},e.unstable_next=function(B){switch(g){case 1:case 2:case 3:var D=3;break;default:D=g}var $=g;g=D;try{return B()}finally{g=$}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(B,D){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var $=g;g=B;try{return D()}finally{g=$}},e.unstable_scheduleCallback=function(B,D,$){var Y=e.unstable_now();switch(typeof $=="object"&&$!==null?($=$.delay,$=typeof $=="number"&&0<$?Y+$:Y):$=Y,B){case 1:var le=-1;break;case 2:le=250;break;case 5:le=1073741823;break;case 4:le=1e4;break;default:le=5e3}return le=$+le,B={id:p++,callback:D,priorityLevel:B,startTime:$,expirationTime:le,sortIndex:-1},$>Y?(B.sortIndex=$,t(c,B),s(d)===null&&B===s(c)&&(j?(u(y),y=-1):j=!0,oe(_,$-Y))):(B.sortIndex=le,t(d,B),v||f||(v=!0,M(N))),B},e.unstable_shouldYield=H,e.unstable_wrapCallback=function(B){var D=g;return function(){var $=g;g=D;try{return B.apply(this,arguments)}finally{g=$}}}})(Gh);Vh.exports=Gh;var Hf=Vh.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vf=b,It=Hf;function q(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,s=1;s<arguments.length;s++)t+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var qh=new Set,ri={};function _s(e,t){un(e,t),un(e+"Capture",t)}function un(e,t){for(ri[e]=t,e=0;e<t.length;e++)qh.add(t[e])}var Nr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),pl=Object.prototype.hasOwnProperty,Gf=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Rd={},Pd={};function qf(e){return pl.call(Pd,e)?!0:pl.call(Rd,e)?!1:Gf.test(e)?Pd[e]=!0:(Rd[e]=!0,!1)}function Kf(e,t,s,n){if(s!==null&&s.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:s!==null?!s.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Qf(e,t,s,n){if(t===null||typeof t>"u"||Kf(e,t,s,n))return!0;if(n)return!1;if(s!==null)switch(s.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function ct(e,t,s,n,i,a,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=s,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=o}var Ye={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Ye[e]=new ct(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Ye[t]=new ct(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Ye[e]=new ct(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Ye[e]=new ct(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Ye[e]=new ct(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Ye[e]=new ct(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Ye[e]=new ct(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Ye[e]=new ct(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Ye[e]=new ct(e,5,!1,e.toLowerCase(),null,!1,!1)});var zc=/[\-:]([a-z])/g;function Ac(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(zc,Ac);Ye[t]=new ct(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(zc,Ac);Ye[t]=new ct(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(zc,Ac);Ye[t]=new ct(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Ye[e]=new ct(e,1,!1,e.toLowerCase(),null,!1,!1)});Ye.xlinkHref=new ct("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Ye[e]=new ct(e,1,!1,e.toLowerCase(),null,!0,!0)});function Ec(e,t,s,n){var i=Ye.hasOwnProperty(t)?Ye[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Qf(t,s,i,n)&&(s=null),n||i===null?qf(t)&&(s===null?e.removeAttribute(t):e.setAttribute(t,""+s)):i.mustUseProperty?e[i.propertyName]=s===null?i.type===3?!1:"":s:(t=i.attributeName,n=i.attributeNamespace,s===null?e.removeAttribute(t):(i=i.type,s=i===3||i===4&&s===!0?"":""+s,n?e.setAttributeNS(n,t,s):e.setAttribute(t,s))))}var zr=Vf.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ii=Symbol.for("react.element"),Ws=Symbol.for("react.portal"),Hs=Symbol.for("react.fragment"),Ic=Symbol.for("react.strict_mode"),fl=Symbol.for("react.profiler"),Kh=Symbol.for("react.provider"),Qh=Symbol.for("react.context"),Oc=Symbol.for("react.forward_ref"),gl=Symbol.for("react.suspense"),xl=Symbol.for("react.suspense_list"),Tc=Symbol.for("react.memo"),Rr=Symbol.for("react.lazy"),Jh=Symbol.for("react.offscreen"),Ld=Symbol.iterator;function Cn(e){return e===null||typeof e!="object"?null:(e=Ld&&e[Ld]||e["@@iterator"],typeof e=="function"?e:null)}var Ee=Object.assign,Oo;function Bn(e){if(Oo===void 0)try{throw Error()}catch(s){var t=s.stack.trim().match(/\n( *(at )?)/);Oo=t&&t[1]||""}return`
`+Oo+e}var To=!1;function Do(e,t){if(!e||To)return"";To=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),a=n.stack.split(`
`),o=i.length-1,l=a.length-1;1<=o&&0<=l&&i[o]!==a[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==a[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==a[l]){var d=`
`+i[o].replace(" at new "," at ");return e.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",e.displayName)),d}while(1<=o&&0<=l);break}}}finally{To=!1,Error.prepareStackTrace=s}return(e=e?e.displayName||e.name:"")?Bn(e):""}function Jf(e){switch(e.tag){case 5:return Bn(e.type);case 16:return Bn("Lazy");case 13:return Bn("Suspense");case 19:return Bn("SuspenseList");case 0:case 2:case 15:return e=Do(e.type,!1),e;case 11:return e=Do(e.type.render,!1),e;case 1:return e=Do(e.type,!0),e;default:return""}}function vl(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Hs:return"Fragment";case Ws:return"Portal";case fl:return"Profiler";case Ic:return"StrictMode";case gl:return"Suspense";case xl:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Qh:return(e.displayName||"Context")+".Consumer";case Kh:return(e._context.displayName||"Context")+".Provider";case Oc:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Tc:return t=e.displayName||null,t!==null?t:vl(e.type)||"Memo";case Rr:t=e._payload,e=e._init;try{return vl(e(t))}catch{}}return null}function Yf(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return vl(t);case 8:return t===Ic?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Yr(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Yh(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Xf(e){var t=Yh(e)?"checked":"value",s=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var i=s.get,a=s.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(o){n=""+o,a.call(this,o)}}),Object.defineProperty(e,t,{enumerable:s.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Oi(e){e._valueTracker||(e._valueTracker=Xf(e))}function Xh(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var s=t.getValue(),n="";return e&&(n=Yh(e)?e.checked?"true":"false":e.value),e=n,e!==s?(t.setValue(e),!0):!1}function ka(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function yl(e,t){var s=t.checked;return Ee({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:s??e._wrapperState.initialChecked})}function Md(e,t){var s=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;s=Yr(t.value!=null?t.value:s),e._wrapperState={initialChecked:n,initialValue:s,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Zh(e,t){t=t.checked,t!=null&&Ec(e,"checked",t,!1)}function bl(e,t){Zh(e,t);var s=Yr(t.value),n=t.type;if(s!=null)n==="number"?(s===0&&e.value===""||e.value!=s)&&(e.value=""+s):e.value!==""+s&&(e.value=""+s);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?wl(e,t.type,s):t.hasOwnProperty("defaultValue")&&wl(e,t.type,Yr(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function $d(e,t,s){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,s||t===e.value||(e.value=t),e.defaultValue=t}s=e.name,s!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,s!==""&&(e.name=s)}function wl(e,t,s){(t!=="number"||ka(e.ownerDocument)!==e)&&(s==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+s&&(e.defaultValue=""+s))}var Fn=Array.isArray;function rn(e,t,s,n){if(e=e.options,t){t={};for(var i=0;i<s.length;i++)t["$"+s[i]]=!0;for(s=0;s<e.length;s++)i=t.hasOwnProperty("$"+e[s].value),e[s].selected!==i&&(e[s].selected=i),i&&n&&(e[s].defaultSelected=!0)}else{for(s=""+Yr(s),t=null,i=0;i<e.length;i++){if(e[i].value===s){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function jl(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(q(91));return Ee({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Bd(e,t){var s=t.value;if(s==null){if(s=t.children,t=t.defaultValue,s!=null){if(t!=null)throw Error(q(92));if(Fn(s)){if(1<s.length)throw Error(q(93));s=s[0]}t=s}t==null&&(t=""),s=t}e._wrapperState={initialValue:Yr(s)}}function em(e,t){var s=Yr(t.value),n=Yr(t.defaultValue);s!=null&&(s=""+s,s!==e.value&&(e.value=s),t.defaultValue==null&&e.defaultValue!==s&&(e.defaultValue=s)),n!=null&&(e.defaultValue=""+n)}function Fd(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function tm(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Sl(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?tm(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Ti,rm=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,s,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,s,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Ti=Ti||document.createElement("div"),Ti.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Ti.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function si(e,t){if(t){var s=e.firstChild;if(s&&s===e.lastChild&&s.nodeType===3){s.nodeValue=t;return}}e.textContent=t}var qn={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Zf=["Webkit","ms","Moz","O"];Object.keys(qn).forEach(function(e){Zf.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),qn[t]=qn[e]})});function sm(e,t,s){return t==null||typeof t=="boolean"||t===""?"":s||typeof t!="number"||t===0||qn.hasOwnProperty(e)&&qn[e]?(""+t).trim():t+"px"}function nm(e,t){e=e.style;for(var s in t)if(t.hasOwnProperty(s)){var n=s.indexOf("--")===0,i=sm(s,t[s],n);s==="float"&&(s="cssFloat"),n?e.setProperty(s,i):e[s]=i}}var eg=Ee({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Nl(e,t){if(t){if(eg[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(q(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(q(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(q(61))}if(t.style!=null&&typeof t.style!="object")throw Error(q(62))}}function kl(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _l=null;function Dc(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Cl=null,sn=null,nn=null;function Ud(e){if(e=ki(e)){if(typeof Cl!="function")throw Error(q(280));var t=e.stateNode;t&&(t=mo(t),Cl(e.stateNode,e.type,t))}}function im(e){sn?nn?nn.push(e):nn=[e]:sn=e}function am(){if(sn){var e=sn,t=nn;if(nn=sn=null,Ud(e),t)for(e=0;e<t.length;e++)Ud(t[e])}}function om(e,t){return e(t)}function lm(){}var Ro=!1;function cm(e,t,s){if(Ro)return e(t,s);Ro=!0;try{return om(e,t,s)}finally{Ro=!1,(sn!==null||nn!==null)&&(lm(),am())}}function ni(e,t){var s=e.stateNode;if(s===null)return null;var n=mo(s);if(n===null)return null;s=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(s&&typeof s!="function")throw Error(q(231,t,typeof s));return s}var zl=!1;if(Nr)try{var zn={};Object.defineProperty(zn,"passive",{get:function(){zl=!0}}),window.addEventListener("test",zn,zn),window.removeEventListener("test",zn,zn)}catch{zl=!1}function tg(e,t,s,n,i,a,o,l,d){var c=Array.prototype.slice.call(arguments,3);try{t.apply(s,c)}catch(p){this.onError(p)}}var Kn=!1,_a=null,Ca=!1,Al=null,rg={onError:function(e){Kn=!0,_a=e}};function sg(e,t,s,n,i,a,o,l,d){Kn=!1,_a=null,tg.apply(rg,arguments)}function ng(e,t,s,n,i,a,o,l,d){if(sg.apply(this,arguments),Kn){if(Kn){var c=_a;Kn=!1,_a=null}else throw Error(q(198));Ca||(Ca=!0,Al=c)}}function Cs(e){var t=e,s=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(s=t.return),e=t.return;while(e)}return t.tag===3?s:null}function dm(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Wd(e){if(Cs(e)!==e)throw Error(q(188))}function ig(e){var t=e.alternate;if(!t){if(t=Cs(e),t===null)throw Error(q(188));return t!==e?null:e}for(var s=e,n=t;;){var i=s.return;if(i===null)break;var a=i.alternate;if(a===null){if(n=i.return,n!==null){s=n;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===s)return Wd(i),e;if(a===n)return Wd(i),t;a=a.sibling}throw Error(q(188))}if(s.return!==n.return)s=i,n=a;else{for(var o=!1,l=i.child;l;){if(l===s){o=!0,s=i,n=a;break}if(l===n){o=!0,n=i,s=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===s){o=!0,s=a,n=i;break}if(l===n){o=!0,n=a,s=i;break}l=l.sibling}if(!o)throw Error(q(189))}}if(s.alternate!==n)throw Error(q(190))}if(s.tag!==3)throw Error(q(188));return s.stateNode.current===s?e:t}function um(e){return e=ig(e),e!==null?hm(e):null}function hm(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=hm(e);if(t!==null)return t;e=e.sibling}return null}var mm=It.unstable_scheduleCallback,Hd=It.unstable_cancelCallback,ag=It.unstable_shouldYield,og=It.unstable_requestPaint,Te=It.unstable_now,lg=It.unstable_getCurrentPriorityLevel,Rc=It.unstable_ImmediatePriority,pm=It.unstable_UserBlockingPriority,za=It.unstable_NormalPriority,cg=It.unstable_LowPriority,fm=It.unstable_IdlePriority,lo=null,gr=null;function dg(e){if(gr&&typeof gr.onCommitFiberRoot=="function")try{gr.onCommitFiberRoot(lo,e,void 0,(e.current.flags&128)===128)}catch{}}var sr=Math.clz32?Math.clz32:mg,ug=Math.log,hg=Math.LN2;function mg(e){return e>>>=0,e===0?32:31-(ug(e)/hg|0)|0}var Di=64,Ri=4194304;function Un(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Aa(e,t){var s=e.pendingLanes;if(s===0)return 0;var n=0,i=e.suspendedLanes,a=e.pingedLanes,o=s&268435455;if(o!==0){var l=o&~i;l!==0?n=Un(l):(a&=o,a!==0&&(n=Un(a)))}else o=s&~i,o!==0?n=Un(o):a!==0&&(n=Un(a));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,a=t&-t,i>=a||i===16&&(a&4194240)!==0))return t;if(n&4&&(n|=s&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)s=31-sr(t),i=1<<s,n|=e[s],t&=~i;return n}function pg(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function fg(e,t){for(var s=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var o=31-sr(a),l=1<<o,d=i[o];d===-1?(!(l&s)||l&n)&&(i[o]=pg(l,t)):d<=t&&(e.expiredLanes|=l),a&=~l}}function El(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function gm(){var e=Di;return Di<<=1,!(Di&4194240)&&(Di=64),e}function Po(e){for(var t=[],s=0;31>s;s++)t.push(e);return t}function Si(e,t,s){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-sr(t),e[t]=s}function gg(e,t){var s=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<s;){var i=31-sr(s),a=1<<i;t[i]=0,n[i]=-1,e[i]=-1,s&=~a}}function Pc(e,t){var s=e.entangledLanes|=t;for(e=e.entanglements;s;){var n=31-sr(s),i=1<<n;i&t|e[n]&t&&(e[n]|=t),s&=~i}}var ve=0;function xm(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var vm,Lc,ym,bm,wm,Il=!1,Pi=[],Wr=null,Hr=null,Vr=null,ii=new Map,ai=new Map,Lr=[],xg="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Vd(e,t){switch(e){case"focusin":case"focusout":Wr=null;break;case"dragenter":case"dragleave":Hr=null;break;case"mouseover":case"mouseout":Vr=null;break;case"pointerover":case"pointerout":ii.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ai.delete(t.pointerId)}}function An(e,t,s,n,i,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:s,eventSystemFlags:n,nativeEvent:a,targetContainers:[i]},t!==null&&(t=ki(t),t!==null&&Lc(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function vg(e,t,s,n,i){switch(t){case"focusin":return Wr=An(Wr,e,t,s,n,i),!0;case"dragenter":return Hr=An(Hr,e,t,s,n,i),!0;case"mouseover":return Vr=An(Vr,e,t,s,n,i),!0;case"pointerover":var a=i.pointerId;return ii.set(a,An(ii.get(a)||null,e,t,s,n,i)),!0;case"gotpointercapture":return a=i.pointerId,ai.set(a,An(ai.get(a)||null,e,t,s,n,i)),!0}return!1}function jm(e){var t=fs(e.target);if(t!==null){var s=Cs(t);if(s!==null){if(t=s.tag,t===13){if(t=dm(s),t!==null){e.blockedOn=t,wm(e.priority,function(){ym(s)});return}}else if(t===3&&s.stateNode.current.memoizedState.isDehydrated){e.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}e.blockedOn=null}function ua(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var s=Ol(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(s===null){s=e.nativeEvent;var n=new s.constructor(s.type,s);_l=n,s.target.dispatchEvent(n),_l=null}else return t=ki(s),t!==null&&Lc(t),e.blockedOn=s,!1;t.shift()}return!0}function Gd(e,t,s){ua(e)&&s.delete(t)}function yg(){Il=!1,Wr!==null&&ua(Wr)&&(Wr=null),Hr!==null&&ua(Hr)&&(Hr=null),Vr!==null&&ua(Vr)&&(Vr=null),ii.forEach(Gd),ai.forEach(Gd)}function En(e,t){e.blockedOn===t&&(e.blockedOn=null,Il||(Il=!0,It.unstable_scheduleCallback(It.unstable_NormalPriority,yg)))}function oi(e){function t(i){return En(i,e)}if(0<Pi.length){En(Pi[0],e);for(var s=1;s<Pi.length;s++){var n=Pi[s];n.blockedOn===e&&(n.blockedOn=null)}}for(Wr!==null&&En(Wr,e),Hr!==null&&En(Hr,e),Vr!==null&&En(Vr,e),ii.forEach(t),ai.forEach(t),s=0;s<Lr.length;s++)n=Lr[s],n.blockedOn===e&&(n.blockedOn=null);for(;0<Lr.length&&(s=Lr[0],s.blockedOn===null);)jm(s),s.blockedOn===null&&Lr.shift()}var an=zr.ReactCurrentBatchConfig,Ea=!0;function bg(e,t,s,n){var i=ve,a=an.transition;an.transition=null;try{ve=1,Mc(e,t,s,n)}finally{ve=i,an.transition=a}}function wg(e,t,s,n){var i=ve,a=an.transition;an.transition=null;try{ve=4,Mc(e,t,s,n)}finally{ve=i,an.transition=a}}function Mc(e,t,s,n){if(Ea){var i=Ol(e,t,s,n);if(i===null)Go(e,t,n,Ia,s),Vd(e,n);else if(vg(i,e,t,s,n))n.stopPropagation();else if(Vd(e,n),t&4&&-1<xg.indexOf(e)){for(;i!==null;){var a=ki(i);if(a!==null&&vm(a),a=Ol(e,t,s,n),a===null&&Go(e,t,n,Ia,s),a===i)break;i=a}i!==null&&n.stopPropagation()}else Go(e,t,n,null,s)}}var Ia=null;function Ol(e,t,s,n){if(Ia=null,e=Dc(n),e=fs(e),e!==null)if(t=Cs(e),t===null)e=null;else if(s=t.tag,s===13){if(e=dm(t),e!==null)return e;e=null}else if(s===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Ia=e,null}function Sm(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(lg()){case Rc:return 1;case pm:return 4;case za:case cg:return 16;case fm:return 536870912;default:return 16}default:return 16}}var Fr=null,$c=null,ha=null;function Nm(){if(ha)return ha;var e,t=$c,s=t.length,n,i="value"in Fr?Fr.value:Fr.textContent,a=i.length;for(e=0;e<s&&t[e]===i[e];e++);var o=s-e;for(n=1;n<=o&&t[s-n]===i[a-n];n++);return ha=i.slice(e,1<n?1-n:void 0)}function ma(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Li(){return!0}function qd(){return!1}function Tt(e){function t(s,n,i,a,o){this._reactName=s,this._targetInst=i,this.type=n,this.nativeEvent=a,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(s=e[l],this[l]=s?s(a):a[l]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?Li:qd,this.isPropagationStopped=qd,this}return Ee(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=Li)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=Li)},persist:function(){},isPersistent:Li}),t}var wn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Bc=Tt(wn),Ni=Ee({},wn,{view:0,detail:0}),jg=Tt(Ni),Lo,Mo,In,co=Ee({},Ni,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Fc,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==In&&(In&&e.type==="mousemove"?(Lo=e.screenX-In.screenX,Mo=e.screenY-In.screenY):Mo=Lo=0,In=e),Lo)},movementY:function(e){return"movementY"in e?e.movementY:Mo}}),Kd=Tt(co),Sg=Ee({},co,{dataTransfer:0}),Ng=Tt(Sg),kg=Ee({},Ni,{relatedTarget:0}),$o=Tt(kg),_g=Ee({},wn,{animationName:0,elapsedTime:0,pseudoElement:0}),Cg=Tt(_g),zg=Ee({},wn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Ag=Tt(zg),Eg=Ee({},wn,{data:0}),Qd=Tt(Eg),Ig={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Og={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Tg={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Dg(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Tg[e])?!!t[e]:!1}function Fc(){return Dg}var Rg=Ee({},Ni,{key:function(e){if(e.key){var t=Ig[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=ma(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Og[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Fc,charCode:function(e){return e.type==="keypress"?ma(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?ma(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Pg=Tt(Rg),Lg=Ee({},co,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Jd=Tt(Lg),Mg=Ee({},Ni,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Fc}),$g=Tt(Mg),Bg=Ee({},wn,{propertyName:0,elapsedTime:0,pseudoElement:0}),Fg=Tt(Bg),Ug=Ee({},co,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Wg=Tt(Ug),Hg=[9,13,27,32],Uc=Nr&&"CompositionEvent"in window,Qn=null;Nr&&"documentMode"in document&&(Qn=document.documentMode);var Vg=Nr&&"TextEvent"in window&&!Qn,km=Nr&&(!Uc||Qn&&8<Qn&&11>=Qn),Yd=" ",Xd=!1;function _m(e,t){switch(e){case"keyup":return Hg.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Cm(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Vs=!1;function Gg(e,t){switch(e){case"compositionend":return Cm(t);case"keypress":return t.which!==32?null:(Xd=!0,Yd);case"textInput":return e=t.data,e===Yd&&Xd?null:e;default:return null}}function qg(e,t){if(Vs)return e==="compositionend"||!Uc&&_m(e,t)?(e=Nm(),ha=$c=Fr=null,Vs=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return km&&t.locale!=="ko"?null:t.data;default:return null}}var Kg={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Zd(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Kg[e.type]:t==="textarea"}function zm(e,t,s,n){im(n),t=Oa(t,"onChange"),0<t.length&&(s=new Bc("onChange","change",null,s,n),e.push({event:s,listeners:t}))}var Jn=null,li=null;function Qg(e){$m(e,0)}function uo(e){var t=Ks(e);if(Xh(t))return e}function Jg(e,t){if(e==="change")return t}var Am=!1;if(Nr){var Bo;if(Nr){var Fo="oninput"in document;if(!Fo){var eu=document.createElement("div");eu.setAttribute("oninput","return;"),Fo=typeof eu.oninput=="function"}Bo=Fo}else Bo=!1;Am=Bo&&(!document.documentMode||9<document.documentMode)}function tu(){Jn&&(Jn.detachEvent("onpropertychange",Em),li=Jn=null)}function Em(e){if(e.propertyName==="value"&&uo(li)){var t=[];zm(t,li,e,Dc(e)),cm(Qg,t)}}function Yg(e,t,s){e==="focusin"?(tu(),Jn=t,li=s,Jn.attachEvent("onpropertychange",Em)):e==="focusout"&&tu()}function Xg(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return uo(li)}function Zg(e,t){if(e==="click")return uo(t)}function ex(e,t){if(e==="input"||e==="change")return uo(t)}function tx(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ir=typeof Object.is=="function"?Object.is:tx;function ci(e,t){if(ir(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var s=Object.keys(e),n=Object.keys(t);if(s.length!==n.length)return!1;for(n=0;n<s.length;n++){var i=s[n];if(!pl.call(t,i)||!ir(e[i],t[i]))return!1}return!0}function ru(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function su(e,t){var s=ru(e);e=0;for(var n;s;){if(s.nodeType===3){if(n=e+s.textContent.length,e<=t&&n>=t)return{node:s,offset:t-e};e=n}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=ru(s)}}function Im(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Im(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Om(){for(var e=window,t=ka();t instanceof e.HTMLIFrameElement;){try{var s=typeof t.contentWindow.location.href=="string"}catch{s=!1}if(s)e=t.contentWindow;else break;t=ka(e.document)}return t}function Wc(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function rx(e){var t=Om(),s=e.focusedElem,n=e.selectionRange;if(t!==s&&s&&s.ownerDocument&&Im(s.ownerDocument.documentElement,s)){if(n!==null&&Wc(s)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in s)s.selectionStart=t,s.selectionEnd=Math.min(e,s.value.length);else if(e=(t=s.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=s.textContent.length,a=Math.min(n.start,i);n=n.end===void 0?a:Math.min(n.end,i),!e.extend&&a>n&&(i=n,n=a,a=i),i=su(s,a);var o=su(s,n);i&&o&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=s;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<t.length;s++)e=t[s],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var sx=Nr&&"documentMode"in document&&11>=document.documentMode,Gs=null,Tl=null,Yn=null,Dl=!1;function nu(e,t,s){var n=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;Dl||Gs==null||Gs!==ka(n)||(n=Gs,"selectionStart"in n&&Wc(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Yn&&ci(Yn,n)||(Yn=n,n=Oa(Tl,"onSelect"),0<n.length&&(t=new Bc("onSelect","select",null,t,s),e.push({event:t,listeners:n}),t.target=Gs)))}function Mi(e,t){var s={};return s[e.toLowerCase()]=t.toLowerCase(),s["Webkit"+e]="webkit"+t,s["Moz"+e]="moz"+t,s}var qs={animationend:Mi("Animation","AnimationEnd"),animationiteration:Mi("Animation","AnimationIteration"),animationstart:Mi("Animation","AnimationStart"),transitionend:Mi("Transition","TransitionEnd")},Uo={},Tm={};Nr&&(Tm=document.createElement("div").style,"AnimationEvent"in window||(delete qs.animationend.animation,delete qs.animationiteration.animation,delete qs.animationstart.animation),"TransitionEvent"in window||delete qs.transitionend.transition);function ho(e){if(Uo[e])return Uo[e];if(!qs[e])return e;var t=qs[e],s;for(s in t)if(t.hasOwnProperty(s)&&s in Tm)return Uo[e]=t[s];return e}var Dm=ho("animationend"),Rm=ho("animationiteration"),Pm=ho("animationstart"),Lm=ho("transitionend"),Mm=new Map,iu="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Zr(e,t){Mm.set(e,t),_s(t,[e])}for(var Wo=0;Wo<iu.length;Wo++){var Ho=iu[Wo],nx=Ho.toLowerCase(),ix=Ho[0].toUpperCase()+Ho.slice(1);Zr(nx,"on"+ix)}Zr(Dm,"onAnimationEnd");Zr(Rm,"onAnimationIteration");Zr(Pm,"onAnimationStart");Zr("dblclick","onDoubleClick");Zr("focusin","onFocus");Zr("focusout","onBlur");Zr(Lm,"onTransitionEnd");un("onMouseEnter",["mouseout","mouseover"]);un("onMouseLeave",["mouseout","mouseover"]);un("onPointerEnter",["pointerout","pointerover"]);un("onPointerLeave",["pointerout","pointerover"]);_s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));_s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));_s("onBeforeInput",["compositionend","keypress","textInput","paste"]);_s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));_s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));_s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Wn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ax=new Set("cancel close invalid load scroll toggle".split(" ").concat(Wn));function au(e,t,s){var n=e.type||"unknown-event";e.currentTarget=s,ng(n,t,void 0,e),e.currentTarget=null}function $m(e,t){t=(t&4)!==0;for(var s=0;s<e.length;s++){var n=e[s],i=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var o=n.length-1;0<=o;o--){var l=n[o],d=l.instance,c=l.currentTarget;if(l=l.listener,d!==a&&i.isPropagationStopped())break e;au(i,l,c),a=d}else for(o=0;o<n.length;o++){if(l=n[o],d=l.instance,c=l.currentTarget,l=l.listener,d!==a&&i.isPropagationStopped())break e;au(i,l,c),a=d}}}if(Ca)throw e=Al,Ca=!1,Al=null,e}function we(e,t){var s=t[$l];s===void 0&&(s=t[$l]=new Set);var n=e+"__bubble";s.has(n)||(Bm(t,e,2,!1),s.add(n))}function Vo(e,t,s){var n=0;t&&(n|=4),Bm(s,e,n,t)}var $i="_reactListening"+Math.random().toString(36).slice(2);function di(e){if(!e[$i]){e[$i]=!0,qh.forEach(function(s){s!=="selectionchange"&&(ax.has(s)||Vo(s,!1,e),Vo(s,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[$i]||(t[$i]=!0,Vo("selectionchange",!1,t))}}function Bm(e,t,s,n){switch(Sm(t)){case 1:var i=bg;break;case 4:i=wg;break;default:i=Mc}s=i.bind(null,t,s,e),i=void 0,!zl||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,s,{capture:!0,passive:i}):e.addEventListener(t,s,!0):i!==void 0?e.addEventListener(t,s,{passive:i}):e.addEventListener(t,s,!1)}function Go(e,t,s,n,i){var a=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=n.return;o!==null;){var d=o.tag;if((d===3||d===4)&&(d=o.stateNode.containerInfo,d===i||d.nodeType===8&&d.parentNode===i))return;o=o.return}for(;l!==null;){if(o=fs(l),o===null)return;if(d=o.tag,d===5||d===6){n=a=o;continue e}l=l.parentNode}}n=n.return}cm(function(){var c=a,p=Dc(s),m=[];e:{var g=Mm.get(e);if(g!==void 0){var f=Bc,v=e;switch(e){case"keypress":if(ma(s)===0)break e;case"keydown":case"keyup":f=Pg;break;case"focusin":v="focus",f=$o;break;case"focusout":v="blur",f=$o;break;case"beforeblur":case"afterblur":f=$o;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=Kd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=Ng;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=$g;break;case Dm:case Rm:case Pm:f=Cg;break;case Lm:f=Fg;break;case"scroll":f=jg;break;case"wheel":f=Wg;break;case"copy":case"cut":case"paste":f=Ag;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=Jd}var j=(t&4)!==0,S=!j&&e==="scroll",u=j?g!==null?g+"Capture":null:g;j=[];for(var h=c,x;h!==null;){x=h;var _=x.stateNode;if(x.tag===5&&_!==null&&(x=_,u!==null&&(_=ni(h,u),_!=null&&j.push(ui(h,_,x)))),S)break;h=h.return}0<j.length&&(g=new f(g,v,null,s,p),m.push({event:g,listeners:j}))}}if(!(t&7)){e:{if(g=e==="mouseover"||e==="pointerover",f=e==="mouseout"||e==="pointerout",g&&s!==_l&&(v=s.relatedTarget||s.fromElement)&&(fs(v)||v[kr]))break e;if((f||g)&&(g=p.window===p?p:(g=p.ownerDocument)?g.defaultView||g.parentWindow:window,f?(v=s.relatedTarget||s.toElement,f=c,v=v?fs(v):null,v!==null&&(S=Cs(v),v!==S||v.tag!==5&&v.tag!==6)&&(v=null)):(f=null,v=c),f!==v)){if(j=Kd,_="onMouseLeave",u="onMouseEnter",h="mouse",(e==="pointerout"||e==="pointerover")&&(j=Jd,_="onPointerLeave",u="onPointerEnter",h="pointer"),S=f==null?g:Ks(f),x=v==null?g:Ks(v),g=new j(_,h+"leave",f,s,p),g.target=S,g.relatedTarget=x,_=null,fs(p)===c&&(j=new j(u,h+"enter",v,s,p),j.target=x,j.relatedTarget=S,_=j),S=_,f&&v)t:{for(j=f,u=v,h=0,x=j;x;x=Is(x))h++;for(x=0,_=u;_;_=Is(_))x++;for(;0<h-x;)j=Is(j),h--;for(;0<x-h;)u=Is(u),x--;for(;h--;){if(j===u||u!==null&&j===u.alternate)break t;j=Is(j),u=Is(u)}j=null}else j=null;f!==null&&ou(m,g,f,j,!1),v!==null&&S!==null&&ou(m,S,v,j,!0)}}e:{if(g=c?Ks(c):window,f=g.nodeName&&g.nodeName.toLowerCase(),f==="select"||f==="input"&&g.type==="file")var N=Jg;else if(Zd(g))if(Am)N=ex;else{N=Xg;var w=Yg}else(f=g.nodeName)&&f.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(N=Zg);if(N&&(N=N(e,c))){zm(m,N,s,p);break e}w&&w(e,g,c),e==="focusout"&&(w=g._wrapperState)&&w.controlled&&g.type==="number"&&wl(g,"number",g.value)}switch(w=c?Ks(c):window,e){case"focusin":(Zd(w)||w.contentEditable==="true")&&(Gs=w,Tl=c,Yn=null);break;case"focusout":Yn=Tl=Gs=null;break;case"mousedown":Dl=!0;break;case"contextmenu":case"mouseup":case"dragend":Dl=!1,nu(m,s,p);break;case"selectionchange":if(sx)break;case"keydown":case"keyup":nu(m,s,p)}var C;if(Uc)e:{switch(e){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else Vs?_m(e,s)&&(y="onCompositionEnd"):e==="keydown"&&s.keyCode===229&&(y="onCompositionStart");y&&(km&&s.locale!=="ko"&&(Vs||y!=="onCompositionStart"?y==="onCompositionEnd"&&Vs&&(C=Nm()):(Fr=p,$c="value"in Fr?Fr.value:Fr.textContent,Vs=!0)),w=Oa(c,y),0<w.length&&(y=new Qd(y,e,null,s,p),m.push({event:y,listeners:w}),C?y.data=C:(C=Cm(s),C!==null&&(y.data=C)))),(C=Vg?Gg(e,s):qg(e,s))&&(c=Oa(c,"onBeforeInput"),0<c.length&&(p=new Qd("onBeforeInput","beforeinput",null,s,p),m.push({event:p,listeners:c}),p.data=C))}$m(m,t)})}function ui(e,t,s){return{instance:e,listener:t,currentTarget:s}}function Oa(e,t){for(var s=t+"Capture",n=[];e!==null;){var i=e,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=ni(e,s),a!=null&&n.unshift(ui(e,a,i)),a=ni(e,t),a!=null&&n.push(ui(e,a,i))),e=e.return}return n}function Is(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function ou(e,t,s,n,i){for(var a=t._reactName,o=[];s!==null&&s!==n;){var l=s,d=l.alternate,c=l.stateNode;if(d!==null&&d===n)break;l.tag===5&&c!==null&&(l=c,i?(d=ni(s,a),d!=null&&o.unshift(ui(s,d,l))):i||(d=ni(s,a),d!=null&&o.push(ui(s,d,l)))),s=s.return}o.length!==0&&e.push({event:t,listeners:o})}var ox=/\r\n?/g,lx=/\u0000|\uFFFD/g;function lu(e){return(typeof e=="string"?e:""+e).replace(ox,`
`).replace(lx,"")}function Bi(e,t,s){if(t=lu(t),lu(e)!==t&&s)throw Error(q(425))}function Ta(){}var Rl=null,Pl=null;function Ll(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Ml=typeof setTimeout=="function"?setTimeout:void 0,cx=typeof clearTimeout=="function"?clearTimeout:void 0,cu=typeof Promise=="function"?Promise:void 0,dx=typeof queueMicrotask=="function"?queueMicrotask:typeof cu<"u"?function(e){return cu.resolve(null).then(e).catch(ux)}:Ml;function ux(e){setTimeout(function(){throw e})}function qo(e,t){var s=t,n=0;do{var i=s.nextSibling;if(e.removeChild(s),i&&i.nodeType===8)if(s=i.data,s==="/$"){if(n===0){e.removeChild(i),oi(t);return}n--}else s!=="$"&&s!=="$?"&&s!=="$!"||n++;s=i}while(s);oi(t)}function Gr(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function du(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var s=e.data;if(s==="$"||s==="$!"||s==="$?"){if(t===0)return e;t--}else s==="/$"&&t++}e=e.previousSibling}return null}var jn=Math.random().toString(36).slice(2),fr="__reactFiber$"+jn,hi="__reactProps$"+jn,kr="__reactContainer$"+jn,$l="__reactEvents$"+jn,hx="__reactListeners$"+jn,mx="__reactHandles$"+jn;function fs(e){var t=e[fr];if(t)return t;for(var s=e.parentNode;s;){if(t=s[kr]||s[fr]){if(s=t.alternate,t.child!==null||s!==null&&s.child!==null)for(e=du(e);e!==null;){if(s=e[fr])return s;e=du(e)}return t}e=s,s=e.parentNode}return null}function ki(e){return e=e[fr]||e[kr],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Ks(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(q(33))}function mo(e){return e[hi]||null}var Bl=[],Qs=-1;function es(e){return{current:e}}function je(e){0>Qs||(e.current=Bl[Qs],Bl[Qs]=null,Qs--)}function be(e,t){Qs++,Bl[Qs]=e.current,e.current=t}var Xr={},rt=es(Xr),vt=es(!1),ws=Xr;function hn(e,t){var s=e.type.contextTypes;if(!s)return Xr;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in s)i[a]=t[a];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function yt(e){return e=e.childContextTypes,e!=null}function Da(){je(vt),je(rt)}function uu(e,t,s){if(rt.current!==Xr)throw Error(q(168));be(rt,t),be(vt,s)}function Fm(e,t,s){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return s;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(q(108,Yf(e)||"Unknown",i));return Ee({},s,n)}function Ra(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Xr,ws=rt.current,be(rt,e),be(vt,vt.current),!0}function hu(e,t,s){var n=e.stateNode;if(!n)throw Error(q(169));s?(e=Fm(e,t,ws),n.__reactInternalMemoizedMergedChildContext=e,je(vt),je(rt),be(rt,e)):je(vt),be(vt,s)}var br=null,po=!1,Ko=!1;function Um(e){br===null?br=[e]:br.push(e)}function px(e){po=!0,Um(e)}function ts(){if(!Ko&&br!==null){Ko=!0;var e=0,t=ve;try{var s=br;for(ve=1;e<s.length;e++){var n=s[e];do n=n(!0);while(n!==null)}br=null,po=!1}catch(i){throw br!==null&&(br=br.slice(e+1)),mm(Rc,ts),i}finally{ve=t,Ko=!1}}return null}var Js=[],Ys=0,Pa=null,La=0,$t=[],Bt=0,js=null,wr=1,jr="";function ls(e,t){Js[Ys++]=La,Js[Ys++]=Pa,Pa=e,La=t}function Wm(e,t,s){$t[Bt++]=wr,$t[Bt++]=jr,$t[Bt++]=js,js=e;var n=wr;e=jr;var i=32-sr(n)-1;n&=~(1<<i),s+=1;var a=32-sr(t)+i;if(30<a){var o=i-i%5;a=(n&(1<<o)-1).toString(32),n>>=o,i-=o,wr=1<<32-sr(t)+i|s<<i|n,jr=a+e}else wr=1<<a|s<<i|n,jr=e}function Hc(e){e.return!==null&&(ls(e,1),Wm(e,1,0))}function Vc(e){for(;e===Pa;)Pa=Js[--Ys],Js[Ys]=null,La=Js[--Ys],Js[Ys]=null;for(;e===js;)js=$t[--Bt],$t[Bt]=null,jr=$t[--Bt],$t[Bt]=null,wr=$t[--Bt],$t[Bt]=null}var Et=null,At=null,ke=!1,rr=null;function Hm(e,t){var s=Ft(5,null,null,0);s.elementType="DELETED",s.stateNode=t,s.return=e,t=e.deletions,t===null?(e.deletions=[s],e.flags|=16):t.push(s)}function mu(e,t){switch(e.tag){case 5:var s=e.type;return t=t.nodeType!==1||s.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Et=e,At=Gr(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Et=e,At=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(s=js!==null?{id:wr,overflow:jr}:null,e.memoizedState={dehydrated:t,treeContext:s,retryLane:1073741824},s=Ft(18,null,null,0),s.stateNode=t,s.return=e,e.child=s,Et=e,At=null,!0):!1;default:return!1}}function Fl(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Ul(e){if(ke){var t=At;if(t){var s=t;if(!mu(e,t)){if(Fl(e))throw Error(q(418));t=Gr(s.nextSibling);var n=Et;t&&mu(e,t)?Hm(n,s):(e.flags=e.flags&-4097|2,ke=!1,Et=e)}}else{if(Fl(e))throw Error(q(418));e.flags=e.flags&-4097|2,ke=!1,Et=e}}}function pu(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Et=e}function Fi(e){if(e!==Et)return!1;if(!ke)return pu(e),ke=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Ll(e.type,e.memoizedProps)),t&&(t=At)){if(Fl(e))throw Vm(),Error(q(418));for(;t;)Hm(e,t),t=Gr(t.nextSibling)}if(pu(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(q(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var s=e.data;if(s==="/$"){if(t===0){At=Gr(e.nextSibling);break e}t--}else s!=="$"&&s!=="$!"&&s!=="$?"||t++}e=e.nextSibling}At=null}}else At=Et?Gr(e.stateNode.nextSibling):null;return!0}function Vm(){for(var e=At;e;)e=Gr(e.nextSibling)}function mn(){At=Et=null,ke=!1}function Gc(e){rr===null?rr=[e]:rr.push(e)}var fx=zr.ReactCurrentBatchConfig;function On(e,t,s){if(e=s.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(s._owner){if(s=s._owner,s){if(s.tag!==1)throw Error(q(309));var n=s.stateNode}if(!n)throw Error(q(147,e));var i=n,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(o){var l=i.refs;o===null?delete l[a]:l[a]=o},t._stringRef=a,t)}if(typeof e!="string")throw Error(q(284));if(!s._owner)throw Error(q(290,e))}return e}function Ui(e,t){throw e=Object.prototype.toString.call(t),Error(q(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function fu(e){var t=e._init;return t(e._payload)}function Gm(e){function t(u,h){if(e){var x=u.deletions;x===null?(u.deletions=[h],u.flags|=16):x.push(h)}}function s(u,h){if(!e)return null;for(;h!==null;)t(u,h),h=h.sibling;return null}function n(u,h){for(u=new Map;h!==null;)h.key!==null?u.set(h.key,h):u.set(h.index,h),h=h.sibling;return u}function i(u,h){return u=Jr(u,h),u.index=0,u.sibling=null,u}function a(u,h,x){return u.index=x,e?(x=u.alternate,x!==null?(x=x.index,x<h?(u.flags|=2,h):x):(u.flags|=2,h)):(u.flags|=1048576,h)}function o(u){return e&&u.alternate===null&&(u.flags|=2),u}function l(u,h,x,_){return h===null||h.tag!==6?(h=tl(x,u.mode,_),h.return=u,h):(h=i(h,x),h.return=u,h)}function d(u,h,x,_){var N=x.type;return N===Hs?p(u,h,x.props.children,_,x.key):h!==null&&(h.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Rr&&fu(N)===h.type)?(_=i(h,x.props),_.ref=On(u,h,x),_.return=u,_):(_=ba(x.type,x.key,x.props,null,u.mode,_),_.ref=On(u,h,x),_.return=u,_)}function c(u,h,x,_){return h===null||h.tag!==4||h.stateNode.containerInfo!==x.containerInfo||h.stateNode.implementation!==x.implementation?(h=rl(x,u.mode,_),h.return=u,h):(h=i(h,x.children||[]),h.return=u,h)}function p(u,h,x,_,N){return h===null||h.tag!==7?(h=bs(x,u.mode,_,N),h.return=u,h):(h=i(h,x),h.return=u,h)}function m(u,h,x){if(typeof h=="string"&&h!==""||typeof h=="number")return h=tl(""+h,u.mode,x),h.return=u,h;if(typeof h=="object"&&h!==null){switch(h.$$typeof){case Ii:return x=ba(h.type,h.key,h.props,null,u.mode,x),x.ref=On(u,null,h),x.return=u,x;case Ws:return h=rl(h,u.mode,x),h.return=u,h;case Rr:var _=h._init;return m(u,_(h._payload),x)}if(Fn(h)||Cn(h))return h=bs(h,u.mode,x,null),h.return=u,h;Ui(u,h)}return null}function g(u,h,x,_){var N=h!==null?h.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return N!==null?null:l(u,h,""+x,_);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Ii:return x.key===N?d(u,h,x,_):null;case Ws:return x.key===N?c(u,h,x,_):null;case Rr:return N=x._init,g(u,h,N(x._payload),_)}if(Fn(x)||Cn(x))return N!==null?null:p(u,h,x,_,null);Ui(u,x)}return null}function f(u,h,x,_,N){if(typeof _=="string"&&_!==""||typeof _=="number")return u=u.get(x)||null,l(h,u,""+_,N);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Ii:return u=u.get(_.key===null?x:_.key)||null,d(h,u,_,N);case Ws:return u=u.get(_.key===null?x:_.key)||null,c(h,u,_,N);case Rr:var w=_._init;return f(u,h,x,w(_._payload),N)}if(Fn(_)||Cn(_))return u=u.get(x)||null,p(h,u,_,N,null);Ui(h,_)}return null}function v(u,h,x,_){for(var N=null,w=null,C=h,y=h=0,L=null;C!==null&&y<x.length;y++){C.index>y?(L=C,C=null):L=C.sibling;var G=g(u,C,x[y],_);if(G===null){C===null&&(C=L);break}e&&C&&G.alternate===null&&t(u,C),h=a(G,h,y),w===null?N=G:w.sibling=G,w=G,C=L}if(y===x.length)return s(u,C),ke&&ls(u,y),N;if(C===null){for(;y<x.length;y++)C=m(u,x[y],_),C!==null&&(h=a(C,h,y),w===null?N=C:w.sibling=C,w=C);return ke&&ls(u,y),N}for(C=n(u,C);y<x.length;y++)L=f(C,u,y,x[y],_),L!==null&&(e&&L.alternate!==null&&C.delete(L.key===null?y:L.key),h=a(L,h,y),w===null?N=L:w.sibling=L,w=L);return e&&C.forEach(function(H){return t(u,H)}),ke&&ls(u,y),N}function j(u,h,x,_){var N=Cn(x);if(typeof N!="function")throw Error(q(150));if(x=N.call(x),x==null)throw Error(q(151));for(var w=N=null,C=h,y=h=0,L=null,G=x.next();C!==null&&!G.done;y++,G=x.next()){C.index>y?(L=C,C=null):L=C.sibling;var H=g(u,C,G.value,_);if(H===null){C===null&&(C=L);break}e&&C&&H.alternate===null&&t(u,C),h=a(H,h,y),w===null?N=H:w.sibling=H,w=H,C=L}if(G.done)return s(u,C),ke&&ls(u,y),N;if(C===null){for(;!G.done;y++,G=x.next())G=m(u,G.value,_),G!==null&&(h=a(G,h,y),w===null?N=G:w.sibling=G,w=G);return ke&&ls(u,y),N}for(C=n(u,C);!G.done;y++,G=x.next())G=f(C,u,y,G.value,_),G!==null&&(e&&G.alternate!==null&&C.delete(G.key===null?y:G.key),h=a(G,h,y),w===null?N=G:w.sibling=G,w=G);return e&&C.forEach(function(J){return t(u,J)}),ke&&ls(u,y),N}function S(u,h,x,_){if(typeof x=="object"&&x!==null&&x.type===Hs&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case Ii:e:{for(var N=x.key,w=h;w!==null;){if(w.key===N){if(N=x.type,N===Hs){if(w.tag===7){s(u,w.sibling),h=i(w,x.props.children),h.return=u,u=h;break e}}else if(w.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Rr&&fu(N)===w.type){s(u,w.sibling),h=i(w,x.props),h.ref=On(u,w,x),h.return=u,u=h;break e}s(u,w);break}else t(u,w);w=w.sibling}x.type===Hs?(h=bs(x.props.children,u.mode,_,x.key),h.return=u,u=h):(_=ba(x.type,x.key,x.props,null,u.mode,_),_.ref=On(u,h,x),_.return=u,u=_)}return o(u);case Ws:e:{for(w=x.key;h!==null;){if(h.key===w)if(h.tag===4&&h.stateNode.containerInfo===x.containerInfo&&h.stateNode.implementation===x.implementation){s(u,h.sibling),h=i(h,x.children||[]),h.return=u,u=h;break e}else{s(u,h);break}else t(u,h);h=h.sibling}h=rl(x,u.mode,_),h.return=u,u=h}return o(u);case Rr:return w=x._init,S(u,h,w(x._payload),_)}if(Fn(x))return v(u,h,x,_);if(Cn(x))return j(u,h,x,_);Ui(u,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,h!==null&&h.tag===6?(s(u,h.sibling),h=i(h,x),h.return=u,u=h):(s(u,h),h=tl(x,u.mode,_),h.return=u,u=h),o(u)):s(u,h)}return S}var pn=Gm(!0),qm=Gm(!1),Ma=es(null),$a=null,Xs=null,qc=null;function Kc(){qc=Xs=$a=null}function Qc(e){var t=Ma.current;je(Ma),e._currentValue=t}function Wl(e,t,s){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===s)break;e=e.return}}function on(e,t){$a=e,qc=Xs=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(xt=!0),e.firstContext=null)}function Wt(e){var t=e._currentValue;if(qc!==e)if(e={context:e,memoizedValue:t,next:null},Xs===null){if($a===null)throw Error(q(308));Xs=e,$a.dependencies={lanes:0,firstContext:e}}else Xs=Xs.next=e;return t}var gs=null;function Jc(e){gs===null?gs=[e]:gs.push(e)}function Km(e,t,s,n){var i=t.interleaved;return i===null?(s.next=s,Jc(t)):(s.next=i.next,i.next=s),t.interleaved=s,_r(e,n)}function _r(e,t){e.lanes|=t;var s=e.alternate;for(s!==null&&(s.lanes|=t),s=e,e=e.return;e!==null;)e.childLanes|=t,s=e.alternate,s!==null&&(s.childLanes|=t),s=e,e=e.return;return s.tag===3?s.stateNode:null}var Pr=!1;function Yc(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Qm(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Sr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function qr(e,t,s){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,fe&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,_r(e,s)}return i=n.interleaved,i===null?(t.next=t,Jc(n)):(t.next=i.next,i.next=t),n.interleaved=t,_r(e,s)}function pa(e,t,s){if(t=t.updateQueue,t!==null&&(t=t.shared,(s&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,s|=n,t.lanes=s,Pc(e,s)}}function gu(e,t){var s=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,s===n)){var i=null,a=null;if(s=s.firstBaseUpdate,s!==null){do{var o={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};a===null?i=a=o:a=a.next=o,s=s.next}while(s!==null);a===null?i=a=t:a=a.next=t}else i=a=t;s={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:n.shared,effects:n.effects},e.updateQueue=s;return}e=s.lastBaseUpdate,e===null?s.firstBaseUpdate=t:e.next=t,s.lastBaseUpdate=t}function Ba(e,t,s,n){var i=e.updateQueue;Pr=!1;var a=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var d=l,c=d.next;d.next=null,o===null?a=c:o.next=c,o=d;var p=e.alternate;p!==null&&(p=p.updateQueue,l=p.lastBaseUpdate,l!==o&&(l===null?p.firstBaseUpdate=c:l.next=c,p.lastBaseUpdate=d))}if(a!==null){var m=i.baseState;o=0,p=c=d=null,l=a;do{var g=l.lane,f=l.eventTime;if((n&g)===g){p!==null&&(p=p.next={eventTime:f,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var v=e,j=l;switch(g=t,f=s,j.tag){case 1:if(v=j.payload,typeof v=="function"){m=v.call(f,m,g);break e}m=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=j.payload,g=typeof v=="function"?v.call(f,m,g):v,g==null)break e;m=Ee({},m,g);break e;case 2:Pr=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,g=i.effects,g===null?i.effects=[l]:g.push(l))}else f={eventTime:f,lane:g,tag:l.tag,payload:l.payload,callback:l.callback,next:null},p===null?(c=p=f,d=m):p=p.next=f,o|=g;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;g=l,l=g.next,g.next=null,i.lastBaseUpdate=g,i.shared.pending=null}}while(!0);if(p===null&&(d=m),i.baseState=d,i.firstBaseUpdate=c,i.lastBaseUpdate=p,t=i.shared.interleaved,t!==null){i=t;do o|=i.lane,i=i.next;while(i!==t)}else a===null&&(i.shared.lanes=0);Ns|=o,e.lanes=o,e.memoizedState=m}}function xu(e,t,s){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=s,typeof i!="function")throw Error(q(191,i));i.call(n)}}}var _i={},xr=es(_i),mi=es(_i),pi=es(_i);function xs(e){if(e===_i)throw Error(q(174));return e}function Xc(e,t){switch(be(pi,t),be(mi,e),be(xr,_i),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Sl(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Sl(t,e)}je(xr),be(xr,t)}function fn(){je(xr),je(mi),je(pi)}function Jm(e){xs(pi.current);var t=xs(xr.current),s=Sl(t,e.type);t!==s&&(be(mi,e),be(xr,s))}function Zc(e){mi.current===e&&(je(xr),je(mi))}var ze=es(0);function Fa(e){for(var t=e;t!==null;){if(t.tag===13){var s=t.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||s.data==="$?"||s.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Qo=[];function ed(){for(var e=0;e<Qo.length;e++)Qo[e]._workInProgressVersionPrimary=null;Qo.length=0}var fa=zr.ReactCurrentDispatcher,Jo=zr.ReactCurrentBatchConfig,Ss=0,Ae=null,Fe=null,Ve=null,Ua=!1,Xn=!1,fi=0,gx=0;function Xe(){throw Error(q(321))}function td(e,t){if(t===null)return!1;for(var s=0;s<t.length&&s<e.length;s++)if(!ir(e[s],t[s]))return!1;return!0}function rd(e,t,s,n,i,a){if(Ss=a,Ae=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,fa.current=e===null||e.memoizedState===null?bx:wx,e=s(n,i),Xn){a=0;do{if(Xn=!1,fi=0,25<=a)throw Error(q(301));a+=1,Ve=Fe=null,t.updateQueue=null,fa.current=jx,e=s(n,i)}while(Xn)}if(fa.current=Wa,t=Fe!==null&&Fe.next!==null,Ss=0,Ve=Fe=Ae=null,Ua=!1,t)throw Error(q(300));return e}function sd(){var e=fi!==0;return fi=0,e}function mr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ve===null?Ae.memoizedState=Ve=e:Ve=Ve.next=e,Ve}function Ht(){if(Fe===null){var e=Ae.alternate;e=e!==null?e.memoizedState:null}else e=Fe.next;var t=Ve===null?Ae.memoizedState:Ve.next;if(t!==null)Ve=t,Fe=e;else{if(e===null)throw Error(q(310));Fe=e,e={memoizedState:Fe.memoizedState,baseState:Fe.baseState,baseQueue:Fe.baseQueue,queue:Fe.queue,next:null},Ve===null?Ae.memoizedState=Ve=e:Ve=Ve.next=e}return Ve}function gi(e,t){return typeof t=="function"?t(e):t}function Yo(e){var t=Ht(),s=t.queue;if(s===null)throw Error(q(311));s.lastRenderedReducer=e;var n=Fe,i=n.baseQueue,a=s.pending;if(a!==null){if(i!==null){var o=i.next;i.next=a.next,a.next=o}n.baseQueue=i=a,s.pending=null}if(i!==null){a=i.next,n=n.baseState;var l=o=null,d=null,c=a;do{var p=c.lane;if((Ss&p)===p)d!==null&&(d=d.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var m={lane:p,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};d===null?(l=d=m,o=n):d=d.next=m,Ae.lanes|=p,Ns|=p}c=c.next}while(c!==null&&c!==a);d===null?o=n:d.next=l,ir(n,t.memoizedState)||(xt=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=d,s.lastRenderedState=n}if(e=s.interleaved,e!==null){i=e;do a=i.lane,Ae.lanes|=a,Ns|=a,i=i.next;while(i!==e)}else i===null&&(s.lanes=0);return[t.memoizedState,s.dispatch]}function Xo(e){var t=Ht(),s=t.queue;if(s===null)throw Error(q(311));s.lastRenderedReducer=e;var n=s.dispatch,i=s.pending,a=t.memoizedState;if(i!==null){s.pending=null;var o=i=i.next;do a=e(a,o.action),o=o.next;while(o!==i);ir(a,t.memoizedState)||(xt=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),s.lastRenderedState=a}return[a,n]}function Ym(){}function Xm(e,t){var s=Ae,n=Ht(),i=t(),a=!ir(n.memoizedState,i);if(a&&(n.memoizedState=i,xt=!0),n=n.queue,nd(tp.bind(null,s,n,e),[e]),n.getSnapshot!==t||a||Ve!==null&&Ve.memoizedState.tag&1){if(s.flags|=2048,xi(9,ep.bind(null,s,n,i,t),void 0,null),Ge===null)throw Error(q(349));Ss&30||Zm(s,t,i)}return i}function Zm(e,t,s){e.flags|=16384,e={getSnapshot:t,value:s},t=Ae.updateQueue,t===null?(t={lastEffect:null,stores:null},Ae.updateQueue=t,t.stores=[e]):(s=t.stores,s===null?t.stores=[e]:s.push(e))}function ep(e,t,s,n){t.value=s,t.getSnapshot=n,rp(t)&&sp(e)}function tp(e,t,s){return s(function(){rp(t)&&sp(e)})}function rp(e){var t=e.getSnapshot;e=e.value;try{var s=t();return!ir(e,s)}catch{return!0}}function sp(e){var t=_r(e,1);t!==null&&nr(t,e,1,-1)}function vu(e){var t=mr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:gi,lastRenderedState:e},t.queue=e,e=e.dispatch=yx.bind(null,Ae,e),[t.memoizedState,e]}function xi(e,t,s,n){return e={tag:e,create:t,destroy:s,deps:n,next:null},t=Ae.updateQueue,t===null?(t={lastEffect:null,stores:null},Ae.updateQueue=t,t.lastEffect=e.next=e):(s=t.lastEffect,s===null?t.lastEffect=e.next=e:(n=s.next,s.next=e,e.next=n,t.lastEffect=e)),e}function np(){return Ht().memoizedState}function ga(e,t,s,n){var i=mr();Ae.flags|=e,i.memoizedState=xi(1|t,s,void 0,n===void 0?null:n)}function fo(e,t,s,n){var i=Ht();n=n===void 0?null:n;var a=void 0;if(Fe!==null){var o=Fe.memoizedState;if(a=o.destroy,n!==null&&td(n,o.deps)){i.memoizedState=xi(t,s,a,n);return}}Ae.flags|=e,i.memoizedState=xi(1|t,s,a,n)}function yu(e,t){return ga(8390656,8,e,t)}function nd(e,t){return fo(2048,8,e,t)}function ip(e,t){return fo(4,2,e,t)}function ap(e,t){return fo(4,4,e,t)}function op(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function lp(e,t,s){return s=s!=null?s.concat([e]):null,fo(4,4,op.bind(null,t,e),s)}function id(){}function cp(e,t){var s=Ht();t=t===void 0?null:t;var n=s.memoizedState;return n!==null&&t!==null&&td(t,n[1])?n[0]:(s.memoizedState=[e,t],e)}function dp(e,t){var s=Ht();t=t===void 0?null:t;var n=s.memoizedState;return n!==null&&t!==null&&td(t,n[1])?n[0]:(e=e(),s.memoizedState=[e,t],e)}function up(e,t,s){return Ss&21?(ir(s,t)||(s=gm(),Ae.lanes|=s,Ns|=s,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,xt=!0),e.memoizedState=s)}function xx(e,t){var s=ve;ve=s!==0&&4>s?s:4,e(!0);var n=Jo.transition;Jo.transition={};try{e(!1),t()}finally{ve=s,Jo.transition=n}}function hp(){return Ht().memoizedState}function vx(e,t,s){var n=Qr(e);if(s={lane:n,action:s,hasEagerState:!1,eagerState:null,next:null},mp(e))pp(t,s);else if(s=Km(e,t,s,n),s!==null){var i=ot();nr(s,e,n,i),fp(s,t,n)}}function yx(e,t,s){var n=Qr(e),i={lane:n,action:s,hasEagerState:!1,eagerState:null,next:null};if(mp(e))pp(t,i);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var o=t.lastRenderedState,l=a(o,s);if(i.hasEagerState=!0,i.eagerState=l,ir(l,o)){var d=t.interleaved;d===null?(i.next=i,Jc(t)):(i.next=d.next,d.next=i),t.interleaved=i;return}}catch{}finally{}s=Km(e,t,i,n),s!==null&&(i=ot(),nr(s,e,n,i),fp(s,t,n))}}function mp(e){var t=e.alternate;return e===Ae||t!==null&&t===Ae}function pp(e,t){Xn=Ua=!0;var s=e.pending;s===null?t.next=t:(t.next=s.next,s.next=t),e.pending=t}function fp(e,t,s){if(s&4194240){var n=t.lanes;n&=e.pendingLanes,s|=n,t.lanes=s,Pc(e,s)}}var Wa={readContext:Wt,useCallback:Xe,useContext:Xe,useEffect:Xe,useImperativeHandle:Xe,useInsertionEffect:Xe,useLayoutEffect:Xe,useMemo:Xe,useReducer:Xe,useRef:Xe,useState:Xe,useDebugValue:Xe,useDeferredValue:Xe,useTransition:Xe,useMutableSource:Xe,useSyncExternalStore:Xe,useId:Xe,unstable_isNewReconciler:!1},bx={readContext:Wt,useCallback:function(e,t){return mr().memoizedState=[e,t===void 0?null:t],e},useContext:Wt,useEffect:yu,useImperativeHandle:function(e,t,s){return s=s!=null?s.concat([e]):null,ga(4194308,4,op.bind(null,t,e),s)},useLayoutEffect:function(e,t){return ga(4194308,4,e,t)},useInsertionEffect:function(e,t){return ga(4,2,e,t)},useMemo:function(e,t){var s=mr();return t=t===void 0?null:t,e=e(),s.memoizedState=[e,t],e},useReducer:function(e,t,s){var n=mr();return t=s!==void 0?s(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=vx.bind(null,Ae,e),[n.memoizedState,e]},useRef:function(e){var t=mr();return e={current:e},t.memoizedState=e},useState:vu,useDebugValue:id,useDeferredValue:function(e){return mr().memoizedState=e},useTransition:function(){var e=vu(!1),t=e[0];return e=xx.bind(null,e[1]),mr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,s){var n=Ae,i=mr();if(ke){if(s===void 0)throw Error(q(407));s=s()}else{if(s=t(),Ge===null)throw Error(q(349));Ss&30||Zm(n,t,s)}i.memoizedState=s;var a={value:s,getSnapshot:t};return i.queue=a,yu(tp.bind(null,n,a,e),[e]),n.flags|=2048,xi(9,ep.bind(null,n,a,s,t),void 0,null),s},useId:function(){var e=mr(),t=Ge.identifierPrefix;if(ke){var s=jr,n=wr;s=(n&~(1<<32-sr(n)-1)).toString(32)+s,t=":"+t+"R"+s,s=fi++,0<s&&(t+="H"+s.toString(32)),t+=":"}else s=gx++,t=":"+t+"r"+s.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},wx={readContext:Wt,useCallback:cp,useContext:Wt,useEffect:nd,useImperativeHandle:lp,useInsertionEffect:ip,useLayoutEffect:ap,useMemo:dp,useReducer:Yo,useRef:np,useState:function(){return Yo(gi)},useDebugValue:id,useDeferredValue:function(e){var t=Ht();return up(t,Fe.memoizedState,e)},useTransition:function(){var e=Yo(gi)[0],t=Ht().memoizedState;return[e,t]},useMutableSource:Ym,useSyncExternalStore:Xm,useId:hp,unstable_isNewReconciler:!1},jx={readContext:Wt,useCallback:cp,useContext:Wt,useEffect:nd,useImperativeHandle:lp,useInsertionEffect:ip,useLayoutEffect:ap,useMemo:dp,useReducer:Xo,useRef:np,useState:function(){return Xo(gi)},useDebugValue:id,useDeferredValue:function(e){var t=Ht();return Fe===null?t.memoizedState=e:up(t,Fe.memoizedState,e)},useTransition:function(){var e=Xo(gi)[0],t=Ht().memoizedState;return[e,t]},useMutableSource:Ym,useSyncExternalStore:Xm,useId:hp,unstable_isNewReconciler:!1};function Xt(e,t){if(e&&e.defaultProps){t=Ee({},t),e=e.defaultProps;for(var s in e)t[s]===void 0&&(t[s]=e[s]);return t}return t}function Hl(e,t,s,n){t=e.memoizedState,s=s(n,t),s=s==null?t:Ee({},t,s),e.memoizedState=s,e.lanes===0&&(e.updateQueue.baseState=s)}var go={isMounted:function(e){return(e=e._reactInternals)?Cs(e)===e:!1},enqueueSetState:function(e,t,s){e=e._reactInternals;var n=ot(),i=Qr(e),a=Sr(n,i);a.payload=t,s!=null&&(a.callback=s),t=qr(e,a,i),t!==null&&(nr(t,e,i,n),pa(t,e,i))},enqueueReplaceState:function(e,t,s){e=e._reactInternals;var n=ot(),i=Qr(e),a=Sr(n,i);a.tag=1,a.payload=t,s!=null&&(a.callback=s),t=qr(e,a,i),t!==null&&(nr(t,e,i,n),pa(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var s=ot(),n=Qr(e),i=Sr(s,n);i.tag=2,t!=null&&(i.callback=t),t=qr(e,i,n),t!==null&&(nr(t,e,n,s),pa(t,e,n))}};function bu(e,t,s,n,i,a,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,a,o):t.prototype&&t.prototype.isPureReactComponent?!ci(s,n)||!ci(i,a):!0}function gp(e,t,s){var n=!1,i=Xr,a=t.contextType;return typeof a=="object"&&a!==null?a=Wt(a):(i=yt(t)?ws:rt.current,n=t.contextTypes,a=(n=n!=null)?hn(e,i):Xr),t=new t(s,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=go,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function wu(e,t,s,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(s,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(s,n),t.state!==e&&go.enqueueReplaceState(t,t.state,null)}function Vl(e,t,s,n){var i=e.stateNode;i.props=s,i.state=e.memoizedState,i.refs={},Yc(e);var a=t.contextType;typeof a=="object"&&a!==null?i.context=Wt(a):(a=yt(t)?ws:rt.current,i.context=hn(e,a)),i.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(Hl(e,t,a,s),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&go.enqueueReplaceState(i,i.state,null),Ba(e,s,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function gn(e,t){try{var s="",n=t;do s+=Jf(n),n=n.return;while(n);var i=s}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:i,digest:null}}function Zo(e,t,s){return{value:e,source:null,stack:s??null,digest:t??null}}function Gl(e,t){try{console.error(t.value)}catch(s){setTimeout(function(){throw s})}}var Sx=typeof WeakMap=="function"?WeakMap:Map;function xp(e,t,s){s=Sr(-1,s),s.tag=3,s.payload={element:null};var n=t.value;return s.callback=function(){Va||(Va=!0,rc=n),Gl(e,t)},s}function vp(e,t,s){s=Sr(-1,s),s.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;s.payload=function(){return n(i)},s.callback=function(){Gl(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(s.callback=function(){Gl(e,t),typeof n!="function"&&(Kr===null?Kr=new Set([this]):Kr.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),s}function ju(e,t,s){var n=e.pingCache;if(n===null){n=e.pingCache=new Sx;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(s)||(i.add(s),e=Lx.bind(null,e,t,s),t.then(e,e))}function Su(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Nu(e,t,s,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,s.flags|=131072,s.flags&=-52805,s.tag===1&&(s.alternate===null?s.tag=17:(t=Sr(-1,1),t.tag=2,qr(s,t,1))),s.lanes|=1),e)}var Nx=zr.ReactCurrentOwner,xt=!1;function at(e,t,s,n){t.child=e===null?qm(t,null,s,n):pn(t,e.child,s,n)}function ku(e,t,s,n,i){s=s.render;var a=t.ref;return on(t,i),n=rd(e,t,s,n,a,i),s=sd(),e!==null&&!xt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Cr(e,t,i)):(ke&&s&&Hc(t),t.flags|=1,at(e,t,n,i),t.child)}function _u(e,t,s,n,i){if(e===null){var a=s.type;return typeof a=="function"&&!md(a)&&a.defaultProps===void 0&&s.compare===null&&s.defaultProps===void 0?(t.tag=15,t.type=a,yp(e,t,a,n,i)):(e=ba(s.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&i)){var o=a.memoizedProps;if(s=s.compare,s=s!==null?s:ci,s(o,n)&&e.ref===t.ref)return Cr(e,t,i)}return t.flags|=1,e=Jr(a,n),e.ref=t.ref,e.return=t,t.child=e}function yp(e,t,s,n,i){if(e!==null){var a=e.memoizedProps;if(ci(a,n)&&e.ref===t.ref)if(xt=!1,t.pendingProps=n=a,(e.lanes&i)!==0)e.flags&131072&&(xt=!0);else return t.lanes=e.lanes,Cr(e,t,i)}return ql(e,t,s,n,i)}function bp(e,t,s){var n=t.pendingProps,i=n.children,a=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},be(en,Ct),Ct|=s;else{if(!(s&1073741824))return e=a!==null?a.baseLanes|s:s,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,be(en,Ct),Ct|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:s,be(en,Ct),Ct|=n}else a!==null?(n=a.baseLanes|s,t.memoizedState=null):n=s,be(en,Ct),Ct|=n;return at(e,t,i,s),t.child}function wp(e,t){var s=t.ref;(e===null&&s!==null||e!==null&&e.ref!==s)&&(t.flags|=512,t.flags|=2097152)}function ql(e,t,s,n,i){var a=yt(s)?ws:rt.current;return a=hn(t,a),on(t,i),s=rd(e,t,s,n,a,i),n=sd(),e!==null&&!xt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Cr(e,t,i)):(ke&&n&&Hc(t),t.flags|=1,at(e,t,s,i),t.child)}function Cu(e,t,s,n,i){if(yt(s)){var a=!0;Ra(t)}else a=!1;if(on(t,i),t.stateNode===null)xa(e,t),gp(t,s,n),Vl(t,s,n,i),n=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var d=o.context,c=s.contextType;typeof c=="object"&&c!==null?c=Wt(c):(c=yt(s)?ws:rt.current,c=hn(t,c));var p=s.getDerivedStateFromProps,m=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||d!==c)&&wu(t,o,n,c),Pr=!1;var g=t.memoizedState;o.state=g,Ba(t,n,o,i),d=t.memoizedState,l!==n||g!==d||vt.current||Pr?(typeof p=="function"&&(Hl(t,s,p,n),d=t.memoizedState),(l=Pr||bu(t,s,l,n,g,d,c))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=d),o.props=n,o.state=d,o.context=c,n=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,Qm(e,t),l=t.memoizedProps,c=t.type===t.elementType?l:Xt(t.type,l),o.props=c,m=t.pendingProps,g=o.context,d=s.contextType,typeof d=="object"&&d!==null?d=Wt(d):(d=yt(s)?ws:rt.current,d=hn(t,d));var f=s.getDerivedStateFromProps;(p=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==m||g!==d)&&wu(t,o,n,d),Pr=!1,g=t.memoizedState,o.state=g,Ba(t,n,o,i);var v=t.memoizedState;l!==m||g!==v||vt.current||Pr?(typeof f=="function"&&(Hl(t,s,f,n),v=t.memoizedState),(c=Pr||bu(t,s,c,n,g,v,d)||!1)?(p||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,v,d),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,v,d)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&g===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&g===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=v),o.props=n,o.state=v,o.context=d,n=c):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&g===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&g===e.memoizedState||(t.flags|=1024),n=!1)}return Kl(e,t,s,n,a,i)}function Kl(e,t,s,n,i,a){wp(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return i&&hu(t,s,!1),Cr(e,t,a);n=t.stateNode,Nx.current=t;var l=o&&typeof s.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=pn(t,e.child,null,a),t.child=pn(t,null,l,a)):at(e,t,l,a),t.memoizedState=n.state,i&&hu(t,s,!0),t.child}function jp(e){var t=e.stateNode;t.pendingContext?uu(e,t.pendingContext,t.pendingContext!==t.context):t.context&&uu(e,t.context,!1),Xc(e,t.containerInfo)}function zu(e,t,s,n,i){return mn(),Gc(i),t.flags|=256,at(e,t,s,n),t.child}var Ql={dehydrated:null,treeContext:null,retryLane:0};function Jl(e){return{baseLanes:e,cachePool:null,transitions:null}}function Sp(e,t,s){var n=t.pendingProps,i=ze.current,a=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(i&2)!==0),l?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),be(ze,i&1),e===null)return Ul(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,a?(n=t.mode,a=t.child,o={mode:"hidden",children:o},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=o):a=yo(o,n,0,null),e=bs(e,n,s,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Jl(s),t.memoizedState=Ql,e):ad(t,o));if(i=e.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return kx(e,t,o,n,l,i,s);if(a){a=n.fallback,o=t.mode,i=e.child,l=i.sibling;var d={mode:"hidden",children:n.children};return!(o&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=d,t.deletions=null):(n=Jr(i,d),n.subtreeFlags=i.subtreeFlags&14680064),l!==null?a=Jr(l,a):(a=bs(a,o,s,null),a.flags|=2),a.return=t,n.return=t,n.sibling=a,t.child=n,n=a,a=t.child,o=e.child.memoizedState,o=o===null?Jl(s):{baseLanes:o.baseLanes|s,cachePool:null,transitions:o.transitions},a.memoizedState=o,a.childLanes=e.childLanes&~s,t.memoizedState=Ql,n}return a=e.child,e=a.sibling,n=Jr(a,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=s),n.return=t,n.sibling=null,e!==null&&(s=t.deletions,s===null?(t.deletions=[e],t.flags|=16):s.push(e)),t.child=n,t.memoizedState=null,n}function ad(e,t){return t=yo({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Wi(e,t,s,n){return n!==null&&Gc(n),pn(t,e.child,null,s),e=ad(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function kx(e,t,s,n,i,a,o){if(s)return t.flags&256?(t.flags&=-257,n=Zo(Error(q(422))),Wi(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=n.fallback,i=t.mode,n=yo({mode:"visible",children:n.children},i,0,null),a=bs(a,i,o,null),a.flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,t.mode&1&&pn(t,e.child,null,o),t.child.memoizedState=Jl(o),t.memoizedState=Ql,a);if(!(t.mode&1))return Wi(e,t,o,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var l=n.dgst;return n=l,a=Error(q(419)),n=Zo(a,n,void 0),Wi(e,t,o,n)}if(l=(o&e.childLanes)!==0,xt||l){if(n=Ge,n!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|o)?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,_r(e,i),nr(n,e,i,-1))}return hd(),n=Zo(Error(q(421))),Wi(e,t,o,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=Mx.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,At=Gr(i.nextSibling),Et=t,ke=!0,rr=null,e!==null&&($t[Bt++]=wr,$t[Bt++]=jr,$t[Bt++]=js,wr=e.id,jr=e.overflow,js=t),t=ad(t,n.children),t.flags|=4096,t)}function Au(e,t,s){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Wl(e.return,t,s)}function el(e,t,s,n,i){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:s,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=s,a.tailMode=i)}function Np(e,t,s){var n=t.pendingProps,i=n.revealOrder,a=n.tail;if(at(e,t,n.children,s),n=ze.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Au(e,s,t);else if(e.tag===19)Au(e,s,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(be(ze,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(s=t.child,i=null;s!==null;)e=s.alternate,e!==null&&Fa(e)===null&&(i=s),s=s.sibling;s=i,s===null?(i=t.child,t.child=null):(i=s.sibling,s.sibling=null),el(t,!1,i,s,a);break;case"backwards":for(s=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&Fa(e)===null){t.child=i;break}e=i.sibling,i.sibling=s,s=i,i=e}el(t,!0,s,null,a);break;case"together":el(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function xa(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Cr(e,t,s){if(e!==null&&(t.dependencies=e.dependencies),Ns|=t.lanes,!(s&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(q(153));if(t.child!==null){for(e=t.child,s=Jr(e,e.pendingProps),t.child=s,s.return=t;e.sibling!==null;)e=e.sibling,s=s.sibling=Jr(e,e.pendingProps),s.return=t;s.sibling=null}return t.child}function _x(e,t,s){switch(t.tag){case 3:jp(t),mn();break;case 5:Jm(t);break;case 1:yt(t.type)&&Ra(t);break;case 4:Xc(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;be(Ma,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(be(ze,ze.current&1),t.flags|=128,null):s&t.child.childLanes?Sp(e,t,s):(be(ze,ze.current&1),e=Cr(e,t,s),e!==null?e.sibling:null);be(ze,ze.current&1);break;case 19:if(n=(s&t.childLanes)!==0,e.flags&128){if(n)return Np(e,t,s);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),be(ze,ze.current),n)break;return null;case 22:case 23:return t.lanes=0,bp(e,t,s)}return Cr(e,t,s)}var kp,Yl,_p,Cp;kp=function(e,t){for(var s=t.child;s!==null;){if(s.tag===5||s.tag===6)e.appendChild(s.stateNode);else if(s.tag!==4&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===t)break;for(;s.sibling===null;){if(s.return===null||s.return===t)return;s=s.return}s.sibling.return=s.return,s=s.sibling}};Yl=function(){};_p=function(e,t,s,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,xs(xr.current);var a=null;switch(s){case"input":i=yl(e,i),n=yl(e,n),a=[];break;case"select":i=Ee({},i,{value:void 0}),n=Ee({},n,{value:void 0}),a=[];break;case"textarea":i=jl(e,i),n=jl(e,n),a=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Ta)}Nl(s,n);var o;s=null;for(c in i)if(!n.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var l=i[c];for(o in l)l.hasOwnProperty(o)&&(s||(s={}),s[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(ri.hasOwnProperty(c)?a||(a=[]):(a=a||[]).push(c,null));for(c in n){var d=n[c];if(l=i!=null?i[c]:void 0,n.hasOwnProperty(c)&&d!==l&&(d!=null||l!=null))if(c==="style")if(l){for(o in l)!l.hasOwnProperty(o)||d&&d.hasOwnProperty(o)||(s||(s={}),s[o]="");for(o in d)d.hasOwnProperty(o)&&l[o]!==d[o]&&(s||(s={}),s[o]=d[o])}else s||(a||(a=[]),a.push(c,s)),s=d;else c==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,l=l?l.__html:void 0,d!=null&&l!==d&&(a=a||[]).push(c,d)):c==="children"?typeof d!="string"&&typeof d!="number"||(a=a||[]).push(c,""+d):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(ri.hasOwnProperty(c)?(d!=null&&c==="onScroll"&&we("scroll",e),a||l===d||(a=[])):(a=a||[]).push(c,d))}s&&(a=a||[]).push("style",s);var c=a;(t.updateQueue=c)&&(t.flags|=4)}};Cp=function(e,t,s,n){s!==n&&(t.flags|=4)};function Tn(e,t){if(!ke)switch(e.tailMode){case"hidden":t=e.tail;for(var s=null;t!==null;)t.alternate!==null&&(s=t),t=t.sibling;s===null?e.tail=null:s.sibling=null;break;case"collapsed":s=e.tail;for(var n=null;s!==null;)s.alternate!==null&&(n=s),s=s.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Ze(e){var t=e.alternate!==null&&e.alternate.child===e.child,s=0,n=0;if(t)for(var i=e.child;i!==null;)s|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)s|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=s,t}function Cx(e,t,s){var n=t.pendingProps;switch(Vc(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ze(t),null;case 1:return yt(t.type)&&Da(),Ze(t),null;case 3:return n=t.stateNode,fn(),je(vt),je(rt),ed(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Fi(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,rr!==null&&(ic(rr),rr=null))),Yl(e,t),Ze(t),null;case 5:Zc(t);var i=xs(pi.current);if(s=t.type,e!==null&&t.stateNode!=null)_p(e,t,s,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(q(166));return Ze(t),null}if(e=xs(xr.current),Fi(t)){n=t.stateNode,s=t.type;var a=t.memoizedProps;switch(n[fr]=t,n[hi]=a,e=(t.mode&1)!==0,s){case"dialog":we("cancel",n),we("close",n);break;case"iframe":case"object":case"embed":we("load",n);break;case"video":case"audio":for(i=0;i<Wn.length;i++)we(Wn[i],n);break;case"source":we("error",n);break;case"img":case"image":case"link":we("error",n),we("load",n);break;case"details":we("toggle",n);break;case"input":Md(n,a),we("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},we("invalid",n);break;case"textarea":Bd(n,a),we("invalid",n)}Nl(s,a),i=null;for(var o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="children"?typeof l=="string"?n.textContent!==l&&(a.suppressHydrationWarning!==!0&&Bi(n.textContent,l,e),i=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(a.suppressHydrationWarning!==!0&&Bi(n.textContent,l,e),i=["children",""+l]):ri.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&we("scroll",n)}switch(s){case"input":Oi(n),$d(n,a,!0);break;case"textarea":Oi(n),Fd(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=Ta)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=tm(s)),e==="http://www.w3.org/1999/xhtml"?s==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(s,{is:n.is}):(e=o.createElement(s),s==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,s),e[fr]=t,e[hi]=n,kp(e,t,!1,!1),t.stateNode=e;e:{switch(o=kl(s,n),s){case"dialog":we("cancel",e),we("close",e),i=n;break;case"iframe":case"object":case"embed":we("load",e),i=n;break;case"video":case"audio":for(i=0;i<Wn.length;i++)we(Wn[i],e);i=n;break;case"source":we("error",e),i=n;break;case"img":case"image":case"link":we("error",e),we("load",e),i=n;break;case"details":we("toggle",e),i=n;break;case"input":Md(e,n),i=yl(e,n),we("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=Ee({},n,{value:void 0}),we("invalid",e);break;case"textarea":Bd(e,n),i=jl(e,n),we("invalid",e);break;default:i=n}Nl(s,i),l=i;for(a in l)if(l.hasOwnProperty(a)){var d=l[a];a==="style"?nm(e,d):a==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,d!=null&&rm(e,d)):a==="children"?typeof d=="string"?(s!=="textarea"||d!=="")&&si(e,d):typeof d=="number"&&si(e,""+d):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(ri.hasOwnProperty(a)?d!=null&&a==="onScroll"&&we("scroll",e):d!=null&&Ec(e,a,d,o))}switch(s){case"input":Oi(e),$d(e,n,!1);break;case"textarea":Oi(e),Fd(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Yr(n.value));break;case"select":e.multiple=!!n.multiple,a=n.value,a!=null?rn(e,!!n.multiple,a,!1):n.defaultValue!=null&&rn(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=Ta)}switch(s){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Ze(t),null;case 6:if(e&&t.stateNode!=null)Cp(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(q(166));if(s=xs(pi.current),xs(xr.current),Fi(t)){if(n=t.stateNode,s=t.memoizedProps,n[fr]=t,(a=n.nodeValue!==s)&&(e=Et,e!==null))switch(e.tag){case 3:Bi(n.nodeValue,s,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Bi(n.nodeValue,s,(e.mode&1)!==0)}a&&(t.flags|=4)}else n=(s.nodeType===9?s:s.ownerDocument).createTextNode(n),n[fr]=t,t.stateNode=n}return Ze(t),null;case 13:if(je(ze),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(ke&&At!==null&&t.mode&1&&!(t.flags&128))Vm(),mn(),t.flags|=98560,a=!1;else if(a=Fi(t),n!==null&&n.dehydrated!==null){if(e===null){if(!a)throw Error(q(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(q(317));a[fr]=t}else mn(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Ze(t),a=!1}else rr!==null&&(ic(rr),rr=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=s,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||ze.current&1?Ue===0&&(Ue=3):hd())),t.updateQueue!==null&&(t.flags|=4),Ze(t),null);case 4:return fn(),Yl(e,t),e===null&&di(t.stateNode.containerInfo),Ze(t),null;case 10:return Qc(t.type._context),Ze(t),null;case 17:return yt(t.type)&&Da(),Ze(t),null;case 19:if(je(ze),a=t.memoizedState,a===null)return Ze(t),null;if(n=(t.flags&128)!==0,o=a.rendering,o===null)if(n)Tn(a,!1);else{if(Ue!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=Fa(e),o!==null){for(t.flags|=128,Tn(a,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=s,s=t.child;s!==null;)a=s,e=n,a.flags&=14680066,o=a.alternate,o===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,e=o.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),s=s.sibling;return be(ze,ze.current&1|2),t.child}e=e.sibling}a.tail!==null&&Te()>xn&&(t.flags|=128,n=!0,Tn(a,!1),t.lanes=4194304)}else{if(!n)if(e=Fa(o),e!==null){if(t.flags|=128,n=!0,s=e.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),Tn(a,!0),a.tail===null&&a.tailMode==="hidden"&&!o.alternate&&!ke)return Ze(t),null}else 2*Te()-a.renderingStartTime>xn&&s!==1073741824&&(t.flags|=128,n=!0,Tn(a,!1),t.lanes=4194304);a.isBackwards?(o.sibling=t.child,t.child=o):(s=a.last,s!==null?s.sibling=o:t.child=o,a.last=o)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Te(),t.sibling=null,s=ze.current,be(ze,n?s&1|2:s&1),t):(Ze(t),null);case 22:case 23:return ud(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Ct&1073741824&&(Ze(t),t.subtreeFlags&6&&(t.flags|=8192)):Ze(t),null;case 24:return null;case 25:return null}throw Error(q(156,t.tag))}function zx(e,t){switch(Vc(t),t.tag){case 1:return yt(t.type)&&Da(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return fn(),je(vt),je(rt),ed(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Zc(t),null;case 13:if(je(ze),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(q(340));mn()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return je(ze),null;case 4:return fn(),null;case 10:return Qc(t.type._context),null;case 22:case 23:return ud(),null;case 24:return null;default:return null}}var Hi=!1,et=!1,Ax=typeof WeakSet=="function"?WeakSet:Set,X=null;function Zs(e,t){var s=e.ref;if(s!==null)if(typeof s=="function")try{s(null)}catch(n){Ie(e,t,n)}else s.current=null}function Xl(e,t,s){try{s()}catch(n){Ie(e,t,n)}}var Eu=!1;function Ex(e,t){if(Rl=Ea,e=Om(),Wc(e)){if("selectionStart"in e)var s={start:e.selectionStart,end:e.selectionEnd};else e:{s=(s=e.ownerDocument)&&s.defaultView||window;var n=s.getSelection&&s.getSelection();if(n&&n.rangeCount!==0){s=n.anchorNode;var i=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{s.nodeType,a.nodeType}catch{s=null;break e}var o=0,l=-1,d=-1,c=0,p=0,m=e,g=null;t:for(;;){for(var f;m!==s||i!==0&&m.nodeType!==3||(l=o+i),m!==a||n!==0&&m.nodeType!==3||(d=o+n),m.nodeType===3&&(o+=m.nodeValue.length),(f=m.firstChild)!==null;)g=m,m=f;for(;;){if(m===e)break t;if(g===s&&++c===i&&(l=o),g===a&&++p===n&&(d=o),(f=m.nextSibling)!==null)break;m=g,g=m.parentNode}m=f}s=l===-1||d===-1?null:{start:l,end:d}}else s=null}s=s||{start:0,end:0}}else s=null;for(Pl={focusedElem:e,selectionRange:s},Ea=!1,X=t;X!==null;)if(t=X,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,X=e;else for(;X!==null;){t=X;try{var v=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var j=v.memoizedProps,S=v.memoizedState,u=t.stateNode,h=u.getSnapshotBeforeUpdate(t.elementType===t.type?j:Xt(t.type,j),S);u.__reactInternalSnapshotBeforeUpdate=h}break;case 3:var x=t.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(q(163))}}catch(_){Ie(t,t.return,_)}if(e=t.sibling,e!==null){e.return=t.return,X=e;break}X=t.return}return v=Eu,Eu=!1,v}function Zn(e,t,s){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,a!==void 0&&Xl(t,s,a)}i=i.next}while(i!==n)}}function xo(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var s=t=t.next;do{if((s.tag&e)===e){var n=s.create;s.destroy=n()}s=s.next}while(s!==t)}}function Zl(e){var t=e.ref;if(t!==null){var s=e.stateNode;switch(e.tag){case 5:e=s;break;default:e=s}typeof t=="function"?t(e):t.current=e}}function zp(e){var t=e.alternate;t!==null&&(e.alternate=null,zp(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[fr],delete t[hi],delete t[$l],delete t[hx],delete t[mx])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Ap(e){return e.tag===5||e.tag===3||e.tag===4}function Iu(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Ap(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function ec(e,t,s){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?s.nodeType===8?s.parentNode.insertBefore(e,t):s.insertBefore(e,t):(s.nodeType===8?(t=s.parentNode,t.insertBefore(e,s)):(t=s,t.appendChild(e)),s=s._reactRootContainer,s!=null||t.onclick!==null||(t.onclick=Ta));else if(n!==4&&(e=e.child,e!==null))for(ec(e,t,s),e=e.sibling;e!==null;)ec(e,t,s),e=e.sibling}function tc(e,t,s){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?s.insertBefore(e,t):s.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(tc(e,t,s),e=e.sibling;e!==null;)tc(e,t,s),e=e.sibling}var Qe=null,er=!1;function Or(e,t,s){for(s=s.child;s!==null;)Ep(e,t,s),s=s.sibling}function Ep(e,t,s){if(gr&&typeof gr.onCommitFiberUnmount=="function")try{gr.onCommitFiberUnmount(lo,s)}catch{}switch(s.tag){case 5:et||Zs(s,t);case 6:var n=Qe,i=er;Qe=null,Or(e,t,s),Qe=n,er=i,Qe!==null&&(er?(e=Qe,s=s.stateNode,e.nodeType===8?e.parentNode.removeChild(s):e.removeChild(s)):Qe.removeChild(s.stateNode));break;case 18:Qe!==null&&(er?(e=Qe,s=s.stateNode,e.nodeType===8?qo(e.parentNode,s):e.nodeType===1&&qo(e,s),oi(e)):qo(Qe,s.stateNode));break;case 4:n=Qe,i=er,Qe=s.stateNode.containerInfo,er=!0,Or(e,t,s),Qe=n,er=i;break;case 0:case 11:case 14:case 15:if(!et&&(n=s.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var a=i,o=a.destroy;a=a.tag,o!==void 0&&(a&2||a&4)&&Xl(s,t,o),i=i.next}while(i!==n)}Or(e,t,s);break;case 1:if(!et&&(Zs(s,t),n=s.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=s.memoizedProps,n.state=s.memoizedState,n.componentWillUnmount()}catch(l){Ie(s,t,l)}Or(e,t,s);break;case 21:Or(e,t,s);break;case 22:s.mode&1?(et=(n=et)||s.memoizedState!==null,Or(e,t,s),et=n):Or(e,t,s);break;default:Or(e,t,s)}}function Ou(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var s=e.stateNode;s===null&&(s=e.stateNode=new Ax),t.forEach(function(n){var i=$x.bind(null,e,n);s.has(n)||(s.add(n),n.then(i,i))})}}function Kt(e,t){var s=t.deletions;if(s!==null)for(var n=0;n<s.length;n++){var i=s[n];try{var a=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:Qe=l.stateNode,er=!1;break e;case 3:Qe=l.stateNode.containerInfo,er=!0;break e;case 4:Qe=l.stateNode.containerInfo,er=!0;break e}l=l.return}if(Qe===null)throw Error(q(160));Ep(a,o,i),Qe=null,er=!1;var d=i.alternate;d!==null&&(d.return=null),i.return=null}catch(c){Ie(i,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Ip(t,e),t=t.sibling}function Ip(e,t){var s=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Kt(t,e),cr(e),n&4){try{Zn(3,e,e.return),xo(3,e)}catch(j){Ie(e,e.return,j)}try{Zn(5,e,e.return)}catch(j){Ie(e,e.return,j)}}break;case 1:Kt(t,e),cr(e),n&512&&s!==null&&Zs(s,s.return);break;case 5:if(Kt(t,e),cr(e),n&512&&s!==null&&Zs(s,s.return),e.flags&32){var i=e.stateNode;try{si(i,"")}catch(j){Ie(e,e.return,j)}}if(n&4&&(i=e.stateNode,i!=null)){var a=e.memoizedProps,o=s!==null?s.memoizedProps:a,l=e.type,d=e.updateQueue;if(e.updateQueue=null,d!==null)try{l==="input"&&a.type==="radio"&&a.name!=null&&Zh(i,a),kl(l,o);var c=kl(l,a);for(o=0;o<d.length;o+=2){var p=d[o],m=d[o+1];p==="style"?nm(i,m):p==="dangerouslySetInnerHTML"?rm(i,m):p==="children"?si(i,m):Ec(i,p,m,c)}switch(l){case"input":bl(i,a);break;case"textarea":em(i,a);break;case"select":var g=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var f=a.value;f!=null?rn(i,!!a.multiple,f,!1):g!==!!a.multiple&&(a.defaultValue!=null?rn(i,!!a.multiple,a.defaultValue,!0):rn(i,!!a.multiple,a.multiple?[]:"",!1))}i[hi]=a}catch(j){Ie(e,e.return,j)}}break;case 6:if(Kt(t,e),cr(e),n&4){if(e.stateNode===null)throw Error(q(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch(j){Ie(e,e.return,j)}}break;case 3:if(Kt(t,e),cr(e),n&4&&s!==null&&s.memoizedState.isDehydrated)try{oi(t.containerInfo)}catch(j){Ie(e,e.return,j)}break;case 4:Kt(t,e),cr(e);break;case 13:Kt(t,e),cr(e),i=e.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(cd=Te())),n&4&&Ou(e);break;case 22:if(p=s!==null&&s.memoizedState!==null,e.mode&1?(et=(c=et)||p,Kt(t,e),et=c):Kt(t,e),cr(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!p&&e.mode&1)for(X=e,p=e.child;p!==null;){for(m=X=p;X!==null;){switch(g=X,f=g.child,g.tag){case 0:case 11:case 14:case 15:Zn(4,g,g.return);break;case 1:Zs(g,g.return);var v=g.stateNode;if(typeof v.componentWillUnmount=="function"){n=g,s=g.return;try{t=n,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(j){Ie(n,s,j)}}break;case 5:Zs(g,g.return);break;case 22:if(g.memoizedState!==null){Du(m);continue}}f!==null?(f.return=g,X=f):Du(m)}p=p.sibling}e:for(p=null,m=e;;){if(m.tag===5){if(p===null){p=m;try{i=m.stateNode,c?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(l=m.stateNode,d=m.memoizedProps.style,o=d!=null&&d.hasOwnProperty("display")?d.display:null,l.style.display=sm("display",o))}catch(j){Ie(e,e.return,j)}}}else if(m.tag===6){if(p===null)try{m.stateNode.nodeValue=c?"":m.memoizedProps}catch(j){Ie(e,e.return,j)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===e)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===e)break e;for(;m.sibling===null;){if(m.return===null||m.return===e)break e;p===m&&(p=null),m=m.return}p===m&&(p=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:Kt(t,e),cr(e),n&4&&Ou(e);break;case 21:break;default:Kt(t,e),cr(e)}}function cr(e){var t=e.flags;if(t&2){try{e:{for(var s=e.return;s!==null;){if(Ap(s)){var n=s;break e}s=s.return}throw Error(q(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(si(i,""),n.flags&=-33);var a=Iu(e);tc(e,a,i);break;case 3:case 4:var o=n.stateNode.containerInfo,l=Iu(e);ec(e,l,o);break;default:throw Error(q(161))}}catch(d){Ie(e,e.return,d)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Ix(e,t,s){X=e,Op(e)}function Op(e,t,s){for(var n=(e.mode&1)!==0;X!==null;){var i=X,a=i.child;if(i.tag===22&&n){var o=i.memoizedState!==null||Hi;if(!o){var l=i.alternate,d=l!==null&&l.memoizedState!==null||et;l=Hi;var c=et;if(Hi=o,(et=d)&&!c)for(X=i;X!==null;)o=X,d=o.child,o.tag===22&&o.memoizedState!==null?Ru(i):d!==null?(d.return=o,X=d):Ru(i);for(;a!==null;)X=a,Op(a),a=a.sibling;X=i,Hi=l,et=c}Tu(e)}else i.subtreeFlags&8772&&a!==null?(a.return=i,X=a):Tu(e)}}function Tu(e){for(;X!==null;){var t=X;if(t.flags&8772){var s=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:et||xo(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!et)if(s===null)n.componentDidMount();else{var i=t.elementType===t.type?s.memoizedProps:Xt(t.type,s.memoizedProps);n.componentDidUpdate(i,s.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&xu(t,a,n);break;case 3:var o=t.updateQueue;if(o!==null){if(s=null,t.child!==null)switch(t.child.tag){case 5:s=t.child.stateNode;break;case 1:s=t.child.stateNode}xu(t,o,s)}break;case 5:var l=t.stateNode;if(s===null&&t.flags&4){s=l;var d=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":d.autoFocus&&s.focus();break;case"img":d.src&&(s.src=d.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var p=c.memoizedState;if(p!==null){var m=p.dehydrated;m!==null&&oi(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(q(163))}et||t.flags&512&&Zl(t)}catch(g){Ie(t,t.return,g)}}if(t===e){X=null;break}if(s=t.sibling,s!==null){s.return=t.return,X=s;break}X=t.return}}function Du(e){for(;X!==null;){var t=X;if(t===e){X=null;break}var s=t.sibling;if(s!==null){s.return=t.return,X=s;break}X=t.return}}function Ru(e){for(;X!==null;){var t=X;try{switch(t.tag){case 0:case 11:case 15:var s=t.return;try{xo(4,t)}catch(d){Ie(t,s,d)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(d){Ie(t,i,d)}}var a=t.return;try{Zl(t)}catch(d){Ie(t,a,d)}break;case 5:var o=t.return;try{Zl(t)}catch(d){Ie(t,o,d)}}}catch(d){Ie(t,t.return,d)}if(t===e){X=null;break}var l=t.sibling;if(l!==null){l.return=t.return,X=l;break}X=t.return}}var Ox=Math.ceil,Ha=zr.ReactCurrentDispatcher,od=zr.ReactCurrentOwner,Ut=zr.ReactCurrentBatchConfig,fe=0,Ge=null,$e=null,Je=0,Ct=0,en=es(0),Ue=0,vi=null,Ns=0,vo=0,ld=0,ei=null,ft=null,cd=0,xn=1/0,yr=null,Va=!1,rc=null,Kr=null,Vi=!1,Ur=null,Ga=0,ti=0,sc=null,va=-1,ya=0;function ot(){return fe&6?Te():va!==-1?va:va=Te()}function Qr(e){return e.mode&1?fe&2&&Je!==0?Je&-Je:fx.transition!==null?(ya===0&&(ya=gm()),ya):(e=ve,e!==0||(e=window.event,e=e===void 0?16:Sm(e.type)),e):1}function nr(e,t,s,n){if(50<ti)throw ti=0,sc=null,Error(q(185));Si(e,s,n),(!(fe&2)||e!==Ge)&&(e===Ge&&(!(fe&2)&&(vo|=s),Ue===4&&Mr(e,Je)),bt(e,n),s===1&&fe===0&&!(t.mode&1)&&(xn=Te()+500,po&&ts()))}function bt(e,t){var s=e.callbackNode;fg(e,t);var n=Aa(e,e===Ge?Je:0);if(n===0)s!==null&&Hd(s),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(s!=null&&Hd(s),t===1)e.tag===0?px(Pu.bind(null,e)):Um(Pu.bind(null,e)),dx(function(){!(fe&6)&&ts()}),s=null;else{switch(xm(n)){case 1:s=Rc;break;case 4:s=pm;break;case 16:s=za;break;case 536870912:s=fm;break;default:s=za}s=Bp(s,Tp.bind(null,e))}e.callbackPriority=t,e.callbackNode=s}}function Tp(e,t){if(va=-1,ya=0,fe&6)throw Error(q(327));var s=e.callbackNode;if(ln()&&e.callbackNode!==s)return null;var n=Aa(e,e===Ge?Je:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=qa(e,n);else{t=n;var i=fe;fe|=2;var a=Rp();(Ge!==e||Je!==t)&&(yr=null,xn=Te()+500,ys(e,t));do try{Rx();break}catch(l){Dp(e,l)}while(!0);Kc(),Ha.current=a,fe=i,$e!==null?t=0:(Ge=null,Je=0,t=Ue)}if(t!==0){if(t===2&&(i=El(e),i!==0&&(n=i,t=nc(e,i))),t===1)throw s=vi,ys(e,0),Mr(e,n),bt(e,Te()),s;if(t===6)Mr(e,n);else{if(i=e.current.alternate,!(n&30)&&!Tx(i)&&(t=qa(e,n),t===2&&(a=El(e),a!==0&&(n=a,t=nc(e,a))),t===1))throw s=vi,ys(e,0),Mr(e,n),bt(e,Te()),s;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(q(345));case 2:cs(e,ft,yr);break;case 3:if(Mr(e,n),(n&130023424)===n&&(t=cd+500-Te(),10<t)){if(Aa(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){ot(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Ml(cs.bind(null,e,ft,yr),t);break}cs(e,ft,yr);break;case 4:if(Mr(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var o=31-sr(n);a=1<<o,o=t[o],o>i&&(i=o),n&=~a}if(n=i,n=Te()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Ox(n/1960))-n,10<n){e.timeoutHandle=Ml(cs.bind(null,e,ft,yr),n);break}cs(e,ft,yr);break;case 5:cs(e,ft,yr);break;default:throw Error(q(329))}}}return bt(e,Te()),e.callbackNode===s?Tp.bind(null,e):null}function nc(e,t){var s=ei;return e.current.memoizedState.isDehydrated&&(ys(e,t).flags|=256),e=qa(e,t),e!==2&&(t=ft,ft=s,t!==null&&ic(t)),e}function ic(e){ft===null?ft=e:ft.push.apply(ft,e)}function Tx(e){for(var t=e;;){if(t.flags&16384){var s=t.updateQueue;if(s!==null&&(s=s.stores,s!==null))for(var n=0;n<s.length;n++){var i=s[n],a=i.getSnapshot;i=i.value;try{if(!ir(a(),i))return!1}catch{return!1}}}if(s=t.child,t.subtreeFlags&16384&&s!==null)s.return=t,t=s;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Mr(e,t){for(t&=~ld,t&=~vo,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var s=31-sr(t),n=1<<s;e[s]=-1,t&=~n}}function Pu(e){if(fe&6)throw Error(q(327));ln();var t=Aa(e,0);if(!(t&1))return bt(e,Te()),null;var s=qa(e,t);if(e.tag!==0&&s===2){var n=El(e);n!==0&&(t=n,s=nc(e,n))}if(s===1)throw s=vi,ys(e,0),Mr(e,t),bt(e,Te()),s;if(s===6)throw Error(q(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,cs(e,ft,yr),bt(e,Te()),null}function dd(e,t){var s=fe;fe|=1;try{return e(t)}finally{fe=s,fe===0&&(xn=Te()+500,po&&ts())}}function ks(e){Ur!==null&&Ur.tag===0&&!(fe&6)&&ln();var t=fe;fe|=1;var s=Ut.transition,n=ve;try{if(Ut.transition=null,ve=1,e)return e()}finally{ve=n,Ut.transition=s,fe=t,!(fe&6)&&ts()}}function ud(){Ct=en.current,je(en)}function ys(e,t){e.finishedWork=null,e.finishedLanes=0;var s=e.timeoutHandle;if(s!==-1&&(e.timeoutHandle=-1,cx(s)),$e!==null)for(s=$e.return;s!==null;){var n=s;switch(Vc(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Da();break;case 3:fn(),je(vt),je(rt),ed();break;case 5:Zc(n);break;case 4:fn();break;case 13:je(ze);break;case 19:je(ze);break;case 10:Qc(n.type._context);break;case 22:case 23:ud()}s=s.return}if(Ge=e,$e=e=Jr(e.current,null),Je=Ct=t,Ue=0,vi=null,ld=vo=Ns=0,ft=ei=null,gs!==null){for(t=0;t<gs.length;t++)if(s=gs[t],n=s.interleaved,n!==null){s.interleaved=null;var i=n.next,a=s.pending;if(a!==null){var o=a.next;a.next=i,n.next=o}s.pending=n}gs=null}return e}function Dp(e,t){do{var s=$e;try{if(Kc(),fa.current=Wa,Ua){for(var n=Ae.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Ua=!1}if(Ss=0,Ve=Fe=Ae=null,Xn=!1,fi=0,od.current=null,s===null||s.return===null){Ue=1,vi=t,$e=null;break}e:{var a=e,o=s.return,l=s,d=t;if(t=Je,l.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){var c=d,p=l,m=p.tag;if(!(p.mode&1)&&(m===0||m===11||m===15)){var g=p.alternate;g?(p.updateQueue=g.updateQueue,p.memoizedState=g.memoizedState,p.lanes=g.lanes):(p.updateQueue=null,p.memoizedState=null)}var f=Su(o);if(f!==null){f.flags&=-257,Nu(f,o,l,a,t),f.mode&1&&ju(a,c,t),t=f,d=c;var v=t.updateQueue;if(v===null){var j=new Set;j.add(d),t.updateQueue=j}else v.add(d);break e}else{if(!(t&1)){ju(a,c,t),hd();break e}d=Error(q(426))}}else if(ke&&l.mode&1){var S=Su(o);if(S!==null){!(S.flags&65536)&&(S.flags|=256),Nu(S,o,l,a,t),Gc(gn(d,l));break e}}a=d=gn(d,l),Ue!==4&&(Ue=2),ei===null?ei=[a]:ei.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var u=xp(a,d,t);gu(a,u);break e;case 1:l=d;var h=a.type,x=a.stateNode;if(!(a.flags&128)&&(typeof h.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Kr===null||!Kr.has(x)))){a.flags|=65536,t&=-t,a.lanes|=t;var _=vp(a,l,t);gu(a,_);break e}}a=a.return}while(a!==null)}Lp(s)}catch(N){t=N,$e===s&&s!==null&&($e=s=s.return);continue}break}while(!0)}function Rp(){var e=Ha.current;return Ha.current=Wa,e===null?Wa:e}function hd(){(Ue===0||Ue===3||Ue===2)&&(Ue=4),Ge===null||!(Ns&268435455)&&!(vo&268435455)||Mr(Ge,Je)}function qa(e,t){var s=fe;fe|=2;var n=Rp();(Ge!==e||Je!==t)&&(yr=null,ys(e,t));do try{Dx();break}catch(i){Dp(e,i)}while(!0);if(Kc(),fe=s,Ha.current=n,$e!==null)throw Error(q(261));return Ge=null,Je=0,Ue}function Dx(){for(;$e!==null;)Pp($e)}function Rx(){for(;$e!==null&&!ag();)Pp($e)}function Pp(e){var t=$p(e.alternate,e,Ct);e.memoizedProps=e.pendingProps,t===null?Lp(e):$e=t,od.current=null}function Lp(e){var t=e;do{var s=t.alternate;if(e=t.return,t.flags&32768){if(s=zx(s,t),s!==null){s.flags&=32767,$e=s;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ue=6,$e=null;return}}else if(s=Cx(s,t,Ct),s!==null){$e=s;return}if(t=t.sibling,t!==null){$e=t;return}$e=t=e}while(t!==null);Ue===0&&(Ue=5)}function cs(e,t,s){var n=ve,i=Ut.transition;try{Ut.transition=null,ve=1,Px(e,t,s,n)}finally{Ut.transition=i,ve=n}return null}function Px(e,t,s,n){do ln();while(Ur!==null);if(fe&6)throw Error(q(327));s=e.finishedWork;var i=e.finishedLanes;if(s===null)return null;if(e.finishedWork=null,e.finishedLanes=0,s===e.current)throw Error(q(177));e.callbackNode=null,e.callbackPriority=0;var a=s.lanes|s.childLanes;if(gg(e,a),e===Ge&&($e=Ge=null,Je=0),!(s.subtreeFlags&2064)&&!(s.flags&2064)||Vi||(Vi=!0,Bp(za,function(){return ln(),null})),a=(s.flags&15990)!==0,s.subtreeFlags&15990||a){a=Ut.transition,Ut.transition=null;var o=ve;ve=1;var l=fe;fe|=4,od.current=null,Ex(e,s),Ip(s,e),rx(Pl),Ea=!!Rl,Pl=Rl=null,e.current=s,Ix(s),og(),fe=l,ve=o,Ut.transition=a}else e.current=s;if(Vi&&(Vi=!1,Ur=e,Ga=i),a=e.pendingLanes,a===0&&(Kr=null),dg(s.stateNode),bt(e,Te()),t!==null)for(n=e.onRecoverableError,s=0;s<t.length;s++)i=t[s],n(i.value,{componentStack:i.stack,digest:i.digest});if(Va)throw Va=!1,e=rc,rc=null,e;return Ga&1&&e.tag!==0&&ln(),a=e.pendingLanes,a&1?e===sc?ti++:(ti=0,sc=e):ti=0,ts(),null}function ln(){if(Ur!==null){var e=xm(Ga),t=Ut.transition,s=ve;try{if(Ut.transition=null,ve=16>e?16:e,Ur===null)var n=!1;else{if(e=Ur,Ur=null,Ga=0,fe&6)throw Error(q(331));var i=fe;for(fe|=4,X=e.current;X!==null;){var a=X,o=a.child;if(X.flags&16){var l=a.deletions;if(l!==null){for(var d=0;d<l.length;d++){var c=l[d];for(X=c;X!==null;){var p=X;switch(p.tag){case 0:case 11:case 15:Zn(8,p,a)}var m=p.child;if(m!==null)m.return=p,X=m;else for(;X!==null;){p=X;var g=p.sibling,f=p.return;if(zp(p),p===c){X=null;break}if(g!==null){g.return=f,X=g;break}X=f}}}var v=a.alternate;if(v!==null){var j=v.child;if(j!==null){v.child=null;do{var S=j.sibling;j.sibling=null,j=S}while(j!==null)}}X=a}}if(a.subtreeFlags&2064&&o!==null)o.return=a,X=o;else e:for(;X!==null;){if(a=X,a.flags&2048)switch(a.tag){case 0:case 11:case 15:Zn(9,a,a.return)}var u=a.sibling;if(u!==null){u.return=a.return,X=u;break e}X=a.return}}var h=e.current;for(X=h;X!==null;){o=X;var x=o.child;if(o.subtreeFlags&2064&&x!==null)x.return=o,X=x;else e:for(o=h;X!==null;){if(l=X,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:xo(9,l)}}catch(N){Ie(l,l.return,N)}if(l===o){X=null;break e}var _=l.sibling;if(_!==null){_.return=l.return,X=_;break e}X=l.return}}if(fe=i,ts(),gr&&typeof gr.onPostCommitFiberRoot=="function")try{gr.onPostCommitFiberRoot(lo,e)}catch{}n=!0}return n}finally{ve=s,Ut.transition=t}}return!1}function Lu(e,t,s){t=gn(s,t),t=xp(e,t,1),e=qr(e,t,1),t=ot(),e!==null&&(Si(e,1,t),bt(e,t))}function Ie(e,t,s){if(e.tag===3)Lu(e,e,s);else for(;t!==null;){if(t.tag===3){Lu(t,e,s);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Kr===null||!Kr.has(n))){e=gn(s,e),e=vp(t,e,1),t=qr(t,e,1),e=ot(),t!==null&&(Si(t,1,e),bt(t,e));break}}t=t.return}}function Lx(e,t,s){var n=e.pingCache;n!==null&&n.delete(t),t=ot(),e.pingedLanes|=e.suspendedLanes&s,Ge===e&&(Je&s)===s&&(Ue===4||Ue===3&&(Je&130023424)===Je&&500>Te()-cd?ys(e,0):ld|=s),bt(e,t)}function Mp(e,t){t===0&&(e.mode&1?(t=Ri,Ri<<=1,!(Ri&130023424)&&(Ri=4194304)):t=1);var s=ot();e=_r(e,t),e!==null&&(Si(e,t,s),bt(e,s))}function Mx(e){var t=e.memoizedState,s=0;t!==null&&(s=t.retryLane),Mp(e,s)}function $x(e,t){var s=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(s=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(q(314))}n!==null&&n.delete(t),Mp(e,s)}var $p;$p=function(e,t,s){if(e!==null)if(e.memoizedProps!==t.pendingProps||vt.current)xt=!0;else{if(!(e.lanes&s)&&!(t.flags&128))return xt=!1,_x(e,t,s);xt=!!(e.flags&131072)}else xt=!1,ke&&t.flags&1048576&&Wm(t,La,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;xa(e,t),e=t.pendingProps;var i=hn(t,rt.current);on(t,s),i=rd(null,t,n,e,i,s);var a=sd();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,yt(n)?(a=!0,Ra(t)):a=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Yc(t),i.updater=go,t.stateNode=i,i._reactInternals=t,Vl(t,n,e,s),t=Kl(null,t,n,!0,a,s)):(t.tag=0,ke&&a&&Hc(t),at(null,t,i,s),t=t.child),t;case 16:n=t.elementType;e:{switch(xa(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=Fx(n),e=Xt(n,e),i){case 0:t=ql(null,t,n,e,s);break e;case 1:t=Cu(null,t,n,e,s);break e;case 11:t=ku(null,t,n,e,s);break e;case 14:t=_u(null,t,n,Xt(n.type,e),s);break e}throw Error(q(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Xt(n,i),ql(e,t,n,i,s);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Xt(n,i),Cu(e,t,n,i,s);case 3:e:{if(jp(t),e===null)throw Error(q(387));n=t.pendingProps,a=t.memoizedState,i=a.element,Qm(e,t),Ba(t,n,null,s);var o=t.memoizedState;if(n=o.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){i=gn(Error(q(423)),t),t=zu(e,t,n,s,i);break e}else if(n!==i){i=gn(Error(q(424)),t),t=zu(e,t,n,s,i);break e}else for(At=Gr(t.stateNode.containerInfo.firstChild),Et=t,ke=!0,rr=null,s=qm(t,null,n,s),t.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if(mn(),n===i){t=Cr(e,t,s);break e}at(e,t,n,s)}t=t.child}return t;case 5:return Jm(t),e===null&&Ul(t),n=t.type,i=t.pendingProps,a=e!==null?e.memoizedProps:null,o=i.children,Ll(n,i)?o=null:a!==null&&Ll(n,a)&&(t.flags|=32),wp(e,t),at(e,t,o,s),t.child;case 6:return e===null&&Ul(t),null;case 13:return Sp(e,t,s);case 4:return Xc(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=pn(t,null,n,s):at(e,t,n,s),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Xt(n,i),ku(e,t,n,i,s);case 7:return at(e,t,t.pendingProps,s),t.child;case 8:return at(e,t,t.pendingProps.children,s),t.child;case 12:return at(e,t,t.pendingProps.children,s),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,a=t.memoizedProps,o=i.value,be(Ma,n._currentValue),n._currentValue=o,a!==null)if(ir(a.value,o)){if(a.children===i.children&&!vt.current){t=Cr(e,t,s);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var l=a.dependencies;if(l!==null){o=a.child;for(var d=l.firstContext;d!==null;){if(d.context===n){if(a.tag===1){d=Sr(-1,s&-s),d.tag=2;var c=a.updateQueue;if(c!==null){c=c.shared;var p=c.pending;p===null?d.next=d:(d.next=p.next,p.next=d),c.pending=d}}a.lanes|=s,d=a.alternate,d!==null&&(d.lanes|=s),Wl(a.return,s,t),l.lanes|=s;break}d=d.next}}else if(a.tag===10)o=a.type===t.type?null:a.child;else if(a.tag===18){if(o=a.return,o===null)throw Error(q(341));o.lanes|=s,l=o.alternate,l!==null&&(l.lanes|=s),Wl(o,s,t),o=a.sibling}else o=a.child;if(o!==null)o.return=a;else for(o=a;o!==null;){if(o===t){o=null;break}if(a=o.sibling,a!==null){a.return=o.return,o=a;break}o=o.return}a=o}at(e,t,i.children,s),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,on(t,s),i=Wt(i),n=n(i),t.flags|=1,at(e,t,n,s),t.child;case 14:return n=t.type,i=Xt(n,t.pendingProps),i=Xt(n.type,i),_u(e,t,n,i,s);case 15:return yp(e,t,t.type,t.pendingProps,s);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Xt(n,i),xa(e,t),t.tag=1,yt(n)?(e=!0,Ra(t)):e=!1,on(t,s),gp(t,n,i),Vl(t,n,i,s),Kl(null,t,n,!0,e,s);case 19:return Np(e,t,s);case 22:return bp(e,t,s)}throw Error(q(156,t.tag))};function Bp(e,t){return mm(e,t)}function Bx(e,t,s,n){this.tag=e,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ft(e,t,s,n){return new Bx(e,t,s,n)}function md(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Fx(e){if(typeof e=="function")return md(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Oc)return 11;if(e===Tc)return 14}return 2}function Jr(e,t){var s=e.alternate;return s===null?(s=Ft(e.tag,t,e.key,e.mode),s.elementType=e.elementType,s.type=e.type,s.stateNode=e.stateNode,s.alternate=e,e.alternate=s):(s.pendingProps=t,s.type=e.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=e.flags&14680064,s.childLanes=e.childLanes,s.lanes=e.lanes,s.child=e.child,s.memoizedProps=e.memoizedProps,s.memoizedState=e.memoizedState,s.updateQueue=e.updateQueue,t=e.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},s.sibling=e.sibling,s.index=e.index,s.ref=e.ref,s}function ba(e,t,s,n,i,a){var o=2;if(n=e,typeof e=="function")md(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Hs:return bs(s.children,i,a,t);case Ic:o=8,i|=8;break;case fl:return e=Ft(12,s,t,i|2),e.elementType=fl,e.lanes=a,e;case gl:return e=Ft(13,s,t,i),e.elementType=gl,e.lanes=a,e;case xl:return e=Ft(19,s,t,i),e.elementType=xl,e.lanes=a,e;case Jh:return yo(s,i,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Kh:o=10;break e;case Qh:o=9;break e;case Oc:o=11;break e;case Tc:o=14;break e;case Rr:o=16,n=null;break e}throw Error(q(130,e==null?e:typeof e,""))}return t=Ft(o,s,t,i),t.elementType=e,t.type=n,t.lanes=a,t}function bs(e,t,s,n){return e=Ft(7,e,n,t),e.lanes=s,e}function yo(e,t,s,n){return e=Ft(22,e,n,t),e.elementType=Jh,e.lanes=s,e.stateNode={isHidden:!1},e}function tl(e,t,s){return e=Ft(6,e,null,t),e.lanes=s,e}function rl(e,t,s){return t=Ft(4,e.children!==null?e.children:[],e.key,t),t.lanes=s,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Ux(e,t,s,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Po(0),this.expirationTimes=Po(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Po(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function pd(e,t,s,n,i,a,o,l,d){return e=new Ux(e,t,s,l,d),t===1?(t=1,a===!0&&(t|=8)):t=0,a=Ft(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},Yc(a),e}function Wx(e,t,s){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ws,key:n==null?null:""+n,children:e,containerInfo:t,implementation:s}}function Fp(e){if(!e)return Xr;e=e._reactInternals;e:{if(Cs(e)!==e||e.tag!==1)throw Error(q(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(yt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(q(171))}if(e.tag===1){var s=e.type;if(yt(s))return Fm(e,s,t)}return t}function Up(e,t,s,n,i,a,o,l,d){return e=pd(s,n,!0,e,i,a,o,l,d),e.context=Fp(null),s=e.current,n=ot(),i=Qr(s),a=Sr(n,i),a.callback=t??null,qr(s,a,i),e.current.lanes=i,Si(e,i,n),bt(e,n),e}function bo(e,t,s,n){var i=t.current,a=ot(),o=Qr(i);return s=Fp(s),t.context===null?t.context=s:t.pendingContext=s,t=Sr(a,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=qr(i,t,o),e!==null&&(nr(e,i,o,a),pa(e,i,o)),o}function Ka(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Mu(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var s=e.retryLane;e.retryLane=s!==0&&s<t?s:t}}function fd(e,t){Mu(e,t),(e=e.alternate)&&Mu(e,t)}function Hx(){return null}var Wp=typeof reportError=="function"?reportError:function(e){console.error(e)};function gd(e){this._internalRoot=e}wo.prototype.render=gd.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(q(409));bo(e,t,null,null)};wo.prototype.unmount=gd.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ks(function(){bo(null,e,null,null)}),t[kr]=null}};function wo(e){this._internalRoot=e}wo.prototype.unstable_scheduleHydration=function(e){if(e){var t=bm();e={blockedOn:null,target:e,priority:t};for(var s=0;s<Lr.length&&t!==0&&t<Lr[s].priority;s++);Lr.splice(s,0,e),s===0&&jm(e)}};function xd(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function jo(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function $u(){}function Vx(e,t,s,n,i){if(i){if(typeof n=="function"){var a=n;n=function(){var c=Ka(o);a.call(c)}}var o=Up(t,n,e,0,null,!1,!1,"",$u);return e._reactRootContainer=o,e[kr]=o.current,di(e.nodeType===8?e.parentNode:e),ks(),o}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var l=n;n=function(){var c=Ka(d);l.call(c)}}var d=pd(e,0,!1,null,null,!1,!1,"",$u);return e._reactRootContainer=d,e[kr]=d.current,di(e.nodeType===8?e.parentNode:e),ks(function(){bo(t,d,s,n)}),d}function So(e,t,s,n,i){var a=s._reactRootContainer;if(a){var o=a;if(typeof i=="function"){var l=i;i=function(){var d=Ka(o);l.call(d)}}bo(t,o,e,i)}else o=Vx(s,t,e,i,n);return Ka(o)}vm=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var s=Un(t.pendingLanes);s!==0&&(Pc(t,s|1),bt(t,Te()),!(fe&6)&&(xn=Te()+500,ts()))}break;case 13:ks(function(){var n=_r(e,1);if(n!==null){var i=ot();nr(n,e,1,i)}}),fd(e,1)}};Lc=function(e){if(e.tag===13){var t=_r(e,134217728);if(t!==null){var s=ot();nr(t,e,134217728,s)}fd(e,134217728)}};ym=function(e){if(e.tag===13){var t=Qr(e),s=_r(e,t);if(s!==null){var n=ot();nr(s,e,t,n)}fd(e,t)}};bm=function(){return ve};wm=function(e,t){var s=ve;try{return ve=e,t()}finally{ve=s}};Cl=function(e,t,s){switch(t){case"input":if(bl(e,s),t=s.name,s.type==="radio"&&t!=null){for(s=e;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<s.length;t++){var n=s[t];if(n!==e&&n.form===e.form){var i=mo(n);if(!i)throw Error(q(90));Xh(n),bl(n,i)}}}break;case"textarea":em(e,s);break;case"select":t=s.value,t!=null&&rn(e,!!s.multiple,t,!1)}};om=dd;lm=ks;var Gx={usingClientEntryPoint:!1,Events:[ki,Ks,mo,im,am,dd]},Dn={findFiberByHostInstance:fs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},qx={bundleType:Dn.bundleType,version:Dn.version,rendererPackageName:Dn.rendererPackageName,rendererConfig:Dn.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:zr.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=um(e),e===null?null:e.stateNode},findFiberByHostInstance:Dn.findFiberByHostInstance||Hx,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Gi=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Gi.isDisabled&&Gi.supportsFiber)try{lo=Gi.inject(qx),gr=Gi}catch{}}Ot.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Gx;Ot.createPortal=function(e,t){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!xd(t))throw Error(q(200));return Wx(e,t,null,s)};Ot.createRoot=function(e,t){if(!xd(e))throw Error(q(299));var s=!1,n="",i=Wp;return t!=null&&(t.unstable_strictMode===!0&&(s=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=pd(e,1,!1,null,null,s,!1,n,i),e[kr]=t.current,di(e.nodeType===8?e.parentNode:e),new gd(t)};Ot.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(q(188)):(e=Object.keys(e).join(","),Error(q(268,e)));return e=um(t),e=e===null?null:e.stateNode,e};Ot.flushSync=function(e){return ks(e)};Ot.hydrate=function(e,t,s){if(!jo(t))throw Error(q(200));return So(null,e,t,!0,s)};Ot.hydrateRoot=function(e,t,s){if(!xd(e))throw Error(q(405));var n=s!=null&&s.hydratedSources||null,i=!1,a="",o=Wp;if(s!=null&&(s.unstable_strictMode===!0&&(i=!0),s.identifierPrefix!==void 0&&(a=s.identifierPrefix),s.onRecoverableError!==void 0&&(o=s.onRecoverableError)),t=Up(t,null,e,1,s??null,i,!1,a,o),e[kr]=t.current,di(e),n)for(e=0;e<n.length;e++)s=n[e],i=s._getVersion,i=i(s._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[s,i]:t.mutableSourceEagerHydrationData.push(s,i);return new wo(t)};Ot.render=function(e,t,s){if(!jo(t))throw Error(q(200));return So(null,e,t,!1,s)};Ot.unmountComponentAtNode=function(e){if(!jo(e))throw Error(q(40));return e._reactRootContainer?(ks(function(){So(null,null,e,!1,function(){e._reactRootContainer=null,e[kr]=null})}),!0):!1};Ot.unstable_batchedUpdates=dd;Ot.unstable_renderSubtreeIntoContainer=function(e,t,s,n){if(!jo(s))throw Error(q(200));if(e==null||e._reactInternals===void 0)throw Error(q(38));return So(e,t,s,!1,n)};Ot.version="18.3.1-next-f1338f8080-20240426";function Hp(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Hp)}catch(e){console.error(e)}}Hp(),Hh.exports=Ot;var Kx=Hh.exports,Bu=Kx;ml.createRoot=Bu.createRoot,ml.hydrateRoot=Bu.hydrateRoot;var vd={},Qa={},ac=function(e,t){return ac=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,n){s.__proto__=n}||function(s,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(s[i]=n[i])},ac(e,t)};function Vp(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");ac(e,t);function s(){this.constructor=e}e.prototype=t===null?Object.create(t):(s.prototype=t.prototype,new s)}var Ja=function(){return Ja=Object.assign||function(t){for(var s,n=1,i=arguments.length;n<i;n++){s=arguments[n];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(t[a]=s[a])}return t},Ja.apply(this,arguments)};function Sn(e,t){var s={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(s[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(s[n[i]]=e[n[i]]);return s}function Gp(e,t,s,n){var i=arguments.length,a=i<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,s):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(e,t,s,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,s,a):o(t,s))||a);return i>3&&a&&Object.defineProperty(t,s,a),a}function qp(e,t){return function(s,n){t(s,n,e)}}function Kp(e,t,s,n,i,a){function o(u){if(u!==void 0&&typeof u!="function")throw new TypeError("Function expected");return u}for(var l=n.kind,d=l==="getter"?"get":l==="setter"?"set":"value",c=!t&&e?n.static?e:e.prototype:null,p=t||(c?Object.getOwnPropertyDescriptor(c,n.name):{}),m,g=!1,f=s.length-1;f>=0;f--){var v={};for(var j in n)v[j]=j==="access"?{}:n[j];for(var j in n.access)v.access[j]=n.access[j];v.addInitializer=function(u){if(g)throw new TypeError("Cannot add initializers after decoration has completed");a.push(o(u||null))};var S=(0,s[f])(l==="accessor"?{get:p.get,set:p.set}:p[d],v);if(l==="accessor"){if(S===void 0)continue;if(S===null||typeof S!="object")throw new TypeError("Object expected");(m=o(S.get))&&(p.get=m),(m=o(S.set))&&(p.set=m),(m=o(S.init))&&i.unshift(m)}else(m=o(S))&&(l==="field"?i.unshift(m):p[d]=m)}c&&Object.defineProperty(c,n.name,p),g=!0}function Qp(e,t,s){for(var n=arguments.length>2,i=0;i<t.length;i++)s=n?t[i].call(e,s):t[i].call(e);return n?s:void 0}function Jp(e){return typeof e=="symbol"?e:"".concat(e)}function Yp(e,t,s){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:s?"".concat(s," ",t):t})}function Xp(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function Z(e,t,s,n){function i(a){return a instanceof s?a:new s(function(o){o(a)})}return new(s||(s=Promise))(function(a,o){function l(p){try{c(n.next(p))}catch(m){o(m)}}function d(p){try{c(n.throw(p))}catch(m){o(m)}}function c(p){p.done?a(p.value):i(p.value).then(l,d)}c((n=n.apply(e,t||[])).next())})}function Zp(e,t){var s={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=l(0),o.throw=l(1),o.return=l(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(c){return function(p){return d([c,p])}}function d(c){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(s=0)),s;)try{if(n=1,i&&(a=c[0]&2?i.return:c[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,c[1])).done)return a;switch(i=0,a&&(c=[c[0]&2,a.value]),c[0]){case 0:case 1:a=c;break;case 4:return s.label++,{value:c[1],done:!1};case 5:s.label++,i=c[1],c=[0];continue;case 7:c=s.ops.pop(),s.trys.pop();continue;default:if(a=s.trys,!(a=a.length>0&&a[a.length-1])&&(c[0]===6||c[0]===2)){s=0;continue}if(c[0]===3&&(!a||c[1]>a[0]&&c[1]<a[3])){s.label=c[1];break}if(c[0]===6&&s.label<a[1]){s.label=a[1],a=c;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(c);break}a[2]&&s.ops.pop(),s.trys.pop();continue}c=t.call(e,s)}catch(p){c=[6,p],i=0}finally{n=a=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}var No=Object.create?function(e,t,s,n){n===void 0&&(n=s);var i=Object.getOwnPropertyDescriptor(t,s);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,i)}:function(e,t,s,n){n===void 0&&(n=s),e[n]=t[s]};function e0(e,t){for(var s in e)s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s)&&No(t,e,s)}function Ya(e){var t=typeof Symbol=="function"&&Symbol.iterator,s=t&&e[t],n=0;if(s)return s.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function yd(e,t){var s=typeof Symbol=="function"&&e[Symbol.iterator];if(!s)return e;var n=s.call(e),i,a=[],o;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(l){o={error:l}}finally{try{i&&!i.done&&(s=n.return)&&s.call(n)}finally{if(o)throw o.error}}return a}function t0(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(yd(arguments[t]));return e}function r0(){for(var e=0,t=0,s=arguments.length;t<s;t++)e+=arguments[t].length;for(var n=Array(e),i=0,t=0;t<s;t++)for(var a=arguments[t],o=0,l=a.length;o<l;o++,i++)n[i]=a[o];return n}function s0(e,t,s){if(s||arguments.length===2)for(var n=0,i=t.length,a;n<i;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))}function vn(e){return this instanceof vn?(this.v=e,this):new vn(e)}function n0(e,t,s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=s.apply(e,t||[]),i,a=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(f){return function(v){return Promise.resolve(v).then(f,m)}}function l(f,v){n[f]&&(i[f]=function(j){return new Promise(function(S,u){a.push([f,j,S,u])>1||d(f,j)})},v&&(i[f]=v(i[f])))}function d(f,v){try{c(n[f](v))}catch(j){g(a[0][3],j)}}function c(f){f.value instanceof vn?Promise.resolve(f.value.v).then(p,m):g(a[0][2],f)}function p(f){d("next",f)}function m(f){d("throw",f)}function g(f,v){f(v),a.shift(),a.length&&d(a[0][0],a[0][1])}}function i0(e){var t,s;return t={},n("next"),n("throw",function(i){throw i}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(i,a){t[i]=e[i]?function(o){return(s=!s)?{value:vn(e[i](o)),done:!1}:a?a(o):o}:a}}function a0(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],s;return t?t.call(e):(e=typeof Ya=="function"?Ya(e):e[Symbol.iterator](),s={},n("next"),n("throw"),n("return"),s[Symbol.asyncIterator]=function(){return this},s);function n(a){s[a]=e[a]&&function(o){return new Promise(function(l,d){o=e[a](o),i(l,d,o.done,o.value)})}}function i(a,o,l,d){Promise.resolve(d).then(function(c){a({value:c,done:l})},o)}}function o0(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var Qx=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},oc=function(e){return oc=Object.getOwnPropertyNames||function(t){var s=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(s[s.length]=n);return s},oc(e)};function l0(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var s=oc(e),n=0;n<s.length;n++)s[n]!=="default"&&No(t,e,s[n]);return Qx(t,e),t}function c0(e){return e&&e.__esModule?e:{default:e}}function d0(e,t,s,n){if(s==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return s==="m"?n:s==="a"?n.call(e):n?n.value:t.get(e)}function u0(e,t,s,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(e,s):i?i.value=s:t.set(e,s),s}function h0(e,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof e=="function"?t===e:e.has(t)}function m0(e,t,s){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var n,i;if(s){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose],s&&(i=n)}if(typeof n!="function")throw new TypeError("Object not disposable.");i&&(n=function(){try{i.call(this)}catch(a){return Promise.reject(a)}}),e.stack.push({value:t,dispose:n,async:s})}else s&&e.stack.push({async:!0});return t}var Jx=typeof SuppressedError=="function"?SuppressedError:function(e,t,s){var n=new Error(s);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};function p0(e){function t(a){e.error=e.hasError?new Jx(a,e.error,"An error was suppressed during disposal."):a,e.hasError=!0}var s,n=0;function i(){for(;s=e.stack.pop();)try{if(!s.async&&n===1)return n=0,e.stack.push(s),Promise.resolve().then(i);if(s.dispose){var a=s.dispose.call(s.value);if(s.async)return n|=2,Promise.resolve(a).then(i,function(o){return t(o),i()})}else n|=1}catch(o){t(o)}if(n===1)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}return i()}function f0(e,t){return typeof e=="string"&&/^\.\.?\//.test(e)?e.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(s,n,i,a,o){return n?t?".jsx":".js":i&&(!a||!o)?s:i+a+"."+o.toLowerCase()+"js"}):e}const Yx={__extends:Vp,__assign:Ja,__rest:Sn,__decorate:Gp,__param:qp,__esDecorate:Kp,__runInitializers:Qp,__propKey:Jp,__setFunctionName:Yp,__metadata:Xp,__awaiter:Z,__generator:Zp,__createBinding:No,__exportStar:e0,__values:Ya,__read:yd,__spread:t0,__spreadArrays:r0,__spreadArray:s0,__await:vn,__asyncGenerator:n0,__asyncDelegator:i0,__asyncValues:a0,__makeTemplateObject:o0,__importStar:l0,__importDefault:c0,__classPrivateFieldGet:d0,__classPrivateFieldSet:u0,__classPrivateFieldIn:h0,__addDisposableResource:m0,__disposeResources:p0,__rewriteRelativeImportExtension:f0},Xx=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:m0,get __assign(){return Ja},__asyncDelegator:i0,__asyncGenerator:n0,__asyncValues:a0,__await:vn,__awaiter:Z,__classPrivateFieldGet:d0,__classPrivateFieldIn:h0,__classPrivateFieldSet:u0,__createBinding:No,__decorate:Gp,__disposeResources:p0,__esDecorate:Kp,__exportStar:e0,__extends:Vp,__generator:Zp,__importDefault:c0,__importStar:l0,__makeTemplateObject:o0,__metadata:Xp,__param:qp,__propKey:Jp,__read:yd,__rest:Sn,__rewriteRelativeImportExtension:f0,__runInitializers:Qp,__setFunctionName:Yp,__spread:t0,__spreadArray:s0,__spreadArrays:r0,__values:Ya,default:Yx},Symbol.toStringTag,{value:"Module"})),Zx=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);let ko=class extends Error{constructor(t,s="FunctionsError",n){super(t),this.name=s,this.context=n}},g0=class extends ko{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}},lc=class extends ko{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}},cc=class extends ko{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}};var Xa;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Xa||(Xa={}));class ev{constructor(t,{headers:s={},customFetch:n,region:i=Xa.Any}={}){this.url=t,this.headers=s,this.region=i,this.fetch=Zx(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return Z(this,arguments,void 0,function*(s,n={}){var i;let a,o;try{const{headers:l,method:d,body:c,signal:p,timeout:m}=n;let g={},{region:f}=n;f||(f=this.region);const v=new URL(`${this.url}/${s}`);f&&f!=="any"&&(g["x-region"]=f,v.searchParams.set("forceFunctionRegion",f));let j;c&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(g["Content-Type"]="application/octet-stream",j=c):typeof c=="string"?(g["Content-Type"]="text/plain",j=c):typeof FormData<"u"&&c instanceof FormData?j=c:(g["Content-Type"]="application/json",j=JSON.stringify(c)):j=c;let S=p;m&&(o=new AbortController,a=setTimeout(()=>o.abort(),m),p?(S=o.signal,p.addEventListener("abort",()=>o.abort())):S=o.signal);const u=yield this.fetch(v.toString(),{method:d||"POST",headers:Object.assign(Object.assign(Object.assign({},g),this.headers),l),body:j,signal:S}).catch(N=>{throw new g0(N)}),h=u.headers.get("x-relay-error");if(h&&h==="true")throw new lc(u);if(!u.ok)throw new cc(u);let x=((i=u.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),_;return x==="application/json"?_=yield u.json():x==="application/octet-stream"||x==="application/pdf"?_=yield u.blob():x==="text/event-stream"?_=u:x==="multipart/form-data"?_=yield u.formData():_=yield u.text(),{data:_,error:null,response:u}}catch(l){return{data:null,error:l,response:l instanceof cc||l instanceof lc?l.context:void 0}}finally{a&&clearTimeout(a)}})}}const tv=Object.freeze(Object.defineProperty({__proto__:null,get FunctionRegion(){return Xa},FunctionsClient:ev,FunctionsError:ko,FunctionsFetchError:g0,FunctionsHttpError:cc,FunctionsRelayError:lc},Symbol.toStringTag,{value:"Module"})),x0=wi(tv);var tt={};const Nn=wi(Xx);var qi={},Ki={},Qi={},Ji={},Yi={},Xi={},Fu;function v0(){if(Fu)return Xi;Fu=1,Object.defineProperty(Xi,"__esModule",{value:!0});class e extends Error{constructor(s){super(s.message),this.name="PostgrestError",this.details=s.details,this.hint=s.hint,this.code=s.code}}return Xi.default=e,Xi}var Uu;function y0(){if(Uu)return Yi;Uu=1,Object.defineProperty(Yi,"__esModule",{value:!0});const t=Nn.__importDefault(v0());let s=class{constructor(i){var a,o;this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=new Headers(i.headers),this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=(a=i.shouldThrowOnError)!==null&&a!==void 0?a:!1,this.signal=i.signal,this.isMaybeSingle=(o=i.isMaybeSingle)!==null&&o!==void 0?o:!1,i.fetch?this.fetch=i.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(i,a){return this.headers=new Headers(this.headers),this.headers.set(i,a),this}then(i,a){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const o=this.fetch;let l=o(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async d=>{var c,p,m,g;let f=null,v=null,j=null,S=d.status,u=d.statusText;if(d.ok){if(this.method!=="HEAD"){const N=await d.text();N===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((c=this.headers.get("Accept"))===null||c===void 0)&&c.includes("application/vnd.pgrst.plan+text"))?v=N:v=JSON.parse(N))}const x=(p=this.headers.get("Prefer"))===null||p===void 0?void 0:p.match(/count=(exact|planned|estimated)/),_=(m=d.headers.get("content-range"))===null||m===void 0?void 0:m.split("/");x&&_&&_.length>1&&(j=parseInt(_[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(v)&&(v.length>1?(f={code:"PGRST116",details:`Results contain ${v.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},v=null,j=null,S=406,u="Not Acceptable"):v.length===1?v=v[0]:v=null)}else{const x=await d.text();try{f=JSON.parse(x),Array.isArray(f)&&d.status===404&&(v=[],f=null,S=200,u="OK")}catch{d.status===404&&x===""?(S=204,u="No Content"):f={message:x}}if(f&&this.isMaybeSingle&&(!((g=f==null?void 0:f.details)===null||g===void 0)&&g.includes("0 rows"))&&(f=null,S=200,u="OK"),f&&this.shouldThrowOnError)throw new t.default(f)}return{error:f,data:v,count:j,status:S,statusText:u}});return this.shouldThrowOnError||(l=l.catch(d=>{var c,p,m,g,f,v;let j="";const S=d==null?void 0:d.cause;if(S){const u=(c=S==null?void 0:S.message)!==null&&c!==void 0?c:"",h=(p=S==null?void 0:S.code)!==null&&p!==void 0?p:"";j=`${(m=d==null?void 0:d.name)!==null&&m!==void 0?m:"FetchError"}: ${d==null?void 0:d.message}`,j+=`

Caused by: ${(g=S==null?void 0:S.name)!==null&&g!==void 0?g:"Error"}: ${u}`,h&&(j+=` (${h})`),S!=null&&S.stack&&(j+=`
${S.stack}`)}else j=(f=d==null?void 0:d.stack)!==null&&f!==void 0?f:"";return{error:{message:`${(v=d==null?void 0:d.name)!==null&&v!==void 0?v:"FetchError"}: ${d==null?void 0:d.message}`,details:j,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),l.then(i,a)}returns(){return this}overrideTypes(){return this}};return Yi.default=s,Yi}var Wu;function b0(){if(Wu)return Ji;Wu=1,Object.defineProperty(Ji,"__esModule",{value:!0});const t=Nn.__importDefault(y0());let s=class extends t.default{select(i){let a=!1;const o=(i??"*").split("").map(l=>/\s/.test(l)&&!a?"":(l==='"'&&(a=!a),l)).join("");return this.url.searchParams.set("select",o),this.headers.append("Prefer","return=representation"),this}order(i,{ascending:a=!0,nullsFirst:o,foreignTable:l,referencedTable:d=l}={}){const c=d?`${d}.order`:"order",p=this.url.searchParams.get(c);return this.url.searchParams.set(c,`${p?`${p},`:""}${i}.${a?"asc":"desc"}${o===void 0?"":o?".nullsfirst":".nullslast"}`),this}limit(i,{foreignTable:a,referencedTable:o=a}={}){const l=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(l,`${i}`),this}range(i,a,{foreignTable:o,referencedTable:l=o}={}){const d=typeof l>"u"?"offset":`${l}.offset`,c=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(d,`${i}`),this.url.searchParams.set(c,`${a-i+1}`),this}abortSignal(i){return this.signal=i,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:i=!1,verbose:a=!1,settings:o=!1,buffers:l=!1,wal:d=!1,format:c="text"}={}){var p;const m=[i?"analyze":null,a?"verbose":null,o?"settings":null,l?"buffers":null,d?"wal":null].filter(Boolean).join("|"),g=(p=this.headers.get("Accept"))!==null&&p!==void 0?p:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${c}; for="${g}"; options=${m};`),c==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(i){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${i}`),this}};return Ji.default=s,Ji}var Hu;function bd(){if(Hu)return Qi;Hu=1,Object.defineProperty(Qi,"__esModule",{value:!0});const t=Nn.__importDefault(b0()),s=new RegExp("[,()]");let n=class extends t.default{eq(a,o){return this.url.searchParams.append(a,`eq.${o}`),this}neq(a,o){return this.url.searchParams.append(a,`neq.${o}`),this}gt(a,o){return this.url.searchParams.append(a,`gt.${o}`),this}gte(a,o){return this.url.searchParams.append(a,`gte.${o}`),this}lt(a,o){return this.url.searchParams.append(a,`lt.${o}`),this}lte(a,o){return this.url.searchParams.append(a,`lte.${o}`),this}like(a,o){return this.url.searchParams.append(a,`like.${o}`),this}likeAllOf(a,o){return this.url.searchParams.append(a,`like(all).{${o.join(",")}}`),this}likeAnyOf(a,o){return this.url.searchParams.append(a,`like(any).{${o.join(",")}}`),this}ilike(a,o){return this.url.searchParams.append(a,`ilike.${o}`),this}ilikeAllOf(a,o){return this.url.searchParams.append(a,`ilike(all).{${o.join(",")}}`),this}ilikeAnyOf(a,o){return this.url.searchParams.append(a,`ilike(any).{${o.join(",")}}`),this}regexMatch(a,o){return this.url.searchParams.append(a,`match.${o}`),this}regexIMatch(a,o){return this.url.searchParams.append(a,`imatch.${o}`),this}is(a,o){return this.url.searchParams.append(a,`is.${o}`),this}isDistinct(a,o){return this.url.searchParams.append(a,`isdistinct.${o}`),this}in(a,o){const l=Array.from(new Set(o)).map(d=>typeof d=="string"&&s.test(d)?`"${d}"`:`${d}`).join(",");return this.url.searchParams.append(a,`in.(${l})`),this}contains(a,o){return typeof o=="string"?this.url.searchParams.append(a,`cs.${o}`):Array.isArray(o)?this.url.searchParams.append(a,`cs.{${o.join(",")}}`):this.url.searchParams.append(a,`cs.${JSON.stringify(o)}`),this}containedBy(a,o){return typeof o=="string"?this.url.searchParams.append(a,`cd.${o}`):Array.isArray(o)?this.url.searchParams.append(a,`cd.{${o.join(",")}}`):this.url.searchParams.append(a,`cd.${JSON.stringify(o)}`),this}rangeGt(a,o){return this.url.searchParams.append(a,`sr.${o}`),this}rangeGte(a,o){return this.url.searchParams.append(a,`nxl.${o}`),this}rangeLt(a,o){return this.url.searchParams.append(a,`sl.${o}`),this}rangeLte(a,o){return this.url.searchParams.append(a,`nxr.${o}`),this}rangeAdjacent(a,o){return this.url.searchParams.append(a,`adj.${o}`),this}overlaps(a,o){return typeof o=="string"?this.url.searchParams.append(a,`ov.${o}`):this.url.searchParams.append(a,`ov.{${o.join(",")}}`),this}textSearch(a,o,{config:l,type:d}={}){let c="";d==="plain"?c="pl":d==="phrase"?c="ph":d==="websearch"&&(c="w");const p=l===void 0?"":`(${l})`;return this.url.searchParams.append(a,`${c}fts${p}.${o}`),this}match(a){return Object.entries(a).forEach(([o,l])=>{this.url.searchParams.append(o,`eq.${l}`)}),this}not(a,o,l){return this.url.searchParams.append(a,`not.${o}.${l}`),this}or(a,{foreignTable:o,referencedTable:l=o}={}){const d=l?`${l}.or`:"or";return this.url.searchParams.append(d,`(${a})`),this}filter(a,o,l){return this.url.searchParams.append(a,`${o}.${l}`),this}};return Qi.default=n,Qi}var Vu;function w0(){if(Vu)return Ki;Vu=1,Object.defineProperty(Ki,"__esModule",{value:!0});const t=Nn.__importDefault(bd());let s=class{constructor(i,{headers:a={},schema:o,fetch:l}){this.url=i,this.headers=new Headers(a),this.schema=o,this.fetch=l}select(i,a){const{head:o=!1,count:l}=a??{},d=o?"HEAD":"GET";let c=!1;const p=(i??"*").split("").map(m=>/\s/.test(m)&&!c?"":(m==='"'&&(c=!c),m)).join("");return this.url.searchParams.set("select",p),l&&this.headers.append("Prefer",`count=${l}`),new t.default({method:d,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(i,{count:a,defaultToNull:o=!0}={}){var l;const d="POST";if(a&&this.headers.append("Prefer",`count=${a}`),o||this.headers.append("Prefer","missing=default"),Array.isArray(i)){const c=i.reduce((p,m)=>p.concat(Object.keys(m)),[]);if(c.length>0){const p=[...new Set(c)].map(m=>`"${m}"`);this.url.searchParams.set("columns",p.join(","))}}return new t.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}upsert(i,{onConflict:a,ignoreDuplicates:o=!1,count:l,defaultToNull:d=!0}={}){var c;const p="POST";if(this.headers.append("Prefer",`resolution=${o?"ignore":"merge"}-duplicates`),a!==void 0&&this.url.searchParams.set("on_conflict",a),l&&this.headers.append("Prefer",`count=${l}`),d||this.headers.append("Prefer","missing=default"),Array.isArray(i)){const m=i.reduce((g,f)=>g.concat(Object.keys(f)),[]);if(m.length>0){const g=[...new Set(m)].map(f=>`"${f}"`);this.url.searchParams.set("columns",g.join(","))}}return new t.default({method:p,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}update(i,{count:a}={}){var o;const l="PATCH";return a&&this.headers.append("Prefer",`count=${a}`),new t.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}delete({count:i}={}){var a;const o="DELETE";return i&&this.headers.append("Prefer",`count=${i}`),new t.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}};return Ki.default=s,Ki}var Gu;function rv(){if(Gu)return qi;Gu=1,Object.defineProperty(qi,"__esModule",{value:!0});const e=Nn,t=e.__importDefault(w0()),s=e.__importDefault(bd());let n=class j0{constructor(a,{headers:o={},schema:l,fetch:d}={}){this.url=a,this.headers=new Headers(o),this.schemaName=l,this.fetch=d}from(a){if(!a||typeof a!="string"||a.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");const o=new URL(`${this.url}/${a}`);return new t.default(o,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(a){return new j0(this.url,{headers:this.headers,schema:a,fetch:this.fetch})}rpc(a,o={},{head:l=!1,get:d=!1,count:c}={}){var p;let m;const g=new URL(`${this.url}/rpc/${a}`);let f;l||d?(m=l?"HEAD":"GET",Object.entries(o).filter(([j,S])=>S!==void 0).map(([j,S])=>[j,Array.isArray(S)?`{${S.join(",")}}`:`${S}`]).forEach(([j,S])=>{g.searchParams.append(j,S)})):(m="POST",f=o);const v=new Headers(this.headers);return c&&v.set("Prefer",`count=${c}`),new s.default({method:m,url:g,headers:v,schema:this.schemaName,body:f,fetch:(p=this.fetch)!==null&&p!==void 0?p:fetch})}};return qi.default=n,qi}Object.defineProperty(tt,"__esModule",{value:!0});tt.PostgrestError=tt.PostgrestBuilder=tt.PostgrestTransformBuilder=tt.PostgrestFilterBuilder=tt.PostgrestQueryBuilder=tt.PostgrestClient=void 0;const kn=Nn,S0=kn.__importDefault(rv());tt.PostgrestClient=S0.default;const N0=kn.__importDefault(w0());tt.PostgrestQueryBuilder=N0.default;const k0=kn.__importDefault(bd());tt.PostgrestFilterBuilder=k0.default;const _0=kn.__importDefault(b0());tt.PostgrestTransformBuilder=_0.default;const C0=kn.__importDefault(y0());tt.PostgrestBuilder=C0.default;const z0=kn.__importDefault(v0());tt.PostgrestError=z0.default;tt.default={PostgrestClient:S0.default,PostgrestQueryBuilder:N0.default,PostgrestFilterBuilder:k0.default,PostgrestTransformBuilder:_0.default,PostgrestBuilder:C0.default,PostgrestError:z0.default};class A0{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const s=process.versions;if(s&&s.node){const n=s.node,i=parseInt(n.replace(/^v/,"").split(".")[0]);return i>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${i} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let s=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(s+=`

Suggested solution: ${t.workaround}`),new Error(s)}static createWebSocket(t,s){const n=this.getWebSocketConstructor();return new n(t,s)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const sv="2.87.1",nv=`realtime-js/${sv}`,E0="1.0.0",iv="2.0.0",qu=E0,dc=1e4,av=1e3,ov=100;var ms;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(ms||(ms={}));var Pe;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Pe||(Pe={}));var tr;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(tr||(tr={}));var uc;(function(e){e.websocket="websocket"})(uc||(uc={}));var ps;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(ps||(ps={}));class lv{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,s){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return s(this._binaryEncodeUserBroadcastPush(t));let n=[t.join_ref,t.ref,t.topic,t.event,t.payload];return s(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(t){var s;return this._isArrayBuffer((s=t.payload)===null||s===void 0?void 0:s.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var s,n;const i=(n=(s=t.payload)===null||s===void 0?void 0:s.payload)!==null&&n!==void 0?n:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,i)}_encodeJsonUserBroadcastPush(t){var s,n;const i=(n=(s=t.payload)===null||s===void 0?void 0:s.payload)!==null&&n!==void 0?n:{},o=new TextEncoder().encode(JSON.stringify(i)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,o)}_encodeUserBroadcastPush(t,s,n){var i,a;const o=t.topic,l=(i=t.ref)!==null&&i!==void 0?i:"",d=(a=t.join_ref)!==null&&a!==void 0?a:"",c=t.payload.event,p=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},m=Object.keys(p).length===0?"":JSON.stringify(p);if(d.length>255)throw new Error(`joinRef length ${d.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`ref length ${l.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`topic length ${o.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`userEvent length ${c.length} exceeds maximum of 255`);if(m.length>255)throw new Error(`metadata length ${m.length} exceeds maximum of 255`);const g=this.USER_BROADCAST_PUSH_META_LENGTH+d.length+l.length+o.length+c.length+m.length,f=new ArrayBuffer(this.HEADER_LENGTH+g);let v=new DataView(f),j=0;v.setUint8(j++,this.KINDS.userBroadcastPush),v.setUint8(j++,d.length),v.setUint8(j++,l.length),v.setUint8(j++,o.length),v.setUint8(j++,c.length),v.setUint8(j++,m.length),v.setUint8(j++,s),Array.from(d,u=>v.setUint8(j++,u.charCodeAt(0))),Array.from(l,u=>v.setUint8(j++,u.charCodeAt(0))),Array.from(o,u=>v.setUint8(j++,u.charCodeAt(0))),Array.from(c,u=>v.setUint8(j++,u.charCodeAt(0))),Array.from(m,u=>v.setUint8(j++,u.charCodeAt(0)));var S=new Uint8Array(f.byteLength+n.byteLength);return S.set(new Uint8Array(f),0),S.set(new Uint8Array(n),f.byteLength),S.buffer}decode(t,s){if(this._isArrayBuffer(t)){let n=this._binaryDecode(t);return s(n)}if(typeof t=="string"){const n=JSON.parse(t),[i,a,o,l,d]=n;return s({join_ref:i,ref:a,topic:o,event:l,payload:d})}return s({})}_binaryDecode(t){const s=new DataView(t),n=s.getUint8(0),i=new TextDecoder;switch(n){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,s,i)}}_decodeUserBroadcast(t,s,n){const i=s.getUint8(1),a=s.getUint8(2),o=s.getUint8(3),l=s.getUint8(4);let d=this.HEADER_LENGTH+4;const c=n.decode(t.slice(d,d+i));d=d+i;const p=n.decode(t.slice(d,d+a));d=d+a;const m=n.decode(t.slice(d,d+o));d=d+o;const g=t.slice(d,t.byteLength),f=l===this.JSON_ENCODING?JSON.parse(n.decode(g)):g,v={type:this.BROADCAST_EVENT,event:p,payload:f};return o>0&&(v.meta=JSON.parse(m)),{join_ref:null,ref:null,topic:c,event:this.BROADCAST_EVENT,payload:v}}_isArrayBuffer(t){var s;return t instanceof ArrayBuffer||((s=t==null?void 0:t.constructor)===null||s===void 0?void 0:s.name)==="ArrayBuffer"}_pick(t,s){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([n])=>s.includes(n)))}}class I0{constructor(t,s){this.callback=t,this.timerCalc=s,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=s}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var ye;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(ye||(ye={}));const Ku=(e,t,s={})=>{var n;const i=(n=s.skipTypes)!==null&&n!==void 0?n:[];return t?Object.keys(t).reduce((a,o)=>(a[o]=cv(o,e,t,i),a),{}):{}},cv=(e,t,s,n)=>{const i=t.find(l=>l.name===e),a=i==null?void 0:i.type,o=s[e];return a&&!n.includes(a)?O0(a,o):hc(o)},O0=(e,t)=>{if(e.charAt(0)==="_"){const s=e.slice(1,e.length);return mv(t,s)}switch(e){case ye.bool:return dv(t);case ye.float4:case ye.float8:case ye.int2:case ye.int4:case ye.int8:case ye.numeric:case ye.oid:return uv(t);case ye.json:case ye.jsonb:return hv(t);case ye.timestamp:return pv(t);case ye.abstime:case ye.date:case ye.daterange:case ye.int4range:case ye.int8range:case ye.money:case ye.reltime:case ye.text:case ye.time:case ye.timestamptz:case ye.timetz:case ye.tsrange:case ye.tstzrange:return hc(t);default:return hc(t)}},hc=e=>e,dv=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},uv=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},hv=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},mv=(e,t)=>{if(typeof e!="string")return e;const s=e.length-1,n=e[s];if(e[0]==="{"&&n==="}"){let a;const o=e.slice(1,s);try{a=JSON.parse("["+o+"]")}catch{a=o?o.split(","):[]}return a.map(l=>O0(t,l))}return e},pv=e=>typeof e=="string"?e.replace(" ","T"):e,T0=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class sl{constructor(t,s,n={},i=dc){this.channel=t,this.event=s,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,s){var n;return this._hasReceived(t)&&s((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:s}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=s=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=s,this._matchReceive(s)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,s){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:s})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:s}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(s))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var mc;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(mc||(mc={}));let D0=class wa{constructor(t,s){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(s==null?void 0:s.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:a,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=wa.syncState(this.state,i,a,o),this.pendingDiffs.forEach(d=>{this.state=wa.syncDiff(this.state,d,a,o)}),this.pendingDiffs=[],l()}),this.channel._on(n.diff,{},i=>{const{onJoin:a,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=wa.syncDiff(this.state,i,a,o),l())}),this.onJoin((i,a,o)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:a,newPresences:o})}),this.onLeave((i,a,o)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:a,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,s,n,i){const a=this.cloneDeep(t),o=this.transformState(s),l={},d={};return this.map(a,(c,p)=>{o[c]||(d[c]=p)}),this.map(o,(c,p)=>{const m=a[c];if(m){const g=p.map(S=>S.presence_ref),f=m.map(S=>S.presence_ref),v=p.filter(S=>f.indexOf(S.presence_ref)<0),j=m.filter(S=>g.indexOf(S.presence_ref)<0);v.length>0&&(l[c]=v),j.length>0&&(d[c]=j)}else l[c]=p}),this.syncDiff(a,{joins:l,leaves:d},n,i)}static syncDiff(t,s,n,i){const{joins:a,leaves:o}={joins:this.transformState(s.joins),leaves:this.transformState(s.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(a,(l,d)=>{var c;const p=(c=t[l])!==null&&c!==void 0?c:[];if(t[l]=this.cloneDeep(d),p.length>0){const m=t[l].map(f=>f.presence_ref),g=p.filter(f=>m.indexOf(f.presence_ref)<0);t[l].unshift(...g)}n(l,p,d)}),this.map(o,(l,d)=>{let c=t[l];if(!c)return;const p=d.map(m=>m.presence_ref);c=c.filter(m=>p.indexOf(m.presence_ref)<0),t[l]=c,i(l,c,d),c.length===0&&delete t[l]}),t}static map(t,s){return Object.getOwnPropertyNames(t).map(n=>s(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((s,n)=>{const i=t[n];return"metas"in i?s[n]=i.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):s[n]=i,s},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}};var pc;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(pc||(pc={}));var cn;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(cn||(cn={}));var pr;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(pr||(pr={}));const fv=Pe;let R0=class Hn{constructor(t,s={config:{}},n){var i,a;if(this.topic=t,this.params=s,this.socket=n,this.bindings={},this.state=Pe.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},s.config),this.timeout=this.socket.timeout,this.joinPush=new sl(this,tr.join,this.params,this.timeout),this.rejoinTimer=new I0(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Pe.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Pe.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Pe.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Pe.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Pe.errored,this.rejoinTimer.scheduleTimeout())}),this._on(tr.reply,{},(o,l)=>{this._trigger(this._replyEventName(l),o)}),this.presence=new D0(this),this.broadcastEndpointURL=T0(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((a=(i=this.params.config)===null||i===void 0?void 0:i.broadcast)===null||a===void 0)&&a.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,s=this.timeout){var n,i,a;if(this.socket.isConnected()||this.socket.connect(),this.state==Pe.closed){const{config:{broadcast:o,presence:l,private:d}}=this.params,c=(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(f=>f.filter))!==null&&i!==void 0?i:[],p=!!this.bindings[cn.PRESENCE]&&this.bindings[cn.PRESENCE].length>0||((a=this.params.config.presence)===null||a===void 0?void 0:a.enabled)===!0,m={},g={broadcast:o,presence:Object.assign(Object.assign({},l),{enabled:p}),postgres_changes:c,private:d};this.socket.accessTokenValue&&(m.access_token=this.socket.accessTokenValue),this._onError(f=>t==null?void 0:t(pr.CHANNEL_ERROR,f)),this._onClose(()=>t==null?void 0:t(pr.CLOSED)),this.updateJoinPayload(Object.assign({config:g},m)),this.joinedOnce=!0,this._rejoin(s),this.joinPush.receive("ok",async({postgres_changes:f})=>{var v;if(this.socket._isManualToken()||this.socket.setAuth(),f===void 0){t==null||t(pr.SUBSCRIBED);return}else{const j=this.bindings.postgres_changes,S=(v=j==null?void 0:j.length)!==null&&v!==void 0?v:0,u=[];for(let h=0;h<S;h++){const x=j[h],{filter:{event:_,schema:N,table:w,filter:C}}=x,y=f&&f[h];if(y&&y.event===_&&Hn.isFilterValueEqual(y.schema,N)&&Hn.isFilterValueEqual(y.table,w)&&Hn.isFilterValueEqual(y.filter,C))u.push(Object.assign(Object.assign({},x),{id:y.id}));else{this.unsubscribe(),this.state=Pe.errored,t==null||t(pr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=u,t&&t(pr.SUBSCRIBED);return}}).receive("error",f=>{this.state=Pe.errored,t==null||t(pr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(f).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(pr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,s={}){return await this.send({type:"presence",event:"track",payload:t},s.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,s,n){return this.state===Pe.joined&&t===cn.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,s,n)}async httpSend(t,s,n={}){var i;const a=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(s==null)return Promise.reject("Payload is required for httpSend()");const o={method:"POST",headers:{Authorization:a,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:s,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(i=n.timeout)!==null&&i!==void 0?i:this.timeout);if(l.status===202)return{success:!0};let d=l.statusText;try{const c=await l.json();d=c.error||c.message||d}catch{}return Promise.reject(new Error(d))}async send(t,s={}){var n,i;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:a,payload:o}=t,d={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:o,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,d,(n=s.timeout)!==null&&n!==void 0?n:this.timeout);return await((i=c.body)===null||i===void 0?void 0:i.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var o,l,d;const c=this._push(t.type,t,s.timeout||this.timeout);t.type==="broadcast"&&!(!((d=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||d===void 0)&&d.ack)&&a("ok"),c.receive("ok",()=>a("ok")),c.receive("error",()=>a("error")),c.receive("timeout",()=>a("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Pe.leaving;const s=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(tr.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(i=>{n=new sl(this,tr.leave,{},t),n.receive("ok",()=>{s(),i("ok")}).receive("timeout",()=>{s(),i("timed out")}).receive("error",()=>{i("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Pe.closed,this.bindings={}}async _fetchWithTimeout(t,s,n){const i=new AbortController,a=setTimeout(()=>i.abort(),n),o=await this.socket.fetch(t,Object.assign(Object.assign({},s),{signal:i.signal}));return clearTimeout(a),o}_push(t,s,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new sl(this,t,s,n);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>ov){const s=this.pushBuffer.shift();s&&(s.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${s.event}`,s.payload))}}_onMessage(t,s,n){return s}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,s,n){var i,a;const o=t.toLocaleLowerCase(),{close:l,error:d,leave:c,join:p}=tr;if(n&&[l,d,c,p].indexOf(o)>=0&&n!==this._joinRef())return;let g=this._onMessage(o,s,n);if(s&&!g)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(f=>{var v,j,S;return((v=f.filter)===null||v===void 0?void 0:v.event)==="*"||((S=(j=f.filter)===null||j===void 0?void 0:j.event)===null||S===void 0?void 0:S.toLocaleLowerCase())===o}).map(f=>f.callback(g,n)):(a=this.bindings[o])===null||a===void 0||a.filter(f=>{var v,j,S,u,h,x;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in f){const _=f.id,N=(v=f.filter)===null||v===void 0?void 0:v.event;return _&&((j=s.ids)===null||j===void 0?void 0:j.includes(_))&&(N==="*"||(N==null?void 0:N.toLocaleLowerCase())===((S=s.data)===null||S===void 0?void 0:S.type.toLocaleLowerCase()))}else{const _=(h=(u=f==null?void 0:f.filter)===null||u===void 0?void 0:u.event)===null||h===void 0?void 0:h.toLocaleLowerCase();return _==="*"||_===((x=s==null?void 0:s.event)===null||x===void 0?void 0:x.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===o}).map(f=>{if(typeof g=="object"&&"ids"in g){const v=g.data,{schema:j,table:S,commit_timestamp:u,type:h,errors:x}=v;g=Object.assign(Object.assign({},{schema:j,table:S,commit_timestamp:u,eventType:h,new:{},old:{},errors:x}),this._getPayloadRecords(v))}f.callback(g,n)})}_isClosed(){return this.state===Pe.closed}_isJoined(){return this.state===Pe.joined}_isJoining(){return this.state===Pe.joining}_isLeaving(){return this.state===Pe.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,s,n){const i=t.toLocaleLowerCase(),a={type:i,filter:s,callback:n};return this.bindings[i]?this.bindings[i].push(a):this.bindings[i]=[a],this}_off(t,s){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(i=>{var a;return!(((a=i.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===n&&Hn.isEqual(i.filter,s))})),this}static isEqual(t,s){if(Object.keys(t).length!==Object.keys(s).length)return!1;for(const n in t)if(t[n]!==s[n])return!1;return!0}static isFilterValueEqual(t,s){return(t??void 0)===(s??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(tr.close,{},t)}_onError(t){this._on(tr.error,{},s=>t(s))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Pe.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const s={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(s.new=Ku(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(s.old=Ku(t.columns,t.old_record)),s}};const nl=()=>{},Zi={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},gv=[1e3,2e3,5e3,1e4],xv=1e4,vv=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;let yv=class{constructor(t,s){var n;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=dc,this.transport=null,this.heartbeatIntervalMs=Zi.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=nl,this.ref=0,this.reconnectTimer=null,this.vsn=qu,this.logger=nl,this.conn=null,this.sendBuffer=[],this.serializer=new lv,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=i=>i?(...a)=>i(...a):(...a)=>fetch(...a),!(!((n=s==null?void 0:s.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=s.params.apikey,this.endPoint=`${t}/${uc.websocket}`,this.httpEndpoint=T0(t),this._initializeOptions(s),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(s==null?void 0:s.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=A0.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const s=t.message;throw s.includes("Node.js")?new Error(`${s}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${s}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,s){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,s??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const s=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),s}async removeAllChannels(){const t=await Promise.all(this.channels.map(s=>s.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,s,n){this.logger(t,s,n)}connectionState(){switch(this.conn&&this.conn.readyState){case ms.connecting:return ps.Connecting;case ms.open:return ps.Open;case ms.closing:return ps.Closing;default:return ps.Closed}}isConnected(){return this.connectionState()===ps.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,s={config:{}}){const n=`realtime:${t}`,i=this.getChannels().find(a=>a.topic===n);if(i)return i;{const a=new R0(`realtime:${t}`,s,this);return this.channels.push(a),a}}push(t){const{topic:s,event:n,payload:i,ref:a}=t,o=()=>{this.encode(t,l=>{var d;(d=this.conn)===null||d===void 0||d.send(l)})};this.log("push",`${s} ${n} (${a})`,i),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(s){this.log("error","error in heartbeat callback",s)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(s){this.log("error","error in heartbeat callback",s)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(av,"heartbeat timeout"),setTimeout(()=>{var s;this.isConnected()||(s=this.reconnectTimer)===null||s===void 0||s.scheduleTimeout()},Zi.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(s){this.log("error","error in heartbeat callback",s)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let s=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));s&&(this.log("transport",`leaving duplicate topic "${t}"`),s.unsubscribe())}_remove(t){this.channels=this.channels.filter(s=>s.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,s=>{if(s.topic==="phoenix"&&s.event==="phx_reply")try{this.heartbeatCallback(s.payload.status==="ok"?"ok":"error")}catch(c){this.log("error","error in heartbeat callback",c)}s.ref&&s.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:i,payload:a,ref:o}=s,l=o?`(${o})`:"",d=a.status||"";this.log("receive",`${d} ${n} ${i} ${l}`.trim(),a),this.channels.filter(c=>c._isMember(n)).forEach(c=>c._trigger(i,a,o)),this._triggerStateCallbacks("message",s)})}_clearTimer(t){var s;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((s=this.reconnectTimer)===null||s===void 0||s.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){if(this.conn){if(this.conn.readyState===ms.open||this.conn.readyState===ms.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(s=>{this.log("error","error waiting for auth on connect",s),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=s=>{this.log("worker","worker error",s.message),this.workerRef.terminate()},this.workerRef.onmessage=s=>{s.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var s;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(s=this.reconnectTimer)===null||s===void 0||s.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(tr.error))}_appendParams(t,s){if(Object.keys(s).length===0)return t;const n=t.match(/\?/)?"&":"?",i=new URLSearchParams(s);return`${t}${n}${i}`}_workerObjectUrl(t){let s;if(t)s=t;else{const n=new Blob([vv],{type:"application/javascript"});s=URL.createObjectURL(n)}return s}_setConnectionState(t,s=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=s)}async _performAuth(t=null){let s,n=!1;if(t)s=t,n=!0;else if(this.accessToken)try{s=await this.accessToken()}catch(i){this.log("error","Error fetching access token from callback",i),s=this.accessTokenValue}else s=this.accessTokenValue;n?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=s&&(this.accessTokenValue=s,this.channels.forEach(i=>{const a={access_token:s,version:nv};s&&i.updateJoinPayload(a),i.joinedOnce&&i._isJoined()&&i._push(tr.access_token,{access_token:s})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(s=>{this.log("error",`Error setting auth in ${t}`,s)})}_triggerStateCallbacks(t,s){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(s)}catch(i){this.log("error",`error in ${t} callback`,i)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new I0(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Zi.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var s,n,i,a,o,l,d,c,p,m,g,f;switch(this.transport=(s=t==null?void 0:t.transport)!==null&&s!==void 0?s:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:dc,this.heartbeatIntervalMs=(i=t==null?void 0:t.heartbeatIntervalMs)!==null&&i!==void 0?i:Zi.HEARTBEAT_INTERVAL,this.worker=(a=t==null?void 0:t.worker)!==null&&a!==void 0?a:!1,this.accessToken=(o=t==null?void 0:t.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(l=t==null?void 0:t.heartbeatCallback)!==null&&l!==void 0?l:nl,this.vsn=(d=t==null?void 0:t.vsn)!==null&&d!==void 0?d:qu,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=t==null?void 0:t.reconnectAfterMs)!==null&&c!==void 0?c:v=>gv[v-1]||xv,this.vsn){case E0:this.encode=(p=t==null?void 0:t.encode)!==null&&p!==void 0?p:(v,j)=>j(JSON.stringify(v)),this.decode=(m=t==null?void 0:t.decode)!==null&&m!==void 0?m:(v,j)=>j(JSON.parse(v));break;case iv:this.encode=(g=t==null?void 0:t.encode)!==null&&g!==void 0?g:this.serializer.encode.bind(this.serializer),this.decode=(f=t==null?void 0:t.decode)!==null&&f!==void 0?f:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}};const bv=Object.freeze(Object.defineProperty({__proto__:null,REALTIME_CHANNEL_STATES:fv,get REALTIME_LISTEN_TYPES(){return cn},get REALTIME_POSTGRES_CHANGES_LISTEN_EVENT(){return pc},get REALTIME_PRESENCE_LISTEN_EVENTS(){return mc},get REALTIME_SUBSCRIBE_STATES(){return pr},RealtimeChannel:R0,RealtimeClient:yv,RealtimePresence:D0,WebSocketFactory:A0},Symbol.toStringTag,{value:"Module"})),P0=wi(bv);class Ci extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Ne(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class L0 extends Ci{constructor(t,s,n){super(t),this.name="StorageApiError",this.status=s,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Za extends Ci{constructor(t,s){super(t),this.name="StorageUnknownError",this.originalError=s}}const wd=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),wv=()=>Response,fc=e=>{if(Array.isArray(e))return e.map(s=>fc(s));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([s,n])=>{const i=s.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));t[i]=fc(n)}),t},jv=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},Sv=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e),il=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},Nv=(e,t,s)=>Z(void 0,void 0,void 0,function*(){const n=yield wv();e instanceof n&&!(s!=null&&s.noResolveJson)?e.json().then(i=>{const a=e.status||500,o=(i==null?void 0:i.statusCode)||a+"";t(new L0(il(i),a,o))}).catch(i=>{t(new Za(il(i),i))}):t(new Za(il(e),e))}),kv=(e,t,s,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!n?i:(jv(n)?(i.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),i.body=JSON.stringify(n)):i.body=n,t!=null&&t.duplex&&(i.duplex=t.duplex),Object.assign(Object.assign({},i),s))};function zi(e,t,s,n,i,a){return Z(this,void 0,void 0,function*(){return new Promise((o,l)=>{e(s,kv(t,n,i,a)).then(d=>{if(!d.ok)throw d;return n!=null&&n.noResolveJson?d:d.json()}).then(d=>o(d)).catch(d=>Nv(d,l,n))})})}function yi(e,t,s,n){return Z(this,void 0,void 0,function*(){return zi(e,"GET",t,s,n)})}function Zt(e,t,s,n,i){return Z(this,void 0,void 0,function*(){return zi(e,"POST",t,n,i,s)})}function gc(e,t,s,n,i){return Z(this,void 0,void 0,function*(){return zi(e,"PUT",t,n,i,s)})}function _v(e,t,s,n){return Z(this,void 0,void 0,function*(){return zi(e,"HEAD",t,Object.assign(Object.assign({},s),{noResolveJson:!0}),n)})}function jd(e,t,s,n,i){return Z(this,void 0,void 0,function*(){return zi(e,"DELETE",t,n,i,s)})}class Cv{constructor(t,s){this.downloadFn=t,this.shouldThrowOnError=s}then(t,s){return this.execute().then(t,s)}execute(){return Z(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Ne(t))return{data:null,error:t};throw t}})}}var M0;class zv{constructor(t,s){this.downloadFn=t,this.shouldThrowOnError=s,this[M0]="BlobDownloadBuilder",this.promise=null}asStream(){return new Cv(this.downloadFn,this.shouldThrowOnError)}then(t,s){return this.getPromise().then(t,s)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return Z(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Ne(t))return{data:null,error:t};throw t}})}}M0=Symbol.toStringTag;const Av={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Qu={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Ev{constructor(t,s={},n,i){this.shouldThrowOnError=!1,this.url=t,this.headers=s,this.bucketId=n,this.fetch=wd(i)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,s,n,i){return Z(this,void 0,void 0,function*(){try{let a;const o=Object.assign(Object.assign({},Qu),i);let l=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(o.upsert)});const d=o.metadata;typeof Blob<"u"&&n instanceof Blob?(a=new FormData,a.append("cacheControl",o.cacheControl),d&&a.append("metadata",this.encodeMetadata(d)),a.append("",n)):typeof FormData<"u"&&n instanceof FormData?(a=n,a.has("cacheControl")||a.append("cacheControl",o.cacheControl),d&&!a.has("metadata")&&a.append("metadata",this.encodeMetadata(d))):(a=n,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,d&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(d))),(typeof ReadableStream<"u"&&a instanceof ReadableStream||a&&typeof a=="object"&&"pipe"in a&&typeof a.pipe=="function")&&!o.duplex&&(o.duplex="half")),i!=null&&i.headers&&(l=Object.assign(Object.assign({},l),i.headers));const c=this._removeEmptyFolders(s),p=this._getFinalPath(c),m=yield(t=="PUT"?gc:Zt)(this.fetch,`${this.url}/object/${p}`,a,Object.assign({headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:c,id:m.Id,fullPath:m.Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Ne(a))return{data:null,error:a};throw a}})}upload(t,s,n){return Z(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,s,n)})}uploadToSignedUrl(t,s,n,i){return Z(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(t),o=this._getFinalPath(a),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",s);try{let d;const c=Object.assign({upsert:Qu.upsert},i),p=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&n instanceof Blob?(d=new FormData,d.append("cacheControl",c.cacheControl),d.append("",n)):typeof FormData<"u"&&n instanceof FormData?(d=n,d.append("cacheControl",c.cacheControl)):(d=n,p["cache-control"]=`max-age=${c.cacheControl}`,p["content-type"]=c.contentType);const m=yield gc(this.fetch,l.toString(),d,{headers:p});return{data:{path:a,fullPath:m.Key},error:null}}catch(d){if(this.shouldThrowOnError)throw d;if(Ne(d))return{data:null,error:d};throw d}})}createSignedUploadUrl(t,s){return Z(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const i=Object.assign({},this.headers);s!=null&&s.upsert&&(i["x-upsert"]="true");const a=yield Zt(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:i}),o=new URL(this.url+a.url),l=o.searchParams.get("token");if(!l)throw new Ci("No token returned by API");return{data:{signedUrl:o.toString(),path:t,token:l},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ne(n))return{data:null,error:n};throw n}})}update(t,s,n){return Z(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,s,n)})}move(t,s,n){return Z(this,void 0,void 0,function*(){try{return{data:yield Zt(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:s,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Ne(i))return{data:null,error:i};throw i}})}copy(t,s,n){return Z(this,void 0,void 0,function*(){try{return{data:{path:(yield Zt(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:s,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Ne(i))return{data:null,error:i};throw i}})}createSignedUrl(t,s,n){return Z(this,void 0,void 0,function*(){try{let i=this._getFinalPath(t),a=yield Zt(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:s},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const o=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${o}`)},{data:a,error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Ne(i))return{data:null,error:i};throw i}})}createSignedUrls(t,s,n){return Z(this,void 0,void 0,function*(){try{const i=yield Zt(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:s,paths:t},{headers:this.headers}),a=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:i.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${a}`):null})),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Ne(i))return{data:null,error:i};throw i}})}download(t,s){const i=typeof(s==null?void 0:s.transform)<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString((s==null?void 0:s.transform)||{}),o=a?`?${a}`:"",l=this._getFinalPath(t),d=()=>yi(this.fetch,`${this.url}/${i}/${l}${o}`,{headers:this.headers,noResolveJson:!0});return new zv(d,this.shouldThrowOnError)}info(t){return Z(this,void 0,void 0,function*(){const s=this._getFinalPath(t);try{const n=yield yi(this.fetch,`${this.url}/object/info/${s}`,{headers:this.headers});return{data:fc(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ne(n))return{data:null,error:n};throw n}})}exists(t){return Z(this,void 0,void 0,function*(){const s=this._getFinalPath(t);try{return yield _v(this.fetch,`${this.url}/object/${s}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ne(n)&&n instanceof Za){const i=n.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,s){const n=this._getFinalPath(t),i=[],a=s!=null&&s.download?`download=${s.download===!0?"":s.download}`:"";a!==""&&i.push(a);const l=typeof(s==null?void 0:s.transform)<"u"?"render/image":"object",d=this.transformOptsToQueryString((s==null?void 0:s.transform)||{});d!==""&&i.push(d);let c=i.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${n}${c}`)}}}remove(t){return Z(this,void 0,void 0,function*(){try{return{data:yield jd(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ne(s))return{data:null,error:s};throw s}})}list(t,s,n){return Z(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},Av),s),{prefix:t||""});return{data:yield Zt(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},n),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Ne(i))return{data:null,error:i};throw i}})}listV2(t,s){return Z(this,void 0,void 0,function*(){try{const n=Object.assign({},t);return{data:yield Zt(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},s),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ne(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const s=[];return t.width&&s.push(`width=${t.width}`),t.height&&s.push(`height=${t.height}`),t.resize&&s.push(`resize=${t.resize}`),t.format&&s.push(`format=${t.format}`),t.quality&&s.push(`quality=${t.quality}`),s.join("&")}}const $0="2.87.1",B0={"X-Client-Info":`storage-js/${$0}`};class Iv{constructor(t,s={},n,i){this.shouldThrowOnError=!1;const a=new URL(t);i!=null&&i.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},B0),s),this.fetch=wd(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(t){return Z(this,void 0,void 0,function*(){try{const s=this.listBucketOptionsToQueryString(t);return{data:yield yi(this.fetch,`${this.url}/bucket${s}`,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ne(s))return{data:null,error:s};throw s}})}getBucket(t){return Z(this,void 0,void 0,function*(){try{return{data:yield yi(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ne(s))return{data:null,error:s};throw s}})}createBucket(t){return Z(this,arguments,void 0,function*(s,n={public:!1}){try{return{data:yield Zt(this.fetch,`${this.url}/bucket`,{id:s,name:s,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Ne(i))return{data:null,error:i};throw i}})}updateBucket(t,s){return Z(this,void 0,void 0,function*(){try{return{data:yield gc(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ne(n))return{data:null,error:n};throw n}})}emptyBucket(t){return Z(this,void 0,void 0,function*(){try{return{data:yield Zt(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ne(s))return{data:null,error:s};throw s}})}deleteBucket(t){return Z(this,void 0,void 0,function*(){try{return{data:yield jd(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ne(s))return{data:null,error:s};throw s}})}listBucketOptionsToQueryString(t){const s={};return t&&("limit"in t&&(s.limit=String(t.limit)),"offset"in t&&(s.offset=String(t.offset)),t.search&&(s.search=t.search),t.sortColumn&&(s.sortColumn=t.sortColumn),t.sortOrder&&(s.sortOrder=t.sortOrder)),Object.keys(s).length>0?"?"+new URLSearchParams(s).toString():""}}var bi=class extends Error{constructor(e,t){var s;super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&((s=t.icebergType)==null?void 0:s.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function Ov(e,t,s){const n=new URL(t,e);if(s)for(const[i,a]of Object.entries(s))a!==void 0&&n.searchParams.set(i,a);return n.toString()}async function Tv(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function Dv(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:s,path:n,query:i,body:a,headers:o}){const l=Ov(e.baseUrl,n,i),d=await Tv(e.auth),c=await t(l,{method:s,headers:{...a?{"Content-Type":"application/json"}:{},...d,...o},body:a?JSON.stringify(a):void 0}),p=await c.text(),m=(c.headers.get("content-type")||"").includes("application/json"),g=m&&p?JSON.parse(p):p;if(!c.ok){const f=m?g:void 0,v=f==null?void 0:f.error;throw new bi((v==null?void 0:v.message)??`Request failed with status ${c.status}`,{status:c.status,icebergType:v==null?void 0:v.type,icebergCode:v==null?void 0:v.code,details:f})}return{status:c.status,headers:c.headers,data:g}}}}function ea(e){return e.join("")}var Rv=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:ea(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(n=>({namespace:n}))}async createNamespace(e,t){const s={namespace:e.namespace,properties:t==null?void 0:t.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:s})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${ea(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${ea(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${ea(e.namespace)}`}),!0}catch(t){if(t instanceof bi&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(s){if(s instanceof bi&&s.status===409)return;throw s}}};function Os(e){return e.join("")}var Pv=class{constructor(e,t="",s){this.client=e,this.prefix=t,this.accessDelegation=s}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Os(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const s={};return this.accessDelegation&&(s["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Os(e.namespace)}/tables`,body:t,headers:s})).data.metadata}async updateTable(e,t){const s=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Os(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":s.data["metadata-location"],metadata:s.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Os(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String((t==null?void 0:t.purge)??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Os(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Os(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(s){if(s instanceof bi&&s.status===404)return!1;throw s}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(s){if(s instanceof bi&&s.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw s}}},Lv=class{constructor(e){var n;let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const s=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=Dv({baseUrl:s,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=(n=e.accessDelegation)==null?void 0:n.join(","),this.namespaceOps=new Rv(this.client,t),this.tableOps=new Pv(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}};class F0{constructor(t,s={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},B0),s),this.fetch=wd(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return Z(this,void 0,void 0,function*(){try{return{data:yield Zt(this.fetch,`${this.url}/bucket`,{name:t},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ne(s))return{data:null,error:s};throw s}})}listBuckets(t){return Z(this,void 0,void 0,function*(){try{const s=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&s.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&s.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&s.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&s.set("sortOrder",t.sortOrder),t!=null&&t.search&&s.set("search",t.search);const n=s.toString(),i=n?`${this.url}/bucket?${n}`:`${this.url}/bucket`;return{data:yield yi(this.fetch,i,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ne(s))return{data:null,error:s};throw s}})}deleteBucket(t){return Z(this,void 0,void 0,function*(){try{return{data:yield jd(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ne(s))return{data:null,error:s};throw s}})}from(t){if(!Sv(t))throw new Ci("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const s=new Lv({baseUrl:this.url,catalogName:t,auth:{type:"custom",getHeaders:()=>Z(this,void 0,void 0,function*(){return this.headers})},fetch:this.fetch}),n=this.shouldThrowOnError;return new Proxy(s,{get(a,o){const l=a[o];return typeof l!="function"?l:(...d)=>Z(this,void 0,void 0,function*(){try{return{data:yield l.apply(a,d),error:null}}catch(c){if(n)throw c;return{data:null,error:c}}})}})}}const Sd={"X-Client-Info":`storage-js/${$0}`,"Content-Type":"application/json"};class Nd extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function gt(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}class ja extends Nd{constructor(t,s,n){super(t),this.name="StorageVectorsApiError",this.status=s,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class U0 extends Nd{constructor(t,s){super(t),this.name="StorageVectorsUnknownError",this.originalError=s}}var xc;(function(e){e.InternalError="InternalError",e.S3VectorConflictException="S3VectorConflictException",e.S3VectorNotFoundException="S3VectorNotFoundException",e.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",e.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",e.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(xc||(xc={}));const _o=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),Mv=()=>Response,W0=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},$v=e=>Array.from(new Float32Array(e)),Bv=(e,t)=>{if(t!==void 0&&e.float32.length!==t)throw new Error(`Vector dimension mismatch: expected ${t}, got ${e.float32.length}`)},Ju=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Fv=(e,t,s)=>Z(void 0,void 0,void 0,function*(){if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!(s!=null&&s.noResolveJson)){const i=e.status||500,a=e;if(typeof a.json=="function")a.json().then(o=>{const l=(o==null?void 0:o.statusCode)||(o==null?void 0:o.code)||i+"";t(new ja(Ju(o),i,l))}).catch(()=>{const o=i+"",l=a.statusText||`HTTP ${i} error`;t(new ja(l,i,o))});else{const o=i+"",l=a.statusText||`HTTP ${i} error`;t(new ja(l,i,o))}}else t(new U0(Ju(e),e))}),Uv=(e,t,s,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return n?(W0(n)?(i.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),i.body=JSON.stringify(n)):i.body=n,Object.assign(Object.assign({},i),s)):i};function Wv(e,t,s,n,i,a){return Z(this,void 0,void 0,function*(){return new Promise((o,l)=>{e(s,Uv(t,n,i,a)).then(d=>{if(!d.ok)throw d;if(n!=null&&n.noResolveJson)return d;const c=d.headers.get("content-type");return!c||!c.includes("application/json")?{}:d.json()}).then(d=>o(d)).catch(d=>Fv(d,l,n))})})}function zt(e,t,s,n,i){return Z(this,void 0,void 0,function*(){return Wv(e,"POST",t,n,i,s)})}class H0{constructor(t,s={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Sd),s),this.fetch=_o(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(t){return Z(this,void 0,void 0,function*(){try{return{data:(yield zt(this.fetch,`${this.url}/CreateIndex`,t,{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(gt(s))return{data:null,error:s};throw s}})}getIndex(t,s){return Z(this,void 0,void 0,function*(){try{return{data:yield zt(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:t,indexName:s},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(gt(n))return{data:null,error:n};throw n}})}listIndexes(t){return Z(this,void 0,void 0,function*(){try{return{data:yield zt(this.fetch,`${this.url}/ListIndexes`,t,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(gt(s))return{data:null,error:s};throw s}})}deleteIndex(t,s){return Z(this,void 0,void 0,function*(){try{return{data:(yield zt(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:t,indexName:s},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(gt(n))return{data:null,error:n};throw n}})}}class V0{constructor(t,s={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Sd),s),this.fetch=_o(n)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(t){return Z(this,void 0,void 0,function*(){try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield zt(this.fetch,`${this.url}/PutVectors`,t,{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(gt(s))return{data:null,error:s};throw s}})}getVectors(t){return Z(this,void 0,void 0,function*(){try{return{data:yield zt(this.fetch,`${this.url}/GetVectors`,t,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(gt(s))return{data:null,error:s};throw s}})}listVectors(t){return Z(this,void 0,void 0,function*(){try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:yield zt(this.fetch,`${this.url}/ListVectors`,t,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(gt(s))return{data:null,error:s};throw s}})}queryVectors(t){return Z(this,void 0,void 0,function*(){try{return{data:yield zt(this.fetch,`${this.url}/QueryVectors`,t,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(gt(s))return{data:null,error:s};throw s}})}deleteVectors(t){return Z(this,void 0,void 0,function*(){try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield zt(this.fetch,`${this.url}/DeleteVectors`,t,{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(gt(s))return{data:null,error:s};throw s}})}}class G0{constructor(t,s={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Sd),s),this.fetch=_o(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return Z(this,void 0,void 0,function*(){try{return{data:(yield zt(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(gt(s))return{data:null,error:s};throw s}})}getBucket(t){return Z(this,void 0,void 0,function*(){try{return{data:yield zt(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:t},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(gt(s))return{data:null,error:s};throw s}})}listBuckets(){return Z(this,arguments,void 0,function*(t={}){try{return{data:yield zt(this.fetch,`${this.url}/ListVectorBuckets`,t,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(gt(s))return{data:null,error:s};throw s}})}deleteBucket(t){return Z(this,void 0,void 0,function*(){try{return{data:(yield zt(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(gt(s))return{data:null,error:s};throw s}})}}class q0 extends G0{constructor(t,s={}){super(t,s.headers||{},s.fetch)}from(t){return new K0(this.url,this.headers,t,this.fetch)}createBucket(t){const s=Object.create(null,{createBucket:{get:()=>super.createBucket}});return Z(this,void 0,void 0,function*(){return s.createBucket.call(this,t)})}getBucket(t){const s=Object.create(null,{getBucket:{get:()=>super.getBucket}});return Z(this,void 0,void 0,function*(){return s.getBucket.call(this,t)})}listBuckets(){const t=Object.create(null,{listBuckets:{get:()=>super.listBuckets}});return Z(this,arguments,void 0,function*(s={}){return t.listBuckets.call(this,s)})}deleteBucket(t){const s=Object.create(null,{deleteBucket:{get:()=>super.deleteBucket}});return Z(this,void 0,void 0,function*(){return s.deleteBucket.call(this,t)})}}class K0 extends H0{constructor(t,s,n,i){super(t,s,i),this.vectorBucketName=n}createIndex(t){const s=Object.create(null,{createIndex:{get:()=>super.createIndex}});return Z(this,void 0,void 0,function*(){return s.createIndex.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const t=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return Z(this,arguments,void 0,function*(s={}){return t.listIndexes.call(this,Object.assign(Object.assign({},s),{vectorBucketName:this.vectorBucketName}))})}getIndex(t){const s=Object.create(null,{getIndex:{get:()=>super.getIndex}});return Z(this,void 0,void 0,function*(){return s.getIndex.call(this,this.vectorBucketName,t)})}deleteIndex(t){const s=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return Z(this,void 0,void 0,function*(){return s.deleteIndex.call(this,this.vectorBucketName,t)})}index(t){return new Q0(this.url,this.headers,this.vectorBucketName,t,this.fetch)}}class Q0 extends V0{constructor(t,s,n,i,a){super(t,s,a),this.vectorBucketName=n,this.indexName=i}putVectors(t){const s=Object.create(null,{putVectors:{get:()=>super.putVectors}});return Z(this,void 0,void 0,function*(){return s.putVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(t){const s=Object.create(null,{getVectors:{get:()=>super.getVectors}});return Z(this,void 0,void 0,function*(){return s.getVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const t=Object.create(null,{listVectors:{get:()=>super.listVectors}});return Z(this,arguments,void 0,function*(s={}){return t.listVectors.call(this,Object.assign(Object.assign({},s),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(t){const s=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return Z(this,void 0,void 0,function*(){return s.queryVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(t){const s=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return Z(this,void 0,void 0,function*(){return s.deleteVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class Hv extends Iv{constructor(t,s={},n,i){super(t,s,n,i)}from(t){return new Ev(this.url,this.headers,t,this.fetch)}get vectors(){return new q0(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new F0(this.url+"/iceberg",this.headers,this.fetch)}}const Vv=Object.freeze(Object.defineProperty({__proto__:null,StorageAnalyticsClient:F0,StorageApiError:L0,StorageClient:Hv,StorageError:Ci,StorageUnknownError:Za,StorageVectorsApiError:ja,StorageVectorsClient:q0,StorageVectorsError:Nd,get StorageVectorsErrorCode(){return xc},StorageVectorsUnknownError:U0,VectorBucketApi:G0,VectorBucketScope:K0,VectorDataApi:V0,VectorIndexApi:H0,VectorIndexScope:Q0,isPlainObject:W0,isStorageError:Ne,isStorageVectorsError:gt,normalizeToFloat32:$v,resolveFetch:_o,resolveResponse:Mv,validateVectorDimension:Bv},Symbol.toStringTag,{value:"Module"})),Gv=wi(Vv);var J0={},Co={};Object.defineProperty(Co,"__esModule",{value:!0});Co.version=void 0;Co.version="2.87.1";(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DEFAULT_REALTIME_OPTIONS=e.DEFAULT_AUTH_OPTIONS=e.DEFAULT_DB_OPTIONS=e.DEFAULT_GLOBAL_OPTIONS=e.DEFAULT_HEADERS=void 0;const t=Co;let s="";typeof Deno<"u"?s="deno":typeof document<"u"?s="web":typeof navigator<"u"&&navigator.product==="ReactNative"?s="react-native":s="node",e.DEFAULT_HEADERS={"X-Client-Info":`supabase-js-${s}/${t.version}`},e.DEFAULT_GLOBAL_OPTIONS={headers:e.DEFAULT_HEADERS},e.DEFAULT_DB_OPTIONS={schema:"public"},e.DEFAULT_AUTH_OPTIONS={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},e.DEFAULT_REALTIME_OPTIONS={}})(J0);var Y0={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.fetchWithAuth=e.resolveHeadersConstructor=e.resolveFetch=void 0;const t=i=>i?(...a)=>i(...a):(...a)=>fetch(...a);e.resolveFetch=t;const s=()=>Headers;e.resolveHeadersConstructor=s;const n=(i,a,o)=>{const l=(0,e.resolveFetch)(o),d=(0,e.resolveHeadersConstructor)();return async(c,p)=>{var m;const g=(m=await a())!==null&&m!==void 0?m:i;let f=new d(p==null?void 0:p.headers);return f.has("apikey")||f.set("apikey",i),f.has("Authorization")||f.set("Authorization",`Bearer ${g}`),l(c,Object.assign(Object.assign({},p),{headers:f}))}};e.fetchWithAuth=n})(Y0);var rs={};Object.defineProperty(rs,"__esModule",{value:!0});rs.isBrowser=void 0;rs.uuid=qv;rs.ensureTrailingSlash=X0;rs.applySettingDefaults=Qv;rs.validateSupabaseUrl=Jv;function qv(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=Math.random()*16|0,s=e=="x"?t:t&3|8;return s.toString(16)})}function X0(e){return e.endsWith("/")?e:e+"/"}const Kv=()=>typeof window<"u";rs.isBrowser=Kv;function Qv(e,t){var s,n;const{db:i,auth:a,realtime:o,global:l}=e,{db:d,auth:c,realtime:p,global:m}=t,g={db:Object.assign(Object.assign({},d),i),auth:Object.assign(Object.assign({},c),a),realtime:Object.assign(Object.assign({},p),o),storage:{},global:Object.assign(Object.assign(Object.assign({},m),l),{headers:Object.assign(Object.assign({},(s=m==null?void 0:m.headers)!==null&&s!==void 0?s:{}),(n=l==null?void 0:l.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return e.accessToken?g.accessToken=e.accessToken:delete g.accessToken,g}function Jv(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(X0(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var zo={};const Z0="2.87.1",Fs=30*1e3,vc=3,al=vc*Fs,Yv="http://localhost:9999",Xv="supabase.auth.token",Zv={"X-Client-Info":`gotrue-js/${Z0}`},yc="X-Supabase-Api-Version",ef={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},ey=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,ty=10*60*1e3;let yn=class extends Error{constructor(t,s,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=s,this.code=n}};function te(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}let tf=class extends yn{constructor(t,s,n){super(t,s,n),this.name="AuthApiError",this.status=s,this.code=n}};function rf(e){return te(e)&&e.name==="AuthApiError"}let $r=class extends yn{constructor(t,s){super(t),this.name="AuthUnknownError",this.originalError=s}},Ar=class extends yn{constructor(t,s,n,i){super(t,n,i),this.name=s,this.status=n}},pt=class extends Ar{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}};function sf(e){return te(e)&&e.name==="AuthSessionMissingError"}let ds=class extends Ar{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}},Vn=class extends Ar{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}},Gn=class extends Ar{constructor(t,s=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}};function nf(e){return te(e)&&e.name==="AuthImplicitGrantRedirectError"}let bc=class extends Ar{constructor(t,s=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}},eo=class extends Ar{constructor(t,s){super(t,"AuthRetryableFetchError",s,void 0)}};function Sa(e){return te(e)&&e.name==="AuthRetryableFetchError"}let wc=class extends Ar{constructor(t,s,n){super(t,"AuthWeakPasswordError",s,"weak_password"),this.reasons=n}};function ry(e){return te(e)&&e.name==="AuthWeakPasswordError"}let to=class extends Ar{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}};const ro="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Yu=` 	
\r=`.split(""),sy=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Yu.length;t+=1)e[Yu[t].charCodeAt(0)]=-2;for(let t=0;t<ro.length;t+=1)e[ro[t].charCodeAt(0)]=t;return e})();function Xu(e,t,s){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;s(ro[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;s(ro[n]),t.queuedBits-=6}}function af(e,t,s){const n=sy[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)s(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function Zu(e){const t=[],s=o=>{t.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},a=o=>{ay(o,n,s)};for(let o=0;o<e.length;o+=1)af(e.charCodeAt(o),i,a);return t.join("")}function ny(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function iy(e,t){for(let s=0;s<e.length;s+=1){let n=e.charCodeAt(s);if(n>55295&&n<=56319){const i=(n-55296)*1024&65535;n=(e.charCodeAt(s+1)-56320&65535|i)+65536,s+=1}ny(n,t)}}function ay(e,t,s){if(t.utf8seq===0){if(e<=127){s(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&s(t.codepoint)}}function dn(e){const t=[],s={queue:0,queuedBits:0},n=i=>{t.push(i)};for(let i=0;i<e.length;i+=1)af(e.charCodeAt(i),s,n);return new Uint8Array(t)}function oy(e){const t=[];return iy(e,s=>t.push(s)),new Uint8Array(t)}function vs(e){const t=[],s={queue:0,queuedBits:0},n=i=>{t.push(i)};return e.forEach(i=>Xu(i,s,n)),Xu(null,s,n),t.join("")}function ly(e){return Math.round(Date.now()/1e3)+e}function cy(){return Symbol("auth-callback")}const Ke=()=>typeof window<"u"&&typeof document<"u",ns={tested:!1,writable:!1},of=()=>{if(!Ke())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ns.tested)return ns.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),ns.tested=!0,ns.writable=!0}catch{ns.tested=!0,ns.writable=!1}return ns.writable};function dy(e){const t={},s=new URL(e);if(s.hash&&s.hash[0]==="#")try{new URLSearchParams(s.hash.substring(1)).forEach((i,a)=>{t[a]=i})}catch{}return s.searchParams.forEach((n,i)=>{t[i]=n}),t}const lf=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),uy=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Us=async(e,t,s)=>{await e.setItem(t,JSON.stringify(s))},is=async(e,t)=>{const s=await e.getItem(t);if(!s)return null;try{return JSON.parse(s)}catch{return s}},qe=async(e,t)=>{await e.removeItem(t)};class Ao{constructor(){this.promise=new Ao.promiseConstructor((t,s)=>{this.resolve=t,this.reject=s})}}Ao.promiseConstructor=Promise;function ol(e){const t=e.split(".");if(t.length!==3)throw new to("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!ey.test(t[n]))throw new to("JWT not in base64url format");return{header:JSON.parse(Zu(t[0])),payload:JSON.parse(Zu(t[1])),signature:dn(t[2]),raw:{header:t[0],payload:t[1]}}}async function hy(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function my(e,t){return new Promise((n,i)=>{(async()=>{for(let a=0;a<1/0;a++)try{const o=await e(a);if(!t(a,null,o)){n(o);return}}catch(o){if(!t(a,o)){i(o);return}}})()})}function py(e){return("0"+e.toString(16)).substr(-2)}function fy(){const t=new Uint32Array(56);if(typeof crypto>"u"){const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=s.length;let i="";for(let a=0;a<56;a++)i+=s.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(t),Array.from(t,py).join("")}async function gy(e){const s=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",s),i=new Uint8Array(n);return Array.from(i).map(a=>String.fromCharCode(a)).join("")}async function xy(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const s=await gy(e);return btoa(s).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ts(e,t,s=!1){const n=fy();let i=n;s&&(i+="/PASSWORD_RECOVERY"),await Us(e,`${t}-code-verifier`,i);const a=await xy(n);return[a,n===a?"plain":"s256"]}const vy=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function yy(e){const t=e.headers.get(yc);if(!t||!t.match(vy))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function by(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function wy(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const jy=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Ds(e){if(!jy.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function ll(){const e={};return new Proxy(e,{get:(t,s)=>{if(s==="__isUserNotAvailableProxy")return!0;if(typeof s=="symbol"){const n=s.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${s}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,s)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${s}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,s)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${s}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Sy(e,t){return new Proxy(e,{get:(s,n,i)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const a=n.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)"||a==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(s,n,i)}return!t.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(s,n,i)}})}function eh(e){return JSON.parse(JSON.stringify(e))}const us=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Ny=[502,503,504];async function th(e){var t;if(!uy(e))throw new eo(us(e),0);if(Ny.includes(e.status))throw new eo(us(e),e.status);let s;try{s=await e.json()}catch(a){throw new $r(us(a),a)}let n;const i=yy(e);if(i&&i.getTime()>=ef["2024-01-01"].timestamp&&typeof s=="object"&&s&&typeof s.code=="string"?n=s.code:typeof s=="object"&&s&&typeof s.error_code=="string"&&(n=s.error_code),n){if(n==="weak_password")throw new wc(us(s),e.status,((t=s.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new pt}else if(typeof s=="object"&&s&&typeof s.weak_password=="object"&&s.weak_password&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.reasons.reduce((a,o)=>a&&typeof o=="string",!0))throw new wc(us(s),e.status,s.weak_password.reasons);throw new tf(us(s),e.status||500,n)}const ky=(e,t,s,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),s))};async function ae(e,t,s,n){var i;const a=Object.assign({},n==null?void 0:n.headers);a[yc]||(a[yc]=ef["2024-01-01"].name),n!=null&&n.jwt&&(a.Authorization=`Bearer ${n.jwt}`);const o=(i=n==null?void 0:n.query)!==null&&i!==void 0?i:{};n!=null&&n.redirectTo&&(o.redirect_to=n.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",d=await _y(e,t,s+l,{headers:a,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(d):{data:Object.assign({},d),error:null}}async function _y(e,t,s,n,i,a){const o=ky(t,n,i,a);let l;try{l=await e(s,Object.assign({},o))}catch(d){throw console.error(d),new eo(us(d),0)}if(l.ok||await th(l),n!=null&&n.noResolveJson)return l;try{return await l.json()}catch(d){await th(d)}}function Yt(e){var t;let s=null;Ay(e)&&(s=Object.assign({},e),e.expires_at||(s.expires_at=ly(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:s,user:n},error:null}}function rh(e){const t=Yt(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((s,n)=>s&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Br(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function Cy(e){return{data:e,error:null}}function zy(e){const{action_link:t,email_otp:s,hashed_token:n,redirect_to:i,verification_type:a}=e,o=Sn(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:s,hashed_token:n,redirect_to:i,verification_type:a},d=Object.assign({},o);return{data:{properties:l,user:d},error:null}}function sh(e){return e}function Ay(e){return e.access_token&&e.refresh_token&&e.expires_in}const Na=["global","local","others"];let kd=class{constructor({url:t="",headers:s={},fetch:n}){this.url=t,this.headers=s,this.fetch=lf(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,s=Na[0]){if(Na.indexOf(s)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Na.join(", ")}`);try{return await ae(this.fetch,"POST",`${this.url}/logout?scope=${s}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(te(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,s={}){try{return await ae(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:s.data},headers:this.headers,redirectTo:s.redirectTo,xform:Br})}catch(n){if(te(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:s}=t,n=Sn(t,["options"]),i=Object.assign(Object.assign({},n),s);return"newEmail"in n&&(i.new_email=n==null?void 0:n.newEmail,delete i.newEmail),await ae(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:zy,redirectTo:s==null?void 0:s.redirectTo})}catch(s){if(te(s))return{data:{properties:null,user:null},error:s};throw s}}async createUser(t){try{return await ae(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Br})}catch(s){if(te(s))return{data:{user:null},error:s};throw s}}async listUsers(t){var s,n,i,a,o,l,d;try{const c={nextPage:null,lastPage:0,total:0},p=await ae(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(s=t==null?void 0:t.page)===null||s===void 0?void 0:s.toString())!==null&&n!==void 0?n:"",per_page:(a=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&a!==void 0?a:""},xform:sh});if(p.error)throw p.error;const m=await p.json(),g=(o=p.headers.get("x-total-count"))!==null&&o!==void 0?o:0,f=(d=(l=p.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&d!==void 0?d:[];return f.length>0&&(f.forEach(v=>{const j=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(v.split(";")[1].split("=")[1]);c[`${S}Page`]=j}),c.total=parseInt(g)),{data:Object.assign(Object.assign({},m),c),error:null}}catch(c){if(te(c))return{data:{users:[]},error:c};throw c}}async getUserById(t){Ds(t);try{return await ae(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Br})}catch(s){if(te(s))return{data:{user:null},error:s};throw s}}async updateUserById(t,s){Ds(t);try{return await ae(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:s,headers:this.headers,xform:Br})}catch(n){if(te(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,s=!1){Ds(t);try{return await ae(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:s},xform:Br})}catch(n){if(te(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){Ds(t.userId);try{const{data:s,error:n}=await ae(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:s,error:n}}catch(s){if(te(s))return{data:null,error:s};throw s}}async _deleteFactor(t){Ds(t.userId),Ds(t.id);try{return{data:await ae(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(s){if(te(s))return{data:null,error:s};throw s}}async _listOAuthClients(t){var s,n,i,a,o,l,d;try{const c={nextPage:null,lastPage:0,total:0},p=await ae(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(s=t==null?void 0:t.page)===null||s===void 0?void 0:s.toString())!==null&&n!==void 0?n:"",per_page:(a=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&a!==void 0?a:""},xform:sh});if(p.error)throw p.error;const m=await p.json(),g=(o=p.headers.get("x-total-count"))!==null&&o!==void 0?o:0,f=(d=(l=p.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&d!==void 0?d:[];return f.length>0&&(f.forEach(v=>{const j=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(v.split(";")[1].split("=")[1]);c[`${S}Page`]=j}),c.total=parseInt(g)),{data:Object.assign(Object.assign({},m),c),error:null}}catch(c){if(te(c))return{data:{clients:[]},error:c};throw c}}async _createOAuthClient(t){try{return await ae(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(te(s))return{data:null,error:s};throw s}}async _getOAuthClient(t){try{return await ae(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(te(s))return{data:null,error:s};throw s}}async _updateOAuthClient(t,s){try{return await ae(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:s,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(te(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(t){try{return await ae(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(s){if(te(s))return{data:null,error:s};throw s}}async _regenerateOAuthClientSecret(t){try{return await ae(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(te(s))return{data:null,error:s};throw s}}};function nh(e={}){return{getItem:t=>e[t]||null,setItem:(t,s)=>{e[t]=s},removeItem:t=>{delete e[t]}}}const hs={debug:!!(globalThis&&of()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class _d extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}let cf=class extends _d{};class Ey extends _d{}async function df(e,t,s){hs.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),hs.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){hs.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,i.name);try{return await s()}finally{hs.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,i.name)}}else{if(t===0)throw hs.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new cf(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(hs.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await s()}}))}const ih={};async function Iy(e,t,s){var n;const i=(n=ih[e])!==null&&n!==void 0?n:Promise.resolve(),a=Promise.race([i.catch(()=>null),t>=0?new Promise((o,l)=>{setTimeout(()=>{l(new Ey(`Acquring process lock with name "${e}" timed out`))},t)}):null].filter(o=>o)).catch(o=>{if(o&&o.isAcquireTimeout)throw o;return null}).then(async()=>await s());return ih[e]=a.catch(async o=>{if(o&&o.isAcquireTimeout)return await i,null;throw o}),await a}function Oy(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function uf(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function Ty(e){return parseInt(e,16)}function Dy(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function Ry(e){var t;const{chainId:s,domain:n,expirationTime:i,issuedAt:a=new Date,nonce:o,notBefore:l,requestId:d,resources:c,scheme:p,uri:m,version:g}=e;{if(!Number.isInteger(s))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${s}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!m)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(g!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${g}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const f=uf(e.address),v=p?`${p}://${n}`:n,j=e.statement?`${e.statement}
`:"",S=`${v} wants you to sign in with your Ethereum account:
${f}

${j}`;let u=`URI: ${m}
Version: ${g}
Chain ID: ${s}${o?`
Nonce: ${o}`:""}
Issued At: ${a.toISOString()}`;if(i&&(u+=`
Expiration Time: ${i.toISOString()}`),l&&(u+=`
Not Before: ${l.toISOString()}`),d&&(u+=`
Request ID: ${d}`),c){let h=`
Resources:`;for(const x of c){if(!x||typeof x!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${x}`);h+=`
- ${x}`}u+=h}return`${S}
${u}`}class Me extends Error{constructor({message:t,code:s,cause:n,name:i}){var a;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=(a=i??(n instanceof Error?n.name:void 0))!==null&&a!==void 0?a:"Unknown Error",this.code=s}}class so extends Me{constructor(t,s){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s,message:t}),this.name="WebAuthnUnknownError",this.originalError=s}}function Py({error:e,options:t}){var s,n,i;const{publicKey:a}=t;if(!a)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Me({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((s=a.authenticatorSelection)===null||s===void 0?void 0:s.requireResidentKey)===!0)return new Me({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((n=a.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new Me({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((i=a.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new Me({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new Me({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new Me({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return a.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new Me({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new Me({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const o=window.location.hostname;if(hf(o)){if(a.rp.id!==o)return new Me({message:`The RP ID "${a.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Me({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(a.user.id.byteLength<1||a.user.id.byteLength>64)return new Me({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new Me({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Me({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function Ly({error:e,options:t}){const{publicKey:s}=t;if(!s)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Me({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new Me({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const n=window.location.hostname;if(hf(n)){if(s.rpId!==n)return new Me({message:`The RP ID "${s.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Me({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new Me({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Me({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class My{createNewAbortSignal(){if(this.controller){const s=new Error("Cancelling existing WebAuthn API call for new one");s.name="AbortError",this.controller.abort(s)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const $y=new My;function By(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:s,excludeCredentials:n}=e,i=Sn(e,["challenge","user","excludeCredentials"]),a=dn(t).buffer,o=Object.assign(Object.assign({},s),{id:dn(s.id).buffer}),l=Object.assign(Object.assign({},i),{challenge:a,user:o});if(n&&n.length>0){l.excludeCredentials=new Array(n.length);for(let d=0;d<n.length;d++){const c=n[d];l.excludeCredentials[d]=Object.assign(Object.assign({},c),{id:dn(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return l}function Fy(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:s}=e,n=Sn(e,["challenge","allowCredentials"]),i=dn(t).buffer,a=Object.assign(Object.assign({},n),{challenge:i});if(s&&s.length>0){a.allowCredentials=new Array(s.length);for(let o=0;o<s.length;o++){const l=s[o];a.allowCredentials[o]=Object.assign(Object.assign({},l),{id:dn(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return a}function Uy(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const s=e;return{id:e.id,rawId:e.id,response:{attestationObject:vs(new Uint8Array(e.response.attestationObject)),clientDataJSON:vs(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=s.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function Wy(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const s=e,n=e.getClientExtensionResults(),i=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:vs(new Uint8Array(i.authenticatorData)),clientDataJSON:vs(new Uint8Array(i.clientDataJSON)),signature:vs(new Uint8Array(i.signature)),userHandle:i.userHandle?vs(new Uint8Array(i.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(t=s.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function hf(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function ah(){var e,t;return!!(Ke()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function Hy(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new so("Browser returned unexpected credential type",t)}:{data:null,error:new so("Empty credential response",t)}}catch(t){return{data:null,error:Py({error:t,options:e})}}}async function Vy(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new so("Browser returned unexpected credential type",t)}:{data:null,error:new so("Empty credential response",t)}}catch(t){return{data:null,error:Ly({error:t,options:e})}}}const Gy={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},qy={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function no(...e){const t=i=>i!==null&&typeof i=="object"&&!Array.isArray(i),s=i=>i instanceof ArrayBuffer||ArrayBuffer.isView(i),n={};for(const i of e)if(i)for(const a in i){const o=i[a];if(o!==void 0)if(Array.isArray(o))n[a]=o;else if(s(o))n[a]=o;else if(t(o)){const l=n[a];t(l)?n[a]=no(l,o):n[a]=no(o)}else n[a]=o}return n}function Ky(e,t){return no(Gy,e,t||{})}function Qy(e,t){return no(qy,e,t||{})}class Jy{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:s,friendlyName:n,signal:i},a){try{const{data:o,error:l}=await this.client.mfa.challenge({factorId:t,webauthn:s});if(!o)return{data:null,error:l};const d=i??$y.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:c}=o.webauthn.credential_options.publicKey;c.name||(c.name=`${c.id}:${n}`),c.displayName||(c.displayName=c.name)}switch(o.webauthn.type){case"create":{const c=Ky(o.webauthn.credential_options.publicKey,a==null?void 0:a.create),{data:p,error:m}=await Hy({publicKey:c,signal:d});return p?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:p}},error:null}:{data:null,error:m}}case"request":{const c=Qy(o.webauthn.credential_options.publicKey,a==null?void 0:a.request),{data:p,error:m}=await Vy(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:c,signal:d}));return p?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:p}},error:null}:{data:null,error:m}}}}catch(o){return te(o)?{data:null,error:o}:{data:null,error:new $r("Unexpected error in challenge",o)}}}async _verify({challengeId:t,factorId:s,webauthn:n}){return this.client.mfa.verify({factorId:s,challengeId:t,webauthn:n})}async _authenticate({factorId:t,webauthn:{rpId:s=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},a){if(!s)return{data:null,error:new yn("rpId is required for WebAuthn authentication")};try{if(!ah())return{data:null,error:new $r("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this.challenge({factorId:t,webauthn:{rpId:s,rpOrigins:n},signal:i},{request:a});if(!o)return{data:null,error:l};const{webauthn:d}=o;return this._verify({factorId:t,challengeId:o.challengeId,webauthn:{type:d.type,rpId:s,rpOrigins:n,credential_response:d.credential_response}})}catch(o){return te(o)?{data:null,error:o}:{data:null,error:new $r("Unexpected error in authenticate",o)}}}async _register({friendlyName:t,webauthn:{rpId:s=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},a){if(!s)return{data:null,error:new yn("rpId is required for WebAuthn registration")};try{if(!ah())return{data:null,error:new $r("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this._enroll({friendlyName:t});if(!o)return await this.client.mfa.listFactors().then(p=>{var m;return(m=p.data)===null||m===void 0?void 0:m.all.find(g=>g.factor_type==="webauthn"&&g.friendly_name===t&&g.status!=="unverified")}).then(p=>p?this.client.mfa.unenroll({factorId:p==null?void 0:p.id}):void 0),{data:null,error:l};const{data:d,error:c}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:s,rpOrigins:n},signal:i},{create:a});return d?this._verify({factorId:o.id,challengeId:d.challengeId,webauthn:{rpId:s,rpOrigins:n,type:d.webauthn.type,credential_response:d.webauthn.credential_response}}):{data:null,error:c}}catch(o){return te(o)?{data:null,error:o}:{data:null,error:new $r("Unexpected error in register",o)}}}}Oy();const Yy={url:Yv,storageKey:Xv,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Zv,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function oh(e,t,s){return await s()}const Rs={};let Cd=class jc{get jwks(){var t,s;return(s=(t=Rs[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&s!==void 0?s:{keys:[]}}set jwks(t){Rs[this.storageKey]=Object.assign(Object.assign({},Rs[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,s;return(s=(t=Rs[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&s!==void 0?s:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Rs[this.storageKey]=Object.assign(Object.assign({},Rs[this.storageKey]),{cachedAt:t})}constructor(t){var s,n,i;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const a=Object.assign(Object.assign({},Yy),t);if(this.storageKey=a.storageKey,this.instanceID=(s=jc.nextInstanceID[this.storageKey])!==null&&s!==void 0?s:0,jc.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.instanceID>0&&Ke()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=a.persistSession,this.autoRefreshToken=a.autoRefreshToken,this.admin=new kd({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=lf(a.fetch),this.lock=a.lock||oh,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,this.throwOnError=a.throwOnError,a.lock?this.lock=a.lock:this.persistSession&&Ke()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=df:this.lock=oh,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new Jy(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:of()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=nh(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=nh(this.memoryStorage)),Ke()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(i=this.broadcastChannel)===null||i===void 0||i.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Z0}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let s={},n="none";if(Ke()&&(s=dy(window.location.href),this._isImplicitGrantCallback(s)?n="implicit":await this._isPKCECallback(s)&&(n="pkce")),Ke()&&this.detectSessionInUrl&&n!=="none"){const{data:i,error:a}=await this._getSessionFromURL(s,n);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),nf(a)){const d=(t=a.details)===null||t===void 0?void 0:t.code;if(d==="identity_already_exists"||d==="identity_not_found"||d==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:o,redirectType:l}=i;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(s){return te(s)?this._returnResult({error:s}):this._returnResult({error:new $r("Unexpected error during initialization",s)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var s,n,i;try{const a=await ae(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(s=t==null?void 0:t.options)===null||s===void 0?void 0:s.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=t==null?void 0:t.options)===null||i===void 0?void 0:i.captchaToken}},xform:Yt}),{data:o,error:l}=a;if(l||!o)return this._returnResult({data:{user:null,session:null},error:l});const d=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",d)),this._returnResult({data:{user:c,session:d},error:null})}catch(a){if(te(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signUp(t){var s,n,i;try{let a;if("email"in t){const{email:p,password:m,options:g}=t;let f=null,v=null;this.flowType==="pkce"&&([f,v]=await Ts(this.storage,this.storageKey)),a=await ae(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:g==null?void 0:g.emailRedirectTo,body:{email:p,password:m,data:(s=g==null?void 0:g.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken},code_challenge:f,code_challenge_method:v},xform:Yt})}else if("phone"in t){const{phone:p,password:m,options:g}=t;a=await ae(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:p,password:m,data:(n=g==null?void 0:g.data)!==null&&n!==void 0?n:{},channel:(i=g==null?void 0:g.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken}},xform:Yt})}else throw new Vn("You must provide either an email or phone number and a password");const{data:o,error:l}=a;if(l||!o)return await qe(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:l});const d=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",d)),this._returnResult({data:{user:c,session:d},error:null})}catch(a){if(await qe(this.storage,`${this.storageKey}-code-verifier`),te(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithPassword(t){try{let s;if("email"in t){const{email:a,password:o,options:l}=t;s=await ae(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:rh})}else if("phone"in t){const{phone:a,password:o,options:l}=t;s=await ae(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:rh})}else throw new Vn("You must provide either an email or phone number and a password");const{data:n,error:i}=s;if(i)return this._returnResult({data:{user:null,session:null},error:i});if(!n||!n.session||!n.user){const a=new ds;return this._returnResult({data:{user:null,session:null},error:a})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(s){if(te(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithOAuth(t){var s,n,i,a;return await this._handleProviderSignIn(t.provider,{redirectTo:(s=t.options)===null||s===void 0?void 0:s.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=t.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(a=t.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:s}=t;switch(s){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${s}"`)}}async signInWithEthereum(t){var s,n,i,a,o,l,d,c,p,m,g;let f,v;if("message"in t)f=t.message,v=t.signature;else{const{chain:j,wallet:S,statement:u,options:h}=t;let x;if(Ke())if(typeof S=="object")x=S;else{const L=window;if("ethereum"in L&&typeof L.ethereum=="object"&&"request"in L.ethereum&&typeof L.ethereum.request=="function")x=L.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof S!="object"||!(h!=null&&h.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");x=S}const _=new URL((s=h==null?void 0:h.url)!==null&&s!==void 0?s:window.location.href),N=await x.request({method:"eth_requestAccounts"}).then(L=>L).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!N||N.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const w=uf(N[0]);let C=(n=h==null?void 0:h.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!C){const L=await x.request({method:"eth_chainId"});C=Ty(L)}const y={domain:_.host,address:w,statement:u,uri:_.href,version:"1",chainId:C,nonce:(i=h==null?void 0:h.signInWithEthereum)===null||i===void 0?void 0:i.nonce,issuedAt:(o=(a=h==null?void 0:h.signInWithEthereum)===null||a===void 0?void 0:a.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(l=h==null?void 0:h.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(d=h==null?void 0:h.signInWithEthereum)===null||d===void 0?void 0:d.notBefore,requestId:(c=h==null?void 0:h.signInWithEthereum)===null||c===void 0?void 0:c.requestId,resources:(p=h==null?void 0:h.signInWithEthereum)===null||p===void 0?void 0:p.resources};f=Ry(y),v=await x.request({method:"personal_sign",params:[Dy(f),w]})}try{const{data:j,error:S}=await ae(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:f,signature:v},!((m=t.options)===null||m===void 0)&&m.captchaToken?{gotrue_meta_security:{captcha_token:(g=t.options)===null||g===void 0?void 0:g.captchaToken}}:null),xform:Yt});if(S)throw S;if(!j||!j.session||!j.user){const u=new ds;return this._returnResult({data:{user:null,session:null},error:u})}return j.session&&(await this._saveSession(j.session),await this._notifyAllSubscribers("SIGNED_IN",j.session)),this._returnResult({data:Object.assign({},j),error:S})}catch(j){if(te(j))return this._returnResult({data:{user:null,session:null},error:j});throw j}}async signInWithSolana(t){var s,n,i,a,o,l,d,c,p,m,g,f;let v,j;if("message"in t)v=t.message,j=t.signature;else{const{chain:S,wallet:u,statement:h,options:x}=t;let _;if(Ke())if(typeof u=="object")_=u;else{const w=window;if("solana"in w&&typeof w.solana=="object"&&("signIn"in w.solana&&typeof w.solana.signIn=="function"||"signMessage"in w.solana&&typeof w.solana.signMessage=="function"))_=w.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof u!="object"||!(x!=null&&x.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");_=u}const N=new URL((s=x==null?void 0:x.url)!==null&&s!==void 0?s:window.location.href);if("signIn"in _&&_.signIn){const w=await _.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},x==null?void 0:x.signInWithSolana),{version:"1",domain:N.host,uri:N.href}),h?{statement:h}:null));let C;if(Array.isArray(w)&&w[0]&&typeof w[0]=="object")C=w[0];else if(w&&typeof w=="object"&&"signedMessage"in w&&"signature"in w)C=w;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in C&&"signature"in C&&(typeof C.signedMessage=="string"||C.signedMessage instanceof Uint8Array)&&C.signature instanceof Uint8Array)v=typeof C.signedMessage=="string"?C.signedMessage:new TextDecoder().decode(C.signedMessage),j=C.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in _)||typeof _.signMessage!="function"||!("publicKey"in _)||typeof _!="object"||!_.publicKey||!("toBase58"in _.publicKey)||typeof _.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");v=[`${N.host} wants you to sign in with your Solana account:`,_.publicKey.toBase58(),...h?["",h,""]:[""],"Version: 1",`URI: ${N.href}`,`Issued At: ${(i=(n=x==null?void 0:x.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((a=x==null?void 0:x.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${x.signInWithSolana.notBefore}`]:[],...!((o=x==null?void 0:x.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${x.signInWithSolana.expirationTime}`]:[],...!((l=x==null?void 0:x.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${x.signInWithSolana.chainId}`]:[],...!((d=x==null?void 0:x.signInWithSolana)===null||d===void 0)&&d.nonce?[`Nonce: ${x.signInWithSolana.nonce}`]:[],...!((c=x==null?void 0:x.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${x.signInWithSolana.requestId}`]:[],...!((m=(p=x==null?void 0:x.signInWithSolana)===null||p===void 0?void 0:p.resources)===null||m===void 0)&&m.length?["Resources",...x.signInWithSolana.resources.map(C=>`- ${C}`)]:[]].join(`
`);const w=await _.signMessage(new TextEncoder().encode(v),"utf8");if(!w||!(w instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");j=w}}try{const{data:S,error:u}=await ae(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:v,signature:vs(j)},!((g=t.options)===null||g===void 0)&&g.captchaToken?{gotrue_meta_security:{captcha_token:(f=t.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:Yt});if(u)throw u;if(!S||!S.session||!S.user){const h=new ds;return this._returnResult({data:{user:null,session:null},error:h})}return S.session&&(await this._saveSession(S.session),await this._notifyAllSubscribers("SIGNED_IN",S.session)),this._returnResult({data:Object.assign({},S),error:u})}catch(S){if(te(S))return this._returnResult({data:{user:null,session:null},error:S});throw S}}async _exchangeCodeForSession(t){const s=await is(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(s??"").split("/");try{const{data:a,error:o}=await ae(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Yt});if(await qe(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!a||!a.session||!a.user){const l=new ds;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign(Object.assign({},a),{redirectType:i??null}),error:o})}catch(a){if(await qe(this.storage,`${this.storageKey}-code-verifier`),te(a))return this._returnResult({data:{user:null,session:null,redirectType:null},error:a});throw a}}async signInWithIdToken(t){try{const{options:s,provider:n,token:i,access_token:a,nonce:o}=t,l=await ae(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:a,nonce:o,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},xform:Yt}),{data:d,error:c}=l;if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!d||!d.session||!d.user){const p=new ds;return this._returnResult({data:{user:null,session:null},error:p})}return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),this._returnResult({data:d,error:c})}catch(s){if(te(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithOtp(t){var s,n,i,a,o;try{if("email"in t){const{email:l,options:d}=t;let c=null,p=null;this.flowType==="pkce"&&([c,p]=await Ts(this.storage,this.storageKey));const{error:m}=await ae(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(s=d==null?void 0:d.data)!==null&&s!==void 0?s:{},create_user:(n=d==null?void 0:d.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:c,code_challenge_method:p},redirectTo:d==null?void 0:d.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:m})}if("phone"in t){const{phone:l,options:d}=t,{data:c,error:p}=await ae(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(i=d==null?void 0:d.data)!==null&&i!==void 0?i:{},create_user:(a=d==null?void 0:d.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},channel:(o=d==null?void 0:d.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:p})}throw new Vn("You must provide either an email or phone number.")}catch(l){if(await qe(this.storage,`${this.storageKey}-code-verifier`),te(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(t){var s,n;try{let i,a;"options"in t&&(i=(s=t.options)===null||s===void 0?void 0:s.redirectTo,a=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:l}=await ae(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:a}}),redirectTo:i,xform:Yt});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const d=o.session,c=o.user;return d!=null&&d.access_token&&(await this._saveSession(d),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",d)),this._returnResult({data:{user:c,session:d},error:null})}catch(i){if(te(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithSSO(t){var s,n,i,a,o;try{let l=null,d=null;this.flowType==="pkce"&&([l,d]=await Ts(this.storage,this.storageKey));const c=await ae(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(s=t.options)===null||s===void 0?void 0:s.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=t==null?void 0:t.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:d}),headers:this.headers,xform:Cy});return!((a=c.data)===null||a===void 0)&&a.url&&Ke()&&!(!((o=t.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(c.data.url),this._returnResult(c)}catch(l){if(await qe(this.storage,`${this.storageKey}-code-verifier`),te(l))return this._returnResult({data:null,error:l});throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:s},error:n}=t;if(n)throw n;if(!s)throw new pt;const{error:i}=await ae(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:s.access_token});return this._returnResult({data:{user:null,session:null},error:i})})}catch(t){if(te(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const s=`${this.url}/resend`;if("email"in t){const{email:n,type:i,options:a}=t,{error:o}=await ae(this.fetch,"POST",s,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},redirectTo:a==null?void 0:a.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in t){const{phone:n,type:i,options:a}=t,{data:o,error:l}=await ae(this.fetch,"POST",s,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l})}throw new Vn("You must provide either an email or phone number and a type")}catch(s){if(te(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async s=>s))}async _acquireLock(t,s){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await s()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=s();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const s=await this.__loadSession();return await t(s)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const s=await is(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",s),s!==null&&(this._isValidSession(s)?t=s:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<al:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const o=await is(this.userStorage,this.storageKey+"-user");o!=null&&o.user?t.user=o.user:t.user=ll()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};t.user=Sy(t.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:i,error:a}=await this._callRefreshToken(t.refresh_token);return a?this._returnResult({data:{session:null},error:a}):this._returnResult({data:{session:i},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const s=await this._acquireLock(-1,async()=>await this._getUser());return s.data.user&&(this.suppressGetSessionWarning=!0),s}async _getUser(t){try{return t?await ae(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Br}):await this._useSession(async s=>{var n,i,a;const{data:o,error:l}=s;if(l)throw l;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new pt}:await ae(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(i=o.session)===null||i===void 0?void 0:i.access_token)!==null&&a!==void 0?a:void 0,xform:Br})})}catch(s){if(te(s))return sf(s)&&(await this._removeSession(),await qe(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:s});throw s}}async updateUser(t,s={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,s))}async _updateUser(t,s={}){try{return await this._useSession(async n=>{const{data:i,error:a}=n;if(a)throw a;if(!i.session)throw new pt;const o=i.session;let l=null,d=null;this.flowType==="pkce"&&t.email!=null&&([l,d]=await Ts(this.storage,this.storageKey));const{data:c,error:p}=await ae(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:s==null?void 0:s.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:l,code_challenge_method:d}),jwt:o.access_token,xform:Br});if(p)throw p;return o.user=c.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(n){if(await qe(this.storage,`${this.storageKey}-code-verifier`),te(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new pt;const s=Date.now()/1e3;let n=s,i=!0,a=null;const{payload:o}=ol(t.access_token);if(o.exp&&(n=o.exp,i=n<=s),i){const{data:l,error:d}=await this._callRefreshToken(t.refresh_token);if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!l)return{data:{user:null,session:null},error:null};a=l}else{const{data:l,error:d}=await this._getUser(t.access_token);if(d)throw d;a={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:n-s,expires_at:n},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return this._returnResult({data:{user:a.user,session:a},error:null})}catch(s){if(te(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async s=>{var n;if(!t){const{data:o,error:l}=s;if(l)throw l;t=(n=o.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new pt;const{data:i,error:a}=await this._callRefreshToken(t.refresh_token);return a?this._returnResult({data:{user:null,session:null},error:a}):i?this._returnResult({data:{user:i.user,session:i},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(s){if(te(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async _getSessionFromURL(t,s){try{if(!Ke())throw new Gn("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Gn(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(s){case"implicit":if(this.flowType==="pkce")throw new bc("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Gn("Not a valid implicit grant flow url.");break;default:}if(s==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new bc("No code detected.");const{data:h,error:x}=await this._exchangeCodeForSession(t.code);if(x)throw x;const _=new URL(window.location.href);return _.searchParams.delete("code"),window.history.replaceState(window.history.state,"",_.toString()),{data:{session:h.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:a,refresh_token:o,expires_in:l,expires_at:d,token_type:c}=t;if(!a||!l||!o||!c)throw new Gn("No session defined in URL");const p=Math.round(Date.now()/1e3),m=parseInt(l);let g=p+m;d&&(g=parseInt(d));const f=g-p;f*1e3<=Fs&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${m}s`);const v=g-m;p-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,g,p):p-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,g,p);const{data:j,error:S}=await this._getUser(a);if(S)throw S;const u={provider_token:n,provider_refresh_token:i,access_token:a,expires_in:m,expires_at:g,refresh_token:o,token_type:c,user:j.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:u,redirectType:t.type},error:null})}catch(n){if(te(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const s=await is(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&s)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async s=>{var n;const{data:i,error:a}=s;if(a)return this._returnResult({error:a});const o=(n=i.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:l}=await this.admin.signOut(o,t);if(l&&!(rf(l)&&(l.status===404||l.status===401||l.status===403)))return this._returnResult({error:l})}return t!=="others"&&(await this._removeSession(),await qe(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const s=cy(),n={id:s,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",s),this.stateChangeEmitters.delete(s)}};return this._debug("#onAuthStateChange()","registered callback with id",s),this.stateChangeEmitters.set(s,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(s)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async s=>{var n,i;try{const{data:{session:a},error:o}=s;if(o)throw o;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",t,"session",a)}catch(a){await((i=this.stateChangeEmitters.get(t))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",a),console.error(a)}})}async resetPasswordForEmail(t,s={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await Ts(this.storage,this.storageKey,!0));try{return await ae(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:s.captchaToken}},headers:this.headers,redirectTo:s.redirectTo})}catch(a){if(await qe(this.storage,`${this.storageKey}-code-verifier`),te(a))return this._returnResult({data:null,error:a});throw a}}async getUserIdentities(){var t;try{const{data:s,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(t=s.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(s){if(te(s))return this._returnResult({data:null,error:s});throw s}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var s;try{const{data:n,error:i}=await this._useSession(async a=>{var o,l,d,c,p;const{data:m,error:g}=a;if(g)throw g;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(o=t.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(d=t.options)===null||d===void 0?void 0:d.queryParams,skipBrowserRedirect:!0});return await ae(this.fetch,"GET",f,{headers:this.headers,jwt:(p=(c=m.session)===null||c===void 0?void 0:c.access_token)!==null&&p!==void 0?p:void 0})});if(i)throw i;return Ke()&&!(!((s=t.options)===null||s===void 0)&&s.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),this._returnResult({data:{provider:t.provider,url:n==null?void 0:n.url},error:null})}catch(n){if(te(n))return this._returnResult({data:{provider:t.provider,url:null},error:n});throw n}}async linkIdentityIdToken(t){return await this._useSession(async s=>{var n;try{const{error:i,data:{session:a}}=s;if(i)throw i;const{options:o,provider:l,token:d,access_token:c,nonce:p}=t,m=await ae(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=a==null?void 0:a.access_token)!==null&&n!==void 0?n:void 0,body:{provider:l,id_token:d,access_token:c,nonce:p,link_identity:!0,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Yt}),{data:g,error:f}=m;return f?this._returnResult({data:{user:null,session:null},error:f}):!g||!g.session||!g.user?this._returnResult({data:{user:null,session:null},error:new ds}):(g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("USER_UPDATED",g.session)),this._returnResult({data:g,error:f}))}catch(i){if(await qe(this.storage,`${this.storageKey}-code-verifier`),te(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}})}async unlinkIdentity(t){try{return await this._useSession(async s=>{var n,i;const{data:a,error:o}=s;if(o)throw o;return await ae(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(i=(n=a.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(s){if(te(s))return this._returnResult({data:null,error:s});throw s}}async _refreshAccessToken(t){const s=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{const n=Date.now();return await my(async i=>(i>0&&await hy(200*Math.pow(2,i-1)),this._debug(s,"refreshing attempt",i),await ae(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Yt})),(i,a)=>{const o=200*Math.pow(2,i);return a&&Sa(a)&&Date.now()+o-n<Fs})}catch(n){if(this._debug(s,"error",n),te(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(s,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,s){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:s.redirectTo,scopes:s.scopes,queryParams:s.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",s,"url",n),Ke()&&!s.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,s;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const i=await is(this.storage,this.storageKey);if(i&&this.userStorage){let o=await is(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:i.user},await Us(this.userStorage,this.storageKey+"-user",o)),i.user=(t=o==null?void 0:o.user)!==null&&t!==void 0?t:ll()}else if(i&&!i.user&&!i.user){const o=await is(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(i.user=o.user,await qe(this.storage,this.storageKey+"-user"),await Us(this.storage,this.storageKey,i)):i.user=ll()}if(this._debug(n,"session from storage",i),!this._isValidSession(i)){this._debug(n,"session is not valid"),i!==null&&await this._removeSession();return}const a=((s=i.expires_at)!==null&&s!==void 0?s:1/0)*1e3-Date.now()<al;if(this._debug(n,`session has${a?"":" not"} expired with margin of ${al}s`),a){if(this.autoRefreshToken&&i.refresh_token){const{error:o}=await this._callRefreshToken(i.refresh_token);o&&(console.error(o),Sa(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(i.access_token);!l&&(o!=null&&o.user)?(i.user=o.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(n,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(n,"error",i),console.error(i);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var s,n;if(!t)throw new pt;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new Ao;const{data:a,error:o}=await this._refreshAccessToken(t);if(o)throw o;if(!a.session)throw new pt;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const l={data:a.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(a){if(this._debug(i,"error",a),te(a)){const o={data:null,error:a};return Sa(a)||await this._removeSession(),(s=this.refreshingDeferred)===null||s===void 0||s.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(a),a}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(t,s,n=!0){const i=`#_notifyAllSubscribers(${t})`;this._debug(i,"begin",s,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:s});const a=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(t,s)}catch(d){a.push(d)}});if(await Promise.all(o),a.length>0){for(let l=0;l<a.length;l+=1)console.error(a[l]);throw a[0]}}finally{this._debug(i,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await qe(this.storage,`${this.storageKey}-code-verifier`);const s=Object.assign({},t),n=s.user&&s.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&s.user&&await Us(this.userStorage,this.storageKey+"-user",{user:s.user});const i=Object.assign({},s);delete i.user;const a=eh(i);await Us(this.storage,this.storageKey,a)}else{const i=eh(s);await Us(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await qe(this.storage,this.storageKey),await qe(this.storage,this.storageKey+"-code-verifier"),await qe(this.storage,this.storageKey+"-user"),this.userStorage&&await qe(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Ke()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(s){console.error("removing visibilitychange callback failed",s)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Fs);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async s=>{const{data:{session:n}}=s;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-t)/Fs);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${Fs}ms, refresh threshold is ${vc} ticks`),i<=vc&&await this._callRefreshToken(n.refresh_token)})}catch(s){console.error("Auto refresh tick failed with error. This is likely a transient error.",s)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof _d)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Ke()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const s=`#_onVisibilityChanged(${t})`;this._debug(s,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(s,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,s,n){const i=[`provider=${encodeURIComponent(s)}`];if(n!=null&&n.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[a,o]=await Ts(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(o)}`});i.push(l.toString())}if(n!=null&&n.queryParams){const a=new URLSearchParams(n.queryParams);i.push(a.toString())}return n!=null&&n.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${i.join("&")}`}async _unenroll(t){try{return await this._useSession(async s=>{var n;const{data:i,error:a}=s;return a?this._returnResult({data:null,error:a}):await ae(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(s){if(te(s))return this._returnResult({data:null,error:s});throw s}}async _enroll(t){try{return await this._useSession(async s=>{var n,i;const{data:a,error:o}=s;if(o)return this._returnResult({data:null,error:o});const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:d,error:c}=await ae(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return c?this._returnResult({data:null,error:c}):(t.factorType==="totp"&&d.type==="totp"&&(!((i=d==null?void 0:d.totp)===null||i===void 0)&&i.qr_code)&&(d.totp.qr_code=`data:image/svg+xml;utf-8,${d.totp.qr_code}`),this._returnResult({data:d,error:null}))})}catch(s){if(te(s))return this._returnResult({data:null,error:s});throw s}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async s=>{var n;const{data:i,error:a}=s;if(a)return this._returnResult({data:null,error:a});const o=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?Uy(t.webauthn.credential_response):Wy(t.webauthn.credential_response)})}:{code:t.code}),{data:l,error:d}=await ae(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:o,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return d?this._returnResult({data:null,error:d}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:d}))})}catch(s){if(te(s))return this._returnResult({data:null,error:s});throw s}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async s=>{var n;const{data:i,error:a}=s;if(a)return this._returnResult({data:null,error:a});const o=await ae(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});if(o.error)return o;const{data:l}=o;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:By(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:Fy(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(s){if(te(s))return this._returnResult({data:null,error:s});throw s}})}async _challengeAndVerify(t){const{data:s,error:n}=await this._challenge({factorId:t.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:t.factorId,challengeId:s.id,code:t.code})}async _listFactors(){var t;const{data:{user:s},error:n}=await this.getUser();if(n)return{data:null,error:n};const i={all:[],phone:[],totp:[],webauthn:[]};for(const a of(t=s==null?void 0:s.factors)!==null&&t!==void 0?t:[])i.all.push(a),a.status==="verified"&&i[a.factor_type].push(a);return{data:i,error:null}}async _getAuthenticatorAssuranceLevel(){var t,s;const{data:{session:n},error:i}=await this.getSession();if(i)return this._returnResult({data:null,error:i});if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=ol(n.access_token);let o=null;a.aal&&(o=a.aal);let l=o;((s=(t=n.user.factors)===null||t===void 0?void 0:t.filter(p=>p.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(l="aal2");const c=a.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:c},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async s=>{const{data:{session:n},error:i}=s;return i?this._returnResult({data:null,error:i}):n?await ae(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:n.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new pt})})}catch(s){if(te(s))return this._returnResult({data:null,error:s});throw s}}async _approveAuthorization(t,s){try{return await this._useSession(async n=>{const{data:{session:i},error:a}=n;if(a)return this._returnResult({data:null,error:a});if(!i)return this._returnResult({data:null,error:new pt});const o=await ae(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&Ke()&&!(s!=null&&s.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(n){if(te(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(t,s){try{return await this._useSession(async n=>{const{data:{session:i},error:a}=n;if(a)return this._returnResult({data:null,error:a});if(!i)return this._returnResult({data:null,error:new pt});const o=await ae(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&Ke()&&!(s!=null&&s.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(n){if(te(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:s},error:n}=t;return n?this._returnResult({data:null,error:n}):s?await ae(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:s.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new pt})})}catch(t){if(te(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async s=>{const{data:{session:n},error:i}=s;return i?this._returnResult({data:null,error:i}):n?(await ae(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new pt})})}catch(s){if(te(s))return this._returnResult({data:null,error:s});throw s}}async fetchJwk(t,s={keys:[]}){let n=s.keys.find(l=>l.kid===t);if(n)return n;const i=Date.now();if(n=this.jwks.keys.find(l=>l.kid===t),n&&this.jwks_cached_at+ty>i)return n;const{data:a,error:o}=await ae(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=i,n=a.keys.find(l=>l.kid===t),!n)?null:n}async getClaims(t,s={}){try{let n=t;if(!n){const{data:f,error:v}=await this.getSession();if(v||!f.session)return this._returnResult({data:null,error:v});n=f.session.access_token}const{header:i,payload:a,signature:o,raw:{header:l,payload:d}}=ol(n);s!=null&&s.allowExpired||by(a.exp);const c=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,s!=null&&s.keys?{keys:s.keys}:s==null?void 0:s.jwks);if(!c){const{error:f}=await this.getUser(n);if(f)throw f;return{data:{claims:a,header:i,signature:o},error:null}}const p=wy(i.alg),m=await crypto.subtle.importKey("jwk",c,p,!0,["verify"]);if(!await crypto.subtle.verify(p,m,o,oy(`${l}.${d}`)))throw new to("Invalid JWT signature");return{data:{claims:a,header:i,signature:o},error:null}}catch(n){if(te(n))return this._returnResult({data:null,error:n});throw n}}};Cd.nextInstanceID={};const Xy=kd,Zy=Cd,eb=Object.freeze(Object.defineProperty({__proto__:null,AuthAdminApi:Xy,AuthApiError:tf,AuthClient:Zy,AuthError:yn,AuthImplicitGrantRedirectError:Gn,AuthInvalidCredentialsError:Vn,AuthInvalidJwtError:to,AuthInvalidTokenResponseError:ds,AuthPKCEGrantCodeExchangeError:bc,AuthRetryableFetchError:eo,AuthSessionMissingError:pt,AuthUnknownError:$r,AuthWeakPasswordError:wc,CustomAuthError:Ar,GoTrueAdminApi:kd,GoTrueClient:Cd,NavigatorLockAcquireTimeoutError:cf,SIGN_OUT_SCOPES:Na,isAuthApiError:rf,isAuthError:te,isAuthImplicitGrantRedirectError:nf,isAuthRetryableFetchError:Sa,isAuthSessionMissingError:sf,isAuthWeakPasswordError:ry,lockInternals:hs,navigatorLock:df,processLock:Iy},Symbol.toStringTag,{value:"Module"})),mf=wi(eb);Object.defineProperty(zo,"__esModule",{value:!0});zo.SupabaseAuthClient=void 0;const tb=mf;class rb extends tb.AuthClient{constructor(t){super(t)}}zo.SupabaseAuthClient=rb;Object.defineProperty(Qa,"__esModule",{value:!0});const sb=x0,nb=tt,ib=P0,ab=Gv,ta=J0,ob=Y0,lh=rs,lb=zo;let cb=class{constructor(t,s,n){var i,a,o;this.supabaseUrl=t,this.supabaseKey=s;const l=(0,lh.validateSupabaseUrl)(t);if(!s)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const d=`sb-${l.hostname.split(".")[0]}-auth-token`,c={db:ta.DEFAULT_DB_OPTIONS,realtime:ta.DEFAULT_REALTIME_OPTIONS,auth:Object.assign(Object.assign({},ta.DEFAULT_AUTH_OPTIONS),{storageKey:d}),global:ta.DEFAULT_GLOBAL_OPTIONS},p=(0,lh.applySettingDefaults)(n??{},c);this.storageKey=(i=p.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(a=p.global.headers)!==null&&a!==void 0?a:{},p.accessToken?(this.accessToken=p.accessToken,this.auth=new Proxy({},{get:(m,g)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(g)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=p.auth)!==null&&o!==void 0?o:{},this.headers,p.global.fetch),this.fetch=(0,ob.fetchWithAuth)(s,this._getAccessToken.bind(this),p.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},p.realtime)),this.accessToken&&this.accessToken().then(m=>this.realtime.setAuth(m)).catch(m=>console.warn("Failed to set initial Realtime auth token:",m)),this.rest=new nb.PostgrestClient(new URL("rest/v1",l).href,{headers:this.headers,schema:p.db.schema,fetch:this.fetch}),this.storage=new ab.StorageClient(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),p.accessToken||this._listenForAuthEvents()}get functions(){return new sb.FunctionsClient(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,s={},n={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,s,n)}channel(t,s={config:{}}){return this.realtime.channel(t,s)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t,s;if(this.accessToken)return await this.accessToken();const{data:n}=await this.auth.getSession();return(s=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&s!==void 0?s:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:s,detectSessionInUrl:n,storage:i,userStorage:a,storageKey:o,flowType:l,lock:d,debug:c,throwOnError:p},m,g){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new lb.SupabaseAuthClient({url:this.authUrl.href,headers:Object.assign(Object.assign({},f),m),storageKey:o,autoRefreshToken:t,persistSession:s,detectSessionInUrl:n,storage:i,userStorage:a,flowType:l,lock:d,debug:c,throwOnError:p,fetch:g,hasCustomAuthorizationHeader:Object.keys(this.headers).some(v=>v.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new ib.RealtimeClient(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((s,n)=>{this._handleTokenChanged(s,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,s,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),s=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};Qa.default=cb;(function(e){var t=Es&&Es.__createBinding||(Object.create?function(p,m,g,f){f===void 0&&(f=g);var v=Object.getOwnPropertyDescriptor(m,g);(!v||("get"in v?!m.__esModule:v.writable||v.configurable))&&(v={enumerable:!0,get:function(){return m[g]}}),Object.defineProperty(p,f,v)}:function(p,m,g,f){f===void 0&&(f=g),p[f]=m[g]}),s=Es&&Es.__exportStar||function(p,m){for(var g in p)g!=="default"&&!Object.prototype.hasOwnProperty.call(m,g)&&t(m,p,g)},n=Es&&Es.__importDefault||function(p){return p&&p.__esModule?p:{default:p}};Object.defineProperty(e,"__esModule",{value:!0}),e.createClient=e.SupabaseClient=e.FunctionRegion=e.FunctionsError=e.FunctionsRelayError=e.FunctionsFetchError=e.FunctionsHttpError=e.PostgrestError=void 0;const i=n(Qa);s(mf,e);var a=tt;Object.defineProperty(e,"PostgrestError",{enumerable:!0,get:function(){return a.PostgrestError}});var o=x0;Object.defineProperty(e,"FunctionsHttpError",{enumerable:!0,get:function(){return o.FunctionsHttpError}}),Object.defineProperty(e,"FunctionsFetchError",{enumerable:!0,get:function(){return o.FunctionsFetchError}}),Object.defineProperty(e,"FunctionsRelayError",{enumerable:!0,get:function(){return o.FunctionsRelayError}}),Object.defineProperty(e,"FunctionsError",{enumerable:!0,get:function(){return o.FunctionsError}}),Object.defineProperty(e,"FunctionRegion",{enumerable:!0,get:function(){return o.FunctionRegion}}),s(P0,e);var l=Qa;Object.defineProperty(e,"SupabaseClient",{enumerable:!0,get:function(){return n(l).default}});const d=(p,m,g)=>new i.default(p,m,g);e.createClient=d;function c(){if(typeof window<"u"||typeof process>"u")return!1;const p=process.version;if(p==null)return!1;const m=p.match(/^v(\d+)\./);return m?parseInt(m[1],10)<=18:!1}c()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217")})(vd);const pf=Oh(vd),db=jf({__proto__:null,default:pf},[vd]),{PostgrestError:ub,FunctionsHttpError:hb,FunctionsFetchError:mb,FunctionsRelayError:pb,FunctionsError:fb,FunctionRegion:gb,SupabaseClient:xb,createClient:io,GoTrueAdminApi:vb,GoTrueClient:yb,AuthAdminApi:bb,AuthClient:wb,navigatorLock:jb,NavigatorLockAcquireTimeoutError:Sb,lockInternals:Nb,processLock:kb,SIGN_OUT_SCOPES:_b,AuthError:Cb,AuthApiError:zb,AuthUnknownError:Ab,CustomAuthError:Eb,AuthSessionMissingError:Ib,AuthInvalidTokenResponseError:Ob,AuthInvalidCredentialsError:Tb,AuthImplicitGrantRedirectError:Db,AuthPKCEGrantCodeExchangeError:Rb,AuthRetryableFetchError:Pb,AuthWeakPasswordError:Lb,AuthInvalidJwtError:Mb,isAuthError:$b,isAuthApiError:Bb,isAuthSessionMissingError:Fb,isAuthImplicitGrantRedirectError:Ub,isAuthRetryableFetchError:Wb,isAuthWeakPasswordError:Hb,RealtimePresence:Vb,RealtimeChannel:Gb,RealtimeClient:qb,REALTIME_LISTEN_TYPES:Kb,REALTIME_POSTGRES_CHANGES_LISTEN_EVENT:Qb,REALTIME_PRESENCE_LISTEN_EVENTS:Jb,REALTIME_SUBSCRIBE_STATES:Yb,REALTIME_CHANNEL_STATES:Xb}=pf||db,Zb=Object.freeze(Object.defineProperty({__proto__:null,AuthAdminApi:bb,AuthApiError:zb,AuthClient:wb,AuthError:Cb,AuthImplicitGrantRedirectError:Db,AuthInvalidCredentialsError:Tb,AuthInvalidJwtError:Mb,AuthInvalidTokenResponseError:Ob,AuthPKCEGrantCodeExchangeError:Rb,AuthRetryableFetchError:Pb,AuthSessionMissingError:Ib,AuthUnknownError:Ab,AuthWeakPasswordError:Lb,CustomAuthError:Eb,FunctionRegion:gb,FunctionsError:fb,FunctionsFetchError:mb,FunctionsHttpError:hb,FunctionsRelayError:pb,GoTrueAdminApi:vb,GoTrueClient:yb,NavigatorLockAcquireTimeoutError:Sb,PostgrestError:ub,REALTIME_CHANNEL_STATES:Xb,REALTIME_LISTEN_TYPES:Kb,REALTIME_POSTGRES_CHANGES_LISTEN_EVENT:Qb,REALTIME_PRESENCE_LISTEN_EVENTS:Jb,REALTIME_SUBSCRIBE_STATES:Yb,RealtimeChannel:Gb,RealtimeClient:qb,RealtimePresence:Vb,SIGN_OUT_SCOPES:_b,SupabaseClient:xb,createClient:io,isAuthApiError:Bb,isAuthError:$b,isAuthImplicitGrantRedirectError:Ub,isAuthRetryableFetchError:Wb,isAuthSessionMissingError:Fb,isAuthWeakPasswordError:Hb,lockInternals:Nb,navigatorLock:jb,processLock:kb},Symbol.toStringTag,{value:"Module"})),ew={species:[],strains:[],locations:[],vessels:[],containerTypes:[],substrateTypes:[],suppliers:[],inventoryCategories:[],inventoryItems:[],cultures:[],grows:[],recipes:[],settings:{defaultUnits:"metric",defaultCurrency:"USD",altitude:0,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone||"America/Chicago",notifications:{enabled:!0,harvestReminders:!0,lowStockAlerts:!0,contaminationAlerts:!0}}},ch=()=>{const e=localStorage.getItem("mycolab-supabase-url"),t=localStorage.getItem("mycolab-supabase-key");return e&&t?io(e,t):null},dh=e=>({id:e.id,name:e.name,species:e.species||"cubensis",difficulty:e.difficulty||"intermediate",colonizationDays:{min:e.colonization_days_min||14,max:e.colonization_days_max||21},fruitingDays:{min:e.fruiting_days_min||7,max:e.fruiting_days_max||14},optimalTempColonization:{min:e.optimal_temp_colonization||24,max:e.optimal_temp_colonization||27},optimalTempFruiting:{min:e.optimal_temp_fruiting||20,max:e.optimal_temp_fruiting||24},notes:e.notes,isActive:e.is_active??!0}),uh=e=>{var t,s,n,i,a,o;return{name:e.name,species:e.species,difficulty:e.difficulty,colonization_days_min:(t=e.colonizationDays)==null?void 0:t.min,colonization_days_max:(s=e.colonizationDays)==null?void 0:s.max,fruiting_days_min:(n=e.fruitingDays)==null?void 0:n.min,fruiting_days_max:(i=e.fruitingDays)==null?void 0:i.max,optimal_temp_colonization:(a=e.optimalTempColonization)==null?void 0:a.min,optimal_temp_fruiting:(o=e.optimalTempFruiting)==null?void 0:o.min,notes:e.notes,is_active:e.isActive}},hh=e=>({id:e.id,name:e.name,type:e.type||"storage",tempRange:e.temp_min||e.temp_max?{min:e.temp_min,max:e.temp_max}:void 0,humidityRange:e.humidity_min||e.humidity_max?{min:e.humidity_min,max:e.humidity_max}:void 0,notes:e.notes,isActive:e.is_active??!0}),mh=e=>{var t,s,n,i;return{name:e.name,type:e.type,temp_min:(t=e.tempRange)==null?void 0:t.min,temp_max:(s=e.tempRange)==null?void 0:s.max,humidity_min:(n=e.humidityRange)==null?void 0:n.min,humidity_max:(i=e.humidityRange)==null?void 0:i.max,notes:e.notes,is_active:e.isActive}},ph=e=>({id:e.id,type:e.type,label:e.label,strainId:e.strain_id,status:e.status||"active",parentId:e.parent_id,generation:e.generation||0,locationId:e.location_id,vesselId:e.vessel_id,recipeId:e.recipe_id,volumeMl:e.volume_ml,fillVolumeMl:e.fill_volume_ml,prepDate:e.prep_date,sterilizationDate:e.sterilization_date,healthRating:e.health_rating||5,notes:e.notes,cost:e.cost||0,supplierId:e.supplier_id,lotNumber:e.lot_number,expiresAt:e.expires_at?new Date(e.expires_at):void 0,createdAt:new Date(e.created_at),updatedAt:new Date(e.updated_at),observations:[],transfers:[]}),fh=e=>{const t={};return e.type!==void 0&&(t.type=e.type),e.label!==void 0&&(t.label=e.label),e.strainId!==void 0&&(t.strain_id=e.strainId),e.status!==void 0&&(t.status=e.status),e.parentId!==void 0&&(t.parent_id=e.parentId),e.generation!==void 0&&(t.generation=e.generation),e.locationId!==void 0&&(t.location_id=e.locationId),e.vesselId!==void 0&&(t.vessel_id=e.vesselId),e.recipeId!==void 0&&(t.recipe_id=e.recipeId),e.volumeMl!==void 0&&(t.volume_ml=e.volumeMl),e.fillVolumeMl!==void 0&&(t.fill_volume_ml=e.fillVolumeMl),e.prepDate!==void 0&&(t.prep_date=e.prepDate),e.sterilizationDate!==void 0&&(t.sterilization_date=e.sterilizationDate),e.healthRating!==void 0&&(t.health_rating=e.healthRating),e.notes!==void 0&&(t.notes=e.notes),e.cost!==void 0&&(t.cost=e.cost),e.supplierId!==void 0&&(t.supplier_id=e.supplierId),e.lotNumber!==void 0&&(t.lot_number=e.lotNumber),e.expiresAt!==void 0&&(t.expires_at=e.expiresAt instanceof Date?e.expiresAt.toISOString():e.expiresAt),t},gh=e=>({id:e.id,name:e.name,strainId:e.strain_id,status:e.status||"active",currentStage:e.current_stage||"spawning",sourceCultureId:e.source_culture_id,spawnType:e.spawn_type||"grain",spawnWeight:e.spawn_weight||0,substrateTypeId:e.substrate_type_id,substrateWeight:e.substrate_weight||0,spawnRate:e.spawn_rate||20,containerTypeId:e.container_type_id,containerCount:e.container_count||1,spawnedAt:new Date(e.spawned_at),colonizationStartedAt:e.colonization_started_at?new Date(e.colonization_started_at):void 0,fruitingStartedAt:e.fruiting_started_at?new Date(e.fruiting_started_at):void 0,completedAt:e.completed_at?new Date(e.completed_at):void 0,locationId:e.location_id,targetTempColonization:e.target_temp_colonization||24,targetTempFruiting:e.target_temp_fruiting||22,targetHumidity:e.target_humidity||90,totalYield:e.total_yield||0,estimatedCost:e.estimated_cost||0,notes:e.notes,createdAt:new Date(e.created_at),observations:[],flushes:[]}),xh=e=>{const t={};return e.name!==void 0&&(t.name=e.name),e.strainId!==void 0&&(t.strain_id=e.strainId),e.status!==void 0&&(t.status=e.status),e.currentStage!==void 0&&(t.current_stage=e.currentStage),e.sourceCultureId!==void 0&&(t.source_culture_id=e.sourceCultureId),e.spawnType!==void 0&&(t.spawn_type=e.spawnType),e.spawnWeight!==void 0&&(t.spawn_weight=e.spawnWeight),e.substrateTypeId!==void 0&&(t.substrate_type_id=e.substrateTypeId),e.substrateWeight!==void 0&&(t.substrate_weight=e.substrateWeight),e.spawnRate!==void 0&&(t.spawn_rate=e.spawnRate),e.containerTypeId!==void 0&&(t.container_type_id=e.containerTypeId),e.containerCount!==void 0&&(t.container_count=e.containerCount),e.spawnedAt!==void 0&&(t.spawned_at=e.spawnedAt instanceof Date?e.spawnedAt.toISOString():e.spawnedAt),e.colonizationStartedAt!==void 0&&(t.colonization_started_at=e.colonizationStartedAt instanceof Date?e.colonizationStartedAt.toISOString():e.colonizationStartedAt),e.fruitingStartedAt!==void 0&&(t.fruiting_started_at=e.fruitingStartedAt instanceof Date?e.fruitingStartedAt.toISOString():e.fruitingStartedAt),e.completedAt!==void 0&&(t.completed_at=e.completedAt instanceof Date?e.completedAt.toISOString():e.completedAt),e.locationId!==void 0&&(t.location_id=e.locationId),e.targetTempColonization!==void 0&&(t.target_temp_colonization=e.targetTempColonization),e.targetTempFruiting!==void 0&&(t.target_temp_fruiting=e.targetTempFruiting),e.targetHumidity!==void 0&&(t.target_humidity=e.targetHumidity),e.totalYield!==void 0&&(t.total_yield=e.totalYield),e.estimatedCost!==void 0&&(t.estimated_cost=e.estimatedCost),e.notes!==void 0&&(t.notes=e.notes),t},vh=e=>({id:e.id,name:e.name,category:e.category,description:e.description||"",yield:{amount:e.yield_amount||500,unit:e.yield_unit||"ml"},prepTime:e.prep_time,sterilizationTime:e.sterilization_time,sterilizationPsi:e.sterilization_psi||15,ingredients:[],instructions:e.instructions||[],tips:e.tips||[],notes:e.notes,isActive:e.is_active??!0,createdAt:new Date(e.created_at),updatedAt:new Date(e.updated_at)}),yh=e=>{const t={};return e.name!==void 0&&(t.name=e.name),e.category!==void 0&&(t.category=e.category),e.description!==void 0&&(t.description=e.description),e.yield!==void 0&&(t.yield_amount=e.yield.amount,t.yield_unit=e.yield.unit),e.prepTime!==void 0&&(t.prep_time=e.prepTime),e.sterilizationTime!==void 0&&(t.sterilization_time=e.sterilizationTime),e.sterilizationPsi!==void 0&&(t.sterilization_psi=e.sterilizationPsi),e.instructions!==void 0&&(t.instructions=e.instructions),e.tips!==void 0&&(t.tips=e.tips),e.notes!==void 0&&(t.notes=e.notes),e.isActive!==void 0&&(t.is_active=e.isActive),t},bh=e=>({id:e.id,name:e.name,website:e.website,email:e.contact_email||e.email,phone:e.phone,notes:e.notes,isActive:e.is_active??!0}),wh=e=>({name:e.name,website:e.website,contact_email:e.email,phone:e.phone,notes:e.notes,is_active:e.isActive}),jh=e=>({id:e.id,flushNumber:e.flush_number,harvestDate:new Date(e.harvest_date),wetWeight:e.wet_weight,dryWeight:e.dry_weight,mushroomCount:e.mushroom_count,quality:e.quality||"good",notes:e.notes}),tw=(e,t)=>({grow_id:t,flush_number:e.flushNumber,harvest_date:e.harvestDate instanceof Date?e.harvestDate.toISOString():e.harvestDate,wet_weight:e.wetWeight,dry_weight:e.dryWeight,mushroom_count:e.mushroomCount,quality:e.quality,notes:e.notes}),ff=b.createContext(void 0),rw=({children:e})=>{const[t,s]=b.useState(ew),[n,i]=b.useState(!0),[a,o]=b.useState(!1),[l,d]=b.useState(null),[c,p]=b.useState(null),m=b.useCallback(async z=>{i(!0),d(null);try{const{data:E,error:I}=await z.from("species").select("*").order("name"),{data:W,error:ne}=await z.from("strains").select("*").order("name");if(ne)throw ne;const{data:ce,error:Ce}=await z.from("locations").select("*").order("name");if(Ce)throw Ce;const{data:Ir,error:_n}=await z.from("suppliers").select("*").order("name");if(_n)throw _n;const{data:ss,error:zd}=await z.from("cultures").select("*").order("created_at",{ascending:!1});if(zd)throw zd;const{data:gf,error:Ad}=await z.from("grows").select("*").order("created_at",{ascending:!1});if(Ad)throw Ad;const{data:xf,error:Ed}=await z.from("flushes").select("*").order("harvest_date",{ascending:!1});if(Ed)throw Ed;const{data:vf,error:Id}=await z.from("recipes").select("*").order("name");if(Id)throw Id;const yf=(E||[]).map(qt=>({id:qt.id,name:qt.name,scientificName:qt.scientific_name,category:qt.category||"gourmet",notes:qt.notes,isActive:qt.is_active??!0})),bf=(gf||[]).map(qt=>{const Ai=gh(qt);return Ai.flushes=(xf||[]).filter(Eo=>Eo.grow_id===qt.id).map(jh),Ai.totalYield=Ai.flushes.reduce((Eo,wf)=>Eo+(wf.wetWeight||0),0),Ai});s(qt=>({...qt,species:yf,strains:(W||[]).map(dh),locations:(ce||[]).map(hh),suppliers:(Ir||[]).map(bh),cultures:(ss||[]).map(ph),grows:bf,recipes:(vf||[]).map(vh)})),o(!0),localStorage.setItem("mycolab-last-sync",new Date().toISOString())}catch(E){console.error("Failed to load data from Supabase:",E),d(E.message||"Failed to load data"),o(!1)}finally{i(!1)}},[]);b.useEffect(()=>{const z=ch();z?(p(z),m(z)):(i(!1),o(!1))},[m]);const g=b.useCallback(async()=>{const z=ch();z&&(p(z),await m(z))},[m]),f=b.useCallback(z=>`${z}-${Date.now().toString(36)}-${Math.random().toString(36).substr(2,5)}`,[]),v=b.useCallback(z=>t.species.find(E=>E.id===z),[t.species]),j=b.useCallback(z=>t.strains.find(E=>E.id===z),[t.strains]),S=b.useCallback(z=>t.locations.find(E=>E.id===z),[t.locations]),u=b.useCallback(z=>t.vessels.find(E=>E.id===z),[t.vessels]),h=b.useCallback(z=>t.containerTypes.find(E=>E.id===z),[t.containerTypes]),x=b.useCallback(z=>t.substrateTypes.find(E=>E.id===z),[t.substrateTypes]),_=b.useCallback(z=>t.suppliers.find(E=>E.id===z),[t.suppliers]),N=b.useCallback(z=>t.inventoryCategories.find(E=>E.id===z),[t.inventoryCategories]),w=b.useCallback(z=>t.inventoryItems.find(E=>E.id===z),[t.inventoryItems]),C=b.useCallback(z=>t.cultures.find(E=>E.id===z),[t.cultures]),y=b.useCallback(z=>t.grows.find(E=>E.id===z),[t.grows]),L=b.useCallback(z=>t.recipes.find(E=>E.id===z),[t.recipes]),G=b.useMemo(()=>t.species.filter(z=>z.isActive),[t.species]),H=b.useMemo(()=>t.strains.filter(z=>z.isActive),[t.strains]),J=b.useMemo(()=>t.locations.filter(z=>z.isActive),[t.locations]),se=b.useMemo(()=>t.vessels.filter(z=>z.isActive),[t.vessels]),ge=b.useMemo(()=>t.containerTypes.filter(z=>z.isActive),[t.containerTypes]),k=b.useMemo(()=>t.substrateTypes.filter(z=>z.isActive),[t.substrateTypes]),M=b.useMemo(()=>t.suppliers.filter(z=>z.isActive),[t.suppliers]),oe=b.useMemo(()=>t.inventoryCategories.filter(z=>z.isActive),[t.inventoryCategories]),B=b.useMemo(()=>t.inventoryItems.filter(z=>z.isActive),[t.inventoryItems]),D=b.useMemo(()=>t.recipes.filter(z=>z.isActive),[t.recipes]),$=b.useCallback(async z=>{if(c){const{data:I,error:W}=await c.from("species").insert({name:z.name,scientific_name:z.scientificName,category:z.category,notes:z.notes,is_active:z.isActive??!0}).select().single();if(W)throw W;const ne={id:I.id,name:I.name,scientificName:I.scientific_name,category:I.category||"gourmet",notes:I.notes,isActive:I.is_active??!0};return s(ce=>({...ce,species:[...ce.species,ne]})),ne}const E={...z,id:f("species")};return s(I=>({...I,species:[...I.species,E]})),E},[c,f]),Y=b.useCallback(async(z,E)=>{if(c){const{error:I}=await c.from("species").update({name:E.name,scientific_name:E.scientificName,category:E.category,notes:E.notes,is_active:E.isActive}).eq("id",z);if(I)throw I}s(I=>({...I,species:I.species.map(W=>W.id===z?{...W,...E}:W)}))},[c]),le=b.useCallback(async z=>{if(c){const{error:E}=await c.from("species").update({is_active:!1}).eq("id",z);if(E)throw E}s(E=>({...E,species:E.species.map(I=>I.id===z?{...I,isActive:!1}:I)}))},[c]),Q=b.useCallback(async z=>{if(c){const{data:I,error:W}=await c.from("strains").insert(uh(z)).select().single();if(W)throw W;const ne=dh(I);return s(ce=>({...ce,strains:[...ce.strains,ne]})),ne}const E={...z,id:f("strain")};return s(I=>({...I,strains:[...I.strains,E]})),E},[c,f]),O=b.useCallback(async(z,E)=>{if(c){const{error:I}=await c.from("strains").update(uh(E)).eq("id",z);if(I)throw I}s(I=>({...I,strains:I.strains.map(W=>W.id===z?{...W,...E}:W)}))},[c]),U=b.useCallback(async z=>{if(c){const{error:E}=await c.from("strains").update({is_active:!1}).eq("id",z);if(E)throw E}s(E=>({...E,strains:E.strains.map(I=>I.id===z?{...I,isActive:!1}:I)}))},[c]),re=b.useCallback(async z=>{if(c){const{data:I,error:W}=await c.from("locations").insert(mh(z)).select().single();if(W)throw W;const ne=hh(I);return s(ce=>({...ce,locations:[...ce.locations,ne]})),ne}const E={...z,id:f("loc")};return s(I=>({...I,locations:[...I.locations,E]})),E},[c,f]),pe=b.useCallback(async(z,E)=>{if(c){const{error:I}=await c.from("locations").update(mh(E)).eq("id",z);if(I)throw I}s(I=>({...I,locations:I.locations.map(W=>W.id===z?{...W,...E}:W)}))},[c]),Be=b.useCallback(async z=>{if(c){const{error:E}=await c.from("locations").update({is_active:!1}).eq("id",z);if(E)throw E}s(E=>({...E,locations:E.locations.map(I=>I.id===z?{...I,isActive:!1}:I)}))},[c]),or=b.useCallback(async z=>{if(c){const{data:I,error:W}=await c.from("suppliers").insert(wh(z)).select().single();if(W)throw W;const ne=bh(I);return s(ce=>({...ce,suppliers:[...ce.suppliers,ne]})),ne}const E={...z,id:f("supp")};return s(I=>({...I,suppliers:[...I.suppliers,E]})),E},[c,f]),dt=b.useCallback(async(z,E)=>{if(c){const{error:I}=await c.from("suppliers").update(wh(E)).eq("id",z);if(I)throw I}s(I=>({...I,suppliers:I.suppliers.map(W=>W.id===z?{...W,...E}:W)}))},[c]),Vt=b.useCallback(async z=>{if(c){const{error:E}=await c.from("suppliers").update({is_active:!1}).eq("id",z);if(E)throw E}s(E=>({...E,suppliers:E.suppliers.map(I=>I.id===z?{...I,isActive:!1}:I)}))},[c]),Er=b.useCallback(async z=>{if(c){const{data:W,error:ne}=await c.from("cultures").insert(fh(z)).select().single();if(ne)throw ne;const ce=ph(W);return s(Ce=>({...Ce,cultures:[ce,...Ce.cultures]})),ce}const E=new Date,I={...z,id:f("cul"),createdAt:E,updatedAt:E,observations:[],transfers:[]};return s(W=>({...W,cultures:[I,...W.cultures]})),I},[c,f]),ee=b.useCallback(async(z,E)=>{if(c){const{error:I}=await c.from("cultures").update(fh(E)).eq("id",z);if(I)throw I}s(I=>({...I,cultures:I.cultures.map(W=>W.id===z?{...W,...E,updatedAt:new Date}:W)}))},[c]),R=b.useCallback(async z=>{if(c){const{error:E}=await c.from("cultures").delete().eq("id",z);if(E)throw E}s(E=>({...E,cultures:E.cultures.filter(I=>I.id!==z)}))},[c]),ue=b.useCallback(z=>{const I={spore_syringe:"SS",liquid_culture:"LC",agar:"AG",slant:"SL"}[z]||"CUL",W=t.cultures.filter(ce=>ce.type===z).length+1,ne=new Date().toISOString().slice(2,10).replace(/-/g,"");return`${I}-${ne}-${W.toString().padStart(3,"0")}`},[t.cultures]),lr=b.useCallback(z=>{const E=[],I=[];let W=t.cultures.find(ce=>ce.id===z);for(;W!=null&&W.parentId;){const ce=t.cultures.find(Ce=>Ce.id===W.parentId);if(ce)E.unshift(ce),W=ce;else break}const ne=ce=>{const Ce=t.cultures.filter(Ir=>Ir.parentId===ce);for(const Ir of Ce)I.push(Ir),ne(Ir.id)};return ne(z),{ancestors:E,descendants:I}},[t.cultures]),wt=b.useCallback((z,E)=>{const I={...E,id:f("obs")};s(W=>({...W,cultures:W.cultures.map(ne=>ne.id===z?{...ne,observations:[...ne.observations,I],updatedAt:new Date}:ne)}))},[f]),Dt=b.useCallback((z,E)=>null,[]),jt=b.useCallback(async z=>{if(c){const{data:I,error:W}=await c.from("grows").insert(xh(z)).select().single();if(W)throw W;const ne=gh(I);return s(ce=>({...ce,grows:[ne,...ce.grows]})),ne}const E={...z,id:f("grow"),createdAt:new Date,observations:[],flushes:[],totalYield:0};return s(I=>({...I,grows:[E,...I.grows]})),E},[c,f]),St=b.useCallback(async(z,E)=>{if(c){const{error:I}=await c.from("grows").update(xh(E)).eq("id",z);if(I)throw I}s(I=>({...I,grows:I.grows.map(W=>W.id===z?{...W,...E}:W)}))},[c]),We=b.useCallback(async z=>{if(c){const{error:E}=await c.from("grows").delete().eq("id",z);if(E)throw E}s(E=>({...E,grows:E.grows.filter(I=>I.id!==z)}))},[c]),ut=["spawning","colonization","fruiting","harvesting","completed"],_e=b.useCallback(async z=>{const E=t.grows.find(ce=>ce.id===z);if(!E||E.currentStage==="completed"||E.currentStage==="contaminated"||E.currentStage==="aborted")return;const I=ut.indexOf(E.currentStage);if(I===-1||I>=ut.length-1)return;const W=ut[I+1],ne={currentStage:W};W==="colonization"&&(ne.colonizationStartedAt=new Date),W==="fruiting"&&(ne.fruitingStartedAt=new Date),W==="completed"&&(ne.completedAt=new Date,ne.status="completed"),await St(z,ne)},[t.grows,St]),Oe=b.useCallback(async(z,E)=>{await St(z,{currentStage:"contaminated",status:"failed",notes:E})},[St]),Gt=b.useCallback((z,E)=>{const I={...E,id:f("gobs")};s(W=>({...W,grows:W.grows.map(ne=>ne.id===z?{...ne,observations:[...ne.observations,I]}:ne)}))},[f]),T=b.useCallback(async(z,E)=>{const I=t.grows.find(ce=>ce.id===z);if(!I)return;const W=I.flushes.length+1;if(c){const{data:ce,error:Ce}=await c.from("flushes").insert(tw({...E,flushNumber:W},z)).select().single();if(Ce)throw Ce;const Ir=jh(ce);s(_n=>({..._n,grows:_n.grows.map(ss=>ss.id===z?{...ss,flushes:[...ss.flushes,Ir],totalYield:ss.totalYield+E.wetWeight}:ss)}));return}const ne={...E,id:f("flush"),flushNumber:W};s(ce=>({...ce,grows:ce.grows.map(Ce=>Ce.id===z?{...Ce,flushes:[...Ce.flushes,ne],totalYield:Ce.totalYield+E.wetWeight}:Ce)}))},[c,t.grows,f]),V=b.useCallback(async z=>{if(c){const{data:W,error:ne}=await c.from("recipes").insert(yh(z)).select().single();if(ne)throw ne;const ce=vh(W);return ce.ingredients=z.ingredients||[],s(Ce=>({...Ce,recipes:[...Ce.recipes,ce]})),ce}const E=new Date,I={...z,id:f("rec"),createdAt:E,updatedAt:E};return s(W=>({...W,recipes:[...W.recipes,I]})),I},[c,f]),xe=b.useCallback(async(z,E)=>{if(c){const{error:I}=await c.from("recipes").update(yh(E)).eq("id",z);if(I)throw I}s(I=>({...I,recipes:I.recipes.map(W=>W.id===z?{...W,...E,updatedAt:new Date}:W)}))},[c]),He=b.useCallback(async z=>{if(c){const{error:E}=await c.from("recipes").update({is_active:!1}).eq("id",z);if(E)throw E}s(E=>({...E,recipes:E.recipes.map(I=>I.id===z?{...I,isActive:!1}:I)}))},[c]),vr=b.useCallback(z=>z.ingredients.reduce((E,I)=>{const W=t.inventoryItems.find(ne=>ne.id===I.inventoryItemId);return W?E+W.unitCost*I.quantity:E},0),[t.inventoryItems]),Nt=b.useCallback((z,E)=>({...z,yield:{...z.yield,amount:z.yield.amount*E},ingredients:z.ingredients.map(I=>({...I,quantity:I.quantity*E}))}),[]),zs=b.useCallback(z=>{const E={...z,id:f("vessel")};return s(I=>({...I,vessels:[...I.vessels,E]})),E},[f]),As=b.useCallback((z,E)=>{s(I=>({...I,vessels:I.vessels.map(W=>W.id===z?{...W,...E}:W)}))},[]),P=b.useCallback(z=>{s(E=>({...E,vessels:E.vessels.map(I=>I.id===z?{...I,isActive:!1}:I)}))},[]),ie=b.useCallback(z=>{const E={...z,id:f("ct")};return s(I=>({...I,containerTypes:[...I.containerTypes,E]})),E},[f]),he=b.useCallback((z,E)=>{s(I=>({...I,containerTypes:I.containerTypes.map(W=>W.id===z?{...W,...E}:W)}))},[]),K=b.useCallback(z=>{s(E=>({...E,containerTypes:E.containerTypes.map(I=>I.id===z?{...I,isActive:!1}:I)}))},[]),De=b.useCallback(z=>{const E={...z,id:f("st")};return s(I=>({...I,substrateTypes:[...I.substrateTypes,E]})),E},[f]),st=b.useCallback((z,E)=>{s(I=>({...I,substrateTypes:I.substrateTypes.map(W=>W.id===z?{...W,...E}:W)}))},[]),ht=b.useCallback(z=>{s(E=>({...E,substrateTypes:E.substrateTypes.map(I=>I.id===z?{...I,isActive:!1}:I)}))},[]),A=b.useCallback(z=>{const E={...z,id:f("cat")};return s(I=>({...I,inventoryCategories:[...I.inventoryCategories,E]})),E},[f]),F=b.useCallback((z,E)=>{s(I=>({...I,inventoryCategories:I.inventoryCategories.map(W=>W.id===z?{...W,...E}:W)}))},[]),de=b.useCallback(z=>{s(E=>({...E,inventoryCategories:E.inventoryCategories.map(I=>I.id===z?{...I,isActive:!1}:I)}))},[]),Re=b.useCallback(z=>{const E=new Date,I={...z,id:f("inv"),createdAt:E,updatedAt:E};return s(W=>({...W,inventoryItems:[...W.inventoryItems,I]})),I},[f]),kt=b.useCallback((z,E)=>{s(I=>({...I,inventoryItems:I.inventoryItems.map(W=>W.id===z?{...W,...E,updatedAt:new Date}:W)}))},[]),_t=b.useCallback(z=>{s(E=>({...E,inventoryItems:E.inventoryItems.map(I=>I.id===z?{...I,isActive:!1}:I)}))},[]),nt=b.useCallback((z,E)=>{s(I=>({...I,inventoryItems:I.inventoryItems.map(W=>W.id===z?{...W,quantity:Math.max(0,W.quantity+E),updatedAt:new Date}:W)}))},[]),Rt=b.useCallback(z=>{s(E=>({...E,settings:{...E.settings,...z}}))},[]),mt=b.useMemo(()=>({state:t,isLoading:n,isConnected:a,error:l,getSpecies:v,getStrain:j,getLocation:S,getVessel:u,getContainerType:h,getSubstrateType:x,getSupplier:_,getInventoryCategory:N,getInventoryItem:w,getCulture:C,getGrow:y,getRecipe:L,activeSpecies:G,activeStrains:H,activeLocations:J,activeVessels:se,activeContainerTypes:ge,activeSubstrateTypes:k,activeSuppliers:M,activeInventoryCategories:oe,activeInventoryItems:B,activeRecipes:D,addSpecies:$,updateSpecies:Y,deleteSpecies:le,addStrain:Q,updateStrain:O,deleteStrain:U,addLocation:re,updateLocation:pe,deleteLocation:Be,addVessel:zs,updateVessel:As,deleteVessel:P,addContainerType:ie,updateContainerType:he,deleteContainerType:K,addSubstrateType:De,updateSubstrateType:st,deleteSubstrateType:ht,addSupplier:or,updateSupplier:dt,deleteSupplier:Vt,addInventoryCategory:A,updateInventoryCategory:F,deleteInventoryCategory:de,addInventoryItem:Re,updateInventoryItem:kt,deleteInventoryItem:_t,adjustInventoryQuantity:nt,addCulture:Er,updateCulture:ee,deleteCulture:R,addCultureObservation:wt,addCultureTransfer:Dt,getCultureLineage:lr,generateCultureLabel:ue,addGrow:jt,updateGrow:St,deleteGrow:We,advanceGrowStage:_e,markGrowContaminated:Oe,addGrowObservation:Gt,addFlush:T,addRecipe:V,updateRecipe:xe,deleteRecipe:He,calculateRecipeCost:vr,scaleRecipe:Nt,updateSettings:Rt,generateId:f,refreshData:g}),[t,n,a,l,v,j,S,u,h,x,_,N,w,C,y,L,G,H,J,se,ge,k,M,oe,B,D,$,Y,le,Q,O,U,re,pe,Be,zs,As,P,ie,he,K,De,st,ht,or,dt,Vt,A,F,de,Re,kt,_t,nt,Er,ee,R,wt,Dt,lr,ue,jt,St,We,_e,Oe,Gt,T,V,xe,He,vr,Nt,Rt,f,g]);return r.jsx(ff.Provider,{value:mt,children:e})},ar=()=>{const e=b.useContext(ff);if(!e)throw new Error("useData must be used within a DataProvider");return e},sw={critical:100,high:75,medium:50,low:25,nice_to_have:10},nw={completed:{bg:"bg-emerald-500/10",text:"text-emerald-400",border:"border-emerald-500/30"},in_progress:{bg:"bg-blue-500/10",text:"text-blue-400",border:"border-blue-500/30"},testing:{bg:"bg-purple-500/10",text:"text-purple-400",border:"border-purple-500/30"},planned:{bg:"bg-amber-500/10",text:"text-amber-400",border:"border-amber-500/30"},backlog:{bg:"bg-zinc-500/10",text:"text-zinc-400",border:"border-zinc-500/30"},blocked:{bg:"bg-red-500/10",text:"text-red-400",border:"border-red-500/30"},cancelled:{bg:"bg-zinc-700/10",text:"text-zinc-500",border:"border-zinc-700/30"}},iw={critical:"text-red-400",high:"text-orange-400",medium:"text-yellow-400",low:"text-zinc-400",nice_to_have:"text-zinc-500"},aw={core:"",ui:"",data:"",integration:"",optimization:"",bug_fix:"",enhancement:""},it={Rocket:()=>r.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.59 14.37a6 6 0 01-5.84 7.38v-4.8m5.84-2.58a14.98 14.98 0 006.16-12.12A14.98 14.98 0 009.631 8.41m5.96 5.96a14.926 14.926 0 01-5.841 2.58m-.119-8.54a6 6 0 00-7.381 5.84h4.8m2.581-5.84a14.927 14.927 0 00-2.58 5.84m2.699 2.7c-.103.021-.207.041-.311.06a15.09 15.09 0 01-2.448-2.448 14.9 14.9 0 01.06-.312m-2.24 2.39a4.493 4.493 0 00-1.757 4.306 4.493 4.493 0 004.306-1.758M16.5 9a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0z"})}),Clock:()=>r.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),Check:()=>r.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),Lock:()=>r.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),Play:()=>r.jsxs("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]}),Flag:()=>r.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 21v-4m0 0V5a2 2 0 012-2h6.5l1 1H21l-3 6 3 6h-8.5l-1-1H5a2 2 0 00-2 2zm9-13.5V9"})}),ChevronRight:()=>r.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),ChevronDown:()=>r.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),Plus:()=>r.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),Target:()=>r.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),Zap:()=>r.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})};function ow(e){const t=e.match(/dev-(\d)/);if(!t)return"misc";const s=parseInt(t[1]);return{0:"Foundation",1:"Tracking",2:"Library",3:"Mapping",4:"Operations",5:"Recipes",6:"Photos",7:"Inventory",8:"Analytics",9:"QR/Labels"}[s]||`Phase ${s}`}function lw(e){const t=new Set(e.filter(s=>s.status==="completed").map(s=>s.id));return e.map(s=>{const n=[];if(s.dependencies){for(const o of s.dependencies)if(!t.has(o)){const l=e.find(d=>d.id===o);n.push((l==null?void 0:l.title)||o)}}const i=n.length===0&&s.status!=="completed"&&s.status!=="cancelled",a=sw[s.priority]+(s.status==="in_progress"?50:0)+(s.status==="planned"?10:0);return{...s,isReady:i,blockedByList:n,priorityScore:a,phase:ow(s.id)}})}const ra=({feature:e,onUpdateStatus:t,isRecommended:s,showPhase:n})=>{const[i,a]=b.useState(!1);return r.jsx("div",{className:`bg-zinc-900/50 border rounded-xl p-4 transition-all hover:border-zinc-600 ${s?"ring-2 ring-emerald-500/50 border-emerald-500/50":nw[e.status].border}`,children:r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx("div",{className:`mt-1 w-2 h-2 rounded-full flex-shrink-0 ${e.status==="completed"?"bg-emerald-400":e.status==="in_progress"?"bg-blue-400":e.isReady?"bg-amber-400":"bg-zinc-600"}`}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[r.jsx("span",{className:"text-xs text-zinc-500 font-mono",children:e.id}),n&&r.jsx("span",{className:"text-xs px-1.5 py-0.5 bg-zinc-800 rounded text-zinc-400",children:e.phase}),r.jsx("span",{className:`text-xs font-medium ${iw[e.priority]}`,children:e.priority}),s&&r.jsx("span",{className:"text-xs px-2 py-0.5 bg-emerald-500/20 text-emerald-400 rounded-full font-medium",children:" Recommended"})]}),r.jsx("h4",{className:"font-medium text-white mt-1",children:e.title}),e.description&&r.jsx("p",{className:"text-sm text-zinc-400 mt-1 line-clamp-2",children:e.description}),r.jsxs("div",{className:"flex items-center gap-3 mt-2 flex-wrap",children:[r.jsxs("span",{className:"text-xs px-2 py-0.5 bg-zinc-800 rounded flex items-center gap-1",children:[aw[e.category]||""," ",e.category]}),e.estimatedHours&&r.jsxs("span",{className:"text-xs text-zinc-500 flex items-center gap-1",children:[r.jsx(it.Clock,{})," ",e.estimatedHours,"h"]}),e.blockedByList.length>0&&r.jsxs("span",{className:"text-xs text-red-400 flex items-center gap-1",children:[r.jsx(it.Lock,{})," Blocked by ",e.blockedByList.length]})]}),i&&r.jsxs("div",{className:"mt-3 pt-3 border-t border-zinc-800 space-y-2",children:[e.notes&&r.jsx("p",{className:"text-sm text-zinc-300",children:e.notes}),e.blockedByList.length>0&&r.jsxs("div",{className:"text-sm",children:[r.jsx("span",{className:"text-red-400",children:"Blocked by:"}),r.jsx("ul",{className:"list-disc list-inside text-zinc-400 ml-2",children:e.blockedByList.map((o,l)=>r.jsx("li",{children:o},l))})]}),e.actualHours&&r.jsxs("p",{className:"text-xs text-zinc-500",children:["Actual: ",e.actualHours,"h (estimated ",e.estimatedHours,"h)"]})]})]}),r.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[r.jsx("button",{onClick:()=>a(!i),className:"p-1 text-zinc-500 hover:text-white transition-colors",children:i?r.jsx(it.ChevronDown,{}):r.jsx(it.ChevronRight,{})}),e.status!=="completed"&&e.status!=="cancelled"&&r.jsxs("select",{value:e.status,onChange:o=>t(e.id,o.target.value),className:"bg-zinc-800 border border-zinc-700 text-white text-xs rounded px-2 py-1 focus:outline-none focus:border-emerald-500",children:[r.jsx("option",{value:"backlog",children:"Backlog"}),r.jsx("option",{value:"planned",children:"Planned"}),r.jsx("option",{value:"in_progress",children:"In Progress"}),r.jsx("option",{value:"testing",children:"Testing"}),r.jsx("option",{value:"completed",children:"Completed"}),r.jsx("option",{value:"blocked",children:"Blocked"})]}),e.status==="completed"&&r.jsx("span",{className:"text-emerald-400",children:r.jsx(it.Check,{})})]})]})})},Rn=({icon:e,label:t,value:s,subValue:n,color:i="text-white"})=>r.jsx("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-4",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:`${i}`,children:e}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-zinc-500 uppercase tracking-wide",children:t}),r.jsx("p",{className:`text-xl font-bold ${i}`,children:s}),n&&r.jsx("p",{className:"text-xs text-zinc-500",children:n})]})]})}),cw=({features:e,onUpdateStatus:t,onAddFeature:s})=>{const[n,i]=b.useState("roadmap"),[a,o]=b.useState("all"),[l,d]=b.useState(new Set(["Foundation","Tracking"])),c=b.useMemo(()=>lw(e),[e]),p=b.useMemo(()=>{const w=c.filter(H=>H.status==="completed"),C=c.filter(H=>H.status==="in_progress"),y=c.filter(H=>H.isReady&&H.status!=="in_progress"),L=c.filter(H=>H.blockedByList.length>0&&H.status!=="completed"),G=c.filter(H=>H.status==="planned");return{total:c.length,completed:w.length,inProgress:C.length,ready:y.length,blocked:L.length,planned:G.length,percentComplete:Math.round(w.length/c.length*100)}},[c]),m=b.useMemo(()=>c.filter(w=>w.isReady&&w.status!=="in_progress").sort((w,C)=>C.priorityScore-w.priorityScore).slice(0,5),[c]),g=b.useMemo(()=>c.filter(w=>w.status==="in_progress"),[c]),f=b.useMemo(()=>{const w={};for(const y of c)w[y.phase]||(w[y.phase]=[]),w[y.phase].push(y);const C=["Foundation","Tracking","Library","Mapping","Operations","Recipes","Photos","Inventory","Analytics","QR/Labels"];return Object.entries(w).sort((y,L)=>{const G=C.indexOf(y[0]),H=C.indexOf(L[0]);return(G===-1?99:G)-(H===-1?99:H)})},[c]),v=b.useMemo(()=>{let w=c;return n==="ready"?w=w.filter(C=>C.isReady&&C.status!=="in_progress"):n==="blocked"&&(w=w.filter(C=>C.blockedByList.length>0&&C.status!=="completed")),a!=="all"&&(w=w.filter(C=>C.category===a)),w.sort((C,y)=>y.priorityScore-C.priorityScore)},[c,n,a]),j=w=>{d(C=>{const y=new Set(C);return y.has(w)?y.delete(w):y.add(w),y})},[S,u]=b.useState(!1),[h,x]=b.useState({title:"",description:"",category:"enhancement",priority:"medium"}),_=[...new Set(c.map(w=>w.category))],N=()=>{h.title.trim()&&(s({...h,status:"planned",estimatedHours:0}),x({title:"",description:"",category:"enhancement",priority:"medium"}),u(!1))};return r.jsxs("div",{className:"p-6 space-y-6 max-w-7xl mx-auto",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-white",children:"Dev Roadmap"}),r.jsx("p",{className:"text-zinc-400",children:"Self-governing feature tracker with intelligent prioritization"})]}),r.jsxs("button",{onClick:()=>u(!0),className:"flex items-center gap-2 px-4 py-2 bg-emerald-500 hover:bg-emerald-600 text-white rounded-lg text-sm font-medium transition-colors",children:[r.jsx(it.Plus,{}),"Add Feature"]})]}),r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4",children:[r.jsx(Rn,{icon:r.jsx(it.Target,{}),label:"Progress",value:`${p.percentComplete}%`,subValue:`${p.completed}/${p.total} features`,color:"text-emerald-400"}),r.jsx(Rn,{icon:r.jsx(it.Play,{}),label:"In Progress",value:p.inProgress,color:"text-blue-400"}),r.jsx(Rn,{icon:r.jsx(it.Zap,{}),label:"Ready to Start",value:p.ready,subValue:"Dependencies met",color:"text-amber-400"}),r.jsx(Rn,{icon:r.jsx(it.Flag,{}),label:"Planned",value:p.planned,color:"text-purple-400"}),r.jsx(Rn,{icon:r.jsx(it.Lock,{}),label:"Blocked",value:p.blocked,color:"text-red-400"})]}),g.length>0&&r.jsxs("div",{className:"bg-gradient-to-r from-blue-950/50 to-indigo-950/50 border border-blue-800/30 rounded-xl p-5",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[r.jsx(it.Play,{}),r.jsx("h2",{className:"font-semibold text-blue-400",children:"Currently In Progress"})]}),r.jsx("div",{className:"space-y-3",children:g.map(w=>r.jsx(ra,{feature:w,onUpdateStatus:t},w.id))})]}),r.jsxs("div",{className:"bg-gradient-to-r from-emerald-950/50 to-teal-950/50 border border-emerald-800/30 rounded-xl p-5",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[r.jsx(it.Rocket,{}),r.jsx("h2",{className:"font-semibold text-emerald-400",children:"Work on Next"})]}),r.jsx("p",{className:"text-sm text-zinc-400 mb-4",children:"Top priority items with all dependencies satisfied, ready to start immediately."}),m.length>0?r.jsx("div",{className:"space-y-3",children:m.map((w,C)=>r.jsx(ra,{feature:w,onUpdateStatus:t,isRecommended:C===0},w.id))}):r.jsx("p",{className:"text-zinc-500 italic",children:"All ready items are in progress. Complete current work to unlock more features."})]}),r.jsxs("div",{className:"flex items-center gap-2 border-b border-zinc-800 pb-2",children:[[{id:"roadmap",label:"Roadmap",count:null},{id:"all",label:"All Features",count:p.total},{id:"ready",label:"Ready",count:p.ready},{id:"blocked",label:"Blocked",count:p.blocked}].map(w=>r.jsxs("button",{onClick:()=>i(w.id),className:`px-4 py-2 text-sm font-medium transition-colors rounded-t-lg ${n===w.id?"text-emerald-400 border-b-2 border-emerald-400 -mb-[2px]":"text-zinc-400 hover:text-white"}`,children:[w.label," ",w.count!==null&&r.jsxs("span",{className:"text-zinc-500",children:["(",w.count,")"]})]},w.id)),n!=="roadmap"&&r.jsx("div",{className:"ml-auto",children:r.jsxs("select",{value:a,onChange:w=>o(w.target.value),className:"bg-zinc-800 border border-zinc-700 text-white text-sm rounded px-3 py-1.5",children:[r.jsx("option",{value:"all",children:"All Categories"}),_.map(w=>r.jsx("option",{value:w,children:w},w))]})})]}),n==="roadmap"?r.jsx("div",{className:"space-y-4",children:f.map(([w,C])=>{const y=C.filter(H=>H.status==="completed").length,L=Math.round(y/C.length*100),G=l.has(w);return r.jsxs("div",{className:"bg-zinc-900/30 border border-zinc-800 rounded-xl overflow-hidden",children:[r.jsxs("button",{onClick:()=>j(w),className:"w-full flex items-center justify-between p-4 hover:bg-zinc-800/30 transition-colors",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[G?r.jsx(it.ChevronDown,{}):r.jsx(it.ChevronRight,{}),r.jsx("h3",{className:"font-semibold text-white",children:w}),r.jsxs("span",{className:"text-sm text-zinc-500",children:[y,"/",C.length," complete"]})]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-32 h-2 bg-zinc-800 rounded-full overflow-hidden",children:r.jsx("div",{className:"h-full bg-emerald-500 rounded-full transition-all",style:{width:`${L}%`}})}),r.jsxs("span",{className:"text-sm text-zinc-400 w-10",children:[L,"%"]})]})]}),G&&r.jsx("div",{className:"p-4 pt-0 space-y-2",children:C.sort((H,J)=>J.priorityScore-H.priorityScore).map(H=>r.jsx(ra,{feature:H,onUpdateStatus:t},H.id))})]},w)})}):r.jsxs("div",{className:"space-y-3",children:[v.map(w=>r.jsx(ra,{feature:w,onUpdateStatus:t,showPhase:!0},w.id)),v.length===0&&r.jsx("p",{className:"text-center text-zinc-500 py-8",children:"No features match the current filters."})]}),r.jsxs("div",{className:"bg-zinc-900/30 border border-zinc-800 rounded-xl p-5",children:[r.jsx("h3",{className:"font-semibold text-white mb-3",children:"Priority Legend"}),r.jsxs("div",{className:"flex flex-wrap gap-4 text-sm",children:[r.jsxs("span",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-red-400",children:""})," Critical - Must have for MVP"]}),r.jsxs("span",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-orange-400",children:""})," High - Important for v1.0"]}),r.jsxs("span",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-yellow-400",children:""})," Medium - Should have"]}),r.jsxs("span",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-zinc-400",children:""})," Low - Nice to have"]})]}),r.jsxs("div",{className:"flex flex-wrap gap-4 text-sm mt-3 pt-3 border-t border-zinc-800",children:[r.jsxs("span",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"w-2 h-2 rounded-full bg-emerald-400"})," Completed"]}),r.jsxs("span",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"w-2 h-2 rounded-full bg-blue-400"})," In Progress"]}),r.jsxs("span",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"w-2 h-2 rounded-full bg-amber-400"})," Ready to Start"]}),r.jsxs("span",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"w-2 h-2 rounded-full bg-zinc-600"})," Blocked/Waiting"]})]})]}),S&&r.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-zinc-900 border border-zinc-700 rounded-xl p-6 w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[r.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Add New Feature"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-1",children:"Title *"}),r.jsx("input",{type:"text",value:h.title,onChange:w=>x({...h,title:w.target.value}),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-emerald-500",placeholder:"Feature title..."})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-1",children:"Description"}),r.jsx("textarea",{value:h.description,onChange:w=>x({...h,description:w.target.value}),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-emerald-500 h-24 resize-none",placeholder:"Feature description..."})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-1",children:"Category"}),r.jsxs("select",{value:h.category,onChange:w=>x({...h,category:w.target.value}),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-emerald-500",children:[r.jsx("option",{value:"core",children:"Core"}),r.jsx("option",{value:"ui",children:"UI"}),r.jsx("option",{value:"data",children:"Data"}),r.jsx("option",{value:"integration",children:"Integration"}),r.jsx("option",{value:"optimization",children:"Optimization"}),r.jsx("option",{value:"bug_fix",children:"Bug Fix"}),r.jsx("option",{value:"enhancement",children:"Enhancement"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-1",children:"Priority"}),r.jsxs("select",{value:h.priority,onChange:w=>x({...h,priority:w.target.value}),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-emerald-500",children:[r.jsx("option",{value:"critical",children:"Critical"}),r.jsx("option",{value:"high",children:"High"}),r.jsx("option",{value:"medium",children:"Medium"}),r.jsx("option",{value:"low",children:"Low"}),r.jsx("option",{value:"nice_to_have",children:"Nice to Have"})]})]})]})]}),r.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[r.jsx("button",{onClick:()=>u(!1),className:"px-4 py-2 text-zinc-400 hover:text-white transition-colors",children:"Cancel"}),r.jsx("button",{onClick:N,disabled:!h.title.trim(),className:"px-4 py-2 bg-emerald-500 hover:bg-emerald-600 disabled:bg-zinc-700 disabled:text-zinc-500 text-white rounded-lg font-medium transition-colors",children:"Add Feature"})]})]})})]})},dw={theme:"dark",defaultCultureLabelPrefix:"CUL",defaultGrowLabelPrefix:"GRW",temperatureUnit:"fahrenheit",currencyCode:"USD",dateFormat:"MM/dd/yyyy",notificationsEnabled:!0,emailNotifications:!1},uw=[{id:"strain-001",name:"B+",species:"Psilocybe cubensis",commonName:"B Plus",characteristics:"Reliable, forgiving, good for beginners. Large fruiting bodies.",avgColonizationDays:14,avgFruitingDays:7,difficulty:"beginner",category:"research",color:"#8B5CF6",sortOrder:1,isActive:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"strain-002",name:"Penis Envy",species:"Psilocybe cubensis",commonName:"PE",characteristics:"Slower colonization, dense fruits, requires more attention.",avgColonizationDays:21,avgFruitingDays:10,difficulty:"advanced",category:"research",color:"#EC4899",sortOrder:2,isActive:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"strain-003",name:"Jedi Mind Fuck",species:"Psilocybe cubensis",commonName:"JMF",characteristics:"Aggressive colonizer, unique appearance.",avgColonizationDays:12,avgFruitingDays:7,difficulty:"intermediate",category:"research",color:"#10B981",sortOrder:3,isActive:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"strain-004",name:"Blue Oyster",species:"Pleurotus ostreatus",commonName:"Blue Oyster Mushroom",characteristics:"Fast colonizer, fruits in wide temperature range, beautiful blue color.",avgColonizationDays:10,avgFruitingDays:5,difficulty:"beginner",category:"gourmet",color:"#3B82F6",sortOrder:4,isActive:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"strain-005",name:"Enoki",species:"Flammulina velutipes",commonName:"Enokitake",characteristics:"Cold-loving, requires lower temperatures for fruiting.",avgColonizationDays:14,avgFruitingDays:14,difficulty:"intermediate",category:"gourmet",color:"#F59E0B",sortOrder:5,isActive:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}],hw=[{id:"vendor-001",name:"SporeWorks",website:"https://sporeworks.com",notes:"Reliable spore supplier",rating:5,tags:["spores","syringes"],sortOrder:1,isActive:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"vendor-002",name:"Midwest Grow Kits",website:"https://midwestgrowkits.com",notes:"Good for supplies and substrates",rating:4,tags:["supplies","substrates","equipment"],sortOrder:2,isActive:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"vendor-003",name:"Amazon",website:"https://amazon.com",notes:"General supplies",rating:4,tags:["general","fast shipping"],sortOrder:3,isActive:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}],mw=[{id:"loc-001",name:"Main Lab Fridge",locationType:"refrigerator",temperatureRange:{min:2,max:4},capacity:50,currentOccupancy:12,sortOrder:1,isActive:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"loc-002",name:"Incubation Chamber",locationType:"incubator",temperatureRange:{min:24,max:27},humidityRange:{min:70,max:80},capacity:20,currentOccupancy:8,sortOrder:2,isActive:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"loc-003",name:"Fruiting Chamber",locationType:"fruiting_chamber",temperatureRange:{min:20,max:24},humidityRange:{min:85,max:95},capacity:10,currentOccupancy:3,sortOrder:3,isActive:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"loc-004",name:"Storage Shelf A",locationType:"storage",sortOrder:4,isActive:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"loc-005",name:"Upstairs Closet",locationType:"storage",description:"Temperature controlled closet for slow colonization",sortOrder:5,isActive:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}],pw=[{id:"vessel-001",name:"Quart Mason Jar",vesselCategory:"jar",volumeMl:946,material:"Glass",reusable:!0,sterile:!1,unitCost:150,sortOrder:1,isActive:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"vessel-002",name:"Pint Mason Jar",vesselCategory:"jar",volumeMl:473,material:"Glass",reusable:!0,sterile:!1,unitCost:125,sortOrder:2,isActive:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"vessel-003",name:"100mm Petri Dish",vesselCategory:"plate",volumeMl:50,material:"Plastic",reusable:!1,sterile:!0,unitCost:35,sortOrder:3,isActive:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"vessel-004",name:"3lb Spawn Bag",vesselCategory:"bag",volumeMl:3e3,material:"Polypropylene",reusable:!1,sterile:!1,unitCost:75,sortOrder:4,isActive:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"vessel-005",name:"LC Bottle 250ml",vesselCategory:"bottle",volumeMl:250,material:"Borosilicate Glass",reusable:!0,sterile:!1,unitCost:500,sortOrder:5,isActive:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}],fw=[{id:"ing-001",name:"Light Malt Extract",ingredientCategory:"liquid_culture",unit:"g",costPerUnit:2,shelfLifeDays:365,inStock:!0,currentQuantity:500,reorderThreshold:100,sortOrder:1,isActive:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"ing-002",name:"Raw Honey",ingredientCategory:"liquid_culture",unit:"g",costPerUnit:3,shelfLifeDays:730,inStock:!0,currentQuantity:1e3,reorderThreshold:200,sortOrder:2,isActive:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"ing-003",name:"Agar Powder",ingredientCategory:"agar",unit:"g",costPerUnit:5,shelfLifeDays:365,inStock:!0,currentQuantity:250,reorderThreshold:50,sortOrder:3,isActive:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"ing-004",name:"Whole Oats",ingredientCategory:"grain",unit:"kg",costPerUnit:150,shelfLifeDays:180,inStock:!0,currentQuantity:10,reorderThreshold:2,sortOrder:4,isActive:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"ing-005",name:"Popcorn Kernels",ingredientCategory:"grain",unit:"kg",costPerUnit:200,shelfLifeDays:365,inStock:!0,currentQuantity:5,reorderThreshold:1,sortOrder:5,isActive:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"ing-006",name:"Coco Coir",ingredientCategory:"substrate",unit:"kg",costPerUnit:100,shelfLifeDays:730,inStock:!0,currentQuantity:8,reorderThreshold:2,sortOrder:6,isActive:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"ing-007",name:"Vermiculite",ingredientCategory:"substrate",unit:"l",costPerUnit:50,shelfLifeDays:9999,inStock:!0,currentQuantity:20,reorderThreshold:5,sortOrder:7,isActive:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"ing-008",name:"Gypsum",ingredientCategory:"supplement",unit:"g",costPerUnit:1,shelfLifeDays:9999,inStock:!0,currentQuantity:2e3,reorderThreshold:500,sortOrder:8,isActive:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}],gw=[{id:"dev-001",title:"Project Setup & Architecture",description:"Initial React/TypeScript setup with comprehensive type definitions",category:"core",status:"completed",priority:"critical",estimatedHours:4,actualHours:4,completedAt:new Date().toISOString(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-002",title:"Type System Design",description:"Complete TypeScript interfaces for all data entities including lookups, cultures, grows, inventory, and notifications",category:"data",status:"completed",priority:"critical",estimatedHours:6,actualHours:6,completedAt:new Date().toISOString(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-003",title:"Interactive Dev Log Component",description:"Feature tracking system with status updates, filtering, and progress visualization",category:"ui",status:"completed",priority:"high",estimatedHours:3,actualHours:3,completedAt:new Date().toISOString(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-004",title:"App Shell & Navigation",description:"Main layout with sidebar navigation and responsive design",category:"ui",status:"completed",priority:"critical",estimatedHours:4,actualHours:4,completedAt:new Date().toISOString(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-005",title:"Dashboard Overview",description:"Main dashboard with stats, active grows, recent activity, and notifications",category:"ui",status:"completed",priority:"high",estimatedHours:5,actualHours:5,completedAt:new Date().toISOString(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-010",title:"Unified Item View (Master Inventory)",description:"Single view showing ALL items: spores, cultures (LC/agar/slants), spawn, bulk containers, with filtering and drill-down to any detail level. Project cards for each item.",category:"core",status:"completed",priority:"critical",estimatedHours:16,actualHours:14,completedAt:new Date().toISOString(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-011",title:"Culture Management (CRUD)",description:"Full create/read/update/delete for cultures with status tracking, health ratings, and contamination logging",category:"core",status:"completed",priority:"critical",estimatedHours:10,actualHours:12,completedAt:new Date().toISOString(),dependencies:["dev-010"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-012",title:"Grow/Block Tracking System",description:"Individual tracking for each jar/bag/block/tub: inoculation date, location changes, colonization progress, harvest logs, disposal. Full lifecycle from spawn to disposal.",category:"core",status:"completed",priority:"critical",estimatedHours:20,actualHours:18,completedAt:new Date().toISOString(),dependencies:["dev-011"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-013",title:"Stage Progression Engine",description:"Track 7-stage grows (spawning  colonization  fruiting  harvesting  completed/contaminated/aborted) with configurable factors",category:"core",status:"completed",priority:"critical",estimatedHours:12,actualHours:10,completedAt:new Date().toISOString(),dependencies:["dev-012"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-014",title:"Lineage & Genetics Tracking",description:"Track parent cultures, crosses, generations, family trees. Know which strain came from which source, support same strain from multiple vendors.",category:"core",status:"completed",priority:"high",estimatedHours:10,actualHours:8,completedAt:new Date().toISOString(),dependencies:["dev-011"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-015",title:"Lineage Visualization",description:"Interactive family tree/network graph showing culture lineages, genetic relationships, and source tracking",category:"ui",status:"completed",priority:"high",estimatedHours:14,actualHours:12,completedAt:new Date().toISOString(),dependencies:["dev-014"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-020",title:"Strain Library",description:"Document and organize all strains/species with growth difficulty ratings, cultivation tips, estimated timelines, and real-world growing parameters",category:"core",status:"completed",priority:"high",estimatedHours:8,actualHours:6,completedAt:new Date().toISOString(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-021",title:"Strain Performance Analytics",description:"Track success rates, average yields, contamination rates, and optimal conditions per strain based on historical grows",category:"core",status:"planned",priority:"medium",estimatedHours:10,dependencies:["dev-020","dev-012"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-030",title:"Farm/Lab Mapping System",description:"Create rooms for each process step (pasteurization, inoculation, colonization, grow, storage). Add racks, shelves, slots to locations. Hierarchical location management.",category:"core",status:"planned",priority:"high",estimatedHours:12,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-031",title:"Location Occupancy Tracking",description:"View batches within each location, determine how many blocks are within each location, estimate total yield per room, see which varieties are in each location",category:"core",status:"planned",priority:"high",estimatedHours:8,dependencies:["dev-030","dev-012"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-032",title:"Room Environmental Metrics",description:"Track history of temperature, CO2 levels, and humidity within each location. Manual entry initially, sensor integration later.",category:"core",status:"planned",priority:"medium",estimatedHours:10,dependencies:["dev-030"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-033",title:"Visual Farm Map",description:"Interactive visual representation of lab/farm layout showing location status, occupancy, and quick navigation",category:"ui",status:"backlog",priority:"medium",estimatedHours:16,dependencies:["dev-030"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-040",title:"Growing Room Daily Check",description:"Daily rounds workflow: input estimated harvest for next 7 days, flag rooms needing attention, track room status. Mobile-friendly for walking rounds.",category:"core",status:"planned",priority:"high",estimatedHours:14,dependencies:["dev-030"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-041",title:"Harvest Forecasting",description:"Predict when blocks need to move to next stage, forecast weight/yields, view 7-day harvest predictions",category:"core",status:"planned",priority:"high",estimatedHours:12,dependencies:["dev-040","dev-013"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-042",title:"Cool Room / Fridge Check",description:"Mobile fridge check feature: review inventory live, track cold-storage items, support multiple cold rooms (cultures, spawn ready, etc.)",category:"core",status:"planned",priority:"medium",estimatedHours:8,dependencies:["dev-030"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-043",title:"Growing Cycle Planning",description:"View all growing rooms and status, plan filling schedule, coordinate activity with available time, save filling data and statistics",category:"core",status:"backlog",priority:"medium",estimatedHours:12,dependencies:["dev-040"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-050",title:"Recipe/Formula Library",description:"Reusable library of substrate recipes, agar formulas, LC recipes. Rich text notes, tables, key parameters. Duplicate successful setups.",category:"core",status:"completed",priority:"high",estimatedHours:10,actualHours:12,completedAt:new Date().toISOString(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-051",title:"Substrate Hydration Calculator",description:"Four calculation modes: (1) dry weight + water %  total, (2) total + water %  dry/water, (3) water + dry  %, (4) total + dry  %",category:"core",status:"completed",priority:"high",estimatedHours:6,actualHours:5,completedAt:new Date().toISOString(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-052",title:"Recipe-to-Grow Linking",description:"Insert saved formula into new grow/project, track which recipes were used for which grows, compare recipe performance",category:"core",status:"planned",priority:"medium",estimatedHours:6,dependencies:["dev-050","dev-012"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-060",title:"Photo Timeline System",description:"Attach images to any entry, organize by date, see progression from colonization to harvest at a glance. Auto-build gallery per grow.",category:"core",status:"planned",priority:"high",estimatedHours:12,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-061",title:"Growth Stage Photo Logging",description:"Log colonization, pinning, and fruiting milestones with images. Compare progress over time.",category:"core",status:"planned",priority:"medium",estimatedHours:8,dependencies:["dev-060"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-062",title:"Event/Observation Logging",description:"Log any event or observation with timestamp, notes, photos. Track inoculation, colonization progress, issues, harvests.",category:"core",status:"planned",priority:"high",estimatedHours:8,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-070",title:"Supplies/Inventory Management",description:"Track all supplies: ingredients, vessels, tools. Stock levels, expiration dates, reorder alerts, vendor tracking.",category:"core",status:"completed",priority:"high",estimatedHours:12,actualHours:14,completedAt:new Date().toISOString(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-071",title:"Cost Tracking System",description:"Track cost-of-goods across all grows. Link ingredient costs to recipes, recipes to grows. Drill-down from final yield to individual ingredient costs.",category:"core",status:"completed",priority:"high",estimatedHours:14,actualHours:10,completedAt:new Date().toISOString(),dependencies:["dev-070","dev-050"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-072",title:"Cost Analysis Dashboard",description:"Visualize cost breakdowns, cost per gram, ROI per grow, compare costs across strains/methods",category:"ui",status:"planned",priority:"medium",estimatedHours:10,dependencies:["dev-071"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-073",title:"Wishlist & Purchase Planning",description:"Track wanted items, plan purchases, track what you want to try vs what you have tried",category:"enhancement",status:"backlog",priority:"low",estimatedHours:4,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-080",title:"Harvest & Yield Logging",description:"Record harvest weights (wet/dry), flush numbers, quality ratings. Track biological efficiency.",category:"core",status:"completed",priority:"critical",estimatedHours:8,actualHours:6,completedAt:new Date().toISOString(),dependencies:["dev-012"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-081",title:"Performance Analytics Dashboard",description:"Understand how grows perform over time. Compare yields, techniques, strains side by side. Identify best performers.",category:"ui",status:"completed",priority:"high",estimatedHours:14,actualHours:12,completedAt:new Date().toISOString(),dependencies:["dev-080"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-082",title:"Success/Failure Pattern Recognition",description:"Learn from data: repeat what works, avoid past mistakes. Track contamination rates, success rates per method.",category:"core",status:"backlog",priority:"medium",estimatedHours:12,dependencies:["dev-081"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-083",title:"Smarter Reuse / Duplication",description:"Duplicate successful grow setups easily. App learns from history to suggest optimal configurations.",category:"enhancement",status:"backlog",priority:"medium",estimatedHours:8,dependencies:["dev-081"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-090",title:"QR Code Generation",description:"Generate QR codes for cultures, vessels, locations, grows. Encode item ID for quick lookup.",category:"core",status:"planned",priority:"high",estimatedHours:6,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-091",title:"Label Design & Printing",description:"Design printable labels with QR codes. Support for thermal printers (WiFi and Bluetooth). PDF export for standard printers.",category:"core",status:"planned",priority:"high",estimatedHours:12,dependencies:["dev-090"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-092",title:"QR Scanner Integration",description:"Scan QR labels to instantly access culture/grow records. Mobile camera integration.",category:"integration",status:"planned",priority:"high",estimatedHours:8,dependencies:["dev-090"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-100",title:"Smart Notification System",description:"Configurable alerts: expiring cultures, stage transitions due, low inventory, LC too old, slow-growing items. Push notifications.",category:"core",status:"planned",priority:"critical",estimatedHours:14,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-101",title:"Customized Notifications per Strain",description:"Set strain-specific notification rules: cultivation windows, substrate requirements, expected timelines",category:"core",status:"backlog",priority:"medium",estimatedHours:6,dependencies:["dev-100","dev-020"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-102",title:"Task Management & Reminders",description:"Create to-do lists and task assignments for daily operations. Reminders for substrate prep, inoculation, harvesting.",category:"core",status:"backlog",priority:"medium",estimatedHours:10,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-110",title:"Lookup Table Management UI",description:"Manage all lookup tables: strains, vendors, locations, vessels, ingredients, tools, procedures. Add/remove/update without breaking historical data.",category:"core",status:"completed",priority:"high",estimatedHours:12,actualHours:14,completedAt:new Date().toISOString(),notes:"Settings page with 10 tabs: Database, Species, Strains, Locations, Vessels, Container Types, Substrate Types, Suppliers, Inventory Categories. Full CRUD for all lookup tables with modal forms.",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-111",title:"ID/Label Configuration",description:"Configurable auto-generation of unique IDs. Custom prefixes, numbering schemes.",category:"core",status:"planned",priority:"medium",estimatedHours:4,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-112",title:"Procedure Library",description:"Step-by-step procedure documentation with linked tools and ingredients. Reusable SOPs.",category:"core",status:"backlog",priority:"medium",estimatedHours:8,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-120",title:"Supabase Database Integration",description:"Cloud PostgreSQL with Supabase. Real-time sync, proper relational schema for all entities. Configurable via Settings.",category:"data",status:"completed",priority:"critical",estimatedHours:20,actualHours:18,completedAt:new Date().toISOString(),notes:"Full Supabase integration with Settings UI. Idempotent schema (safe to run multiple times). Schema migrations for evolving columns. Write permission testing. RLS policies for anonymous access. 17 tables with full CRUD.",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-121",title:"API Layer (Node.js)",description:"RESTful API with Express/Fastify. Full CRUD endpoints for all entities.",category:"core",status:"backlog",priority:"critical",estimatedHours:24,dependencies:["dev-120"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-122",title:"User Authentication",description:"Login/registration, session management. Azure AD or Auth0 integration option.",category:"core",status:"backlog",priority:"high",estimatedHours:12,dependencies:["dev-121"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-123",title:"Cloud File Storage",description:"Azure Blob or DigitalOcean Spaces for photos. Secure upload, CDN delivery.",category:"integration",status:"backlog",priority:"high",estimatedHours:10,dependencies:["dev-121"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-124",title:"Cloud Deployment (DigitalOcean/Azure)",description:"Deploy to production. CI/CD pipeline, SSL, domain setup.",category:"integration",status:"backlog",priority:"critical",estimatedHours:12,dependencies:["dev-121","dev-122"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-130",title:"Mobile-First Responsive Design",description:"Full mobile experience for lab use. Touch-friendly, quick logging. Scrollable sidebar, no content overflow.",category:"ui",status:"in_progress",priority:"high",estimatedHours:16,actualHours:8,notes:"Modal scrolling fixed - tall forms now scrollable on all screen sizes. CSS overflow fixes applied globally. Buttons always accessible. Settings page responsive with collapsible tabs.",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-131",title:"PWA (Progressive Web App)",description:"Installable app, offline capability, push notifications.",category:"integration",status:"backlog",priority:"medium",estimatedHours:12,dependencies:["dev-130","dev-100"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-132",title:"Native Mobile App (React Native)",description:"Dedicated iOS/Android app for best mobile experience.",category:"integration",status:"backlog",priority:"nice_to_have",estimatedHours:80,dependencies:["dev-121"],notes:"Future consideration after web app is stable",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-140",title:"Global Search",description:"Search across all entities: cultures, grows, strains, recipes. Advanced filtering.",category:"core",status:"planned",priority:"high",estimatedHours:10,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-141",title:"Data Export/Import",description:"Export to CSV/JSON. Backup/restore functionality. Data portability.",category:"core",status:"backlog",priority:"medium",estimatedHours:8,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-142",title:"Bulk Operations",description:"Bulk update, delete, archive items. Batch imports.",category:"core",status:"backlog",priority:"low",estimatedHours:6,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-150",title:"Dark/Light Theme Toggle",description:"User-selectable theme with system preference detection.",category:"ui",status:"backlog",priority:"low",estimatedHours:4,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-151",title:"Accessibility Improvements",description:"WCAG compliance, keyboard navigation, screen reader support.",category:"ui",status:"backlog",priority:"medium",estimatedHours:10,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-160",title:"Contamination Pattern Analysis",description:'Log contamination type, timing, stage. Analyze patterns: "Trich at day 7 = sterilization vs day 2 = bacterial". Track contam rates by variable (grain type, season, PC time).',category:"core",status:"completed",priority:"high",estimatedHours:12,actualHours:10,completedAt:new Date().toISOString(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-161",title:"Biological Efficiency Calculator",description:"Auto-calculate BE% = (fresh mushroom weight / dry substrate weight)  100. Track per strain, method, substrate. Compare performance.",category:"core",status:"completed",priority:"high",estimatedHours:6,actualHours:5,completedAt:new Date().toISOString(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-162",title:"Transfer Generation Tracking",description:"Explicit T0  T1  T2 numbering. Track genetic degradation over transfers. Alerts when generation too high.",category:"core",status:"completed",priority:"high",estimatedHours:4,actualHours:3,completedAt:new Date().toISOString(),dependencies:["dev-014"],notes:"Integrated into Culture Management with automatic generation increment on transfers",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-163",title:"Spawn Rate Calculator",description:"Quick calculator for spawn:substrate ratios (1:2, 1:4, etc.). Calculate amounts needed for target batch size.",category:"core",status:"completed",priority:"medium",estimatedHours:3,actualHours:3,completedAt:new Date().toISOString(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-164",title:"Culture Viability Reminders",description:"Track days since last transfer. Alert when culture needs subculturing or viability testing. Species-specific thresholds.",category:"core",status:"planned",priority:"high",estimatedHours:6,dependencies:["dev-100"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-165",title:"Batch Correlation & Tracking",description:"Link specific agar/grain/substrate batches to outcomes. Track batch-level contam rates. Identify problematic batches.",category:"core",status:"planned",priority:"high",estimatedHours:10,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-166",title:"Pressure Cooking Calculator",description:"Calculate PC times for different volumes/materials at different PSI. Altitude adjustment. Safety margins.",category:"core",status:"completed",priority:"medium",estimatedHours:4,actualHours:4,completedAt:new Date().toISOString(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-167",title:"Media Scaling Calculator",description:"Scale agar/LC recipes up or down (10 plates  50 plates). Maintain ratios. Auto-calculate ingredient amounts.",category:"core",status:"completed",priority:"medium",estimatedHours:4,actualHours:2,completedAt:new Date().toISOString(),notes:"Integrated into Recipe Builder with 0.5x-5x scaling slider",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-168",title:"Timeline/Gantt View",description:"Visual timeline of all active grows overlaid. Show start dates, current stage, expected completion. Identify bottlenecks.",category:"ui",status:"planned",priority:"medium",estimatedHours:14,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-169",title:"Calendar Integration",description:"Push expected dates to Google Calendar / iCal. Sync harvest predictions, transfer reminders, stage transitions.",category:"integration",status:"backlog",priority:"medium",estimatedHours:10,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-170",title:"Microscopy Log",description:"Dedicated logging for spore/culture examination under microscope. Spore measurements, contamination identification, health assessment.",category:"core",status:"planned",priority:"low",estimatedHours:6,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-171",title:"Printable Log Sheets",description:"PDF export for paper logging in the lab. Pre-formatted sheets for agar work, inoculation, harvest. QR code links back to digital records.",category:"core",status:"backlog",priority:"low",estimatedHours:8,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-172",title:"Failure Mode Categories",description:"Pre-defined failure modes with guided logging. Contamination types, stage of failure, suspected causes. Build knowledge base over time.",category:"core",status:"planned",priority:"high",estimatedHours:6,dependencies:["dev-160"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-173",title:"Phenotype Tracking",description:"Log visual characteristics: cap color, stem length, cluster size, print color, growth pattern (rhizo vs tomentose). Compare across genetics.",category:"core",status:"planned",priority:"medium",estimatedHours:6,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-174",title:"Clone Tracking Workflow",description:"Special workflow for tissue clones vs spore-derived cultures. Track clone source (cap, stem, inner tissue). Document selection criteria.",category:"core",status:"planned",priority:"medium",estimatedHours:6,dependencies:["dev-014"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-175",title:"Weather/Season Correlation",description:"Optional ambient condition logging. Track outdoor temp, humidity, barometric pressure. Correlate with grow outcomes for pattern detection.",category:"enhancement",status:"backlog",priority:"low",estimatedHours:8,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-180",title:"Statistical Analysis Engine",description:'Analyze performance by variable. "Your B+ performs 23% better at 76F vs 72F". Confidence intervals, sample size warnings.',category:"core",status:"backlog",priority:"medium",estimatedHours:20,dependencies:["dev-081"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-181",title:"Predictive Scheduling",description:'Based on strain + conditions, predict timeline. "Expect pins in 4 days". Machine learning from historical data.',category:"enhancement",status:"backlog",priority:"medium",estimatedHours:24,dependencies:["dev-180"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-182",title:"SOP Library & Linking",description:"Standardized Operating Procedures linked to every action. Deviation logging. Procedure version control.",category:"core",status:"backlog",priority:"medium",estimatedHours:12,dependencies:["dev-112"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-183",title:"Full Audit Trail",description:"Every change logged with timestamp, user, before/after. Lab notebook compliance. Immutable history.",category:"core",status:"backlog",priority:"high",estimatedHours:14,dependencies:["dev-121"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-184",title:"Batch Release Criteria",description:'Define release criteria: "Spawn ready when: colonization 100% + no contam + 14 days minimum". Auto-flag when criteria met.',category:"core",status:"backlog",priority:"medium",estimatedHours:8,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-185",title:"Closed-Loop Feedback System",description:"Environmental data auto-correlated with outcomes. Identify optimal conditions automatically. Recommendations engine.",category:"enhancement",status:"backlog",priority:"high",estimatedHours:30,dependencies:["dev-200","dev-180"],notes:"Requires sensor integration + statistical engine",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-200",title:"Environmental Sensor Integration",description:"Connect to temperature/humidity/CO2 sensors for automatic logging. IoT integration.",category:"integration",status:"backlog",priority:"low",estimatedHours:30,notes:"Future feature - IoT device prototype will come after app is fully stood up. Foundation pieces (locations, environmental data models) should be built first.",dependencies:["dev-030","dev-032"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-201",title:"AI Contamination Detection",description:"Upload photos for AI analysis of potential contamination. Early warning system.",category:"enhancement",status:"backlog",priority:"nice_to_have",estimatedHours:40,notes:"Requires ML model training",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-202",title:"Community Features",description:"Share grows, Q&A with other growers, community strain library. Optional social features.",category:"enhancement",status:"backlog",priority:"nice_to_have",estimatedHours:60,notes:"v2.0+ consideration",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-203",title:"Multi-User / Collaboration",description:"Multiple users, roles/permissions, shared grows, consensus forecasting.",category:"enhancement",status:"backlog",priority:"nice_to_have",estimatedHours:40,dependencies:["dev-122"],notes:"v2.0+ for team/farm use",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-300",title:"Shared Data Store Architecture",description:"Central state management system with unified entity relationships. DataContext provider with 60+ CRUD operations, lookup helpers, and type-safe data flow.",category:"data",status:"completed",priority:"critical",estimatedHours:20,actualHours:16,completedAt:new Date().toISOString(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-301",title:"Settings & Preferences Page",description:"User preferences for units, timezone, notifications, display options. Altitude settings for pressure cooking calculations.",category:"ui",status:"completed",priority:"high",estimatedHours:6,actualHours:5,completedAt:new Date().toISOString(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-302",title:"Recipe Cost Auto-Calculation",description:"Automatic cost calculation for recipes based on linked inventory items. Real-time cost updates as ingredients change.",category:"core",status:"completed",priority:"high",estimatedHours:4,actualHours:3,completedAt:new Date().toISOString(),dependencies:["dev-050","dev-070"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-303",title:"Culture Label Auto-Generation",description:"Automatic label generation for new cultures based on type (LC-001, AG-001, SS-001, SL-001). Sequential numbering.",category:"core",status:"completed",priority:"medium",estimatedHours:2,actualHours:1,completedAt:new Date().toISOString(),dependencies:["dev-011"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-304",title:"Grow-to-Culture Linking",description:"Link grows to source cultures. Track which cultures produced which grows. Bi-directional navigation.",category:"core",status:"completed",priority:"high",estimatedHours:4,actualHours:3,completedAt:new Date().toISOString(),dependencies:["dev-011","dev-012"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-400",title:"Quick Actions Dashboard Widget",description:"One-click actions from dashboard: Log Observation, Record Harvest, New Culture, Start Grow. Reduces clicks for daily tasks.",category:"ui",status:"planned",priority:"high",estimatedHours:6,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-401",title:"Batch Operations for Cultures",description:"Create multiple cultures at once (e.g., 10 agar plates from one LC). Bulk status updates, bulk transfers.",category:"core",status:"planned",priority:"high",estimatedHours:8,dependencies:["dev-011"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-402",title:"Grow Templates",description:'Save and reuse grow configurations. "Blue Oyster Standard Setup" = strain + substrate + container + conditions. One-click new grow from template.',category:"core",status:"planned",priority:"high",estimatedHours:8,dependencies:["dev-012"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-403",title:"Culture Templates",description:'Templates for common culture setups. "Standard LC" = vessel + media recipe + volume. Quick creation of consistent cultures.',category:"core",status:"planned",priority:"medium",estimatedHours:6,dependencies:["dev-011"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-404",title:"Inoculation Workflow",description:"Guided workflow: select source culture  select target(s)  log transfer  auto-update generation counts  print labels. Reduces errors.",category:"core",status:"planned",priority:"high",estimatedHours:10,dependencies:["dev-011","dev-014"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-405",title:"Harvest Workflow",description:"Streamlined harvest logging: select grow  enter weight  auto-calculate BE%  log flush  update stage. Optional: deduct from inventory.",category:"core",status:"planned",priority:"high",estimatedHours:6,dependencies:["dev-080"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-410",title:"Tagging System",description:'Add custom tags to any entity. Filter by tags across the app. Examples: "experiment", "keeper", "priority", "clone-candidate".',category:"core",status:"planned",priority:"high",estimatedHours:8,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-411",title:"Favorites/Starred Items",description:"Star important items for quick access. Favorites widget on dashboard. Works across cultures, grows, strains, recipes.",category:"ui",status:"planned",priority:"medium",estimatedHours:4,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-412",title:"Archive System",description:"Archive completed/old items instead of deleting. Archived items hidden by default but searchable. Restore from archive.",category:"core",status:"planned",priority:"high",estimatedHours:6,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-413",title:"Activity Feed",description:"Chronological feed of all actions: cultures created, grows updated, harvests logged, observations added. Filter by entity type or date.",category:"ui",status:"planned",priority:"medium",estimatedHours:8,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-414",title:"Keyboard Shortcuts",description:"Power-user shortcuts: Cmd+K for search, Cmd+N for new, arrow keys for navigation. Shortcut reference panel.",category:"ui",status:"backlog",priority:"low",estimatedHours:6,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-415",title:"Breadcrumb Navigation",description:"Always know where you are: Dashboard > Grows > Blue Oyster Batch 3 > Flush 2. Click to navigate up.",category:"ui",status:"planned",priority:"medium",estimatedHours:4,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-420",title:"Customizable Dashboard",description:"Drag-and-drop dashboard widgets. Show/hide sections. Resize widgets. Save layout preferences.",category:"ui",status:"backlog",priority:"medium",estimatedHours:16,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-421",title:"Dashboard Widgets Library",description:"Additional widgets: Calendar, Weather, Recent Harvests, Contamination Alerts, Low Stock, Expiring Cultures, Stage Distribution.",category:"ui",status:"planned",priority:"high",estimatedHours:12,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-422",title:"At-a-Glance Status Cards",description:"Visual status indicators: cultures needing attention (by age/health), grows ready for next stage, items expiring soon.",category:"ui",status:"planned",priority:"high",estimatedHours:8,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-423",title:"Today View",description:"What needs attention TODAY: scheduled harvests, stage transitions due, cultures to check, low stock items, expiring soon.",category:"ui",status:"planned",priority:"critical",estimatedHours:10,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-430",title:"Form Validation System",description:"Comprehensive validation: required fields, date ranges, numeric bounds, cross-field validation (end date > start date).",category:"core",status:"planned",priority:"high",estimatedHours:8,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-431",title:"Data Integrity Checks",description:"Background checks: orphaned records, impossible dates, missing required relationships. Dashboard warnings for issues.",category:"core",status:"planned",priority:"medium",estimatedHours:8,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-432",title:"Undo/Redo System",description:"Undo recent changes. Redo undone changes. History of last 10 actions per session.",category:"core",status:"backlog",priority:"medium",estimatedHours:12,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-433",title:"Soft Delete with Recovery",description:"Deleted items go to trash. 30-day recovery window. Permanent delete from trash.",category:"core",status:"planned",priority:"medium",estimatedHours:6,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-440",title:"First-Run Setup Wizard",description:"Guided setup for new users: configure locations, add first strains, set preferences. Skip option for experienced users.",category:"ui",status:"in_progress",priority:"high",estimatedHours:8,actualHours:4,notes:"Basic wizard implemented, needs polish and more steps",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-441",title:"Sample Data Generator",description:"Generate realistic sample data for testing/demo. Configurable: number of cultures, grows, time range. Clear sample data option.",category:"core",status:"planned",priority:"medium",estimatedHours:6,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-442",title:"Contextual Help Tooltips",description:'Hover help on complex fields. "What is Biological Efficiency?" tooltips. Link to full documentation.',category:"ui",status:"planned",priority:"medium",estimatedHours:6,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-443",title:"In-App Documentation",description:"Searchable help docs within app. Cultivation guides, best practices, troubleshooting. Markdown-based, easy to update.",category:"ui",status:"backlog",priority:"low",estimatedHours:16,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-444",title:"Interactive Tutorials",description:'Step-by-step guided tours: "Create your first culture", "Log a harvest", "Track lineage". Highlight UI elements.',category:"ui",status:"backlog",priority:"low",estimatedHours:12,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-450",title:"Summary Reports",description:"Generate reports: Monthly harvest summary, Strain performance comparison, Contamination analysis, Cost breakdown.",category:"core",status:"planned",priority:"high",estimatedHours:12,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-451",title:"PDF Report Export",description:"Export reports to PDF. Professional formatting. Include charts and tables. Custom date ranges.",category:"core",status:"planned",priority:"medium",estimatedHours:10,dependencies:["dev-450"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-452",title:"Grow Journal Export",description:"Export complete grow history as document. All observations, photos, harvests, notes. Shareable format.",category:"core",status:"planned",priority:"medium",estimatedHours:8,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-453",title:"CSV/Excel Export",description:"Export any table to CSV or Excel. Configurable columns. All entities supported.",category:"core",status:"planned",priority:"high",estimatedHours:6,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-460",title:"Environmental Readings Data Model",description:"Database schema for environmental readings: timestamp, location_id, temp, humidity, CO2, light level. Optimized for time-series queries.",category:"data",status:"planned",priority:"high",estimatedHours:6,notes:"Foundation for future sensor integration. Manual entry first, then IoT.",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-461",title:"Manual Environmental Logging",description:"Log temp/humidity readings manually per location. Quick-entry form. History view per location.",category:"core",status:"planned",priority:"high",estimatedHours:6,dependencies:["dev-460","dev-030"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-462",title:"Environmental Charts",description:"Line charts showing temp/humidity over time per location. Overlay optimal ranges. Highlight out-of-range periods.",category:"ui",status:"planned",priority:"medium",estimatedHours:8,dependencies:["dev-460"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-463",title:"Environmental Alerts",description:"Alerts when readings are out of range. Configurable thresholds per location. Push notifications (future).",category:"core",status:"planned",priority:"medium",estimatedHours:6,dependencies:["dev-460","dev-100"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-500",title:"Recipe-to-Culture Linking",description:"When creating a culture (LC, agar, slant, etc.), allow user to select which recipe was used to make the media. Track what's actually IN each container. Essential for knowing what recipe produced which results.",category:"core",status:"completed",priority:"critical",estimatedHours:8,dependencies:["dev-050"],notes:"Core workflow gap - users need to know what recipe is in each culture container",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-501",title:"Fill Volume vs Container Capacity",description:"Containers have total capacity (e.g., 1000ml jar) but are often partially filled (e.g., 600ml of LC). Track both: vessel.volume_ml (max capacity) and culture.fill_volume_ml (actual amount). Show fill percentage.",category:"core",status:"completed",priority:"critical",estimatedHours:6,notes:"Real-world usage: a 1000ml jar might only have 600ml of LC. Users need to track actual volume.",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-502",title:"Batch/Prep Session Tracking",description:'When you prep a batch of media (e.g., make 5L of LC and fill 8 jars), track it as a "prep session" or "batch". Link all containers filled from the same batch. Track prep date, sterilization params, recipe used.',category:"core",status:"planned",priority:"high",estimatedHours:10,dependencies:["dev-500"],notes:"Essential for batch-level contamination tracking - if one jar from a batch contams, check the others",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-503",title:"Container Lifecycle States",description:"Track container status through its lifecycle: empty  sterilized  filled  inoculated  colonizing  ready  in-use  exhausted/contaminated. Different from culture status - this is the physical container.",category:"core",status:"planned",priority:"high",estimatedHours:6,notes:"Users need to know: is this jar clean? sterilized? what's in it?",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-504",title:"Sterilization Logging",description:"Log sterilization events for containers: date, method (PC/autoclave), pressure, time, who did it. Track if container was sterilized before filling. Alert if using unsterilized container.",category:"core",status:"planned",priority:"high",estimatedHours:8,dependencies:["dev-166"],notes:"Links to pressure cooking calculator. Important for contamination root cause analysis.",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-505",title:"Container Reuse Tracking",description:"For reusable vessels (jars, bottles), track usage count and history. How many times has this jar been used? Last cleaned? Any contamination history? Flag high-use containers for inspection.",category:"core",status:"planned",priority:"medium",estimatedHours:6,dependencies:["dev-503"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-506",title:"Media Age & Expiration",description:'Track how old the media is in each container. LC degrades over time, agar dries out. Show "days since prep", calculate viability window, alert when media is getting old.',category:"core",status:"planned",priority:"high",estimatedHours:6,dependencies:["dev-500"],notes:"LC viability is typically 2-6 months. Agar plates dry out. Users need expiration awareness.",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-507",title:"Culture Creation Workflow Redesign",description:'Redesign "Add Culture" flow to capture: container type, fill volume, recipe used, prep/sterilization date, source (if inoculated), location. Guided multi-step form for complete data capture.',category:"ui",status:"planned",priority:"critical",estimatedHours:12,dependencies:["dev-500","dev-501","dev-504"],notes:"Consolidates the above features into a proper user workflow",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-508",title:"Quick Fill from Batch",description:'After prepping a batch of media, quickly log multiple containers filled from it. "I made LC today and filled 8 jars"  creates 8 culture records with shared batch ID, recipe, prep date.',category:"core",status:"planned",priority:"high",estimatedHours:8,dependencies:["dev-502","dev-401"],notes:"Reduces data entry burden when prepping multiple containers at once",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-509",title:"What's In This Container View",description:"For any container/culture, show complete contents: recipe name, ingredients, prep date, sterilization date, inoculation date, source culture, current volume remaining, age, viability status.",category:"ui",status:"planned",priority:"high",estimatedHours:8,dependencies:["dev-500","dev-501","dev-506"],notes:'Single view to answer "what exactly is in this jar?"',createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-510",title:"Volume Deduction on Use",description:'When using culture (e.g., inoculating grain from LC), deduct volume used. "Used 10ml from LC-042" updates remaining volume. Track usage history per container.',category:"core",status:"planned",priority:"medium",estimatedHours:6,dependencies:["dev-501"],notes:"Know how much LC is left in each jar",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-600",title:'Inline "Add New" in Form Dropdowns',description:'When creating a grow/culture/etc, allow "Add New..." option in dropdown for strains, spawn types, substrates, containers. Opens mini-form inline or modal without losing form state.',category:"ui",status:"completed",priority:"critical",estimatedHours:0,notes:"HIGHEST PRIORITY - Users cannot complete workflows without this. Must be able to add missing options on the fly.",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-601",title:"Form Draft Auto-Save",description:"Automatically save form state to localStorage as user fills it out. Restore drafts on return. Prevents data loss when navigating away to add missing items.",category:"core",status:"planned",priority:"critical",estimatedHours:0,dependencies:["dev-600"],notes:"Essential for draft workflow - user can leave form to add items and return to complete it.",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-602",title:"Draft Resume Flow",description:"After adding a new strain/substrate/etc, automatically return user to their saved draft with the new item selected. Clear draft on successful submission.",category:"ui",status:"planned",priority:"critical",estimatedHours:0,dependencies:["dev-601"],notes:"Complete the loop - create  navigate  add  return  resume.",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"dev-603",title:"Draft Indicator in UI",description:'Show visual indicator when drafts exist. "Continue editing Grow Draft" button on dashboard or relevant page. List pending drafts.',category:"ui",status:"planned",priority:"high",estimatedHours:0,dependencies:["dev-601"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}],Ps={dry_to_total:{title:"Dry Weight  Total",description:"Know your dry substrate weight and target moisture? Get the total finished weight.",inputs:["Dry Weight (g)","Target Moisture %"],outputs:["Water to Add (g)","Total Weight (g)"]},total_to_dry:{title:"Total Weight  Components",description:"Have a target block weight and moisture level? Calculate dry substrate and water needed.",inputs:["Target Total Weight (g)","Target Moisture %"],outputs:["Dry Substrate (g)","Water (g)"]},weights_to_percent:{title:"Weights  Moisture %",description:"Know how much water and dry substrate you used? Calculate the moisture percentage.",inputs:["Water Weight (g)","Dry Weight (g)"],outputs:["Moisture %","Total Weight (g)"]},total_dry_to_percent:{title:"Total & Dry  Moisture %",description:"Weighed before and after drying? Calculate the moisture content.",inputs:["Total Weight (g)","Dry Weight (g)"],outputs:["Moisture %","Water Content (g)"]}},xw=[{name:"CVG (Coco Coir)",moisture:65,notes:"Standard coco/verm/gypsum"},{name:"Hardwood Sawdust",moisture:60,notes:"Oak, maple, etc."},{name:"Straw",moisture:70,notes:"Pasteurized straw"},{name:"Manure-based",moisture:65,notes:"Horse manure substrate"},{name:"Master's Mix",moisture:60,notes:"50/50 hardwood/soy hulls"},{name:"BRF Cakes",moisture:55,notes:"Brown rice flour + verm"},{name:"Field Capacity",moisture:72,notes:"Maximum water retention"}],vw=()=>{const[e,t]=b.useState("dry_to_total"),[s,n]=b.useState(""),[i,a]=b.useState(""),[o,l]=b.useState(null),[d,c]=b.useState(!1),[p,m]=b.useState([]);b.useEffect(()=>{const u=parseFloat(s),h=parseFloat(i);if(isNaN(u)||isNaN(h)||u<=0||h<=0){l(null);return}let x={};switch(e){case"dry_to_total":if(h>=100){l(null);return}const _=u*(h/(100-h));x={dryWeight:u,moisturePercent:h,waterWeight:Math.round(_*10)/10,totalWeight:Math.round((u+_)*10)/10};break;case"total_to_dry":if(h>=100){l(null);return}const N=u*(h/100);x={totalWeight:u,moisturePercent:h,waterWeight:Math.round(N*10)/10,dryWeight:Math.round((u-N)*10)/10};break;case"weights_to_percent":const w=u+h;x={waterWeight:u,dryWeight:h,totalWeight:Math.round(w*10)/10,moisturePercent:Math.round(u/w*1e3)/10};break;case"total_dry_to_percent":if(h>u){l(null);return}const C=u-h;x={totalWeight:u,dryWeight:h,waterWeight:Math.round(C*10)/10,moisturePercent:Math.round(C/u*1e3)/10};break}l(x)},[e,s,i]);const g=u=>{t(u),n(""),a(""),l(null)},f=u=>{(e==="dry_to_total"||e==="total_to_dry")&&a(u.toString()),c(!1)},v=()=>{if(!o)return;const u={id:Date.now().toString(),mode:e,inputs:[parseFloat(s),parseFloat(i)],result:o,timestamp:new Date};m(h=>[u,...h].slice(0,10))},j=()=>Ps[e].inputs,S=u=>u<50?{label:"Too Dry",color:"text-amber-400"}:u<55?{label:"Low",color:"text-yellow-400"}:u<=65?{label:"Optimal",color:"text-emerald-400"}:u<=72?{label:"High (Field Capacity)",color:"text-blue-400"}:{label:"Too Wet",color:"text-red-400"};return r.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold text-white",children:"Substrate Calculator"}),r.jsx("p",{className:"text-zinc-400 text-sm",children:"Four ways to calculate perfect hydration ratios"})]}),r.jsx("div",{className:"flex items-center gap-2",children:r.jsx("button",{onClick:()=>c(!d),className:"px-4 py-2 bg-zinc-800 hover:bg-zinc-700 text-white rounded-lg text-sm font-medium border border-zinc-700 transition-colors",children:" Presets"})})]}),d&&r.jsxs("div",{className:"bg-zinc-900 border border-zinc-700 rounded-xl p-4 animate-fade-in",children:[r.jsx("h3",{className:"text-sm font-medium text-zinc-400 mb-3",children:"Common Substrate Targets"}),r.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:xw.map(u=>r.jsxs("button",{onClick:()=>f(u.moisture),className:"p-3 bg-zinc-800/50 hover:bg-zinc-800 border border-zinc-700 rounded-lg text-left transition-colors group",children:[r.jsx("p",{className:"text-sm font-medium text-white group-hover:text-emerald-400",children:u.name}),r.jsxs("p",{className:"text-lg font-bold text-emerald-400",children:[u.moisture,"%"]}),r.jsx("p",{className:"text-xs text-zinc-500",children:u.notes})]},u.name))})]}),r.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:Object.keys(Ps).map(u=>r.jsxs("button",{onClick:()=>g(u),className:`p-4 rounded-xl border text-left transition-all ${e===u?"bg-emerald-500/10 border-emerald-500/50 ring-1 ring-emerald-500/30":"bg-zinc-900/50 border-zinc-800 hover:border-zinc-700"}`,children:[r.jsxs("div",{className:`text-xs font-medium mb-1 ${e===u?"text-emerald-400":"text-zinc-500"}`,children:["Mode ",Object.keys(Ps).indexOf(u)+1]}),r.jsx("div",{className:`text-sm font-semibold ${e===u?"text-white":"text-zinc-300"}`,children:Ps[u].title})]},u))}),r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl overflow-hidden",children:[r.jsx("div",{className:"p-5 border-b border-zinc-800 bg-zinc-900/30",children:r.jsx("p",{className:"text-zinc-400",children:Ps[e].description})}),r.jsx("div",{className:"p-6",children:r.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[r.jsxs("div",{className:"space-y-4",children:[r.jsx("h3",{className:"text-sm font-medium text-zinc-400 uppercase tracking-wider",children:"Inputs"}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:j()[0]}),r.jsx("input",{type:"number",value:s,onChange:u=>n(u.target.value),placeholder:"Enter value...",className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-4 py-3 text-white text-lg font-mono focus:outline-none focus:border-emerald-500 focus:ring-1 focus:ring-emerald-500"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:j()[1]}),r.jsx("input",{type:"number",value:i,onChange:u=>a(u.target.value),placeholder:"Enter value...",className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-4 py-3 text-white text-lg font-mono focus:outline-none focus:border-emerald-500 focus:ring-1 focus:ring-emerald-500"}),(e==="dry_to_total"||e==="total_to_dry")&&r.jsx("p",{className:"text-xs text-zinc-500 mt-1",children:"Common range: 55-72%"})]})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("h3",{className:"text-sm font-medium text-zinc-400 uppercase tracking-wider",children:"Results"}),o?r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.waterWeight!==void 0&&r.jsxs("div",{className:"bg-blue-950/30 border border-blue-800/50 rounded-lg p-4",children:[r.jsx("p",{className:"text-xs text-blue-400 mb-1",children:"Water"}),r.jsxs("p",{className:"text-2xl font-bold text-white font-mono",children:[o.waterWeight.toLocaleString(),"g"]})]}),o.dryWeight!==void 0&&e!=="dry_to_total"&&r.jsxs("div",{className:"bg-amber-950/30 border border-amber-800/50 rounded-lg p-4",children:[r.jsx("p",{className:"text-xs text-amber-400 mb-1",children:"Dry Substrate"}),r.jsxs("p",{className:"text-2xl font-bold text-white font-mono",children:[o.dryWeight.toLocaleString(),"g"]})]}),o.totalWeight!==void 0&&e!=="total_to_dry"&&e!=="total_dry_to_percent"&&r.jsxs("div",{className:"bg-emerald-950/30 border border-emerald-800/50 rounded-lg p-4",children:[r.jsx("p",{className:"text-xs text-emerald-400 mb-1",children:"Total Weight"}),r.jsxs("p",{className:"text-2xl font-bold text-white font-mono",children:[o.totalWeight.toLocaleString(),"g"]})]}),o.moisturePercent!==void 0&&(e==="weights_to_percent"||e==="total_dry_to_percent")&&r.jsxs("div",{className:"bg-purple-950/30 border border-purple-800/50 rounded-lg p-4 col-span-2",children:[r.jsx("p",{className:"text-xs text-purple-400 mb-1",children:"Moisture Content"}),r.jsxs("div",{className:"flex items-baseline gap-3",children:[r.jsxs("p",{className:"text-3xl font-bold text-white font-mono",children:[o.moisturePercent,"%"]}),r.jsx("span",{className:`text-sm font-medium ${S(o.moisturePercent).color}`,children:S(o.moisturePercent).label})]})]})]}),o.moisturePercent!==void 0&&r.jsxs("div",{className:"bg-zinc-800/50 rounded-lg p-4",children:[r.jsxs("div",{className:"flex justify-between text-xs text-zinc-500 mb-2",children:[r.jsx("span",{children:"0%"}),r.jsx("span",{children:"50%"}),r.jsx("span",{children:"72%"}),r.jsx("span",{children:"100%"})]}),r.jsxs("div",{className:"relative h-4 bg-zinc-700 rounded-full overflow-hidden",children:[r.jsx("div",{className:"absolute h-full bg-emerald-900/50",style:{left:"55%",width:"17%"}}),r.jsx("div",{className:"absolute top-0 bottom-0 w-1 bg-white rounded-full shadow-lg shadow-white/50",style:{left:`${Math.min(o.moisturePercent,100)}%`,transform:"translateX(-50%)"}})]}),r.jsxs("div",{className:"flex justify-between text-xs mt-2",children:[r.jsx("span",{className:"text-amber-400",children:"Dry"}),r.jsx("span",{className:"text-emerald-400",children:"Optimal (55-72%)"}),r.jsx("span",{className:"text-red-400",children:"Wet"})]})]}),r.jsx("button",{onClick:v,className:"w-full py-2 bg-zinc-800 hover:bg-zinc-700 text-zinc-300 rounded-lg text-sm font-medium border border-zinc-700 transition-colors",children:" Save Calculation"})]}):r.jsx("div",{className:"h-40 flex items-center justify-center bg-zinc-800/30 rounded-lg border border-zinc-800 border-dashed",children:r.jsx("p",{className:"text-zinc-500 text-sm",children:"Enter values to see results"})})]})]})})]}),r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-5",children:[r.jsx("h3",{className:"text-sm font-medium text-zinc-400 mb-4",children:" Quick Reference"}),r.jsxs("div",{className:"grid md:grid-cols-3 gap-4 text-sm",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-emerald-400 font-medium mb-1",children:"Field Capacity Test"}),r.jsx("p",{className:"text-zinc-400",children:"Squeeze substrate firmly. A few drops = perfect. Stream = too wet. Nothing = too dry."})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-blue-400 font-medium mb-1",children:"Spawn-to-Sub Ratio"}),r.jsx("p",{className:"text-zinc-400",children:"Standard is 1:2 to 1:4 (spawn:substrate by weight). Higher spawn = faster colonization."})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-purple-400 font-medium mb-1",children:"Biological Efficiency"}),r.jsx("p",{className:"text-zinc-400",children:"BE% = (fresh mushroom weight / dry substrate weight)  100. Good = 100%+"})]})]})]}),p.length>0&&r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-5",children:[r.jsx("h3",{className:"text-sm font-medium text-zinc-400 mb-4",children:" Recent Calculations"}),r.jsx("div",{className:"space-y-2",children:p.map(u=>r.jsxs("div",{className:"flex items-center justify-between p-3 bg-zinc-800/50 rounded-lg",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("span",{className:"text-xs text-zinc-500",children:Ps[u.mode].title}),r.jsxs("span",{className:"text-sm text-white font-mono",children:[u.inputs[0],"g + ",u.inputs[1],u.mode.includes("percent")?"g":"%"]})]}),r.jsxs("div",{className:"flex items-center gap-4",children:[u.result.waterWeight&&r.jsxs("span",{className:"text-sm text-blue-400",children:[u.result.waterWeight,"g water"]}),u.result.moisturePercent&&r.jsxs("span",{className:"text-sm text-emerald-400",children:[u.result.moisturePercent,"%"]}),r.jsx("span",{className:"text-xs text-zinc-500",children:u.timestamp.toLocaleTimeString()})]})]},u.id))})]})]})},Mt={Spore:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("circle",{cx:"12",cy:"12",r:"3"}),r.jsx("circle",{cx:"12",cy:"12",r:"8",strokeDasharray:"4 2"})]}),LC:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("path",{d:"M8 3v4l-2 9a4 4 0 0 0 4 4h4a4 4 0 0 0 4-4l-2-9V3"}),r.jsx("line",{x1:"9",y1:"3",x2:"15",y2:"3"})]}),Agar:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("circle",{cx:"12",cy:"12",r:"9"}),r.jsx("ellipse",{cx:"12",cy:"12",rx:"4",ry:"2"})]}),Grow:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("rect",{x:"3",y:"8",width:"18",height:"12",rx:"2"}),r.jsx("path",{d:"M7 8V6a5 5 0 0 1 10 0v2"})]}),Grid:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),r.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),r.jsx("rect",{x:"3",y:"14",width:"7",height:"7"}),r.jsx("rect",{x:"14",y:"14",width:"7",height:"7"})]}),List:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("line",{x1:"8",y1:"6",x2:"21",y2:"6"}),r.jsx("line",{x1:"8",y1:"12",x2:"21",y2:"12"}),r.jsx("line",{x1:"8",y1:"18",x2:"21",y2:"18"}),r.jsx("line",{x1:"3",y1:"6",x2:"3.01",y2:"6"}),r.jsx("line",{x1:"3",y1:"12",x2:"3.01",y2:"12"}),r.jsx("line",{x1:"3",y1:"18",x2:"3.01",y2:"18"})]}),Search:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),X:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),Refresh:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("polyline",{points:"23 4 23 10 17 10"}),r.jsx("polyline",{points:"1 20 1 14 7 14"}),r.jsx("path",{d:"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"})]})},Ls={spore_syringe:{label:"Spore Syringe",icon:Mt.Spore,color:"text-purple-400",bgColor:"bg-purple-950/50 border-purple-800"},liquid_culture:{label:"Liquid Culture",icon:Mt.LC,color:"text-blue-400",bgColor:"bg-blue-950/50 border-blue-800"},agar:{label:"Agar",icon:Mt.Agar,color:"text-pink-400",bgColor:"bg-pink-950/50 border-pink-800"},slant:{label:"Slant",icon:Mt.Agar,color:"text-orange-400",bgColor:"bg-orange-950/50 border-orange-800"},grow:{label:"Grow",icon:Mt.Grow,color:"text-emerald-400",bgColor:"bg-emerald-950/50 border-emerald-800"}},Ms={active:{label:"Active",color:"text-emerald-400",bgColor:"bg-emerald-950/50 border-emerald-800"},colonizing:{label:"Colonizing",color:"text-blue-400",bgColor:"bg-blue-950/50 border-blue-800"},contaminated:{label:"Contaminated",color:"text-red-400",bgColor:"bg-red-950/50 border-red-800"},depleted:{label:"Depleted",color:"text-zinc-500",bgColor:"bg-zinc-900/50 border-zinc-800"},completed:{label:"Completed",color:"text-green-400",bgColor:"bg-green-950/50 border-green-800"},spawning:{label:"Spawning",color:"text-amber-400",bgColor:"bg-amber-950/50 border-amber-800"},colonization:{label:"Colonizing",color:"text-blue-400",bgColor:"bg-blue-950/50 border-blue-800"},fruiting:{label:"Fruiting",color:"text-purple-400",bgColor:"bg-purple-950/50 border-purple-800"},harvesting:{label:"Harvesting",color:"text-green-400",bgColor:"bg-green-950/50 border-green-800"}},Sh=({rating:e})=>{const t=["bg-red-500","bg-orange-500","bg-yellow-500","bg-lime-500","bg-emerald-500"];return r.jsx("div",{className:"flex gap-0.5",children:[1,2,3,4,5].map(s=>r.jsx("div",{className:`w-1.5 h-4 rounded-sm ${s<=e?t[Math.min(e-1,4)]:"bg-zinc-700"}`},s))})},yw=()=>{var x,_;const{state:e,isLoading:t,isConnected:s,activeStrains:n,refreshData:i}=ar(),[a,o]=b.useState("grid"),[l,d]=b.useState(""),[c,p]=b.useState([]),[m,g]=b.useState(null),[f,v]=b.useState(!1);b.useEffect(()=>{const N=w=>{var C;((C=w.detail)==null?void 0:C.page)==="inventory"&&v(!0)};return window.addEventListener("mycolab:create-new",N),()=>window.removeEventListener("mycolab:create-new",N)},[]);const j=b.useMemo(()=>{const N=e.cultures.map(C=>{const y=n.find(G=>G.id===C.strainId),L=Math.floor((Date.now()-new Date(C.createdAt).getTime())/(1e3*60*60*24));return{id:C.id,label:C.label,type:C.type,strainId:C.strainId,strainName:(y==null?void 0:y.name)||"Unknown",status:C.status,createdAt:new Date(C.createdAt),daysOld:L,healthRating:C.healthRating,notes:C.notes,isGrow:!1,original:C}}),w=e.grows.map(C=>{const y=n.find(G=>G.id===C.strainId),L=Math.floor((Date.now()-new Date(C.spawnedAt).getTime())/(1e3*60*60*24));return{id:C.id,label:C.name,type:"grow",strainId:C.strainId,strainName:(y==null?void 0:y.name)||"Unknown",status:C.currentStage,createdAt:new Date(C.createdAt),daysOld:L,notes:C.notes,isGrow:!0,original:C}});return[...N,...w].sort((C,y)=>y.createdAt.getTime()-C.createdAt.getTime())},[e.cultures,e.grows,n]);b.useMemo(()=>[...new Set(j.map(w=>w.strainName))].sort(),[j]);const S=b.useMemo(()=>{let N=j;if(l){const w=l.toLowerCase();N=N.filter(C=>{var y;return C.label.toLowerCase().includes(w)||C.strainName.toLowerCase().includes(w)||((y=C.notes)==null?void 0:y.toLowerCase().includes(w))})}return c.length>0&&(N=N.filter(w=>c.includes(w.type))),N},[j,l,c]),u=b.useMemo(()=>{const N={spore_syringe:0,liquid_culture:0,agar:0,slant:0,grow:0};return j.forEach(w=>{N[w.type]!==void 0&&N[w.type]++}),N},[j]),h=N=>{p(w=>w.includes(N)?w.filter(C=>C!==N):[...w,N])};return t?r.jsx("div",{className:"p-6 flex items-center justify-center h-64",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"w-8 h-8 border-2 border-emerald-500 border-t-transparent rounded-full animate-spin mx-auto mb-3"}),r.jsx("p",{className:"text-zinc-400",children:"Loading inventory..."})]})}):r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"mb-6",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-4",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-xl font-semibold text-white",children:"Lab Inventory"}),r.jsxs("p",{className:"text-sm text-zinc-500",children:[j.length," items  ",s?"Synced with cloud":"Local only"]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("button",{onClick:()=>i(),className:"p-2 rounded-lg text-zinc-400 hover:text-white hover:bg-zinc-800 transition-colors",title:"Refresh",children:r.jsx(Mt.Refresh,{})}),r.jsx("button",{onClick:()=>o("grid"),className:`p-2 rounded-lg transition-colors ${a==="grid"?"bg-zinc-800 text-white":"text-zinc-400 hover:text-white"}`,children:r.jsx(Mt.Grid,{})}),r.jsx("button",{onClick:()=>o("list"),className:`p-2 rounded-lg transition-colors ${a==="list"?"bg-zinc-800 text-white":"text-zinc-400 hover:text-white"}`,children:r.jsx(Mt.List,{})})]})]}),r.jsxs("div",{className:"relative mb-4",children:[r.jsx(Mt.Search,{}),r.jsx("input",{type:"text",placeholder:"Search cultures, grows, strains...",value:l,onChange:N=>d(N.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-zinc-900 border border-zinc-800 rounded-lg text-white placeholder-zinc-500 focus:outline-none focus:border-emerald-500"}),r.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-zinc-500",children:r.jsx(Mt.Search,{})})]}),r.jsx("div",{className:"flex flex-wrap gap-2",children:Object.keys(Ls).map(N=>{const w=Ls[N],C=u[N],y=c.includes(N);return r.jsxs("button",{onClick:()=>h(N),className:`flex items-center gap-2 px-3 py-1.5 rounded-full text-sm border transition-colors ${y?`${w.bgColor} ${w.color}`:"bg-zinc-900 border-zinc-800 text-zinc-400 hover:border-zinc-700"}`,children:[r.jsx(w.icon,{}),r.jsx("span",{children:w.label}),r.jsx("span",{className:`px-1.5 py-0.5 rounded text-xs ${y?"bg-black/20":"bg-zinc-800"}`,children:C})]},N)})})]}),j.length===0&&r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-12 text-center",children:[r.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-zinc-800 flex items-center justify-center",children:r.jsx(Mt.LC,{})}),r.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"No items yet"}),r.jsx("p",{className:"text-zinc-500 mb-6 max-w-md mx-auto",children:"Your lab inventory is empty. Add cultures and start grows to see them here."}),r.jsxs("div",{className:"flex justify-center gap-3",children:[r.jsx("button",{className:"px-4 py-2 bg-emerald-500 hover:bg-emerald-600 text-white rounded-lg text-sm font-medium",children:"Add Culture"}),r.jsx("button",{className:"px-4 py-2 bg-zinc-800 hover:bg-zinc-700 text-white rounded-lg text-sm font-medium border border-zinc-700",children:"Start Grow"})]})]}),a==="grid"&&S.length>0&&r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:S.map(N=>{const w=Ls[N.type],C=Ms[N.status]||Ms.active;return r.jsxs("div",{onClick:()=>g(N),className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-4 hover:border-zinc-700 cursor-pointer transition-colors",children:[r.jsxs("div",{className:"flex items-start justify-between mb-3",children:[r.jsx("div",{className:`p-2 rounded-lg border ${w.bgColor}`,children:r.jsx(w.icon,{})}),N.healthRating&&r.jsx(Sh,{rating:N.healthRating})]}),r.jsx("h4",{className:"font-medium text-white mb-1 truncate",children:N.label}),r.jsx("p",{className:"text-sm text-zinc-500 mb-3",children:N.strainName}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:`px-2 py-0.5 text-xs rounded-full border ${C.bgColor} ${C.color}`,children:C.label}),r.jsxs("span",{className:"text-xs text-zinc-500",children:[N.daysOld,"d old"]})]})]},N.id)})}),a==="list"&&S.length>0&&r.jsx("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl overflow-hidden",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b border-zinc-800",children:[r.jsx("th",{className:"text-left p-4 text-sm font-medium text-zinc-400",children:"Label"}),r.jsx("th",{className:"text-left p-4 text-sm font-medium text-zinc-400 hidden sm:table-cell",children:"Type"}),r.jsx("th",{className:"text-left p-4 text-sm font-medium text-zinc-400",children:"Strain"}),r.jsx("th",{className:"text-left p-4 text-sm font-medium text-zinc-400 hidden md:table-cell",children:"Status"}),r.jsx("th",{className:"text-left p-4 text-sm font-medium text-zinc-400 hidden lg:table-cell",children:"Age"})]})}),r.jsx("tbody",{className:"divide-y divide-zinc-800",children:S.map(N=>{const w=Ls[N.type],C=Ms[N.status]||Ms.active;return r.jsxs("tr",{onClick:()=>g(N),className:"hover:bg-zinc-800/50 cursor-pointer transition-colors",children:[r.jsx("td",{className:"p-4",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:`p-1.5 rounded border ${w.bgColor}`,children:r.jsx(w.icon,{})}),r.jsx("span",{className:"text-white font-medium",children:N.label})]})}),r.jsx("td",{className:"p-4 hidden sm:table-cell",children:r.jsx("span",{className:w.color,children:w.label})}),r.jsx("td",{className:"p-4 text-zinc-300",children:N.strainName}),r.jsx("td",{className:"p-4 hidden md:table-cell",children:r.jsx("span",{className:`px-2 py-0.5 text-xs rounded-full border ${C.bgColor} ${C.color}`,children:C.label})}),r.jsxs("td",{className:"p-4 text-zinc-500 hidden lg:table-cell",children:[N.daysOld," days"]})]},N.id)})})]})}),m&&r.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",onClick:()=>g(null),children:r.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl w-full max-w-lg max-h-[90vh] overflow-y-auto",onClick:N=>N.stopPropagation(),children:[r.jsxs("div",{className:"p-5 border-b border-zinc-800 flex items-center justify-between",children:[r.jsx("h3",{className:"text-lg font-semibold text-white",children:m.label}),r.jsx("button",{onClick:()=>g(null),className:"p-1 text-zinc-400 hover:text-white",children:r.jsx(Mt.X,{})})]}),r.jsxs("div",{className:"p-5 space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-zinc-500 mb-1",children:"Type"}),r.jsx("p",{className:`font-medium ${Ls[m.type].color}`,children:Ls[m.type].label})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-zinc-500 mb-1",children:"Strain"}),r.jsx("p",{className:"text-white font-medium",children:m.strainName})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-zinc-500 mb-1",children:"Status"}),r.jsx("p",{className:((x=Ms[m.status])==null?void 0:x.color)||"text-white",children:((_=Ms[m.status])==null?void 0:_.label)||m.status})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-zinc-500 mb-1",children:"Age"}),r.jsxs("p",{className:"text-white",children:[m.daysOld," days"]})]}),m.healthRating&&r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-zinc-500 mb-1",children:"Health"}),r.jsx(Sh,{rating:m.healthRating})]})]}),m.notes&&r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-zinc-500 mb-1",children:"Notes"}),r.jsx("p",{className:"text-zinc-300",children:m.notes})]}),r.jsxs("div",{className:"pt-4 flex gap-3",children:[r.jsx("button",{className:"flex-1 py-2 bg-emerald-500 hover:bg-emerald-600 text-white rounded-lg font-medium",children:m.isGrow?"View Grow":"View Culture"}),r.jsx("button",{className:"px-4 py-2 bg-zinc-800 hover:bg-zinc-700 text-white rounded-lg border border-zinc-700",children:"Edit"})]})]})]})})]})},Pt={trichoderma:{name:"Trichoderma (Green Mold)",color:"text-green-400",appearance:"Starts white, turns bright green. Aggressive spreader.",commonCauses:["Inadequate sterilization","Bacterial contamination weakening mycelium","Contaminated spawn","Environmental spores during S2B"],timing:"Days 3-14: Sterilization issue. Post-colonization: Environmental.",prevention:["Ensure full colonization before S2B","Proper PC time (90 min at 15 PSI for grain)","Clean spawn-to-bulk technique","Avoid opening during colonization"]},cobweb:{name:"Cobweb Mold",color:"text-gray-400",appearance:"Wispy, gray, cotton-like. Grows extremely fast (faster than mycelium).",commonCauses:["High humidity + poor FAE","Contaminated casing layer","Stagnant air"],timing:"Usually appears during fruiting conditions.",prevention:["Increase FAE","Lower humidity slightly","Pasteurize casing layer","Can be treated with H2O2 spray if caught early"]},black_mold:{name:"Black Mold (Aspergillus niger)",color:"text-zinc-600",appearance:"Black or very dark green/brown spots.",commonCauses:["Severe sterilization failure","Very old or improperly stored grain","Water damage"],timing:"Can appear anytime. Serious contamination.",prevention:["Fresh, dry grains","Proper sterilization","Clean, dry storage"]},penicillium:{name:"Penicillium (Blue-Green Mold)",color:"text-blue-400",appearance:"Blue-green with white edges. Powdery texture.",commonCauses:["Contaminated grain or substrate","Environmental contamination","Improper storage"],timing:"Often early (days 3-7) if from source.",prevention:["Inspect grain before use","Proper sterilization","Clean work area"]},aspergillus:{name:"Aspergillus",color:"text-yellow-400",appearance:"Yellow, green, or brown. Often fuzzy or powdery.",commonCauses:["Present on grain before sterilization","Insufficient PC time","High temperatures"],timing:"Days 3-10 typically.",prevention:["Quality grain source","Full sterilization cycle","Moderate incubation temps"]},bacterial:{name:"Bacterial Contamination",color:"text-orange-400",appearance:"Slimy, wet spots. Often smells sour or foul. Grain looks wet/mushy.",commonCauses:["Grain too wet before PC","Insufficient sterilization","Contaminated water/syringe","Break and shake with wet grain"],timing:"Days 1-4: Very early = bacterial. Precedes other contams.",prevention:["Proper grain hydration (no burst kernels)","Dry grain surface before PC","Sterile water for LC/syringes","Don't B&S if grain looks wet"]},lipstick:{name:"Lipstick Mold (Sporendonema)",color:"text-pink-400",appearance:"Pink or orange-red spots.",commonCauses:["Contaminated grain","Environmental (rare indoors)"],timing:"Usually early to mid colonization.",prevention:["Quality grain","Proper sterilization","Clean storage"]},wet_spot:{name:"Wet Spot (Bacillus)",color:"text-amber-600",appearance:"Wet, slimy grain that doesn't colonize. Smells sour.",commonCauses:["Grain too wet","Bacterial endospores survived PC","Too short PC time"],timing:"Days 1-5. Grain never colonizes properly.",prevention:["Proper grain prep - dry surface","Extended PC time (90-120 min)","Don't overfill jars"]},unknown:{name:"Unknown/Other",color:"text-zinc-400",appearance:"Varies - document carefully for identification.",commonCauses:["Various"],timing:"Document when detected.",prevention:["Identify type for specific prevention"]}},sa={agar:{label:"Agar",color:"text-pink-400"},liquid_culture:{label:"Liquid Culture",color:"text-blue-400"},grain_spawn:{label:"Grain Spawn",color:"text-amber-400"},bulk_colonization:{label:"Bulk Colonization",color:"text-emerald-400"},fruiting:{label:"Fruiting",color:"text-purple-400"}},na={sterilization_failure:{label:"Sterilization Failure",icon:""},inoculation_technique:{label:"Inoculation Technique",icon:""},contaminated_source:{label:"Contaminated Source",icon:""},environmental:{label:"Environmental",icon:""},substrate_issue:{label:"Substrate Issue",icon:""},equipment:{label:"Equipment",icon:""},user_error:{label:"User Error",icon:""},unknown:{label:"Unknown",icon:""}},dr={AlertTriangle:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("path",{d:"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"}),r.jsx("line",{x1:"12",y1:"9",x2:"12",y2:"13"}),r.jsx("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]}),TrendingUp:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("polyline",{points:"23 6 13.5 15.5 8.5 10.5 1 18"}),r.jsx("polyline",{points:"17 6 23 6 23 12"})]}),Book:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("path",{d:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20"}),r.jsx("path",{d:"M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"})]}),Filter:()=>r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:r.jsx("polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"})}),X:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),ChevronDown:()=>r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:r.jsx("polyline",{points:"6 9 12 15 18 9"})}),Info:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),r.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]})},bw=()=>{const{state:e,getStrain:t,getLocation:s}=ar(),[n,i]=b.useState("log"),[a,o]=b.useState(!1),[l,d]=b.useState(null),[c,p]=b.useState("all"),[m,g]=b.useState("all"),f=b.useMemo(()=>{const u=[];return e.cultures.filter(h=>h.status==="contaminated").forEach(h=>{const x=t(h.strainId),_=s(h.locationId||""),N={agar:"agar",slant:"agar",liquid_culture:"liquid_culture",spore_syringe:"liquid_culture",spawn:"grain_spawn"};u.push({id:`culture-${h.id}`,itemId:h.id,itemLabel:h.label,strainName:(x==null?void 0:x.name)||"Unknown",type:"unknown",stage:N[h.type]||"agar",daysSinceInoculation:h.createdAt?Math.floor((Date.now()-new Date(h.createdAt).getTime())/(1e3*60*60*24)):0,suspectedCause:"unknown",notes:h.notes,dateDetected:new Date(h.updatedAt||h.createdAt),locationName:_==null?void 0:_.name})}),e.grows.filter(h=>h.currentStage==="contaminated").forEach(h=>{const x=t(h.strainId),_=s(h.locationId||"");u.push({id:`grow-${h.id}`,itemId:h.id,itemLabel:h.name,strainName:(x==null?void 0:x.name)||"Unknown",type:"unknown",stage:"bulk_colonization",daysSinceInoculation:h.spawnedAt?Math.floor((Date.now()-new Date(h.spawnedAt).getTime())/(1e3*60*60*24)):0,suspectedCause:"unknown",notes:h.notes,dateDetected:new Date(h.createdAt),substrateType:h.substrateTypeId,locationName:_==null?void 0:_.name})}),u},[e.cultures,e.grows,t,s]),v=b.useMemo(()=>{const u=f.length,h=Object.keys(Pt).reduce((H,J)=>(H[J]=f.filter(se=>se.type===J).length,H),{}),x=Object.keys(sa).reduce((H,J)=>(H[J]=f.filter(se=>se.stage===J).length,H),{}),_=Object.keys(na).reduce((H,J)=>(H[J]=f.filter(se=>se.suspectedCause===J).length,H),{}),N=f.filter(H=>H.daysSinceInoculation<=5).length,w=f.filter(H=>H.daysSinceInoculation>5&&H.daysSinceInoculation<=14).length,C=f.filter(H=>H.daysSinceInoculation>14).length,y=f.filter(H=>H.grainType).reduce((H,J)=>(H[J.grainType]=(H[J.grainType]||0)+1,H),{}),L=f.reduce((H,J)=>(H[J.strainName]=(H[J.strainName]||0)+1,H),{}),G=f.length>0?Math.round(f.reduce((H,J)=>H+J.daysSinceInoculation,0)/f.length):0;return{totalEvents:u,byType:h,byStage:x,byCause:_,earlyContam:N,midContam:w,lateContam:C,grainTypes:y,byStrain:L,avgDaysToContam:G}},[f]),j=b.useMemo(()=>f.filter(u=>!(c!=="all"&&u.type!==c||m!=="all"&&u.stage!==m)).sort((u,h)=>h.dateDetected.getTime()-u.dateDetected.getTime()),[f,c,m]),S=(u,h)=>h==="agar"||h==="liquid_culture"?u<=2?"Likely bacterial or contaminated source":u<=5?"Possible inoculation technique issue":"May indicate environmental or storage issue":h==="grain_spawn"?u<=3?"Bacterial - grain too wet or inadequate sterilization":u<=7?"Sterilization failure - PC time/pressure issue":u<=14?"Late sterilization issue or inoculation contam":"Environmental or storage contamination":h==="bulk_colonization"?u<=7?"Contaminated spawn or S2B technique":"Environmental - often from opening too early":"Environmental contamination during fruiting";return r.jsxs("div",{className:"max-w-6xl mx-auto space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold text-white",children:"Contamination Analysis"}),r.jsx("p",{className:"text-zinc-400 text-sm",children:"Track, analyze, and learn from contamination events"})]}),r.jsxs("button",{onClick:()=>o(!0),className:"flex items-center gap-2 px-4 py-2 bg-red-500/20 hover:bg-red-500/30 text-red-400 rounded-lg text-sm font-medium border border-red-500/30 transition-colors",children:[r.jsx(dr.AlertTriangle,{}),"Log Contamination"]})]}),r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-4",children:[r.jsx("p",{className:"text-xs text-zinc-500 mb-1",children:"Total Events"}),r.jsx("p",{className:"text-2xl font-bold text-white",children:v.totalEvents})]}),r.jsxs("div",{className:"bg-red-950/30 border border-red-800/50 rounded-xl p-4",children:[r.jsx("p",{className:"text-xs text-red-400 mb-1",children:"Early (<5 days)"}),r.jsx("p",{className:"text-2xl font-bold text-white",children:v.earlyContam}),r.jsx("p",{className:"text-xs text-zinc-500",children:"Usually bacterial/sterile"})]}),r.jsxs("div",{className:"bg-amber-950/30 border border-amber-800/50 rounded-xl p-4",children:[r.jsx("p",{className:"text-xs text-amber-400 mb-1",children:"Mid (5-14 days)"}),r.jsx("p",{className:"text-2xl font-bold text-white",children:v.midContam}),r.jsx("p",{className:"text-xs text-zinc-500",children:"Often sterilization"})]}),r.jsxs("div",{className:"bg-blue-950/30 border border-blue-800/50 rounded-xl p-4",children:[r.jsx("p",{className:"text-xs text-blue-400 mb-1",children:"Late (>14 days)"}),r.jsx("p",{className:"text-2xl font-bold text-white",children:v.lateContam}),r.jsx("p",{className:"text-xs text-zinc-500",children:"Usually environmental"})]}),r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-4",children:[r.jsx("p",{className:"text-xs text-zinc-500 mb-1",children:"Avg Days to Contam"}),r.jsx("p",{className:"text-2xl font-bold text-white",children:v.avgDaysToContam})]})]}),r.jsx("div",{className:"flex gap-2 border-b border-zinc-800 pb-2",children:[{id:"log",label:"Event Log",icon:dr.AlertTriangle},{id:"analysis",label:"Pattern Analysis",icon:dr.TrendingUp},{id:"knowledge",label:"Knowledge Base",icon:dr.Book}].map(u=>r.jsxs("button",{onClick:()=>i(u.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-colors ${n===u.id?"bg-emerald-500/20 text-emerald-400":"text-zinc-400 hover:text-white hover:bg-zinc-800"}`,children:[r.jsx(u.icon,{}),u.label]},u.id))}),n==="log"&&r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex gap-3 items-center",children:[r.jsx(dr.Filter,{}),r.jsxs("select",{value:c,onChange:u=>p(u.target.value),className:"bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-sm text-white",children:[r.jsx("option",{value:"all",children:"All Types"}),Object.entries(Pt).map(([u,h])=>r.jsx("option",{value:u,children:h.name},u))]}),r.jsxs("select",{value:m,onChange:u=>g(u.target.value),className:"bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-sm text-white",children:[r.jsx("option",{value:"all",children:"All Stages"}),Object.entries(sa).map(([u,h])=>r.jsx("option",{value:u,children:h.label},u))]}),r.jsxs("span",{className:"text-zinc-500 text-sm ml-auto",children:[j.length," events"]})]}),r.jsx("div",{className:"space-y-3",children:j.map(u=>{const h=Pt[u.type],x=sa[u.stage],_=na[u.suspectedCause];return r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-4 hover:border-zinc-700 transition-colors",children:[r.jsxs("div",{className:"flex items-start justify-between mb-3",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 rounded-lg bg-red-950/50 border border-red-800/50 flex items-center justify-center",children:r.jsx(dr.AlertTriangle,{})}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"font-mono font-semibold text-white",children:u.itemLabel}),r.jsx("span",{className:"text-zinc-500",children:""}),r.jsx("span",{className:"text-sm text-zinc-400",children:u.strainName})]}),r.jsx("p",{className:`text-sm font-medium ${h.color}`,children:h.name})]})]}),r.jsxs("div",{className:"text-right",children:[r.jsx("p",{className:"text-sm text-zinc-400",children:u.dateDetected.toLocaleDateString()}),r.jsxs("p",{className:"text-xs text-zinc-500",children:["Day ",u.daysSinceInoculation]})]})]}),r.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[r.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium bg-zinc-800 ${x.color}`,children:x.label}),r.jsxs("span",{className:"px-2 py-1 rounded text-xs font-medium bg-zinc-800 text-zinc-300",children:[_.icon," ",_.label]}),u.grainType&&r.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium bg-zinc-800 text-amber-400",children:u.grainType}),u.pcTime&&r.jsxs("span",{className:"px-2 py-1 rounded text-xs font-medium bg-zinc-800 text-blue-400",children:["PC: ",u.pcTime,"min"]})]}),u.notes&&r.jsx("p",{className:"text-sm text-zinc-400 mb-3",children:u.notes}),r.jsx("div",{className:"pt-3 border-t border-zinc-800",children:r.jsxs("p",{className:"text-xs text-zinc-500 flex items-center gap-1",children:[r.jsx(dr.Info,{}),r.jsx("span",{className:"text-zinc-400",children:S(u.daysSinceInoculation,u.stage)})]})})]},u.id)})})]}),n==="analysis"&&r.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-5",children:[r.jsx("h3",{className:"text-sm font-medium text-zinc-400 mb-4",children:"By Contamination Type"}),r.jsx("div",{className:"space-y-2",children:Object.entries(v.byType).filter(([u,h])=>h>0).sort(([,u],[,h])=>h-u).map(([u,h])=>{const x=Pt[u],_=Math.round(h/v.totalEvents*100);return r.jsx("div",{className:"flex items-center gap-3",children:r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[r.jsx("span",{className:x.color,children:x.name}),r.jsxs("span",{className:"text-zinc-400",children:[h," (",_,"%)"]})]}),r.jsx("div",{className:"h-2 bg-zinc-800 rounded-full overflow-hidden",children:r.jsx("div",{className:"h-full bg-gradient-to-r from-red-500 to-red-600 rounded-full",style:{width:`${_}%`}})})]})},u)})})]}),r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-5",children:[r.jsx("h3",{className:"text-sm font-medium text-zinc-400 mb-4",children:"By Stage"}),r.jsx("div",{className:"space-y-2",children:Object.entries(v.byStage).filter(([u,h])=>h>0).sort(([,u],[,h])=>h-u).map(([u,h])=>{const x=sa[u],_=Math.round(h/v.totalEvents*100);return r.jsx("div",{className:"flex items-center gap-3",children:r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[r.jsx("span",{className:x.color,children:x.label}),r.jsxs("span",{className:"text-zinc-400",children:[h," (",_,"%)"]})]}),r.jsx("div",{className:"h-2 bg-zinc-800 rounded-full overflow-hidden",children:r.jsx("div",{className:"h-full bg-gradient-to-r from-amber-500 to-amber-600 rounded-full",style:{width:`${_}%`}})})]})},u)})})]}),r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-5",children:[r.jsx("h3",{className:"text-sm font-medium text-zinc-400 mb-4",children:"By Suspected Cause"}),r.jsx("div",{className:"space-y-2",children:Object.entries(v.byCause).filter(([u,h])=>h>0).sort(([,u],[,h])=>h-u).map(([u,h])=>{const x=na[u],_=Math.round(h/v.totalEvents*100);return r.jsx("div",{className:"flex items-center gap-3",children:r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[r.jsxs("span",{className:"text-zinc-300",children:[x.icon," ",x.label]}),r.jsxs("span",{className:"text-zinc-400",children:[h," (",_,"%)"]})]}),r.jsx("div",{className:"h-2 bg-zinc-800 rounded-full overflow-hidden",children:r.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 to-blue-600 rounded-full",style:{width:`${_}%`}})})]})},u)})})]}),r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-5",children:[r.jsx("h3",{className:"text-sm font-medium text-zinc-400 mb-4",children:"By Strain"}),r.jsx("div",{className:"space-y-2",children:Object.entries(v.byStrain).sort(([,u],[,h])=>h-u).map(([u,h])=>{const x=Math.round(h/v.totalEvents*100);return r.jsx("div",{className:"flex items-center gap-3",children:r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[r.jsx("span",{className:"text-emerald-400",children:u}),r.jsxs("span",{className:"text-zinc-400",children:[h," (",x,"%)"]})]}),r.jsx("div",{className:"h-2 bg-zinc-800 rounded-full overflow-hidden",children:r.jsx("div",{className:"h-full bg-gradient-to-r from-emerald-500 to-emerald-600 rounded-full",style:{width:`${x}%`}})})]})},u)})})]}),r.jsxs("div",{className:"md:col-span-2 bg-zinc-900/50 border border-zinc-800 rounded-xl p-5",children:[r.jsx("h3",{className:"text-sm font-medium text-zinc-400 mb-4",children:" Key Insights"}),r.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[v.earlyContam>v.lateContam&&r.jsxs("div",{className:"p-4 bg-red-950/30 border border-red-800/50 rounded-lg",children:[r.jsx("p",{className:"text-sm text-red-400 font-medium mb-1",children:"Early Contam Dominant"}),r.jsx("p",{className:"text-xs text-zinc-400",children:"Most contamination occurs early (<5 days). Focus on sterilization and technique."})]}),Object.entries(v.byType).filter(([u,h])=>h>0&&u==="bacterial").length>0&&r.jsxs("div",{className:"p-4 bg-orange-950/30 border border-orange-800/50 rounded-lg",children:[r.jsx("p",{className:"text-sm text-orange-400 font-medium mb-1",children:"Bacterial Issues Present"}),r.jsx("p",{className:"text-xs text-zinc-400",children:"Check grain hydration, PC times, and water sources."})]}),Object.entries(v.byStage).filter(([u,h])=>h>0&&u==="grain_spawn").length>0&&r.jsxs("div",{className:"p-4 bg-amber-950/30 border border-amber-800/50 rounded-lg",children:[r.jsx("p",{className:"text-sm text-amber-400 font-medium mb-1",children:"Grain Spawn Issues"}),r.jsx("p",{className:"text-xs text-zinc-400",children:"Consider longer PC times, drier grain, or different grain type."})]})]})]})]}),n==="knowledge"&&r.jsxs("div",{className:"space-y-4",children:[r.jsx("p",{className:"text-zinc-400 text-sm",children:"Click on a contamination type to learn more about identification and prevention."}),r.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:Object.entries(Pt).map(([u,h])=>r.jsxs("button",{onClick:()=>d(l===u?null:u),className:`text-left p-4 rounded-xl border transition-all ${l===u?"bg-zinc-800 border-zinc-600":"bg-zinc-900/50 border-zinc-800 hover:border-zinc-700"}`,children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("p",{className:`font-medium ${h.color}`,children:h.name}),r.jsx(dr.ChevronDown,{})]}),r.jsx("p",{className:"text-xs text-zinc-500",children:h.appearance})]},u))}),l&&r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-6 animate-fade-in",children:[r.jsxs("div",{className:"flex items-start justify-between mb-4",children:[r.jsx("h3",{className:`text-xl font-semibold ${Pt[l].color}`,children:Pt[l].name}),r.jsx("button",{onClick:()=>d(null),className:"text-zinc-400 hover:text-white",children:r.jsx(dr.X,{})})]}),r.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-zinc-400 mb-2",children:"Appearance"}),r.jsx("p",{className:"text-zinc-300",children:Pt[l].appearance})]}),r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-zinc-400 mb-2",children:"Timing Diagnosis"}),r.jsx("p",{className:"text-zinc-300",children:Pt[l].timing})]}),r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-zinc-400 mb-2",children:"Common Causes"}),r.jsx("ul",{className:"space-y-1",children:Pt[l].commonCauses.map((u,h)=>r.jsxs("li",{className:"text-sm text-zinc-300 flex items-start gap-2",children:[r.jsx("span",{className:"text-red-400 mt-1",children:""}),u]},h))})]}),r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-zinc-400 mb-2",children:"Prevention"}),r.jsx("ul",{className:"space-y-1",children:Pt[l].prevention.map((u,h)=>r.jsxs("li",{className:"text-sm text-zinc-300 flex items-start gap-2",children:[r.jsx("span",{className:"text-emerald-400 mt-1",children:""}),u]},h))})]})]})]})]}),a&&r.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-zinc-900 border border-zinc-700 rounded-xl p-6 max-w-lg w-full mx-4",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-white",children:"Log Contamination Event"}),r.jsx("button",{onClick:()=>o(!1),className:"text-zinc-400 hover:text-white",children:r.jsx(dr.X,{})})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Item"}),r.jsxs("select",{className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white",children:[r.jsx("option",{children:"Select item..."}),e.cultures.filter(u=>u.status!=="contaminated").map(u=>{const h=t(u.strainId);return r.jsxs("option",{value:u.id,children:[u.label," - ",(h==null?void 0:h.name)||"Unknown"]},u.id)}),e.grows.filter(u=>u.currentStage!=="contaminated").map(u=>{const h=t(u.strainId);return r.jsxs("option",{value:u.id,children:[u.name," - ",(h==null?void 0:h.name)||"Unknown"]},u.id)}),e.cultures.length===0&&e.grows.length===0&&r.jsx("option",{disabled:!0,children:"No items available - add cultures or grows first"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Contamination Type"}),r.jsxs("select",{className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white",children:[r.jsx("option",{children:"Select type..."}),Object.entries(Pt).map(([u,h])=>r.jsx("option",{value:u,children:h.name},u))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Suspected Cause"}),r.jsxs("select",{className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white",children:[r.jsx("option",{children:"Select cause..."}),Object.entries(na).map(([u,h])=>r.jsxs("option",{value:u,children:[h.icon," ",h.label]},u))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Days Since Inoculation"}),r.jsx("input",{type:"number",className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white",placeholder:"e.g., 7"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Notes"}),r.jsx("textarea",{className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white h-24",placeholder:"Describe what you observed..."})]})]}),r.jsxs("div",{className:"flex gap-3 mt-6",children:[r.jsx("button",{onClick:()=>o(!1),className:"flex-1 py-2 bg-zinc-800 hover:bg-zinc-700 text-white rounded-lg font-medium border border-zinc-700",children:"Cancel"}),r.jsx("button",{onClick:()=>o(!1),className:"flex-1 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg font-medium",children:"Log Event"})]})]})})]})},$s=e=>e<50?{rating:"poor",color:"text-red-400",label:"Poor"}:e<75?{rating:"below_average",color:"text-orange-400",label:"Below Average"}:e<100?{rating:"average",color:"text-yellow-400",label:"Average"}:e<150?{rating:"good",color:"text-lime-400",label:"Good"}:e<200?{rating:"excellent",color:"text-emerald-400",label:"Excellent"}:{rating:"exceptional",color:"text-cyan-400",label:"Exceptional"},as={Calculator:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("rect",{x:"4",y:"2",width:"16",height:"20",rx:"2"}),r.jsx("line",{x1:"8",y1:"6",x2:"16",y2:"6"}),r.jsx("line",{x1:"8",y1:"10",x2:"8",y2:"10.01"}),r.jsx("line",{x1:"12",y1:"10",x2:"12",y2:"10.01"}),r.jsx("line",{x1:"16",y1:"10",x2:"16",y2:"10.01"}),r.jsx("line",{x1:"8",y1:"14",x2:"8",y2:"14.01"}),r.jsx("line",{x1:"12",y1:"14",x2:"12",y2:"14.01"}),r.jsx("line",{x1:"16",y1:"14",x2:"16",y2:"14.01"})]}),BarChart:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("line",{x1:"18",y1:"20",x2:"18",y2:"10"}),r.jsx("line",{x1:"12",y1:"20",x2:"12",y2:"4"}),r.jsx("line",{x1:"6",y1:"20",x2:"6",y2:"14"})]}),Award:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("circle",{cx:"12",cy:"8",r:"7"}),r.jsx("polyline",{points:"8.21 13.89 7 23 12 20 17 23 15.79 13.88"})]}),Info:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),r.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),History:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("polyline",{points:"12 6 12 12 16 14"})]})},ww=()=>{var u,h,x,_,N,w,C;const{state:e,getStrain:t,getSubstrateType:s}=ar(),[n,i]=b.useState("calculator"),[a,o]=b.useState(""),[l,d]=b.useState(""),[c,p]=b.useState(""),[m,g]=b.useState(null),f=b.useMemo(()=>{const y=[];return e.grows.forEach(L=>{if(!L.flushes||L.flushes.length===0)return;const G=t(L.strainId),H=s(L.substrateTypeId);L.flushes.forEach((J,se)=>{y.push({id:`${L.id}-flush-${se}`,growId:L.id,growLabel:L.name,strainName:(G==null?void 0:G.name)||"Unknown",flushNumber:se+1,freshWeight:J.wetWeight||0,dryWeight:J.dryWeight,drySubstrateWeight:L.substrateWeight||0,harvestDate:new Date(J.harvestDate),substrateType:(H==null?void 0:H.name)||"Unknown",spawnType:L.spawnType||"Unknown"})})}),y},[e.grows,t,s]),v=()=>{const y=parseFloat(a),L=parseFloat(c),G=parseFloat(l);if(isNaN(y)||isNaN(L)||y<=0||L<=0){g(null);return}const H=y/L*100,J=!isNaN(G)&&G>0?G/L*100:void 0,se=$s(H);g({freshBE:Math.round(H*10)/10,dryBE:J?Math.round(J*10)/10:void 0,rating:se.rating,ratingColor:se.color})},j=()=>{o(""),d(""),p(""),g(null)},S=b.useMemo(()=>{const y=new Map;f.forEach(D=>{const $=y.get(D.growId)||[];y.set(D.growId,[...$,D])});const L=Array.from(y.entries()).map(([D,$])=>{const Y=$.reduce((re,pe)=>re+pe.freshWeight,0),le=$.reduce((re,pe)=>re+(pe.dryWeight||0),0),Q=$[0].drySubstrateWeight,O=Y/Q*100,U=le>0?le/Q*100:void 0;return{growId:D,growLabel:$[0].growLabel,strainName:$[0].strainName,substrateType:$[0].substrateType,spawnType:$[0].spawnType,flushCount:$.length,totalFresh:Y,totalDry:le,freshBE:Math.round(O*10)/10,dryBE:U?Math.round(U*10)/10:void 0,rating:$s(O)}}),G=new Map;L.forEach(D=>{const $=G.get(D.strainName)||{totalFresh:0,totalSubstrate:0,count:0},Y=y.get(D.growId);G.set(D.strainName,{totalFresh:$.totalFresh+D.totalFresh,totalSubstrate:$.totalSubstrate+Y[0].drySubstrateWeight,count:$.count+1})});const H=Array.from(G.entries()).map(([D,$])=>({strain:D,avgBE:Math.round($.totalFresh/$.totalSubstrate*1e3)/10,growCount:$.count})).sort((D,$)=>$.avgBE-D.avgBE),J=new Map;L.forEach(D=>{const $=J.get(D.substrateType)||{totalFresh:0,totalSubstrate:0,count:0},Y=y.get(D.growId);J.set(D.substrateType,{totalFresh:$.totalFresh+D.totalFresh,totalSubstrate:$.totalSubstrate+Y[0].drySubstrateWeight,count:$.count+1})});const se=Array.from(J.entries()).map(([D,$])=>({substrate:D,avgBE:Math.round($.totalFresh/$.totalSubstrate*1e3)/10,growCount:$.count})).sort((D,$)=>$.avgBE-D.avgBE),ge=f.reduce((D,$)=>D+$.freshWeight,0),k=L.reduce((D,$)=>{const Y=y.get($.growId);return D+Y[0].drySubstrateWeight},0),M=ge/k*100,oe=L.reduce((D,$)=>$.freshBE>D.freshBE?$:D,L[0]),B=H[0];return{growBEs:L.sort((D,$)=>$.freshBE-D.freshBE),strainBEs:H,substrateBEs:se,overallBE:Math.round(M*10)/10,totalHarvests:f.length,totalGrows:L.length,totalFresh:Math.round(ge),bestGrow:oe,bestStrain:B}},[f]);return r.jsxs("div",{className:"max-w-6xl mx-auto space-y-6",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold text-white",children:"Biological Efficiency"}),r.jsx("p",{className:"text-zinc-400 text-sm",children:"Calculate and track BE% across your grows"})]}),r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-4",children:[r.jsx("p",{className:"text-xs text-zinc-500 mb-1",children:"Overall Avg BE%"}),r.jsxs("p",{className:`text-2xl font-bold ${$s(S.overallBE).color}`,children:[S.overallBE,"%"]})]}),r.jsxs("div",{className:"bg-emerald-950/30 border border-emerald-800/50 rounded-xl p-4",children:[r.jsx("p",{className:"text-xs text-emerald-400 mb-1",children:"Best Grow"}),r.jsxs("p",{className:"text-2xl font-bold text-white",children:[(u=S.bestGrow)==null?void 0:u.freshBE,"%"]}),r.jsx("p",{className:"text-xs text-zinc-500",children:(h=S.bestGrow)==null?void 0:h.growLabel})]}),r.jsxs("div",{className:"bg-blue-950/30 border border-blue-800/50 rounded-xl p-4",children:[r.jsx("p",{className:"text-xs text-blue-400 mb-1",children:"Best Strain"}),r.jsxs("p",{className:"text-2xl font-bold text-white",children:[(x=S.bestStrain)==null?void 0:x.avgBE,"%"]}),r.jsx("p",{className:"text-xs text-zinc-500",children:(_=S.bestStrain)==null?void 0:_.strain})]}),r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-4",children:[r.jsx("p",{className:"text-xs text-zinc-500 mb-1",children:"Total Harvests"}),r.jsx("p",{className:"text-2xl font-bold text-white",children:S.totalHarvests})]}),r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-4",children:[r.jsx("p",{className:"text-xs text-zinc-500 mb-1",children:"Total Yield"}),r.jsxs("p",{className:"text-2xl font-bold text-white",children:[S.totalFresh,"g"]}),r.jsx("p",{className:"text-xs text-zinc-500",children:"fresh weight"})]})]}),r.jsx("div",{className:"flex gap-2 border-b border-zinc-800 pb-2",children:[{id:"calculator",label:"Calculator",icon:as.Calculator},{id:"history",label:"Grow History",icon:as.History},{id:"compare",label:"Compare",icon:as.BarChart}].map(y=>r.jsxs("button",{onClick:()=>i(y.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-colors ${n===y.id?"bg-emerald-500/20 text-emerald-400":"text-zinc-400 hover:text-white hover:bg-zinc-800"}`,children:[r.jsx(y.icon,{}),y.label]},y.id))}),n==="calculator"&&r.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-6",children:[r.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[r.jsx(as.Calculator,{}),"BE Calculator"]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm text-zinc-400 mb-2",children:["Fresh Mushroom Weight (g) ",r.jsx("span",{className:"text-red-400",children:"*"})]}),r.jsx("input",{type:"number",value:a,onChange:y=>o(y.target.value),placeholder:"e.g., 285",className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-4 py-3 text-white text-lg font-mono focus:outline-none focus:border-emerald-500"})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm text-zinc-400 mb-2",children:["Dry Mushroom Weight (g) ",r.jsx("span",{className:"text-zinc-600",children:"(optional)"})]}),r.jsx("input",{type:"number",value:l,onChange:y=>d(y.target.value),placeholder:"e.g., 28",className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-4 py-3 text-white text-lg font-mono focus:outline-none focus:border-emerald-500"}),r.jsx("p",{className:"text-xs text-zinc-600 mt-1",children:"~10% of fresh weight typically"})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm text-zinc-400 mb-2",children:["Dry Substrate Weight (g) ",r.jsx("span",{className:"text-red-400",children:"*"})]}),r.jsx("input",{type:"number",value:c,onChange:y=>p(y.target.value),placeholder:"e.g., 450",className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-4 py-3 text-white text-lg font-mono focus:outline-none focus:border-emerald-500"}),r.jsx("p",{className:"text-xs text-zinc-600 mt-1",children:"Weight of substrate before hydration"})]}),r.jsxs("div",{className:"flex gap-3 pt-2",children:[r.jsx("button",{onClick:v,className:"flex-1 py-3 bg-emerald-500 hover:bg-emerald-600 text-white rounded-lg font-medium transition-colors",children:"Calculate BE%"}),r.jsx("button",{onClick:j,className:"px-4 py-3 bg-zinc-800 hover:bg-zinc-700 text-white rounded-lg font-medium border border-zinc-700 transition-colors",children:"Reset"})]})]})]}),r.jsxs("div",{className:"space-y-6",children:[m?r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-6 animate-fade-in",children:[r.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[r.jsx(as.Award,{}),"Results"]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"bg-zinc-800/50 rounded-lg p-4",children:[r.jsx("p",{className:"text-sm text-zinc-400 mb-1",children:"Fresh Weight BE%"}),r.jsxs("div",{className:"flex items-baseline gap-3",children:[r.jsxs("p",{className:`text-4xl font-bold ${m.ratingColor}`,children:[m.freshBE,"%"]}),r.jsx("span",{className:`px-2 py-1 rounded text-sm font-medium bg-zinc-800 ${m.ratingColor}`,children:$s(m.freshBE).label})]})]}),m.dryBE&&r.jsxs("div",{className:"bg-zinc-800/50 rounded-lg p-4",children:[r.jsx("p",{className:"text-sm text-zinc-400 mb-1",children:"Dry Weight BE%"}),r.jsxs("p",{className:"text-2xl font-bold text-white",children:[m.dryBE,"%"]})]}),r.jsxs("div",{className:"bg-zinc-800/50 rounded-lg p-4",children:[r.jsx("p",{className:"text-xs text-zinc-500 mb-2",children:"BE% Scale"}),r.jsxs("div",{className:"relative h-4 bg-zinc-700 rounded-full overflow-hidden",children:[r.jsxs("div",{className:"absolute inset-0 flex",children:[r.jsx("div",{className:"bg-red-600/50 w-[25%]"}),r.jsx("div",{className:"bg-orange-600/50 w-[12.5%]"}),r.jsx("div",{className:"bg-yellow-600/50 w-[12.5%]"}),r.jsx("div",{className:"bg-lime-600/50 w-[25%]"}),r.jsx("div",{className:"bg-emerald-600/50 w-[25%]"})]}),r.jsx("div",{className:"absolute top-0 bottom-0 w-1 bg-white rounded-full shadow-lg shadow-white/50",style:{left:`${Math.min(m.freshBE/2,100)}%`,transform:"translateX(-50%)"}})]}),r.jsxs("div",{className:"flex justify-between text-xs text-zinc-500 mt-1",children:[r.jsx("span",{children:"0%"}),r.jsx("span",{children:"50%"}),r.jsx("span",{children:"100%"}),r.jsx("span",{children:"150%"}),r.jsx("span",{children:"200%+"})]})]})]})]}):r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 border-dashed rounded-xl p-6 flex flex-col items-center justify-center h-full min-h-[300px]",children:[r.jsx(as.Calculator,{}),r.jsx("p",{className:"text-zinc-500 mt-2",children:"Enter values to calculate BE%"})]}),r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-5",children:[r.jsxs("h3",{className:"text-sm font-medium text-zinc-400 mb-3 flex items-center gap-2",children:[r.jsx(as.Info,{}),"BE% Reference"]}),r.jsxs("div",{className:"space-y-2 text-sm",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-red-400",children:"Poor"}),r.jsx("span",{className:"text-zinc-500",children:"<50%"})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-orange-400",children:"Below Average"}),r.jsx("span",{className:"text-zinc-500",children:"50-75%"})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-yellow-400",children:"Average"}),r.jsx("span",{className:"text-zinc-500",children:"75-100%"})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-lime-400",children:"Good"}),r.jsx("span",{className:"text-zinc-500",children:"100-150%"})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-emerald-400",children:"Excellent"}),r.jsx("span",{className:"text-zinc-500",children:"150-200%"})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-cyan-400",children:"Exceptional"}),r.jsx("span",{className:"text-zinc-500",children:">200%"})]})]}),r.jsx("p",{className:"text-xs text-zinc-600 mt-3",children:"BE% = (Fresh Mushroom Weight / Dry Substrate Weight)  100"})]})]})]}),n==="history"&&r.jsxs("div",{className:"space-y-4",children:[r.jsx("p",{className:"text-zinc-400 text-sm",children:"All recorded grows sorted by BE%"}),r.jsx("div",{className:"space-y-3",children:S.growBEs.map(y=>r.jsx("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-4 hover:border-zinc-700 transition-colors",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsxs("div",{className:`w-14 h-14 rounded-lg flex items-center justify-center text-2xl font-bold ${y.rating.color} bg-zinc-800`,children:[y.freshBE,"%"]}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"font-mono font-semibold text-white",children:y.growLabel}),r.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium bg-zinc-800 ${y.rating.color}`,children:y.rating.label})]}),r.jsx("p",{className:"text-sm text-emerald-400",children:y.strainName}),r.jsxs("p",{className:"text-xs text-zinc-500",children:[y.substrateType,"  ",y.spawnType,"  ",y.flushCount," flush",y.flushCount>1?"es":""]})]})]}),r.jsxs("div",{className:"text-right",children:[r.jsxs("p",{className:"text-lg font-semibold text-white",children:[y.totalFresh,"g"]}),r.jsx("p",{className:"text-xs text-zinc-500",children:"fresh total"}),y.dryBE&&r.jsxs("p",{className:"text-xs text-zinc-400 mt-1",children:["Dry: ",y.dryBE,"%"]})]})]})},y.growId))})]}),n==="compare"&&r.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-5",children:[r.jsx("h3",{className:"text-sm font-medium text-zinc-400 mb-4",children:"Average BE% by Strain"}),r.jsx("div",{className:"space-y-3",children:S.strainBEs.map((y,L)=>r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-6 text-right",children:r.jsx("span",{className:`text-sm font-medium ${L===0?"text-amber-400":"text-zinc-500"}`,children:L===0?"":`#${L+1}`})}),r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[r.jsx("span",{className:"text-white",children:y.strain}),r.jsxs("span",{className:$s(y.avgBE).color,children:[y.avgBE,"%"]})]}),r.jsx("div",{className:"h-2 bg-zinc-800 rounded-full overflow-hidden",children:r.jsx("div",{className:`h-full rounded-full ${L===0?"bg-gradient-to-r from-amber-500 to-amber-400":"bg-gradient-to-r from-emerald-600 to-emerald-500"}`,style:{width:`${Math.min(y.avgBE/2,100)}%`}})}),r.jsxs("p",{className:"text-xs text-zinc-600 mt-1",children:[y.growCount," grow",y.growCount>1?"s":""]})]})]},y.strain))})]}),r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-5",children:[r.jsx("h3",{className:"text-sm font-medium text-zinc-400 mb-4",children:"Average BE% by Substrate"}),r.jsx("div",{className:"space-y-3",children:S.substrateBEs.map((y,L)=>r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-6 text-right",children:r.jsx("span",{className:`text-sm font-medium ${L===0?"text-amber-400":"text-zinc-500"}`,children:L===0?"":`#${L+1}`})}),r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[r.jsx("span",{className:"text-white",children:y.substrate}),r.jsxs("span",{className:$s(y.avgBE).color,children:[y.avgBE,"%"]})]}),r.jsx("div",{className:"h-2 bg-zinc-800 rounded-full overflow-hidden",children:r.jsx("div",{className:`h-full rounded-full ${L===0?"bg-gradient-to-r from-blue-500 to-blue-400":"bg-gradient-to-r from-teal-600 to-teal-500"}`,style:{width:`${Math.min(y.avgBE/2,100)}%`}})}),r.jsxs("p",{className:"text-xs text-zinc-600 mt-1",children:[y.growCount," grow",y.growCount>1?"s":""]})]})]},y.substrate))})]}),r.jsxs("div",{className:"md:col-span-2 bg-zinc-900/50 border border-zinc-800 rounded-xl p-5",children:[r.jsx("h3",{className:"text-sm font-medium text-zinc-400 mb-4",children:" Insights"}),r.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[r.jsxs("div",{className:"p-4 bg-emerald-950/30 border border-emerald-800/50 rounded-lg",children:[r.jsx("p",{className:"text-sm text-emerald-400 font-medium mb-1",children:"Top Performer"}),r.jsx("p",{className:"text-lg font-bold text-white",children:(N=S.bestStrain)==null?void 0:N.strain}),r.jsxs("p",{className:"text-xs text-zinc-400",children:["Averaging ",(w=S.bestStrain)==null?void 0:w.avgBE,"% BE across ",(C=S.bestStrain)==null?void 0:C.growCount," grow(s)"]})]}),S.substrateBEs.length>1&&r.jsxs("div",{className:"p-4 bg-blue-950/30 border border-blue-800/50 rounded-lg",children:[r.jsx("p",{className:"text-sm text-blue-400 font-medium mb-1",children:"Best Substrate"}),r.jsx("p",{className:"text-lg font-bold text-white",children:S.substrateBEs[0].substrate}),r.jsxs("p",{className:"text-xs text-zinc-400",children:[Math.round(S.substrateBEs[0].avgBE-S.substrateBEs[S.substrateBEs.length-1].avgBE),"% better than lowest"]})]}),r.jsxs("div",{className:"p-4 bg-zinc-800/50 border border-zinc-700 rounded-lg",children:[r.jsx("p",{className:"text-sm text-zinc-400 font-medium mb-1",children:"Total Production"}),r.jsxs("p",{className:"text-lg font-bold text-white",children:[S.totalFresh,"g fresh"]}),r.jsxs("p",{className:"text-xs text-zinc-400",children:["From ",S.totalGrows," grows, ",S.totalHarvests," harvests"]})]})]})]})]})]})},jw=e=>{const t=["#10b981","#8b5cf6","#f59e0b","#3b82f6","#ec4899","#14b8a6","#f97316","#6366f1"];let s=0;for(let n=0;n<e.length;n++)s=e.charCodeAt(n)+((s<<5)-s);return t[Math.abs(s)%t.length]},Tr={TrendingUp:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5",children:[r.jsx("polyline",{points:"23 6 13.5 15.5 8.5 10.5 1 18"}),r.jsx("polyline",{points:"17 6 23 6 23 12"})]}),BarChart:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5",children:[r.jsx("line",{x1:"18",y1:"20",x2:"18",y2:"10"}),r.jsx("line",{x1:"12",y1:"20",x2:"12",y2:"4"}),r.jsx("line",{x1:"6",y1:"20",x2:"6",y2:"14"})]}),PieChart:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5",children:[r.jsx("path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83"}),r.jsx("path",{d:"M22 12A10 10 0 0 0 12 2v10z"})]}),Activity:()=>r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5",children:r.jsx("polyline",{points:"22 12 18 12 15 21 9 3 6 12 2 12"})}),Calendar:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5",children:[r.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),r.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),r.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),r.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),Award:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5",children:[r.jsx("circle",{cx:"12",cy:"8",r:"7"}),r.jsx("polyline",{points:"8.21 13.89 7 23 12 20 17 23 15.79 13.88"})]}),Target:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("circle",{cx:"12",cy:"12",r:"6"}),r.jsx("circle",{cx:"12",cy:"12",r:"2"})]}),Zap:()=>r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5",children:r.jsx("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"})})},cl=({data:e,maxValue:t,showValues:s=!0,height:n=200})=>{const i=t||Math.max(...e.map(a=>a.value));return r.jsx("div",{className:"flex items-end justify-between gap-2",style:{height:n},children:e.map((a,o)=>{const l=i>0?a.value/i*100:0;return r.jsxs("div",{className:"flex-1 flex flex-col items-center gap-2",children:[r.jsxs("div",{className:"w-full flex flex-col items-center justify-end",style:{height:n-40},children:[s&&a.value>0&&r.jsx("span",{className:"text-xs text-zinc-400 mb-1",children:a.value}),r.jsx("div",{className:"w-full rounded-t-md transition-all duration-500 hover:opacity-80",style:{height:`${l}%`,backgroundColor:a.color||"#10b981",minHeight:a.value>0?4:0}})]}),r.jsx("span",{className:"text-xs text-zinc-500 truncate max-w-full",children:a.label})]},o)})})},Sw=({data:e,size:t=160,thickness:s=24})=>{const n=e.reduce((l,d)=>l+d.value,0),i=(t-s)/2,a=2*Math.PI*i;let o=0;return r.jsxs("div",{className:"relative",style:{width:t,height:t},children:[r.jsx("svg",{width:t,height:t,className:"transform -rotate-90",children:e.map((l,d)=>{const p=(n>0?l.value/n:0)*a,m=o;return o+=p,r.jsx("circle",{cx:t/2,cy:t/2,r:i,fill:"none",stroke:l.color,strokeWidth:s,strokeDasharray:`${p} ${a-p}`,strokeDashoffset:-m,className:"transition-all duration-500"},d)})}),r.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[r.jsx("span",{className:"text-2xl font-bold text-white",children:n}),r.jsx("span",{className:"text-xs text-zinc-500",children:"Total"})]})]})},Nw=({data:e,color:t="#10b981",height:s=40,width:n=100})=>{if(e.length===0)return null;const i=Math.max(...e),a=Math.min(...e),o=i-a||1,l=e.map((d,c)=>{const p=c/(e.length-1)*n,m=s-(d-a)/o*s;return`${p},${m}`}).join(" ");return r.jsxs("svg",{width:n,height:s,className:"overflow-visible",children:[r.jsx("polyline",{points:l,fill:"none",stroke:t,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),r.jsx("circle",{cx:(e.length-1)/(e.length-1)*n,cy:s-(e[e.length-1]-a)/o*s,r:"3",fill:t})]})},Nh=({value:e,max:t,size:s=80,strokeWidth:n=8,color:i="#10b981",label:a})=>{const o=(s-n)/2,l=2*Math.PI*o,d=t>0?Math.min(e/t,1):0,c=l-d*l;return r.jsxs("div",{className:"relative",style:{width:s,height:s},children:[r.jsxs("svg",{width:s,height:s,className:"transform -rotate-90",children:[r.jsx("circle",{cx:s/2,cy:s/2,r:o,fill:"none",stroke:"#27272a",strokeWidth:n}),r.jsx("circle",{cx:s/2,cy:s/2,r:o,fill:"none",stroke:i,strokeWidth:n,strokeDasharray:l,strokeDashoffset:c,strokeLinecap:"round",className:"transition-all duration-700"})]}),r.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[r.jsxs("span",{className:"text-lg font-bold text-white",children:[Math.round(d*100),"%"]}),a&&r.jsx("span",{className:"text-xs text-zinc-500",children:a})]})]})},kw=({data:e,months:t=3})=>{const s=new Date,n=new Date(s);n.setMonth(n.getMonth()-t);const i=[];let a=[];const o=new Date(n);for(o.setDate(o.getDate()-o.getDay());o<=s;){const c=e.find(p=>p.date.toDateString()===o.toDateString());a.push({date:new Date(o),value:(c==null?void 0:c.value)||0}),a.length===7&&(i.push(a),a=[]),o.setDate(o.getDate()+1)}a.length>0&&i.push(a);const l=Math.max(...e.map(c=>c.value),1),d=c=>{if(c===0)return"bg-zinc-800";const p=c/l;return p<.25?"bg-emerald-900/50":p<.5?"bg-emerald-700/60":p<.75?"bg-emerald-500/70":"bg-emerald-400"};return r.jsx("div",{className:"flex gap-1",children:i.map((c,p)=>r.jsx("div",{className:"flex flex-col gap-1",children:c.map((m,g)=>r.jsx("div",{className:`w-3 h-3 rounded-sm ${d(m.value)} transition-colors hover:ring-1 hover:ring-white/30`,title:`${m.date.toLocaleDateString()}: ${m.value}g`},g))},p))})},kh=({data:e,unit:t="",maxValue:s})=>{const n=s||Math.max(...e.map(i=>i.value));return r.jsx("div",{className:"space-y-3",children:e.map((i,a)=>{const o=n>0?i.value/n*100:0;return r.jsxs("div",{children:[r.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("span",{className:"text-zinc-400 w-4",children:[a+1,"."]}),r.jsx("span",{className:"text-white",children:i.label})]}),r.jsxs("span",{className:"text-zinc-400",children:[i.value,t]})]}),r.jsx("div",{className:"h-2 bg-zinc-800 rounded-full overflow-hidden",children:r.jsx("div",{className:"h-full rounded-full transition-all duration-500",style:{width:`${o}%`,backgroundColor:i.color||"#10b981"}})}),i.subLabel&&r.jsx("p",{className:"text-xs text-zinc-600 mt-1",children:i.subLabel})]},a)})})},_w=()=>{const{state:e,getStrain:t,getSubstrateType:s,getLocation:n}=ar(),[i,a]=b.useState("90d"),[o,l]=b.useState("all"),d=b.useMemo(()=>e.grows.map(m=>{var u;const g=t(m.strainId),f=s(m.substrateTypeId),v=n(m.locationId||"");let S={active:"active",paused:"active",completed:"completed",failed:"contaminated"}[m.status]||"active";return m.currentStage==="contaminated"&&(S="contaminated"),m.currentStage==="aborted"&&(S="aborted"),m.currentStage==="completed"&&(S="completed"),{id:m.id,strain:(g==null?void 0:g.name)||"Unknown",substrate:(f==null?void 0:f.name)||"Unknown",spawnType:m.spawnType||"Unknown",startDate:new Date(m.spawnedAt),endDate:m.completedAt?new Date(m.completedAt):void 0,status:S,totalYield:m.totalYield||0,flushCount:((u=m.flushes)==null?void 0:u.length)||0,drySubstrateWeight:m.substrateWeight||0,cost:m.estimatedCost||0,location:(v==null?void 0:v.name)||"Unknown"}}),[e.grows,t,s,n]),c=b.useMemo(()=>{const m=new Date,g=new Date;switch(i){case"30d":g.setDate(m.getDate()-30);break;case"90d":g.setDate(m.getDate()-90);break;case"1y":g.setFullYear(m.getFullYear()-1);break;default:g.setFullYear(2e3)}let f=d.filter(k=>k.startDate>=g);o!=="all"&&(f=f.filter(k=>k.strain===o));const v=f.filter(k=>k.status==="completed"),j=f.filter(k=>k.status==="contaminated"),S=f.filter(k=>k.status==="active"),u=v.reduce((k,M)=>k+M.totalYield,0),h=f.reduce((k,M)=>k+M.cost,0),x=v.length>0?v.reduce((k,M)=>k+M.totalYield/M.drySubstrateWeight*100,0)/v.length:0,_=f.length>0?v.length/(v.length+j.length)*100:0,N=u>0?h/u:0,w=new Map;v.forEach(k=>{const M=w.get(k.strain)||[];w.set(k.strain,[...M,k])});const C=Array.from(w.entries()).map(([k,M])=>{const oe=M.reduce(($,Y)=>$+Y.totalYield,0),B=M.reduce(($,Y)=>$+Y.drySubstrateWeight,0),D=M.reduce(($,Y)=>Y.endDate?$+Math.floor((Y.endDate.getTime()-Y.startDate.getTime())/(1e3*60*60*24)):$,0)/M.length;return{strain:k,avgBE:Math.round(oe/B*100),totalYield:oe,growCount:M.length,successRate:100,avgDaysToHarvest:Math.round(D),color:jw(k)}}).sort((k,M)=>M.avgBE-k.avgBE),y=new Map;f.forEach(k=>{const M=`${k.startDate.getFullYear()}-${String(k.startDate.getMonth()+1).padStart(2,"0")}`,oe=y.get(M)||{yields:0,grows:0,contaminations:0,substrates:0};y.set(M,{yields:oe.yields+k.totalYield,grows:oe.grows+1,contaminations:oe.contaminations+(k.status==="contaminated"?1:0),substrates:oe.substrates+k.drySubstrateWeight})});const L=Array.from(y.entries()).sort(([k],[M])=>k.localeCompare(M)).map(([k,M])=>({month:new Date(k+"-01").toLocaleDateString("en-US",{month:"short"}),yields:M.yields,grows:M.grows,contaminations:M.contaminations,successRate:M.grows>0?Math.round((M.grows-M.contaminations)/M.grows*100):0,avgBE:M.substrates>0?Math.round(M.yields/M.substrates*100):0})),G=new Map;v.forEach(k=>{const M=G.get(k.substrate)||{totalYield:0,totalSubstrate:0,count:0};G.set(k.substrate,{totalYield:M.totalYield+k.totalYield,totalSubstrate:M.totalSubstrate+k.drySubstrateWeight,count:M.count+1})});const H=Array.from(G.entries()).map(([k,M])=>({label:k,value:Math.round(M.totalYield/M.totalSubstrate*100),subLabel:`${M.count} grow${M.count>1?"s":""}`,color:k==="CVG"?"#10b981":k==="Masters Mix"?"#3b82f6":"#f59e0b"})).sort((k,M)=>M.value-k.value),J=[{label:"Completed",value:v.length,color:"#10b981"},{label:"Active",value:S.length,color:"#3b82f6"},{label:"Contaminated",value:j.length,color:"#ef4444"}].filter(k=>k.value>0),se=v.filter(k=>k.endDate).map(k=>({date:k.endDate,value:k.totalYield})),ge=L.slice(-6).map(k=>k.yields);return{totalGrows:f.length,completedGrows:v.length,activeGrows:S.length,contaminatedGrows:j.length,totalYield:u,totalCost:h,avgBE:Math.round(x),successRate:Math.round(_),costPerGram:Math.round(N*100)/100,strainPerformance:C,monthlyData:L,substratePerformance:H,statusDistribution:J,harvestData:se,yieldTrend:ge}},[d,i,o]),p=[...new Set(d.map(m=>m.strain))];return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold text-white",children:"Analytics"}),r.jsx("p",{className:"text-zinc-400 text-sm",children:"Performance insights and data visualization"})]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsxs("select",{value:o,onChange:m=>l(m.target.value),className:"bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-sm text-white focus:outline-none focus:border-emerald-500",children:[r.jsx("option",{value:"all",children:"All Strains"}),p.map(m=>r.jsx("option",{value:m,children:m},m))]}),r.jsx("div",{className:"flex bg-zinc-800 rounded-lg border border-zinc-700 overflow-hidden",children:["30d","90d","1y","all"].map(m=>r.jsx("button",{onClick:()=>a(m),className:`px-3 py-2 text-sm font-medium transition-colors ${i===m?"bg-emerald-500/20 text-emerald-400":"text-zinc-400 hover:text-white hover:bg-zinc-700"}`,children:m==="all"?"All Time":m.toUpperCase()},m))})]})]}),r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:[r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-4",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("span",{className:"text-xs text-zinc-500",children:"Total Yield"}),r.jsx(Tr.TrendingUp,{})]}),r.jsxs("p",{className:"text-2xl font-bold text-white",children:[c.totalYield.toLocaleString(),"g"]}),r.jsx(Nw,{data:c.yieldTrend,height:30,width:80})]}),r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-4",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("span",{className:"text-xs text-zinc-500",children:"Avg BE%"}),r.jsx(Tr.Target,{})]}),r.jsxs("p",{className:"text-2xl font-bold text-emerald-400",children:[c.avgBE,"%"]}),r.jsx("p",{className:"text-xs text-zinc-500 mt-1",children:c.avgBE>=100?" Above average":"Room to improve"})]}),r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-4",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("span",{className:"text-xs text-zinc-500",children:"Success Rate"}),r.jsx(Tr.Award,{})]}),r.jsxs("p",{className:`text-2xl font-bold ${c.successRate>=80?"text-emerald-400":c.successRate>=60?"text-yellow-400":"text-red-400"}`,children:[c.successRate,"%"]}),r.jsxs("p",{className:"text-xs text-zinc-500 mt-1",children:[c.completedGrows,"/",c.completedGrows+c.contaminatedGrows," completed"]})]}),r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-4",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("span",{className:"text-xs text-zinc-500",children:"Cost/Gram"}),r.jsx(Tr.Zap,{})]}),r.jsxs("p",{className:"text-2xl font-bold text-white",children:["$",c.costPerGram]}),r.jsxs("p",{className:"text-xs text-zinc-500 mt-1",children:["$",c.totalCost," total invested"]})]}),r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-4",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("span",{className:"text-xs text-zinc-500",children:"Active Grows"}),r.jsx(Tr.Activity,{})]}),r.jsx("p",{className:"text-2xl font-bold text-blue-400",children:c.activeGrows}),r.jsx("p",{className:"text-xs text-zinc-500 mt-1",children:"In progress"})]}),r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-4",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("span",{className:"text-xs text-zinc-500",children:"Total Grows"}),r.jsx(Tr.Calendar,{})]}),r.jsx("p",{className:"text-2xl font-bold text-white",children:c.totalGrows}),r.jsxs("p",{className:"text-xs text-zinc-500 mt-1",children:[c.contaminatedGrows," contaminated"]})]})]}),r.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[r.jsxs("div",{className:"md:col-span-2 bg-zinc-900/50 border border-zinc-800 rounded-xl p-5",children:[r.jsxs("h3",{className:"text-sm font-medium text-zinc-400 mb-4 flex items-center gap-2",children:[r.jsx(Tr.BarChart,{}),"Monthly Yields (g)"]}),r.jsx(cl,{data:c.monthlyData.map(m=>({label:m.month,value:m.yields,color:"#10b981"})),height:180})]}),r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-5",children:[r.jsxs("h3",{className:"text-sm font-medium text-zinc-400 mb-4 flex items-center gap-2",children:[r.jsx(Tr.PieChart,{}),"Grow Status"]}),r.jsx("div",{className:"flex items-center justify-center",children:r.jsx(Sw,{data:c.statusDistribution})}),r.jsx("div",{className:"flex justify-center gap-4 mt-4",children:c.statusDistribution.map(m=>r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:m.color}}),r.jsx("span",{className:"text-xs text-zinc-400",children:m.label})]},m.label))})]})]}),r.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-5",children:[r.jsx("h3",{className:"text-sm font-medium text-zinc-400 mb-4",children:"Strain Performance (BE%)"}),r.jsx(kh,{data:c.strainPerformance.map(m=>({label:m.strain,value:m.avgBE,subLabel:`${m.growCount} grow${m.growCount>1?"s":""}  ${m.totalYield}g total`,color:m.color})),unit:"%"})]}),r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-5",children:[r.jsx("h3",{className:"text-sm font-medium text-zinc-400 mb-4",children:"Substrate Performance (BE%)"}),r.jsx(kh,{data:c.substratePerformance,unit:"%"})]})]}),r.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-5",children:[r.jsx("h3",{className:"text-sm font-medium text-zinc-400 mb-4",children:"Monthly Avg BE%"}),r.jsx(cl,{data:c.monthlyData.map(m=>({label:m.month,value:m.avgBE,color:m.avgBE>=100?"#10b981":m.avgBE>=75?"#f59e0b":"#ef4444"})),height:140})]}),r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-5",children:[r.jsx("h3",{className:"text-sm font-medium text-zinc-400 mb-4",children:"Monthly Success Rate"}),r.jsx(cl,{data:c.monthlyData.map(m=>({label:m.month,value:m.successRate,color:m.successRate>=80?"#10b981":m.successRate>=60?"#f59e0b":"#ef4444"})),maxValue:100,height:140})]}),r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-5",children:[r.jsx("h3",{className:"text-sm font-medium text-zinc-400 mb-4",children:"Performance Goals"}),r.jsxs("div",{className:"flex flex-wrap justify-center gap-4",children:[r.jsx(Nh,{value:c.avgBE,max:150,color:"#10b981",label:"BE%"}),r.jsx(Nh,{value:c.successRate,max:100,color:"#3b82f6",label:"Success"})]})]})]}),r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-5",children:[r.jsx("h3",{className:"text-sm font-medium text-zinc-400 mb-4",children:"Harvest Activity (Last 3 Months)"}),r.jsxs("div",{className:"flex items-start gap-4",children:[r.jsx(kw,{data:c.harvestData,months:3}),r.jsxs("div",{className:"flex flex-col gap-1 text-xs text-zinc-500",children:[r.jsx("span",{children:"More harvests "}),r.jsxs("div",{className:"flex gap-1",children:[r.jsx("div",{className:"w-3 h-3 rounded-sm bg-zinc-800"}),r.jsx("div",{className:"w-3 h-3 rounded-sm bg-emerald-900/50"}),r.jsx("div",{className:"w-3 h-3 rounded-sm bg-emerald-700/60"}),r.jsx("div",{className:"w-3 h-3 rounded-sm bg-emerald-500/70"}),r.jsx("div",{className:"w-3 h-3 rounded-sm bg-emerald-400"})]})]})]})]}),r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-5",children:[r.jsx("h3",{className:"text-sm font-medium text-zinc-400 mb-4",children:" Key Insights"}),r.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[c.strainPerformance[0]&&r.jsxs("div",{className:"p-4 bg-emerald-950/30 border border-emerald-800/50 rounded-lg",children:[r.jsx("p",{className:"text-sm text-emerald-400 font-medium mb-1",children:"Top Performing Strain"}),r.jsx("p",{className:"text-lg font-bold text-white",children:c.strainPerformance[0].strain}),r.jsxs("p",{className:"text-xs text-zinc-400",children:[c.strainPerformance[0].avgBE,"% BE average"]})]}),c.substratePerformance[0]&&r.jsxs("div",{className:"p-4 bg-blue-950/30 border border-blue-800/50 rounded-lg",children:[r.jsx("p",{className:"text-sm text-blue-400 font-medium mb-1",children:"Best Substrate"}),r.jsx("p",{className:"text-lg font-bold text-white",children:c.substratePerformance[0].label}),r.jsxs("p",{className:"text-xs text-zinc-400",children:[c.substratePerformance[0].value,"% BE average"]})]}),r.jsxs("div",{className:"p-4 bg-zinc-800/50 border border-zinc-700 rounded-lg",children:[r.jsx("p",{className:"text-sm text-zinc-400 font-medium mb-1",children:"Efficiency Score"}),r.jsx("p",{className:"text-lg font-bold text-white",children:c.costPerGram>0?`$${c.costPerGram}/g`:"N/A"}),r.jsx("p",{className:"text-xs text-zinc-400",children:c.costPerGram<.05?"Excellent efficiency!":c.costPerGram<.1?"Good efficiency":"Room to optimize"})]})]})]})]})},Se={Plus:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),X:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),Edit:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),r.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),Trash:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("polyline",{points:"3 6 5 6 21 6"}),r.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]}),Cloud:()=>r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5",children:r.jsx("path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z"})}),CloudOff:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5",children:[r.jsx("path",{d:"m2 2 20 20"}),r.jsx("path",{d:"M5.782 5.782A7 7 0 0 0 9 19h8.5a4.5 4.5 0 0 0 1.307-.193"})]}),Refresh:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("polyline",{points:"23 4 23 10 17 10"}),r.jsx("path",{d:"M20.49 15a9 9 0 1 1-2.12-9.36L23 10"})]}),Copy:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),r.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]}),AlertCircle:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),r.jsx("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),CheckCircle:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"m9 12 2 2 4-4"})]}),XCircle:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),r.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]}),Table:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("line",{x1:"3",y1:"9",x2:"21",y2:"9"}),r.jsx("line",{x1:"3",y1:"15",x2:"21",y2:"15"}),r.jsx("line",{x1:"9",y1:"3",x2:"9",y2:"21"})]})},ia={database:{label:"Database",icon:""},species:{label:"Species",icon:""},strains:{label:"Strains",icon:""},locations:{label:"Locations",icon:""},vessels:{label:"Vessels",icon:""},containers:{label:"Containers",icon:""},substrates:{label:"Substrates",icon:""},suppliers:{label:"Suppliers",icon:""},categories:{label:"Categories",icon:""},preferences:{label:"Preferences",icon:""}},Cw=["species","strains","locations","vessels","container_types","substrate_types","suppliers","inventory_categories","inventory_items","cultures","culture_observations","culture_transfers","grows","grow_observations","flushes","recipes","recipe_ingredients"],zw=()=>{const{state:e,isConnected:t,refreshData:s,updateSettings:n,addSpecies:i,updateSpecies:a,deleteSpecies:o,addStrain:l,updateStrain:d,deleteStrain:c,addLocation:p,updateLocation:m,deleteLocation:g,addSupplier:f,updateSupplier:v,deleteSupplier:j,addVessel:S,updateVessel:u,deleteVessel:h,addContainerType:x,updateContainerType:_,deleteContainerType:N,addSubstrateType:w,updateSubstrateType:C,deleteSubstrateType:y,addInventoryCategory:L,updateInventoryCategory:G,deleteInventoryCategory:H}=ar(),[J,se]=b.useState("database"),[ge,k]=b.useState(!1),[M,oe]=b.useState(null),[B,D]=b.useState(!1),[$,Y]=b.useState(null),[le,Q]=b.useState(null),[O,U]=b.useState(()=>localStorage.getItem("mycolab-supabase-url")||""),[re,pe]=b.useState(()=>localStorage.getItem("mycolab-supabase-key")||""),[Be,or]=b.useState(!1),[dt,Vt]=b.useState([]),[Er,ee]=b.useState(!1),[R,ue]=b.useState({}),[lr,wt]=b.useState(e.settings);b.useEffect(()=>{wt(e.settings)},[e.settings]),b.useEffect(()=>{if(le){const P=setTimeout(()=>Q(null),3e3);return()=>clearTimeout(P)}},[le]),b.useEffect(()=>{if($){const P=setTimeout(()=>Y(null),8e3);return()=>clearTimeout(P)}},[$]);const[Dt,jt]=b.useState(null),St=async()=>{if(!O||!re){Y("Please enter both URL and API key");return}or(!0),Y(null),Vt([]),jt(null);try{const P=io(O,re),ie=[];for(const De of Cw)try{const{count:st,error:ht}=await P.from(De).select("*",{count:"exact",head:!0});ht?ie.push({name:De,exists:!1,rowCount:0,error:ht.message}):ie.push({name:De,exists:!0,rowCount:st||0})}catch(st){ie.push({name:De,exists:!1,rowCount:0,error:st.message})}Vt(ie);const he=ie.filter(De=>De.exists),K=ie.filter(De=>!De.exists);he.length===0?Y("Connected but no tables found. Please run the schema SQL in Supabase SQL Editor."):(localStorage.setItem("mycolab-supabase-url",O),localStorage.setItem("mycolab-supabase-key",re),localStorage.setItem("mycolab-last-sync",new Date().toISOString()),K.length>0?Q(`Connected! Found ${he.length} tables. ${K.length} tables missing.`):Q(`Connected! All ${he.length} tables found.`),await s())}catch(P){Y(`Connection failed: ${P.message}`)}finally{or(!1)}},We=async()=>{if(!O||!re){Y("Connect to database first");return}jt(null);try{const P=io(O,re),ie=`__test_${Date.now()}`,{data:he,error:K}=await P.from("strains").insert({name:ie,species:"Test Species"}).select().single();if(K){jt({success:!1,message:`Write failed: ${K.message}. Make sure you've run the RLS policies from the schema SQL.`});return}he!=null&&he.id&&await P.from("strains").delete().eq("id",he.id),jt({success:!0,message:"Write permissions confirmed! Database is ready for use."})}catch(P){jt({success:!1,message:`Write test error: ${P.message}`})}},ut=()=>{localStorage.removeItem("mycolab-supabase-url"),localStorage.removeItem("mycolab-supabase-key"),localStorage.removeItem("mycolab-last-sync"),U(""),pe(""),Vt([]),Q("Credentials cleared")},_e=async()=>{try{const ie=await(await fetch("/supabase-schema.sql")).text();await navigator.clipboard.writeText(ie),ee(!0),setTimeout(()=>ee(!1),2e3)}catch{Y("Could not copy schema. Please download the file manually.")}},Oe=P=>{oe(null),ue(T(P)),k(!0)},Gt=P=>{oe(P),ue(V(P,J)),k(!0)},T=P=>{switch(P){case"species":return{name:"",scientificName:"",category:"gourmet",notes:""};case"strains":return{name:"",species:"",difficulty:"intermediate",colonizationDaysMin:14,colonizationDaysMax:21,fruitingDaysMin:7,fruitingDaysMax:14,notes:""};case"locations":return{name:"",type:"storage",tempMin:"",tempMax:"",humidityMin:"",humidityMax:"",notes:""};case"vessels":return{name:"",type:"jar",volumeMl:"",isReusable:!0,notes:""};case"containers":return{name:"",category:"tub",volumeL:"",notes:""};case"substrates":return{name:"",code:"",category:"bulk",spawnRateMin:10,spawnRateOptimal:20,spawnRateMax:30,fieldCapacity:65,notes:""};case"suppliers":return{name:"",website:"",email:"",phone:"",notes:""};case"categories":return{name:"",color:"#10b981",icon:""};default:return{}}},V=(P,ie)=>{var he,K,De,st,ht,A,F,de,Re,kt,_t;switch(ie){case"species":return{name:P.name||"",scientificName:P.scientificName||"",category:P.category||"gourmet",notes:P.notes||""};case"strains":return{name:P.name||"",species:P.species||"",difficulty:P.difficulty||"intermediate",colonizationDaysMin:((he=P.colonizationDays)==null?void 0:he.min)||14,colonizationDaysMax:((K=P.colonizationDays)==null?void 0:K.max)||21,fruitingDaysMin:((De=P.fruitingDays)==null?void 0:De.min)||7,fruitingDaysMax:((st=P.fruitingDays)==null?void 0:st.max)||14,notes:P.notes||""};case"locations":return{name:P.name||"",type:P.type||"storage",tempMin:((ht=P.tempRange)==null?void 0:ht.min)??"",tempMax:((A=P.tempRange)==null?void 0:A.max)??"",humidityMin:((F=P.humidityRange)==null?void 0:F.min)??"",humidityMax:((de=P.humidityRange)==null?void 0:de.max)??"",notes:P.notes||""};case"vessels":return{name:P.name||"",type:P.type||"jar",volumeMl:P.volumeMl||"",isReusable:P.isReusable??!0,notes:P.notes||""};case"containers":return{name:P.name||"",category:P.category||"tub",volumeL:P.volumeL||"",notes:P.notes||""};case"substrates":return{name:P.name||"",code:P.code||"",category:P.category||"bulk",spawnRateMin:((Re=P.spawnRateRange)==null?void 0:Re.min)||10,spawnRateOptimal:((kt=P.spawnRateRange)==null?void 0:kt.optimal)||20,spawnRateMax:((_t=P.spawnRateRange)==null?void 0:_t.max)||30,fieldCapacity:P.fieldCapacity||65,notes:P.notes||""};case"suppliers":return{name:P.name||"",website:P.website||"",email:P.email||"",phone:P.phone||"",notes:P.notes||""};case"categories":return{name:P.name||"",color:P.color||"#10b981",icon:P.icon||""};default:return P}},xe=async()=>{var P,ie,he,K,De,st,ht,A,F,de,Re,kt,_t,nt;if(!((P=R.name)!=null&&P.trim())){Y("Name is required");return}D(!0),Y(null);try{switch(J){case"species":const Rt={name:R.name.trim(),scientificName:((ie=R.scientificName)==null?void 0:ie.trim())||void 0,category:R.category||"gourmet",notes:((he=R.notes)==null?void 0:he.trim())||void 0,isActive:!0};M?(await a(M.id,Rt),Q("Species updated")):(await i(Rt),Q("Species added"));break;case"strains":const mt={name:R.name.trim(),species:((K=R.species)==null?void 0:K.trim())||"Unknown",difficulty:R.difficulty,colonizationDays:{min:Number(R.colonizationDaysMin)||14,max:Number(R.colonizationDaysMax)||21},fruitingDays:{min:Number(R.fruitingDaysMin)||7,max:Number(R.fruitingDaysMax)||14},optimalTempColonization:{min:24,max:27},optimalTempFruiting:{min:20,max:24},notes:((De=R.notes)==null?void 0:De.trim())||void 0,isActive:!0};if(console.log("Saving strain:",mt),M)await d(M.id,mt),Q("Strain updated");else{const Ce=await l(mt);console.log("Strain saved:",Ce),Q("Strain added to database")}break;case"locations":const z={name:R.name.trim(),type:R.type,tempRange:R.tempMin!==""&&R.tempMax!==""?{min:Number(R.tempMin),max:Number(R.tempMax)}:void 0,humidityRange:R.humidityMin!==""&&R.humidityMax!==""?{min:Number(R.humidityMin),max:Number(R.humidityMax)}:void 0,notes:((st=R.notes)==null?void 0:st.trim())||void 0,isActive:!0};M?(await m(M.id,z),Q("Location updated")):(await p(z),Q("Location added"));break;case"suppliers":const E={name:R.name.trim(),website:((ht=R.website)==null?void 0:ht.trim())||void 0,email:((A=R.email)==null?void 0:A.trim())||void 0,phone:((F=R.phone)==null?void 0:F.trim())||void 0,notes:((de=R.notes)==null?void 0:de.trim())||void 0,isActive:!0};M?(await v(M.id,E),Q("Supplier updated")):(await f(E),Q("Supplier added"));break;case"vessels":const I={name:R.name.trim(),type:R.type,volumeMl:R.volumeMl?Number(R.volumeMl):void 0,isReusable:R.isReusable??!0,notes:((Re=R.notes)==null?void 0:Re.trim())||void 0,isActive:!0};M?u(M.id,I):S(I),Q("Vessel saved");break;case"containers":const W={name:R.name.trim(),category:R.category,volumeL:R.volumeL?Number(R.volumeL):void 0,notes:((kt=R.notes)==null?void 0:kt.trim())||void 0,isActive:!0};M?_(M.id,W):x(W),Q("Container saved");break;case"substrates":const ne={name:R.name.trim(),code:((_t=R.code)==null?void 0:_t.trim())||R.name.toLowerCase().replace(/\s+/g,"_"),category:R.category,spawnRateRange:{min:Number(R.spawnRateMin)||10,optimal:Number(R.spawnRateOptimal)||20,max:Number(R.spawnRateMax)||30},fieldCapacity:R.fieldCapacity?Number(R.fieldCapacity):void 0,notes:((nt=R.notes)==null?void 0:nt.trim())||void 0,isActive:!0};M?C(M.id,ne):w(ne),Q("Substrate saved");break;case"categories":const ce={name:R.name.trim(),color:R.color||"#10b981",icon:R.icon||"",isActive:!0};M?G(M.id,ce):L(ce),Q("Category saved");break}k(!1),oe(null)}catch(Rt){console.error("Save error:",Rt);let mt=Rt.message||"Unknown error";mt.includes("row-level security")||mt.includes("RLS")?mt=`Database permission error: ${mt}. Make sure you've run the RLS policies from the schema SQL in Supabase.`:mt.includes("violates foreign key")&&(mt=`Reference error: ${mt}. The referenced record may not exist.`),Y(`Save failed: ${mt}`)}finally{D(!1)}},He=async(P,ie)=>{if(confirm("Are you sure you want to delete this item?"))try{switch(ie){case"species":await o(P);break;case"strains":await c(P);break;case"locations":await g(P);break;case"suppliers":await j(P);break;case"vessels":h(P);break;case"containers":N(P);break;case"substrates":y(P);break;case"categories":H(P);break}Q("Item deleted")}catch(he){Y(`Delete failed: ${he.message}`)}},vr=()=>{var P;return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-6",children:[r.jsx("div",{className:"flex items-center gap-4 mb-4",children:t?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"w-12 h-12 rounded-xl bg-emerald-950/50 border border-emerald-700 flex items-center justify-center text-emerald-400",children:r.jsx(Se.Cloud,{})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-emerald-400",children:"Connected to Supabase"}),r.jsxs("p",{className:"text-sm text-zinc-500",children:["Last sync: ",localStorage.getItem("mycolab-last-sync")?new Date(localStorage.getItem("mycolab-last-sync")).toLocaleString():"Never"]})]})]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"w-12 h-12 rounded-xl bg-zinc-800 border border-zinc-700 flex items-center justify-center text-zinc-500",children:r.jsx(Se.CloudOff,{})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-zinc-400",children:"Not Connected"}),r.jsx("p",{className:"text-sm text-zinc-500",children:"Configure your Supabase credentials below"})]})]})}),r.jsxs("div",{className:"grid gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Supabase Project URL"}),r.jsx("input",{type:"text",value:O,onChange:ie=>U(ie.target.value),placeholder:"https://your-project.supabase.co",className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white placeholder-zinc-500"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"API Key (anon/public)"}),r.jsx("input",{type:"password",value:re,onChange:ie=>pe(ie.target.value),placeholder:"Your Supabase anon key",className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white font-mono text-sm placeholder-zinc-500"}),r.jsx("p",{className:"text-xs text-zinc-500 mt-1",children:"Found in Supabase  Settings  API  Project API keys  anon public"})]}),r.jsxs("div",{className:"flex flex-wrap gap-3",children:[r.jsx("button",{onClick:St,disabled:Be||!O||!re,className:"px-4 py-2 bg-emerald-500 hover:bg-emerald-600 disabled:bg-zinc-700 disabled:text-zinc-500 text-white rounded-lg font-medium flex items-center gap-2",children:Be?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Testing..."]}):r.jsxs(r.Fragment,{children:[r.jsx(Se.Refresh,{}),"Test & Connect"]})}),O&&r.jsx("button",{onClick:ut,className:"px-4 py-2 bg-zinc-800 hover:bg-zinc-700 text-white rounded-lg border border-zinc-700",children:"Clear Credentials"}),r.jsxs("button",{onClick:()=>s(),disabled:!t,className:"px-4 py-2 bg-zinc-800 hover:bg-zinc-700 disabled:opacity-50 text-white rounded-lg border border-zinc-700 flex items-center gap-2",children:[r.jsx(Se.Refresh,{}),"Refresh Data"]})]})]})]}),dt.length>0&&r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-6",children:[r.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[r.jsx(Se.Table,{}),"Database Tables Status"]}),r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:dt.map(ie=>r.jsxs("div",{className:`border rounded-lg p-3 ${ie.exists?"bg-emerald-950/30 border-emerald-800":"bg-red-950/30 border-red-800"}`,children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[ie.exists?r.jsx("span",{className:"text-emerald-400",children:r.jsx(Se.CheckCircle,{})}):r.jsx("span",{className:"text-red-400",children:r.jsx(Se.XCircle,{})}),r.jsx("span",{className:"text-sm font-medium text-white",children:ie.name})]}),ie.exists?r.jsxs("p",{className:"text-xs text-zinc-400",children:[ie.rowCount," rows"]}):r.jsx("p",{className:"text-xs text-red-400 truncate",children:ie.error||"Not found"})]},ie.name))}),r.jsxs("div",{className:"mt-4 pt-4 border-t border-zinc-800",children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[r.jsxs("button",{onClick:We,className:"px-4 py-2 bg-amber-600 hover:bg-amber-700 text-white rounded-lg font-medium flex items-center gap-2",children:[r.jsx(Se.Edit,{}),"Test Write Permissions"]}),Dt&&r.jsxs("div",{className:`flex items-center gap-2 ${Dt.success?"text-emerald-400":"text-red-400"}`,children:[Dt.success?r.jsx(Se.CheckCircle,{}):r.jsx(Se.XCircle,{}),r.jsx("span",{className:"text-sm",children:Dt.message})]})]}),r.jsx("p",{className:"text-xs text-zinc-500 mt-2",children:"This will insert and delete a test record to verify write access. If it fails, you need to run the RLS policies from the schema SQL."})]})]}),r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Schema Setup"}),r.jsx("p",{className:"text-sm text-zinc-400 mb-4",children:"If tables are missing or you see permission errors, run the schema SQL in your Supabase SQL Editor."}),r.jsx("div",{className:"bg-amber-950/30 border border-amber-800 rounded-lg p-4 mb-4",children:r.jsxs("p",{className:"text-sm text-amber-300",children:[r.jsx("strong",{children:"Important:"})," The schema includes anonymous access policies. Make sure to run the FULL schema file to enable data access without authentication."]})}),r.jsxs("div",{className:"flex flex-wrap gap-3",children:[r.jsxs("button",{onClick:_e,className:"px-4 py-2 bg-zinc-800 hover:bg-zinc-700 text-white rounded-lg border border-zinc-700 flex items-center gap-2",children:[r.jsx(Se.Copy,{}),Er?"Copied!":"Copy Schema SQL"]}),r.jsx("a",{href:"https://supabase.com/dashboard",target:"_blank",rel:"noopener noreferrer",className:"px-4 py-2 bg-zinc-800 hover:bg-zinc-700 text-white rounded-lg border border-zinc-700",children:"Open Supabase Dashboard "})]})]}),r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Local Data Summary"}),r.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-2xl font-bold text-emerald-400",children:((P=e.species)==null?void 0:P.length)||0}),r.jsx("p",{className:"text-sm text-zinc-500",children:"Species"})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-2xl font-bold text-emerald-400",children:e.strains.length}),r.jsx("p",{className:"text-sm text-zinc-500",children:"Strains"})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-2xl font-bold text-emerald-400",children:e.cultures.length}),r.jsx("p",{className:"text-sm text-zinc-500",children:"Cultures"})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-2xl font-bold text-emerald-400",children:e.grows.length}),r.jsx("p",{className:"text-sm text-zinc-500",children:"Grows"})]})]})]})]})},Nt=(P,ie)=>r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl overflow-hidden",children:[r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b border-zinc-800",children:[ie.map(he=>r.jsx("th",{className:"text-left p-4 text-sm font-medium text-zinc-400",children:he.label},he.key)),r.jsx("th",{className:"text-right p-4 text-sm font-medium text-zinc-400 w-24",children:"Actions"})]})}),r.jsx("tbody",{className:"divide-y divide-zinc-800",children:P.filter(he=>he.isActive!==!1).map(he=>r.jsxs("tr",{className:"hover:bg-zinc-800/30",children:[ie.map(K=>r.jsx("td",{className:"p-4 text-white",children:K.render?K.render(he):he[K.key]||"-"},K.key)),r.jsx("td",{className:"p-4 text-right",children:r.jsxs("div",{className:"flex justify-end gap-2",children:[r.jsx("button",{onClick:()=>Gt(he),className:"p-1.5 text-zinc-400 hover:text-white hover:bg-zinc-800 rounded",title:"Edit",children:r.jsx(Se.Edit,{})}),r.jsx("button",{onClick:()=>He(he.id,J),className:"p-1.5 text-zinc-400 hover:text-red-400 hover:bg-zinc-800 rounded",title:"Delete",children:r.jsx(Se.Trash,{})})]})})]},he.id))})]})}),P.filter(he=>he.isActive!==!1).length===0&&r.jsx("div",{className:"p-8 text-center text-zinc-500",children:'No items yet. Click "Add" to create one.'})]}),zs=()=>{switch(J){case"database":return vr();case"species":return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3",children:[r.jsx("p",{className:"text-zinc-400",children:"Mushroom species for your strain library"}),r.jsxs("button",{onClick:()=>Oe("species"),className:"px-3 py-2 bg-emerald-500 hover:bg-emerald-600 text-white rounded-lg text-sm font-medium flex items-center gap-2",children:[r.jsx(Se.Plus,{})," Add Species"]})]}),Nt(e.species||[],[{key:"name",label:"Name"},{key:"scientificName",label:"Scientific Name"},{key:"category",label:"Category",render:P=>r.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-zinc-800 border border-zinc-700 capitalize",children:P.category})}])]});case"strains":return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3",children:[r.jsx("p",{className:"text-zinc-400",children:"Strain varieties in your library"}),r.jsxs("button",{onClick:()=>Oe("strains"),className:"px-3 py-2 bg-emerald-500 hover:bg-emerald-600 text-white rounded-lg text-sm font-medium flex items-center gap-2",children:[r.jsx(Se.Plus,{})," Add Strain"]})]}),Nt(e.strains,[{key:"name",label:"Name"},{key:"species",label:"Species"},{key:"difficulty",label:"Difficulty",render:P=>{const ie={beginner:"bg-emerald-950/50 text-emerald-400 border-emerald-700",intermediate:"bg-amber-950/50 text-amber-400 border-amber-700",advanced:"bg-red-950/50 text-red-400 border-red-700"};return r.jsx("span",{className:`px-2 py-0.5 rounded text-xs border ${ie[P.difficulty]||ie.intermediate}`,children:P.difficulty})}},{key:"colonizationDays",label:"Colonization",render:P=>{var ie,he;return`${((ie=P.colonizationDays)==null?void 0:ie.min)||0}-${((he=P.colonizationDays)==null?void 0:he.max)||0}d`}}])]});case"locations":return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3",children:[r.jsx("p",{className:"text-zinc-400",children:"Lab areas and growing spaces"}),r.jsxs("button",{onClick:()=>Oe("locations"),className:"px-3 py-2 bg-emerald-500 hover:bg-emerald-600 text-white rounded-lg text-sm font-medium flex items-center gap-2",children:[r.jsx(Se.Plus,{})," Add Location"]})]}),Nt(e.locations,[{key:"name",label:"Name"},{key:"type",label:"Type",render:P=>r.jsx("span",{className:"capitalize",children:P.type})},{key:"tempRange",label:"Temp Range",render:P=>P.tempRange?`${P.tempRange.min}-${P.tempRange.max}C`:"-"},{key:"humidityRange",label:"Humidity",render:P=>P.humidityRange?`${P.humidityRange.min}-${P.humidityRange.max}%`:"-"}])]});case"vessels":return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3",children:[r.jsx("p",{className:"text-zinc-400",children:"Culture containers: jars, bags, plates, syringes"}),r.jsxs("button",{onClick:()=>Oe("vessels"),className:"px-3 py-2 bg-emerald-500 hover:bg-emerald-600 text-white rounded-lg text-sm font-medium flex items-center gap-2",children:[r.jsx(Se.Plus,{})," Add Vessel"]})]}),Nt(e.vessels,[{key:"name",label:"Name"},{key:"type",label:"Type",render:P=>r.jsx("span",{className:"capitalize",children:P.type})},{key:"volumeMl",label:"Volume",render:P=>P.volumeMl?`${P.volumeMl}ml`:"-"},{key:"isReusable",label:"Reusable",render:P=>P.isReusable?r.jsx("span",{className:"text-emerald-400",children:""}):r.jsx("span",{className:"text-zinc-500",children:""})}])]});case"containers":return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3",children:[r.jsx("p",{className:"text-zinc-400",children:"Grow containers: monotubs, buckets, bags"}),r.jsxs("button",{onClick:()=>Oe("containers"),className:"px-3 py-2 bg-emerald-500 hover:bg-emerald-600 text-white rounded-lg text-sm font-medium flex items-center gap-2",children:[r.jsx(Se.Plus,{})," Add Container"]})]}),Nt(e.containerTypes,[{key:"name",label:"Name"},{key:"category",label:"Category",render:P=>r.jsx("span",{className:"capitalize",children:P.category})},{key:"volumeL",label:"Volume",render:P=>P.volumeL?`${P.volumeL}L`:"-"}])]});case"substrates":return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3",children:[r.jsx("p",{className:"text-zinc-400",children:"Substrate types for spawning and fruiting"}),r.jsxs("button",{onClick:()=>Oe("substrates"),className:"px-3 py-2 bg-emerald-500 hover:bg-emerald-600 text-white rounded-lg text-sm font-medium flex items-center gap-2",children:[r.jsx(Se.Plus,{})," Add Substrate"]})]}),Nt(e.substrateTypes,[{key:"name",label:"Name"},{key:"code",label:"Code"},{key:"category",label:"Category",render:P=>r.jsx("span",{className:"capitalize",children:P.category})}])]});case"suppliers":return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3",children:[r.jsx("p",{className:"text-zinc-400",children:"Vendors for spores, supplies, equipment"}),r.jsxs("button",{onClick:()=>Oe("suppliers"),className:"px-3 py-2 bg-emerald-500 hover:bg-emerald-600 text-white rounded-lg text-sm font-medium flex items-center gap-2",children:[r.jsx(Se.Plus,{})," Add Supplier"]})]}),Nt(e.suppliers,[{key:"name",label:"Name"},{key:"website",label:"Website",render:P=>P.website?r.jsx("a",{href:P.website,target:"_blank",rel:"noopener noreferrer",className:"text-emerald-400 hover:underline",children:P.website}):"-"},{key:"email",label:"Email"}])]});case"categories":return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3",children:[r.jsx("p",{className:"text-zinc-400",children:"Inventory categories for organizing supplies"}),r.jsxs("button",{onClick:()=>Oe("categories"),className:"px-3 py-2 bg-emerald-500 hover:bg-emerald-600 text-white rounded-lg text-sm font-medium flex items-center gap-2",children:[r.jsx(Se.Plus,{})," Add Category"]})]}),Nt(e.inventoryCategories,[{key:"name",label:"Name"},{key:"color",label:"Color",render:P=>r.jsx("div",{className:"w-6 h-6 rounded border border-zinc-600",style:{backgroundColor:P.color}})},{key:"icon",label:"Icon",render:P=>r.jsx("span",{className:"text-xl",children:P.icon})}])]});case"preferences":return r.jsx("div",{className:"space-y-6",children:r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"General Settings"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Units"}),r.jsxs("select",{value:lr.defaultUnits,onChange:P=>wt(ie=>({...ie,defaultUnits:P.target.value})),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white",children:[r.jsx("option",{value:"metric",children:"Metric (g, ml, C)"}),r.jsx("option",{value:"imperial",children:"Imperial (oz, fl oz, F)"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Currency"}),r.jsxs("select",{value:lr.defaultCurrency,onChange:P=>wt(ie=>({...ie,defaultCurrency:P.target.value})),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white",children:[r.jsx("option",{value:"USD",children:"USD ($)"}),r.jsx("option",{value:"EUR",children:"EUR ()"}),r.jsx("option",{value:"GBP",children:"GBP ()"}),r.jsx("option",{value:"CAD",children:"CAD ($)"})]})]})]}),r.jsx("button",{onClick:()=>{n(lr),Q("Settings saved")},className:"mt-6 px-4 py-2 bg-emerald-500 hover:bg-emerald-600 text-white rounded-lg font-medium",children:"Save Preferences"})]})});default:return null}},As=()=>{var ie,he;if(!ge)return null;const P=()=>{switch(J){case"species":return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-1",children:"Name *"}),r.jsx("input",{type:"text",value:R.name||"",onChange:K=>ue({...R,name:K.target.value}),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white",placeholder:"e.g., Psilocybe cubensis",autoFocus:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-1",children:"Scientific Name"}),r.jsx("input",{type:"text",value:R.scientificName||"",onChange:K=>ue({...R,scientificName:K.target.value}),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-1",children:"Category"}),r.jsxs("select",{value:R.category||"gourmet",onChange:K=>ue({...R,category:K.target.value}),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white",children:[r.jsx("option",{value:"gourmet",children:"Gourmet"}),r.jsx("option",{value:"medicinal",children:"Medicinal"}),r.jsx("option",{value:"research",children:"Research"}),r.jsx("option",{value:"other",children:"Other"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-1",children:"Notes"}),r.jsx("textarea",{value:R.notes||"",onChange:K=>ue({...R,notes:K.target.value}),rows:3,className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white resize-none"})]})]});case"strains":return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-1",children:"Name *"}),r.jsx("input",{type:"text",value:R.name||"",onChange:K=>ue({...R,name:K.target.value}),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white",placeholder:"e.g., Golden Teacher",autoFocus:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-1",children:"Species *"}),r.jsx("input",{type:"text",value:R.species||"",onChange:K=>ue({...R,species:K.target.value}),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white",placeholder:"e.g., Psilocybe cubensis"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-1",children:"Difficulty"}),r.jsxs("select",{value:R.difficulty||"intermediate",onChange:K=>ue({...R,difficulty:K.target.value}),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white",children:[r.jsx("option",{value:"beginner",children:"Beginner"}),r.jsx("option",{value:"intermediate",children:"Intermediate"}),r.jsx("option",{value:"advanced",children:"Advanced"})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-1",children:"Colonization Min (days)"}),r.jsx("input",{type:"number",value:R.colonizationDaysMin||"",onChange:K=>ue({...R,colonizationDaysMin:K.target.value}),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-1",children:"Colonization Max (days)"}),r.jsx("input",{type:"number",value:R.colonizationDaysMax||"",onChange:K=>ue({...R,colonizationDaysMax:K.target.value}),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-1",children:"Notes"}),r.jsx("textarea",{value:R.notes||"",onChange:K=>ue({...R,notes:K.target.value}),rows:2,className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white resize-none"})]})]});case"locations":return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-1",children:"Name *"}),r.jsx("input",{type:"text",value:R.name||"",onChange:K=>ue({...R,name:K.target.value}),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white",autoFocus:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-1",children:"Type"}),r.jsxs("select",{value:R.type||"storage",onChange:K=>ue({...R,type:K.target.value}),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white",children:[r.jsx("option",{value:"incubation",children:"Incubation"}),r.jsx("option",{value:"fruiting",children:"Fruiting"}),r.jsx("option",{value:"storage",children:"Storage"}),r.jsx("option",{value:"lab",children:"Lab"}),r.jsx("option",{value:"other",children:"Other"})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-1",children:"Temp Min (C)"}),r.jsx("input",{type:"number",value:R.tempMin??"",onChange:K=>ue({...R,tempMin:K.target.value}),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-1",children:"Temp Max (C)"}),r.jsx("input",{type:"number",value:R.tempMax??"",onChange:K=>ue({...R,tempMax:K.target.value}),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white"})]})]})]});case"suppliers":return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-1",children:"Name *"}),r.jsx("input",{type:"text",value:R.name||"",onChange:K=>ue({...R,name:K.target.value}),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white",autoFocus:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-1",children:"Website"}),r.jsx("input",{type:"url",value:R.website||"",onChange:K=>ue({...R,website:K.target.value}),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white",placeholder:"https://"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-1",children:"Email"}),r.jsx("input",{type:"email",value:R.email||"",onChange:K=>ue({...R,email:K.target.value}),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-1",children:"Phone"}),r.jsx("input",{type:"tel",value:R.phone||"",onChange:K=>ue({...R,phone:K.target.value}),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white"})]})]});case"vessels":return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-1",children:"Name *"}),r.jsx("input",{type:"text",value:R.name||"",onChange:K=>ue({...R,name:K.target.value}),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white",autoFocus:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-1",children:"Type"}),r.jsxs("select",{value:R.type||"jar",onChange:K=>ue({...R,type:K.target.value}),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white",children:[r.jsx("option",{value:"jar",children:"Jar"}),r.jsx("option",{value:"bag",children:"Bag"}),r.jsx("option",{value:"plate",children:"Plate"}),r.jsx("option",{value:"tube",children:"Tube"}),r.jsx("option",{value:"bottle",children:"Bottle"}),r.jsx("option",{value:"syringe",children:"Syringe"}),r.jsx("option",{value:"other",children:"Other"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-1",children:"Volume (ml)"}),r.jsx("input",{type:"number",value:R.volumeMl||"",onChange:K=>ue({...R,volumeMl:K.target.value}),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"checkbox",id:"isReusable",checked:R.isReusable??!0,onChange:K=>ue({...R,isReusable:K.target.checked}),className:"w-4 h-4 rounded"}),r.jsx("label",{htmlFor:"isReusable",className:"text-sm text-zinc-400",children:"Reusable"})]})]});case"containers":return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-1",children:"Name *"}),r.jsx("input",{type:"text",value:R.name||"",onChange:K=>ue({...R,name:K.target.value}),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white",autoFocus:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-1",children:"Category"}),r.jsxs("select",{value:R.category||"tub",onChange:K=>ue({...R,category:K.target.value}),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white",children:[r.jsx("option",{value:"tub",children:"Tub"}),r.jsx("option",{value:"bag",children:"Bag"}),r.jsx("option",{value:"bucket",children:"Bucket"}),r.jsx("option",{value:"bed",children:"Bed"}),r.jsx("option",{value:"jar",children:"Jar"}),r.jsx("option",{value:"other",children:"Other"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-1",children:"Volume (L)"}),r.jsx("input",{type:"number",value:R.volumeL||"",onChange:K=>ue({...R,volumeL:K.target.value}),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white"})]})]});case"substrates":return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-1",children:"Name *"}),r.jsx("input",{type:"text",value:R.name||"",onChange:K=>ue({...R,name:K.target.value}),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white",autoFocus:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-1",children:"Code"}),r.jsx("input",{type:"text",value:R.code||"",onChange:K=>ue({...R,code:K.target.value}),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white",placeholder:"e.g., cvg"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-1",children:"Category"}),r.jsxs("select",{value:R.category||"bulk",onChange:K=>ue({...R,category:K.target.value}),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white",children:[r.jsx("option",{value:"bulk",children:"Bulk"}),r.jsx("option",{value:"grain",children:"Grain"}),r.jsx("option",{value:"agar",children:"Agar"}),r.jsx("option",{value:"liquid",children:"Liquid"})]})]})]});case"categories":return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-1",children:"Name *"}),r.jsx("input",{type:"text",value:R.name||"",onChange:K=>ue({...R,name:K.target.value}),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white",autoFocus:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-1",children:"Color"}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("input",{type:"color",value:R.color||"#10b981",onChange:K=>ue({...R,color:K.target.value}),className:"w-10 h-10 rounded border border-zinc-700 cursor-pointer"}),r.jsx("input",{type:"text",value:R.color||"#10b981",onChange:K=>ue({...R,color:K.target.value}),className:"flex-1 bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white font-mono"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-1",children:"Icon (emoji)"}),r.jsx("input",{type:"text",value:R.icon||"",onChange:K=>ue({...R,icon:K.target.value}),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white"})]})]});default:return r.jsx("p",{className:"text-zinc-500",children:"Form not available for this tab."})}};return r.jsx("div",{className:"fixed inset-0 bg-black/70 z-50 overflow-y-auto",onClick:()=>k(!1),children:r.jsx("div",{className:"min-h-full flex items-start justify-center p-4 py-8",children:r.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl w-full max-w-lg",onClick:K=>K.stopPropagation(),children:[r.jsxs("div",{className:"p-5 border-b border-zinc-800 flex items-center justify-between",children:[r.jsxs("h3",{className:"text-lg font-semibold text-white",children:[M?"Edit":"Add"," ",((ie=ia[J])==null?void 0:ie.label.replace(/s$/,""))||"Item"]}),r.jsx("button",{onClick:()=>k(!1),className:"p-1 text-zinc-400 hover:text-white",children:r.jsx(Se.X,{})})]}),r.jsx("div",{className:"p-5",children:P()}),r.jsxs("div",{className:"p-5 border-t border-zinc-800 flex gap-3",children:[r.jsx("button",{onClick:()=>k(!1),className:"flex-1 py-2 bg-zinc-800 hover:bg-zinc-700 text-white rounded-lg border border-zinc-700",children:"Cancel"}),r.jsx("button",{onClick:xe,disabled:B||!((he=R.name)!=null&&he.trim()),className:"flex-1 py-2 bg-emerald-500 hover:bg-emerald-600 disabled:bg-zinc-700 disabled:text-zinc-500 text-white rounded-lg font-medium",children:B?"Saving...":"Save"})]})]})})})};return r.jsxs("div",{className:"space-y-6",children:[$&&r.jsxs("div",{className:"bg-red-950/50 border border-red-800 rounded-lg p-4 flex items-start gap-3",children:[r.jsx("div",{className:"text-red-400 flex-shrink-0 mt-0.5",children:r.jsx(Se.AlertCircle,{})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-red-400 font-medium",children:"Error"}),r.jsx("p",{className:"text-red-300 text-sm",children:$})]})]}),le&&r.jsxs("div",{className:"bg-emerald-950/50 border border-emerald-800 rounded-lg p-4 flex items-center gap-3",children:[r.jsx("div",{className:"text-emerald-400",children:r.jsx(Se.CheckCircle,{})}),r.jsx("p",{className:"text-emerald-400",children:le})]}),r.jsx("div",{className:"flex flex-wrap gap-2 border-b border-zinc-800 pb-4",children:Object.keys(ia).map(P=>r.jsxs("button",{onClick:()=>se(P),className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2 ${J===P?"bg-emerald-500 text-white":"bg-zinc-800 text-zinc-400 hover:bg-zinc-700 hover:text-white"}`,children:[r.jsx("span",{children:ia[P].icon}),r.jsx("span",{className:"hidden sm:inline",children:ia[P].label})]},P))}),zs(),As()]})},aa=[{name:"CVG (Coco Coir/Verm/Gypsum)",minRate:10,maxRate:30,optimalRate:20,description:"Standard bulk substrate for cubensis",colonizationSpeed:"10-14 days at 20%"},{name:"Manure-Based",minRate:15,maxRate:35,optimalRate:25,description:"Horse or cow manure substrates",colonizationSpeed:"12-16 days at 25%"},{name:"Straw (Pasteurized)",minRate:10,maxRate:25,optimalRate:15,description:"Oyster mushrooms and other aggressive species",colonizationSpeed:"7-10 days at 15%"},{name:"Hardwood Sawdust",minRate:15,maxRate:30,optimalRate:20,description:"Gourmet species like shiitake, lions mane",colonizationSpeed:"14-21 days at 20%"},{name:"Master's Mix (50/50)",minRate:10,maxRate:25,optimalRate:15,description:"Hardwood pellets + soy hulls",colonizationSpeed:"10-14 days at 15%"},{name:"BRF Cakes (PF Tek)",minRate:0,maxRate:0,optimalRate:0,description:"N/A - BRF is inoculated directly with spores/LC",colonizationSpeed:"14-21 days from inoculation"},{name:"Grain-to-Grain (G2G)",minRate:5,maxRate:15,optimalRate:10,description:"Expanding grain spawn",colonizationSpeed:"7-10 days at 10%"}],Dr={Calculator:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5",children:[r.jsx("rect",{x:"4",y:"2",width:"16",height:"20",rx:"2"}),r.jsx("line",{x1:"8",y1:"6",x2:"16",y2:"6"}),r.jsx("line",{x1:"8",y1:"10",x2:"8",y2:"10.01"}),r.jsx("line",{x1:"12",y1:"10",x2:"12",y2:"10.01"}),r.jsx("line",{x1:"16",y1:"10",x2:"16",y2:"10.01"}),r.jsx("line",{x1:"8",y1:"14",x2:"8",y2:"14.01"}),r.jsx("line",{x1:"12",y1:"14",x2:"12",y2:"14.01"}),r.jsx("line",{x1:"16",y1:"14",x2:"16",y2:"14.01"}),r.jsx("line",{x1:"8",y1:"18",x2:"8",y2:"18.01"}),r.jsx("line",{x1:"12",y1:"18",x2:"16",y2:"18"})]}),Info:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),r.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),Zap:()=>r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:r.jsx("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"})}),Clock:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("polyline",{points:"12 6 12 12 16 14"})]}),AlertTriangle:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("path",{d:"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"}),r.jsx("line",{x1:"12",y1:"9",x2:"12",y2:"13"}),r.jsx("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]}),ArrowRight:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"}),r.jsx("polyline",{points:"12 5 19 12 12 19"})]}),Save:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}),r.jsx("polyline",{points:"17 21 17 13 7 13 7 21"}),r.jsx("polyline",{points:"7 3 7 8 15 8"})]}),RotateCcw:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("polyline",{points:"1 4 1 10 7 10"}),r.jsx("path",{d:"M3.51 15a9 9 0 1 0 2.13-9.36L1 10"})]})},Aw=()=>{const[e,t]=b.useState("calculate"),[s,n]=b.useState(""),[i,a]=b.useState(""),[o,l]=b.useState(aa[0].name),[d,c]=b.useState("20"),[p,m]=b.useState(""),[g,f]=b.useState(""),[v,j]=b.useState("fromSpawn"),[S,u]=b.useState([]),h=aa.find(y=>y.name===o)||aa[0],x=b.useMemo(()=>{const y=parseFloat(s),L=parseFloat(i);if(isNaN(y)||isNaN(L)||y<=0||L<=0)return null;const G=y+L,H=y/G*100;let J,se,ge,k;if(h.name==="BRF Cakes (PF Tek)")return{spawnRate:H,rating:"optimal",colonizationEstimate:"N/A - BRF uses direct inoculation",contaminationRisk:"N/A",recommendation:"BRF cakes are inoculated directly with spores or LC, not spawned to bulk."};if(H<h.minRate)J="low",se="21+ days (slow)",ge="HIGH - slow colonization allows contaminants to establish",k=`Increase spawn to at least ${h.minRate}% for reliable colonization. Current rate may lead to stalls or contamination.`;else if(H<=h.optimalRate){J="optimal";const M=h.colonizationSpeed.match(/(\d+)-(\d+)/);se=M?`${M[1]}-${M[2]} days`:"10-14 days",ge="LOW - good balance of speed and efficiency",k="Optimal spawn rate! Good balance between colonization speed and spawn efficiency."}else H<=h.maxRate?(J="high",se="7-10 days (fast)",ge="VERY LOW - fast colonization outpaces contaminants",k="Higher spawn rate will colonize quickly but uses more spawn. Good for contamination-prone environments."):(J="very-high",se="5-7 days (very fast)",ge="MINIMAL",k=`Very high spawn rate (>${h.maxRate}%). Will colonize very fast but may reduce total yield per spawn invested.`);return{spawnRate:H,rating:J,colonizationEstimate:se,contaminationRisk:ge,recommendation:k}},[s,i,h]),_=b.useMemo(()=>{const y=parseFloat(d);if(isNaN(y)||y<=0||y>=100)return null;if(v==="fromSpawn"){const L=parseFloat(p);if(isNaN(L)||L<=0)return null;const G=L*(100-y)/y,H=L+G;return{spawnWeight:L,substrateWeight:Math.round(G),totalWeight:Math.round(H),actualRate:y}}else{const L=parseFloat(g);if(isNaN(L)||L<=0)return null;const G=y*L/(100-y),H=G+L;return{spawnWeight:Math.round(G),substrateWeight:L,totalWeight:Math.round(H),actualRate:y}}},[d,p,g,v]),N=()=>{if(!x)return;const y={id:Date.now().toString(),timestamp:new Date,spawnWeight:parseFloat(s),substrateWeight:parseFloat(i),spawnRate:x.spawnRate,preset:o};u(L=>[y,...L].slice(0,10))},w=()=>{n(""),a(""),m(""),f("")},C=y=>{switch(y){case"low":return"text-red-400 bg-red-950/50 border-red-800";case"optimal":return"text-emerald-400 bg-emerald-950/50 border-emerald-800";case"high":return"text-amber-400 bg-amber-950/50 border-amber-800";case"very-high":return"text-orange-400 bg-orange-950/50 border-orange-800";default:return"text-zinc-400 bg-zinc-800 border-zinc-700"}};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[r.jsx(Dr.Calculator,{}),"Spawn Rate Calculator"]}),r.jsx("p",{className:"text-zinc-400 text-sm",children:"Calculate optimal spawn-to-substrate ratios"})]}),r.jsxs("div",{className:"flex bg-zinc-800 rounded-lg border border-zinc-700 overflow-hidden",children:[r.jsx("button",{onClick:()=>t("calculate"),className:`px-4 py-2 text-sm font-medium transition-colors ${e==="calculate"?"bg-emerald-500/20 text-emerald-400":"text-zinc-400 hover:text-white"}`,children:"Calculate Rate"}),r.jsx("button",{onClick:()=>t("plan"),className:`px-4 py-2 text-sm font-medium transition-colors ${e==="plan"?"bg-emerald-500/20 text-emerald-400":"text-zinc-400 hover:text-white"}`,children:"Plan Batch"})]})]}),r.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[r.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-5",children:[r.jsx("label",{className:"block text-sm font-medium text-zinc-400 mb-3",children:"Substrate Type"}),r.jsx("div",{className:"grid sm:grid-cols-2 gap-2",children:aa.map(y=>r.jsxs("button",{onClick:()=>l(y.name),className:`p-3 rounded-lg border text-left transition-all ${o===y.name?"bg-emerald-950/30 border-emerald-700 text-white":"bg-zinc-800/50 border-zinc-700 text-zinc-400 hover:border-zinc-600"}`,children:[r.jsx("p",{className:"font-medium text-sm",children:y.name}),r.jsx("p",{className:"text-xs text-zinc-500 mt-1",children:y.optimalRate>0?`Optimal: ${y.optimalRate}%`:"Direct inoculation"})]},y.name))})]}),e==="calculate"?r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-5",children:[r.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Enter Weights"}),r.jsxs("div",{className:"grid sm:grid-cols-2 gap-4 mb-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Spawn Weight (g)"}),r.jsx("input",{type:"number",value:s,onChange:y=>n(y.target.value),placeholder:"e.g., 500",className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-4 py-3 text-white text-lg focus:outline-none focus:border-emerald-500"}),r.jsx("p",{className:"text-xs text-zinc-500 mt-1",children:"Colonized grain spawn"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Substrate Weight (g)"}),r.jsx("input",{type:"number",value:i,onChange:y=>a(y.target.value),placeholder:"e.g., 2000",className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-4 py-3 text-white text-lg focus:outline-none focus:border-emerald-500"}),r.jsx("p",{className:"text-xs text-zinc-500 mt-1",children:"Hydrated bulk substrate"})]})]}),x&&r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between p-4 bg-zinc-800/50 rounded-lg",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-zinc-400",children:"Spawn Rate"}),r.jsxs("p",{className:"text-3xl font-bold text-white",children:[x.spawnRate.toFixed(1),"%"]})]}),r.jsxs("div",{className:`px-4 py-2 rounded-lg border font-medium ${C(x.rating)}`,children:[x.rating==="optimal"&&" Optimal",x.rating==="low"&&" Low",x.rating==="high"&&" High",x.rating==="very-high"&&" Very High"]})]}),r.jsxs("div",{className:"grid sm:grid-cols-3 gap-3",children:[r.jsxs("div",{className:"p-3 bg-zinc-800/30 rounded-lg",children:[r.jsxs("div",{className:"flex items-center gap-2 text-zinc-400 text-sm mb-1",children:[r.jsx(Dr.Clock,{}),"Colonization"]}),r.jsx("p",{className:"text-white font-medium",children:x.colonizationEstimate})]}),r.jsxs("div",{className:"p-3 bg-zinc-800/30 rounded-lg",children:[r.jsxs("div",{className:"flex items-center gap-2 text-zinc-400 text-sm mb-1",children:[r.jsx(Dr.AlertTriangle,{}),"Contam Risk"]}),r.jsx("p",{className:"text-white font-medium",children:x.contaminationRisk.split(" - ")[0]})]}),r.jsxs("div",{className:"p-3 bg-zinc-800/30 rounded-lg",children:[r.jsxs("div",{className:"flex items-center gap-2 text-zinc-400 text-sm mb-1",children:[r.jsx(Dr.Zap,{}),"Total Weight"]}),r.jsxs("p",{className:"text-white font-medium",children:[(parseFloat(s)+parseFloat(i)).toLocaleString(),"g"]})]})]}),r.jsx("div",{className:`p-4 rounded-lg border ${C(x.rating)}`,children:r.jsx("p",{className:"text-sm",children:x.recommendation})}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs("button",{onClick:N,className:"flex items-center gap-2 px-4 py-2 bg-emerald-500/20 text-emerald-400 rounded-lg hover:bg-emerald-500/30 transition-colors",children:[r.jsx(Dr.Save,{}),"Save"]}),r.jsxs("button",{onClick:w,className:"flex items-center gap-2 px-4 py-2 bg-zinc-800 text-zinc-400 rounded-lg hover:bg-zinc-700 transition-colors",children:[r.jsx(Dr.RotateCcw,{}),"Clear"]})]})]}),!x&&s&&i&&r.jsx("p",{className:"text-zinc-500 text-center py-4",children:"Enter valid weights to calculate"})]}):r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-5",children:[r.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Plan Your Batch"}),r.jsxs("div",{className:"flex gap-2 mb-4",children:[r.jsx("button",{onClick:()=>j("fromSpawn"),className:`flex-1 py-2 px-4 rounded-lg text-sm font-medium transition-colors ${v==="fromSpawn"?"bg-emerald-500/20 text-emerald-400 border border-emerald-700":"bg-zinc-800 text-zinc-400 border border-zinc-700"}`,children:"I have spawn, need substrate"}),r.jsx("button",{onClick:()=>j("fromSubstrate"),className:`flex-1 py-2 px-4 rounded-lg text-sm font-medium transition-colors ${v==="fromSubstrate"?"bg-emerald-500/20 text-emerald-400 border border-emerald-700":"bg-zinc-800 text-zinc-400 border border-zinc-700"}`,children:"I have substrate, need spawn"})]}),r.jsxs("div",{className:"grid sm:grid-cols-2 gap-4 mb-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Target Spawn Rate (%)"}),r.jsx("input",{type:"number",value:d,onChange:y=>c(y.target.value),placeholder:"e.g., 20",min:"1",max:"99",className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-4 py-3 text-white text-lg focus:outline-none focus:border-emerald-500"}),r.jsxs("p",{className:"text-xs text-zinc-500 mt-1",children:["Optimal for ",h.name,": ",h.optimalRate,"%"]})]}),v==="fromSpawn"?r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Available Spawn (g)"}),r.jsx("input",{type:"number",value:p,onChange:y=>m(y.target.value),placeholder:"e.g., 500",className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-4 py-3 text-white text-lg focus:outline-none focus:border-emerald-500"})]}):r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Target Substrate (g)"}),r.jsx("input",{type:"number",value:g,onChange:y=>f(y.target.value),placeholder:"e.g., 2000",className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-4 py-3 text-white text-lg focus:outline-none focus:border-emerald-500"})]})]}),_&&r.jsxs("div",{className:"p-4 bg-zinc-800/50 rounded-lg",children:[r.jsx("h4",{className:"text-sm font-medium text-zinc-400 mb-3",children:"Batch Plan"}),r.jsxs("div",{className:"flex items-center justify-center gap-4 text-center",children:[r.jsxs("div",{children:[r.jsxs("p",{className:"text-2xl font-bold text-white",children:[_.spawnWeight.toLocaleString(),"g"]}),r.jsx("p",{className:"text-xs text-zinc-500",children:"Spawn"})]}),r.jsx("div",{className:"text-zinc-600",children:r.jsx(Dr.ArrowRight,{})}),r.jsxs("div",{children:[r.jsxs("p",{className:"text-2xl font-bold text-white",children:[_.substrateWeight.toLocaleString(),"g"]}),r.jsx("p",{className:"text-xs text-zinc-500",children:"Substrate"})]}),r.jsx("div",{className:"text-zinc-600",children:"="}),r.jsxs("div",{children:[r.jsxs("p",{className:"text-2xl font-bold text-emerald-400",children:[_.totalWeight.toLocaleString(),"g"]}),r.jsx("p",{className:"text-xs text-zinc-500",children:"Total"})]})]}),r.jsxs("p",{className:"text-center text-sm text-zinc-400 mt-3",children:["at ",_.actualRate,"% spawn rate"]})]})]}),r.jsx("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-5",children:r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx("div",{className:"p-2 bg-blue-950/50 rounded-lg text-blue-400",children:r.jsx(Dr.Info,{})}),r.jsxs("div",{children:[r.jsx("h4",{className:"font-medium text-white",children:h.name}),r.jsx("p",{className:"text-sm text-zinc-400 mt-1",children:h.description}),r.jsxs("div",{className:"flex gap-4 mt-2 text-sm",children:[r.jsxs("span",{className:"text-zinc-500",children:["Range: ",r.jsxs("span",{className:"text-white",children:[h.minRate,"-",h.maxRate,"%"]})]}),r.jsxs("span",{className:"text-zinc-500",children:["Colonization: ",r.jsx("span",{className:"text-white",children:h.colonizationSpeed})]})]})]})]})})]}),r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-5",children:[r.jsx("h3",{className:"text-sm font-medium text-zinc-400 mb-4",children:"Quick Reference"}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"p-3 bg-red-950/30 border border-red-900/50 rounded-lg",children:[r.jsx("p",{className:"text-xs text-red-400 font-medium mb-1",children:"<10% - Too Low"}),r.jsx("p",{className:"text-xs text-zinc-500",children:"Slow colonization, high contam risk"})]}),r.jsxs("div",{className:"p-3 bg-emerald-950/30 border border-emerald-900/50 rounded-lg",children:[r.jsx("p",{className:"text-xs text-emerald-400 font-medium mb-1",children:"10-25% - Optimal"}),r.jsx("p",{className:"text-xs text-zinc-500",children:"Best balance of speed and efficiency"})]}),r.jsxs("div",{className:"p-3 bg-amber-950/30 border border-amber-900/50 rounded-lg",children:[r.jsx("p",{className:"text-xs text-amber-400 font-medium mb-1",children:"25-35% - High"}),r.jsx("p",{className:"text-xs text-zinc-500",children:"Fast colonization, uses more spawn"})]}),r.jsxs("div",{className:"p-3 bg-orange-950/30 border border-orange-900/50 rounded-lg",children:[r.jsx("p",{className:"text-xs text-orange-400 font-medium mb-1",children:">35% - Very High"}),r.jsx("p",{className:"text-xs text-zinc-500",children:"Fastest but inefficient spawn use"})]})]})]}),r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-5",children:[r.jsx("h3",{className:"text-sm font-medium text-zinc-400 mb-4",children:"Common Ratios"}),r.jsxs("div",{className:"space-y-2 text-sm",children:[r.jsxs("div",{className:"flex justify-between py-2 border-b border-zinc-800",children:[r.jsx("span",{className:"text-zinc-400",children:"1:1"}),r.jsx("span",{className:"text-white",children:"50% (G2G expansion)"})]}),r.jsxs("div",{className:"flex justify-between py-2 border-b border-zinc-800",children:[r.jsx("span",{className:"text-zinc-400",children:"1:2"}),r.jsx("span",{className:"text-white",children:"33% (aggressive)"})]}),r.jsxs("div",{className:"flex justify-between py-2 border-b border-zinc-800",children:[r.jsx("span",{className:"text-zinc-400",children:"1:3"}),r.jsx("span",{className:"text-white",children:"25% (high)"})]}),r.jsxs("div",{className:"flex justify-between py-2 border-b border-zinc-800",children:[r.jsx("span",{className:"text-zinc-400",children:"1:4"}),r.jsx("span",{className:"text-emerald-400 font-medium",children:"20% (optimal)"})]}),r.jsxs("div",{className:"flex justify-between py-2 border-b border-zinc-800",children:[r.jsx("span",{className:"text-zinc-400",children:"1:5"}),r.jsx("span",{className:"text-white",children:"17% (efficient)"})]}),r.jsxs("div",{className:"flex justify-between py-2",children:[r.jsx("span",{className:"text-zinc-400",children:"1:10"}),r.jsx("span",{className:"text-white",children:"9% (minimum)"})]})]})]}),S.length>0&&r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-5",children:[r.jsx("h3",{className:"text-sm font-medium text-zinc-400 mb-4",children:"Recent Calculations"}),r.jsx("div",{className:"space-y-2",children:S.slice(0,5).map(y=>r.jsxs("div",{className:"p-2 bg-zinc-800/50 rounded-lg text-sm cursor-pointer hover:bg-zinc-800",onClick:()=>{n(y.spawnWeight.toString()),a(y.substrateWeight.toString()),l(y.preset),t("calculate")},children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsxs("span",{className:"text-white",children:[y.spawnRate.toFixed(1),"%"]}),r.jsx("span",{className:"text-zinc-500 text-xs",children:y.timestamp.toLocaleDateString()})]}),r.jsxs("p",{className:"text-xs text-zinc-500",children:[y.spawnWeight,"g + ",y.substrateWeight,"g"]})]},y.id))})]})]})]})]})},dl=[{minFeet:0,maxFeet:1e3,psiIncrease:0,label:"0-1,000 ft"},{minFeet:1001,maxFeet:2e3,psiIncrease:.5,label:"1,001-2,000 ft"},{minFeet:2001,maxFeet:3e3,psiIncrease:1,label:"2,001-3,000 ft"},{minFeet:3001,maxFeet:4e3,psiIncrease:1.5,label:"3,001-4,000 ft"},{minFeet:4001,maxFeet:5e3,psiIncrease:2,label:"4,001-5,000 ft"},{minFeet:5001,maxFeet:6e3,psiIncrease:2.5,label:"5,001-6,000 ft"},{minFeet:6001,maxFeet:7e3,psiIncrease:3,label:"6,001-7,000 ft"},{minFeet:7001,maxFeet:8e3,psiIncrease:3.5,label:"7,001-8,000 ft"},{minFeet:8001,maxFeet:1e4,psiIncrease:4,label:"8,001-10,000 ft"}],Pn=[{id:"grain-quart",name:"Grain Jars (Quart)",category:"grain",basePSI:15,baseMinutes:90,perQuartAdditional:0,maxMinutes:120,notes:"Oats, rye, wheat, popcorn, millet. Ensure grain is properly hydrated."},{id:"grain-pint",name:"Grain Jars (Pint)",category:"grain",basePSI:15,baseMinutes:75,perQuartAdditional:0,maxMinutes:90,notes:"Smaller jars need slightly less time."},{id:"grain-bag-3lb",name:"Grain Bags (3lb)",category:"grain",basePSI:15,baseMinutes:150,perQuartAdditional:0,maxMinutes:180,notes:"Larger mass requires longer sterilization. Lay flat in PC."},{id:"grain-bag-5lb",name:"Grain Bags (5lb)",category:"grain",basePSI:15,baseMinutes:180,perQuartAdditional:0,maxMinutes:210,notes:"May need to run in batches. Ensure steam penetration."},{id:"sawdust-block",name:"Sawdust Blocks (5lb)",category:"substrate",basePSI:15,baseMinutes:150,perQuartAdditional:0,maxMinutes:180,notes:"Masters mix, supplemented sawdust. Dense blocks need longer."},{id:"straw-pasteurize",name:"Straw (Pasteurization)",category:"substrate",basePSI:0,baseMinutes:60,perQuartAdditional:0,maxMinutes:90,notes:"NOT pressure cooked - use hot water bath at 160-180F."},{id:"manure-substrate",name:"Manure Substrate",category:"substrate",basePSI:15,baseMinutes:120,perQuartAdditional:0,maxMinutes:150,notes:"Composted manure-based substrates."},{id:"agar-plates",name:"Agar Plates (Stack)",category:"agar",basePSI:15,baseMinutes:45,perQuartAdditional:0,maxMinutes:60,notes:"Pour immediately after removing from PC while still liquid."},{id:"agar-slants",name:"Agar Slants",category:"agar",basePSI:15,baseMinutes:30,perQuartAdditional:0,maxMinutes:45,notes:"Small volume tubes sterilize quickly."},{id:"agar-bottle",name:"Agar Media Bottle (500ml)",category:"agar",basePSI:15,baseMinutes:45,perQuartAdditional:5,maxMinutes:60,notes:"Keep cap loose during sterilization."},{id:"lc-jar",name:"Liquid Culture (Quart)",category:"liquid",basePSI:15,baseMinutes:30,perQuartAdditional:5,maxMinutes:45,notes:"Sugar water with nutrients. Dont overfill - max 500ml in quart jar."},{id:"lc-bottle",name:"LC Bottle (500ml)",category:"liquid",basePSI:15,baseMinutes:25,perQuartAdditional:0,maxMinutes:35,notes:"Keep cap loose. Let cool slowly to avoid boil-over."},{id:"water-distilled",name:"Distilled Water (Quart)",category:"liquid",basePSI:15,baseMinutes:20,perQuartAdditional:5,maxMinutes:30,notes:"For syringe filling, rinsing. Already pure - just sterilizing."},{id:"tools-syringes",name:"Syringes & Needles",category:"tools",basePSI:15,baseMinutes:30,perQuartAdditional:0,maxMinutes:45,notes:"Wrap in foil. Remove plunger before sterilizing."},{id:"tools-scalpels",name:"Scalpels & Tools",category:"tools",basePSI:15,baseMinutes:30,perQuartAdditional:0,maxMinutes:45,notes:"Wrap in foil. Can also flame sterilize between uses."}],Lt={Thermometer:()=>r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5",children:r.jsx("path",{d:"M14 14.76V3.5a2.5 2.5 0 0 0-5 0v11.26a4.5 4.5 0 1 0 5 0z"})}),Clock:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("polyline",{points:"12 6 12 12 16 14"})]}),Play:()=>r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),Pause:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5",children:[r.jsx("rect",{x:"6",y:"4",width:"4",height:"16"}),r.jsx("rect",{x:"14",y:"4",width:"4",height:"16"})]}),RotateCcw:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5",children:[r.jsx("polyline",{points:"1 4 1 10 7 10"}),r.jsx("path",{d:"M3.51 15a9 9 0 1 0 2.13-9.36L1 10"})]}),AlertTriangle:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("path",{d:"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"}),r.jsx("line",{x1:"12",y1:"9",x2:"12",y2:"13"}),r.jsx("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]}),Check:()=>r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:r.jsx("polyline",{points:"20 6 9 17 4 12"})}),Mountain:()=>r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5",children:r.jsx("path",{d:"M8 3l4 8 5-5 5 15H2L8 3z"})}),Volume:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5",children:[r.jsx("path",{d:"M14 2.26a3 3 0 0 0-2.45 3.17v10.14A3 3 0 0 0 14 18.74V2.26z"}),r.jsx("path",{d:"M14 2.26L18 6v12l-4 3.74"}),r.jsx("path",{d:"M14 2.26L10 6v12l4 3.74"})]}),Info:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),r.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),Bell:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5",children:[r.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),r.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]})},_h=e=>{const t=Math.floor(e/3600),s=Math.floor(e%3600/60),n=e%60;return t>0?`${t}:${s.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`:`${s}:${n.toString().padStart(2,"0")}`},Ew=()=>{const[e,t]=b.useState(Pn[0].id),[s,n]=b.useState("0"),[i,a]=b.useState("1"),[o,l]=b.useState(""),[d,c]=b.useState(!1),[p,m]=b.useState({isRunning:!1,isPaused:!1,totalSeconds:0,remainingSeconds:0,startTime:null}),[g,f]=b.useState(!0),v=Pn.find(y=>y.id===e)||Pn[0],j=b.useMemo(()=>{const y=parseInt(s)||0,L=parseInt(i)||1,G=dl.find(k=>y>=k.minFeet&&y<=k.maxFeet)||dl[0],H=v.basePSI+G.psiIncrease;let J=v.baseMinutes;L>1&&v.perQuartAdditional>0&&(J+=(L-1)*v.perQuartAdditional);const se=Math.min(J,v.maxMinutes),ge=d&&o?parseInt(o):se;return{psi:H,minutes:ge,altitudeAdjustment:G,isPasteurization:v.basePSI===0}},[e,s,i,o,d,v]);b.useEffect(()=>{let y=null;return p.isRunning&&!p.isPaused&&p.remainingSeconds>0&&(y=setInterval(()=>{m(L=>{const G=L.remainingSeconds-1;if(G<=0){if(g){try{new Audio("data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2teleUY6teleU45YQkREg7yqmpKPl6mpnYVnSEVDiMD/").play().catch(()=>{})}catch{}"Notification"in window&&Notification.permission==="granted"&&new Notification("Pressure Cooking Complete!",{body:`${v.name} sterilization is done.`,icon:""})}return{...L,isRunning:!1,remainingSeconds:0}}return{...L,remainingSeconds:G}})},1e3)),()=>{y&&clearInterval(y)}},[p.isRunning,p.isPaused,p.remainingSeconds,g,v.name]);const S=b.useCallback(()=>{const y=j.minutes*60;m({isRunning:!0,isPaused:!1,totalSeconds:y,remainingSeconds:y,startTime:Date.now()}),"Notification"in window&&Notification.permission==="default"&&Notification.requestPermission()},[j.minutes]),u=b.useCallback(()=>{m(y=>({...y,isPaused:!y.isPaused}))},[]),h=b.useCallback(()=>{m({isRunning:!1,isPaused:!1,totalSeconds:0,remainingSeconds:0,startTime:null})},[]),x=p.totalSeconds>0?(p.totalSeconds-p.remainingSeconds)/p.totalSeconds*100:0,_=["grain","substrate","agar","liquid","tools"],[N,w]=b.useState("all"),C=N==="all"?Pn:Pn.filter(y=>y.category===N);return r.jsxs("div",{className:"space-y-6",children:[r.jsx("div",{className:"flex items-center justify-between",children:r.jsxs("div",{children:[r.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[r.jsx(Lt.Thermometer,{}),"Pressure Cooking Calculator"]}),r.jsx("p",{className:"text-zinc-400 text-sm",children:"Calculate sterilization times with altitude adjustment"})]})}),r.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[r.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[r.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-2",children:[r.jsx("button",{onClick:()=>w("all"),className:`px-3 py-1.5 rounded-lg text-sm font-medium whitespace-nowrap transition-colors ${N==="all"?"bg-emerald-500/20 text-emerald-400":"bg-zinc-800 text-zinc-400 hover:text-white"}`,children:"All"}),_.map(y=>r.jsx("button",{onClick:()=>w(y),className:`px-3 py-1.5 rounded-lg text-sm font-medium whitespace-nowrap capitalize transition-colors ${N===y?"bg-emerald-500/20 text-emerald-400":"bg-zinc-800 text-zinc-400 hover:text-white"}`,children:y},y))]}),r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-5",children:[r.jsx("label",{className:"block text-sm font-medium text-zinc-400 mb-3",children:"What are you sterilizing?"}),r.jsx("div",{className:"grid sm:grid-cols-2 gap-2 max-h-64 overflow-y-auto",children:C.map(y=>r.jsxs("button",{onClick:()=>t(y.id),className:`p-3 rounded-lg border text-left transition-all ${e===y.id?"bg-emerald-950/30 border-emerald-700 text-white":"bg-zinc-800/50 border-zinc-700 text-zinc-400 hover:border-zinc-600"}`,children:[r.jsx("p",{className:"font-medium text-sm",children:y.name}),r.jsx("p",{className:"text-xs text-zinc-500 mt-1",children:y.basePSI>0?`${y.basePSI} PSI  ${y.baseMinutes} min`:"Pasteurization"})]},y.id))})]}),r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-5",children:[r.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Settings"}),r.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm text-zinc-400 mb-2 flex items-center gap-2",children:[r.jsx(Lt.Mountain,{}),"Altitude (feet)"]}),r.jsx("input",{type:"number",value:s,onChange:y=>n(y.target.value),placeholder:"0",className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-4 py-3 text-white focus:outline-none focus:border-emerald-500"}),r.jsx("p",{className:"text-xs text-zinc-500 mt-1",children:"Chicago: ~600 ft  Denver: ~5,280 ft"})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm text-zinc-400 mb-2 flex items-center gap-2",children:[r.jsx(Lt.Volume,{}),"Quantity (jars/bags)"]}),r.jsx("input",{type:"number",value:i,onChange:y=>a(y.target.value),min:"1",max:"20",className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-4 py-3 text-white focus:outline-none focus:border-emerald-500"}),r.jsx("p",{className:"text-xs text-zinc-500 mt-1",children:"More items may need longer time"})]})]}),r.jsxs("div",{className:"mt-4 pt-4 border-t border-zinc-800",children:[r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer mb-3",children:[r.jsx("input",{type:"checkbox",checked:d,onChange:y=>c(y.target.checked),className:"w-4 h-4 rounded bg-zinc-800 border-zinc-700 text-emerald-500 focus:ring-emerald-500"}),r.jsx("span",{className:"text-sm text-zinc-300",children:"Use custom time"})]}),d&&r.jsx("input",{type:"number",value:o,onChange:y=>l(y.target.value),placeholder:"Enter minutes...",className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-emerald-500"})]})]}),r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-5",children:[r.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Recommended Settings"}),j.isPasteurization?r.jsxs("div",{className:"p-4 bg-amber-950/30 border border-amber-800/50 rounded-lg",children:[r.jsxs("div",{className:"flex items-center gap-2 text-amber-400 mb-2",children:[r.jsx(Lt.AlertTriangle,{}),r.jsx("span",{className:"font-medium",children:"Pasteurization (Not Pressure Cooked)"})]}),r.jsxs("p",{className:"text-sm text-zinc-300",children:["Use hot water bath at 160-180F (71-82C) for ",j.minutes," minutes. Do not use pressure cooker for straw pasteurization."]})]}):r.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"p-4 bg-zinc-800/50 rounded-lg text-center",children:[r.jsx("p",{className:"text-sm text-zinc-400 mb-1",children:"Pressure"}),r.jsxs("p",{className:"text-3xl font-bold text-white",children:[j.psi," PSI"]}),j.altitudeAdjustment.psiIncrease>0&&r.jsxs("p",{className:"text-xs text-amber-400 mt-1",children:["+",j.altitudeAdjustment.psiIncrease," PSI for altitude"]})]}),r.jsxs("div",{className:"p-4 bg-zinc-800/50 rounded-lg text-center",children:[r.jsx("p",{className:"text-sm text-zinc-400 mb-1",children:"Time at Pressure"}),r.jsxs("p",{className:"text-3xl font-bold text-white",children:[j.minutes," min"]}),r.jsx("p",{className:"text-xs text-zinc-500 mt-1",children:"After reaching full pressure"})]})]}),r.jsxs("div",{className:"mt-4 p-3 bg-zinc-800/30 rounded-lg flex items-start gap-2",children:[r.jsx(Lt.Info,{}),r.jsx("p",{className:"text-sm text-zinc-400",children:v.notes})]})]})]}),r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-5",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("h3",{className:"text-sm font-medium text-zinc-400 flex items-center gap-2",children:[r.jsx(Lt.Clock,{}),"Timer"]}),r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"checkbox",checked:g,onChange:y=>f(y.target.checked),className:"w-3 h-3 rounded bg-zinc-800 border-zinc-700 text-emerald-500 focus:ring-emerald-500"}),r.jsx(Lt.Bell,{})]})]}),r.jsxs("div",{className:"relative mb-4",children:[r.jsxs("svg",{className:"w-40 h-40 mx-auto transform -rotate-90",children:[r.jsx("circle",{cx:"80",cy:"80",r:"70",fill:"none",stroke:"#27272a",strokeWidth:"8"}),r.jsx("circle",{cx:"80",cy:"80",r:"70",fill:"none",stroke:(p.remainingSeconds===0&&p.totalSeconds>0,"#10b981"),strokeWidth:"8",strokeLinecap:"round",strokeDasharray:2*Math.PI*70,strokeDashoffset:2*Math.PI*70*(1-x/100),className:"transition-all duration-1000"})]}),r.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[r.jsx("span",{className:"text-3xl font-mono font-bold text-white",children:p.isRunning?_h(p.remainingSeconds):_h(j.minutes*60)}),r.jsx("span",{className:"text-xs text-zinc-500 mt-1",children:p.isRunning?p.isPaused?"PAUSED":"RUNNING":"READY"})]})]}),r.jsx("div",{className:"flex gap-2",children:p.isRunning?r.jsxs(r.Fragment,{children:[r.jsxs("button",{onClick:u,className:"flex-1 flex items-center justify-center gap-2 py-3 bg-amber-500 hover:bg-amber-600 text-white rounded-lg font-medium transition-colors",children:[p.isPaused?r.jsx(Lt.Play,{}):r.jsx(Lt.Pause,{}),p.isPaused?"Resume":"Pause"]}),r.jsx("button",{onClick:h,className:"flex items-center justify-center gap-2 py-3 px-4 bg-zinc-700 hover:bg-zinc-600 text-white rounded-lg font-medium transition-colors",children:r.jsx(Lt.RotateCcw,{})})]}):r.jsxs("button",{onClick:S,disabled:j.isPasteurization,className:"flex-1 flex items-center justify-center gap-2 py-3 bg-emerald-500 hover:bg-emerald-600 disabled:bg-zinc-700 disabled:text-zinc-500 text-white rounded-lg font-medium transition-colors",children:[r.jsx(Lt.Play,{}),"Start"]})}),p.totalSeconds>0&&p.remainingSeconds===0&&!p.isRunning&&r.jsxs("div",{className:"mt-4 p-3 bg-emerald-950/30 border border-emerald-800/50 rounded-lg text-center",children:[r.jsx(Lt.Check,{}),r.jsx("p",{className:"text-emerald-400 font-medium",children:"Complete!"}),r.jsx("p",{className:"text-xs text-zinc-400",children:"Let pressure release naturally"})]})]}),r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-5",children:[r.jsx("h3",{className:"text-sm font-medium text-zinc-400 mb-3",children:"Altitude Adjustments"}),r.jsx("div",{className:"space-y-1 text-sm",children:dl.slice(0,6).map(y=>r.jsxs("div",{className:`flex justify-between py-1.5 px-2 rounded ${parseInt(s)>=y.minFeet&&parseInt(s)<=y.maxFeet?"bg-emerald-950/30 text-emerald-400":"text-zinc-400"}`,children:[r.jsx("span",{children:y.label}),r.jsxs("span",{children:["+",y.psiIncrease," PSI"]})]},y.label))})]}),r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-5",children:[r.jsx("h3",{className:"text-sm font-medium text-zinc-400 mb-3",children:"Safety Checklist"}),r.jsx("div",{className:"space-y-2",children:["Check gasket condition","Ensure vent is clear","Add correct water level","Lid locked properly","Start timer at full pressure","Natural release for grains"].map((y,L)=>r.jsxs("label",{className:"flex items-center gap-2 text-sm text-zinc-400 cursor-pointer hover:text-zinc-300",children:[r.jsx("input",{type:"checkbox",className:"w-4 h-4 rounded bg-zinc-800 border-zinc-700 text-emerald-500 focus:ring-emerald-500"}),y]},L))})]})]})]})]})},Ln={liquid_culture:{label:"Liquid Culture",icon:"",prefix:"LC"},agar:{label:"Agar Plate",icon:"",prefix:"AG"},slant:{label:"Slant",icon:"",prefix:"SL"},spore_syringe:{label:"Spore Syringe",icon:"",prefix:"SS"}},oa={active:{label:"Active",color:"text-emerald-400 bg-emerald-950/50"},colonizing:{label:"Colonizing",color:"text-blue-400 bg-blue-950/50"},ready:{label:"Ready",color:"text-green-400 bg-green-950/50"},contaminated:{label:"Contaminated",color:"text-red-400 bg-red-950/50"},archived:{label:"Archived",color:"text-zinc-400 bg-zinc-800"},depleted:{label:"Depleted",color:"text-amber-400 bg-amber-950/50"}},Qt={Plus:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),Search:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),X:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),Trash:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("polyline",{points:"3 6 5 6 21 6"}),r.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]}),Grid:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),r.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),r.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),r.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]}),List:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("line",{x1:"8",y1:"6",x2:"21",y2:"6"}),r.jsx("line",{x1:"8",y1:"12",x2:"21",y2:"12"}),r.jsx("line",{x1:"8",y1:"18",x2:"21",y2:"18"}),r.jsx("line",{x1:"3",y1:"6",x2:"3.01",y2:"6"}),r.jsx("line",{x1:"3",y1:"12",x2:"3.01",y2:"12"}),r.jsx("line",{x1:"3",y1:"18",x2:"3.01",y2:"18"})]}),Share:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("circle",{cx:"18",cy:"5",r:"3"}),r.jsx("circle",{cx:"6",cy:"12",r:"3"}),r.jsx("circle",{cx:"18",cy:"19",r:"3"}),r.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),r.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),Clipboard:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"}),r.jsx("rect",{x:"8",y:"2",width:"8",height:"4",rx:"1",ry:"1"})]})},ul=({rating:e})=>r.jsx("div",{className:"flex gap-0.5",children:[1,2,3,4,5].map(t=>r.jsx("div",{className:`w-1.5 h-4 rounded-sm ${t<=e?e>=4?"bg-emerald-500":e>=2?"bg-amber-500":"bg-red-500":"bg-zinc-700"}`},t))}),Ch=e=>{const t=Math.floor((Date.now()-new Date(e).getTime())/864e5);return t===0?"Today":t===1?"1 day ago":`${t} days ago`},Iw=()=>{var Dt,jt,St,We,ut,_e,Oe,Gt;const{state:e,activeStrains:t,activeLocations:s,activeVessels:n,activeSuppliers:i,activeRecipes:a,getStrain:o,getLocation:l,getVessel:d,getSupplier:c,getRecipe:p,getCultureLineage:m,generateCultureLabel:g,addCulture:f,updateCulture:v,deleteCulture:j,addCultureObservation:S,addCultureTransfer:u}=ar(),h=e.cultures,[x,_]=b.useState("grid"),[N,w]=b.useState(""),[C,y]=b.useState("all"),[L,G]=b.useState("all"),[H,J]=b.useState("all"),[se,ge]=b.useState("date"),[k,M]=b.useState(null),[oe,B]=b.useState(!1),[D,$]=b.useState(!1),[Y,le]=b.useState(!1),[Q,O]=b.useState({type:"agar",strainId:"",locationId:"",vesselId:"",recipeId:"",volumeMl:void 0,fillVolumeMl:void 0,cost:0,supplierId:"",lotNumber:"",notes:"",prepDate:new Date().toISOString().split("T")[0]}),[U,re]=b.useState({type:"general",notes:"",healthRating:void 0}),[pe,Be]=b.useState({toType:"agar",quantity:1,unit:"wedge",notes:"",createNewRecord:!1});b.useEffect(()=>{const T=V=>{var xe;((xe=V.detail)==null?void 0:xe.page)==="cultures"&&B(!0)};return window.addEventListener("mycolab:create-new",T),()=>window.removeEventListener("mycolab:create-new",T)},[]);const or=b.useMemo(()=>{let T=[...h];if(C!=="all"&&(T=T.filter(V=>V.type===C)),L!=="all"&&(T=T.filter(V=>V.status===L)),H!=="all"&&(T=T.filter(V=>V.strainId===H)),N){const V=N.toLowerCase();T=T.filter(xe=>{var He;return xe.label.toLowerCase().includes(V)||((He=o(xe.strainId))==null?void 0:He.name.toLowerCase().includes(V))||xe.notes.toLowerCase().includes(V)})}switch(se){case"date":T.sort((V,xe)=>new Date(xe.createdAt).getTime()-new Date(V.createdAt).getTime());break;case"name":T.sort((V,xe)=>V.label.localeCompare(xe.label));break;case"strain":T.sort((V,xe)=>{var He,vr;return(((He=o(V.strainId))==null?void 0:He.name)||"").localeCompare(((vr=o(xe.strainId))==null?void 0:vr.name)||"")});break;case"health":T.sort((V,xe)=>xe.healthRating-V.healthRating);break}return T},[h,C,L,H,N,se,o]),dt=b.useMemo(()=>{const T=h.filter(V=>!["contaminated","archived","depleted"].includes(V.status));return{liquidCulture:T.filter(V=>V.type==="liquid_culture").length,agar:T.filter(V=>V.type==="agar").length,slant:T.filter(V=>V.type==="slant").length,sporeSyringe:T.filter(V=>V.type==="spore_syringe").length}},[h]),Vt=b.useMemo(()=>[...new Set(h.map(T=>T.strainId))],[h]),Er=()=>{!Q.strainId||!Q.locationId||!Q.vesselId||(f({type:Q.type,label:g(Q.type),strainId:Q.strainId,status:"colonizing",generation:0,locationId:Q.locationId,vesselId:Q.vesselId,recipeId:Q.recipeId||void 0,volumeMl:Q.volumeMl,fillVolumeMl:Q.fillVolumeMl,prepDate:Q.prepDate||void 0,healthRating:5,notes:Q.notes,cost:Q.cost,supplierId:Q.supplierId||void 0,lotNumber:Q.lotNumber||void 0}),B(!1),O({type:"agar",strainId:"",locationId:"",vesselId:"",recipeId:"",volumeMl:void 0,fillVolumeMl:void 0,cost:0,supplierId:"",lotNumber:"",notes:"",prepDate:new Date().toISOString().split("T")[0]}))},ee=()=>{!k||!U.notes||(S(k.id,{date:new Date,type:U.type,notes:U.notes,healthRating:U.healthRating}),setTimeout(()=>{const T=e.cultures.find(V=>V.id===k.id);T&&M(T)},0),$(!1),re({type:"general",notes:"",healthRating:void 0}))},R=()=>{if(!k)return;const T=pe.createNewRecord?`culture-${Date.now()}`:void 0;u(k.id,{date:new Date,fromId:k.id,toId:T,toType:pe.toType,quantity:pe.quantity,unit:pe.unit,notes:pe.notes}),setTimeout(()=>{const V=e.cultures.find(xe=>xe.id===k.id);V&&M(V)},0),le(!1),Be({toType:"agar",quantity:1,unit:"wedge",notes:"",createNewRecord:!1})},ue=T=>{confirm("Are you sure you want to delete this culture?")&&(j(T),(k==null?void 0:k.id)===T&&M(null))},lr=T=>{k&&(v(k.id,{status:T}),M({...k,status:T}))},wt=b.useMemo(()=>k?m(k.id):{ancestors:[],descendants:[]},[k,m]);return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold text-white",children:"Culture Library"}),r.jsx("p",{className:"text-zinc-400 text-sm",children:"Manage your living cultures and genetics"})]}),r.jsxs("button",{onClick:()=>B(!0),className:"flex items-center gap-2 px-4 py-2 bg-emerald-500 hover:bg-emerald-600 text-white rounded-lg font-medium transition-colors",children:[r.jsx(Qt.Plus,{}),"New Culture"]})]}),r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-4 flex items-center gap-3",children:[r.jsx("span",{className:"text-2xl",children:""}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-zinc-500",children:"Liquid Cultures"}),r.jsx("p",{className:"text-xl font-bold text-white",children:dt.liquidCulture})]})]}),r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-4 flex items-center gap-3",children:[r.jsx("span",{className:"text-2xl",children:""}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-zinc-500",children:"Agar Plates"}),r.jsx("p",{className:"text-xl font-bold text-white",children:dt.agar})]})]}),r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-4 flex items-center gap-3",children:[r.jsx("span",{className:"text-2xl",children:""}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-zinc-500",children:"Slants"}),r.jsx("p",{className:"text-xl font-bold text-white",children:dt.slant})]})]}),r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-4 flex items-center gap-3",children:[r.jsx("span",{className:"text-2xl",children:""}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-zinc-500",children:"Spore Syringes"}),r.jsx("p",{className:"text-xl font-bold text-white",children:dt.sporeSyringe})]})]})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[r.jsxs("div",{className:"flex-1 min-w-64 relative",children:[r.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-zinc-500",children:r.jsx(Qt.Search,{})}),r.jsx("input",{type:"text",value:N,onChange:T=>w(T.target.value),placeholder:"Search cultures...",className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg pl-10 pr-4 py-2 text-white placeholder-zinc-500 focus:outline-none focus:border-emerald-500"})]}),r.jsxs("select",{value:C,onChange:T=>y(T.target.value),className:"bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm",children:[r.jsx("option",{value:"all",children:"All Types"}),Object.entries(Ln).map(([T,V])=>r.jsxs("option",{value:T,children:[V.icon," ",V.label]},T))]}),r.jsxs("select",{value:L,onChange:T=>G(T.target.value),className:"bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm",children:[r.jsx("option",{value:"all",children:"All Statuses"}),Object.entries(oa).map(([T,V])=>r.jsx("option",{value:T,children:V.label},T))]}),r.jsxs("select",{value:H,onChange:T=>J(T.target.value),className:"bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm",children:[r.jsx("option",{value:"all",children:"All Strains"}),Vt.map(T=>{const V=o(T);return V?r.jsx("option",{value:T,children:V.name},T):null})]}),r.jsxs("select",{value:se,onChange:T=>ge(T.target.value),className:"bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm",children:[r.jsx("option",{value:"date",children:"Sort by Date"}),r.jsx("option",{value:"name",children:"Sort by Name"}),r.jsx("option",{value:"strain",children:"Sort by Strain"}),r.jsx("option",{value:"health",children:"Sort by Health"})]}),r.jsxs("div",{className:"flex bg-zinc-800 rounded-lg border border-zinc-700 overflow-hidden",children:[r.jsx("button",{onClick:()=>_("grid"),className:`p-2 transition-colors ${x==="grid"?"bg-emerald-500/20 text-emerald-400":"text-zinc-400 hover:text-white"}`,children:r.jsx(Qt.Grid,{})}),r.jsx("button",{onClick:()=>_("list"),className:`p-2 transition-colors ${x==="list"?"bg-emerald-500/20 text-emerald-400":"text-zinc-400 hover:text-white"}`,children:r.jsx(Qt.List,{})})]})]}),r.jsxs("div",{className:"flex gap-6",children:[r.jsx("div",{className:"flex-1",children:x==="grid"?r.jsx("div",{className:"grid md:grid-cols-2 xl:grid-cols-3 gap-4",children:or.map(T=>{const V=o(T.strainId),xe=Ln[T.type],He=oa[T.status];return r.jsxs("div",{onClick:()=>M(T),className:`bg-zinc-900/50 border rounded-xl p-4 cursor-pointer transition-all hover:border-zinc-600 ${(k==null?void 0:k.id)===T.id?"border-emerald-600":"border-zinc-800"}`,children:[r.jsxs("div",{className:"flex items-start justify-between mb-3",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-xl",children:xe.icon}),r.jsxs("div",{children:[r.jsx("p",{className:"font-semibold text-white",children:T.label}),r.jsx("p",{className:"text-xs text-zinc-500",children:(V==null?void 0:V.name)||"Unknown"})]})]}),r.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${He.color}`,children:He.label})]}),r.jsxs("div",{className:"flex items-center justify-between text-sm",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("span",{className:"text-zinc-500",children:["G",T.generation]}),r.jsx(ul,{rating:T.healthRating})]}),T.volumeMl&&r.jsxs("span",{className:"text-zinc-400",children:[T.volumeMl,"ml"]})]}),r.jsx("div",{className:"mt-3 pt-3 border-t border-zinc-800 text-xs text-zinc-500",children:Ch(T.createdAt)})]},T.id)})}):r.jsx("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl overflow-hidden",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b border-zinc-800",children:[r.jsx("th",{className:"text-left p-3 text-sm font-medium text-zinc-400",children:"Culture"}),r.jsx("th",{className:"text-left p-3 text-sm font-medium text-zinc-400",children:"Strain"}),r.jsx("th",{className:"text-left p-3 text-sm font-medium text-zinc-400",children:"Status"}),r.jsx("th",{className:"text-left p-3 text-sm font-medium text-zinc-400",children:"Gen"}),r.jsx("th",{className:"text-left p-3 text-sm font-medium text-zinc-400",children:"Health"}),r.jsx("th",{className:"text-left p-3 text-sm font-medium text-zinc-400",children:"Age"})]})}),r.jsx("tbody",{children:or.map(T=>{const V=o(T.strainId),xe=Ln[T.type],He=oa[T.status];return r.jsxs("tr",{onClick:()=>M(T),className:`border-b border-zinc-800/50 cursor-pointer hover:bg-zinc-800/30 ${(k==null?void 0:k.id)===T.id?"bg-emerald-950/20":""}`,children:[r.jsx("td",{className:"p-3",children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{children:xe.icon}),r.jsx("span",{className:"font-medium text-white",children:T.label})]})}),r.jsx("td",{className:"p-3 text-sm text-white",children:(V==null?void 0:V.name)||"Unknown"}),r.jsx("td",{className:"p-3",children:r.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${He.color}`,children:He.label})}),r.jsxs("td",{className:"p-3 text-sm text-zinc-400",children:["G",T.generation]}),r.jsx("td",{className:"p-3",children:r.jsx(ul,{rating:T.healthRating})}),r.jsx("td",{className:"p-3 text-sm text-zinc-500",children:Ch(T.createdAt)})]},T.id)})})]})})}),k&&r.jsxs("div",{className:"w-96 bg-zinc-900/50 border border-zinc-800 rounded-xl p-5 h-fit sticky top-6 max-h-[calc(100vh-200px)] overflow-y-auto",children:[r.jsxs("div",{className:"flex items-start justify-between mb-4",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("span",{className:"text-3xl",children:Ln[k.type].icon}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-bold text-white",children:k.label}),r.jsx("p",{className:"text-sm text-zinc-400",children:(Dt=o(k.strainId))==null?void 0:Dt.name})]})]}),r.jsx("button",{onClick:()=>M(null),className:"text-zinc-400 hover:text-white",children:r.jsx(Qt.X,{})})]}),r.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:Object.entries(oa).map(([T,V])=>r.jsx("button",{onClick:()=>lr(T),className:`px-2 py-1 rounded text-xs font-medium transition-all ${k.status===T?V.color+" ring-1 ring-white/20":"bg-zinc-800 text-zinc-500 hover:text-white"}`,children:V.label},T))}),r.jsxs("div",{className:"space-y-2 text-sm mb-4",children:[r.jsxs("div",{className:"flex justify-between py-2 border-b border-zinc-800",children:[r.jsx("span",{className:"text-zinc-500",children:"Generation"}),r.jsxs("span",{className:"text-white",children:["G",k.generation]})]}),r.jsxs("div",{className:"flex justify-between py-2 border-b border-zinc-800",children:[r.jsx("span",{className:"text-zinc-500",children:"Health"}),r.jsx(ul,{rating:k.healthRating})]}),r.jsxs("div",{className:"flex justify-between py-2 border-b border-zinc-800",children:[r.jsx("span",{className:"text-zinc-500",children:"Location"}),r.jsx("span",{className:"text-white",children:(jt=l(k.locationId))==null?void 0:jt.name})]}),r.jsxs("div",{className:"flex justify-between py-2 border-b border-zinc-800",children:[r.jsx("span",{className:"text-zinc-500",children:"Vessel"}),r.jsx("span",{className:"text-white",children:(St=d(k.vesselId))==null?void 0:St.name})]}),k.recipeId&&r.jsxs("div",{className:"py-2 border-b border-zinc-800",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-zinc-500",children:"Recipe"}),r.jsx("span",{className:"text-emerald-400 font-medium",children:((We=p(k.recipeId))==null?void 0:We.name)||"Unknown"})]}),((ut=p(k.recipeId))==null?void 0:ut.description)&&r.jsx("p",{className:"text-xs text-zinc-500 mt-1",children:(_e=p(k.recipeId))==null?void 0:_e.description})]}),(k.volumeMl||k.fillVolumeMl)&&r.jsxs("div",{className:"py-2 border-b border-zinc-800",children:[r.jsxs("div",{className:"flex justify-between mb-1",children:[r.jsx("span",{className:"text-zinc-500",children:"Volume"}),r.jsxs("span",{className:"text-white",children:[k.fillVolumeMl||k.volumeMl,"ml",k.fillVolumeMl&&k.volumeMl&&k.fillVolumeMl!==k.volumeMl&&r.jsxs("span",{className:"text-zinc-500 text-xs ml-1",children:["/ ",k.volumeMl,"ml (",Math.round(k.fillVolumeMl/k.volumeMl*100),"% full)"]})]})]}),k.fillVolumeMl&&k.volumeMl&&r.jsx("div",{className:"h-1.5 bg-zinc-700 rounded-full overflow-hidden",children:r.jsx("div",{className:"h-full bg-emerald-500 rounded-full",style:{width:`${Math.min(100,k.fillVolumeMl/k.volumeMl*100)}%`}})})]}),k.prepDate&&r.jsxs("div",{className:"flex justify-between py-2 border-b border-zinc-800",children:[r.jsx("span",{className:"text-zinc-500",children:"Prep Date"}),r.jsx("span",{className:"text-white",children:new Date(k.prepDate).toLocaleDateString()})]}),k.supplierId&&r.jsxs("div",{className:"flex justify-between py-2 border-b border-zinc-800",children:[r.jsx("span",{className:"text-zinc-500",children:"Supplier"}),r.jsx("span",{className:"text-white",children:(Oe=c(k.supplierId))==null?void 0:Oe.name})]}),r.jsxs("div",{className:"flex justify-between py-2 border-b border-zinc-800",children:[r.jsx("span",{className:"text-zinc-500",children:"Cost"}),r.jsxs("span",{className:"text-white",children:["$",k.cost.toFixed(2)]})]}),r.jsxs("div",{className:"flex justify-between py-2 border-b border-zinc-800",children:[r.jsx("span",{className:"text-zinc-500",children:"Created"}),r.jsx("span",{className:"text-white",children:new Date(k.createdAt).toLocaleDateString()})]})]}),(wt.ancestors.length>0||wt.descendants.length>0)&&r.jsxs("div",{className:"mb-4",children:[r.jsx("p",{className:"text-xs text-zinc-500 mb-2",children:"Lineage"}),r.jsxs("div",{className:"bg-zinc-800/50 rounded-lg p-3 space-y-1 text-sm",children:[wt.ancestors.map(T=>r.jsxs("div",{className:"text-zinc-400 cursor-pointer hover:text-white",onClick:()=>M(T),children:[" ",T.label," (G",T.generation,")"]},T.id)),r.jsxs("div",{className:"text-emerald-400 font-medium",children:[" ",k.label," (G",k.generation,")"]}),wt.descendants.map(T=>r.jsxs("div",{className:"text-zinc-400 cursor-pointer hover:text-white",onClick:()=>M(T),children:[" ",T.label," (G",T.generation,")"]},T.id))]})]}),k.notes&&r.jsxs("div",{className:"mb-4",children:[r.jsx("p",{className:"text-xs text-zinc-500 mb-1",children:"Notes"}),r.jsx("p",{className:"text-sm text-zinc-300 bg-zinc-800/50 rounded p-2",children:k.notes})]}),k.observations.length>0&&r.jsxs("div",{className:"mb-4",children:[r.jsx("p",{className:"text-xs text-zinc-500 mb-2",children:"Recent Observations"}),r.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:k.observations.slice(-3).reverse().map(T=>r.jsxs("div",{className:"bg-zinc-800/50 rounded p-2 text-xs",children:[r.jsxs("div",{className:"flex justify-between text-zinc-500 mb-1",children:[r.jsx("span",{children:T.type}),r.jsx("span",{children:new Date(T.date).toLocaleDateString()})]}),r.jsx("p",{className:"text-zinc-300",children:T.notes})]},T.id))})]}),r.jsxs("div",{className:"flex flex-wrap gap-2 pt-4 border-t border-zinc-800",children:[r.jsxs("button",{onClick:()=>$(!0),className:"flex-1 flex items-center justify-center gap-1 py-2 bg-zinc-800 hover:bg-zinc-700 text-white rounded-lg text-sm font-medium",children:[r.jsx(Qt.Clipboard,{}),"Log"]}),r.jsxs("button",{onClick:()=>le(!0),className:"flex-1 flex items-center justify-center gap-1 py-2 bg-emerald-500/20 hover:bg-emerald-500/30 text-emerald-400 rounded-lg text-sm font-medium",children:[r.jsx(Qt.Share,{}),"Transfer"]}),r.jsx("button",{onClick:()=>ue(k.id),className:"p-2 bg-red-950/50 hover:bg-red-950 text-red-400 rounded-lg",children:r.jsx(Qt.Trash,{})})]})]})]}),oe&&r.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-zinc-900 border border-zinc-700 rounded-xl p-6 max-w-md w-full max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-white",children:"New Culture"}),r.jsx("button",{onClick:()=>B(!1),className:"text-zinc-400 hover:text-white",children:r.jsx(Qt.X,{})})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Type"}),r.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.entries(Ln).map(([T,V])=>r.jsxs("button",{onClick:()=>O(xe=>({...xe,type:T})),className:`p-3 rounded-lg border text-sm font-medium transition-all ${Q.type===T?"border-emerald-500 bg-emerald-500/10 text-emerald-400":"border-zinc-700 bg-zinc-800 text-zinc-400 hover:border-zinc-600"}`,children:[r.jsx("span",{className:"text-xl mr-2",children:V.icon}),V.label]},T))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Strain *"}),r.jsxs("select",{value:Q.strainId,onChange:T=>O(V=>({...V,strainId:T.target.value})),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white",children:[r.jsx("option",{value:"",children:"Select strain..."}),t.map(T=>r.jsx("option",{value:T.id,children:T.name},T.id))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Location *"}),r.jsxs("select",{value:Q.locationId,onChange:T=>O(V=>({...V,locationId:T.target.value})),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white",children:[r.jsx("option",{value:"",children:"Select location..."}),s.map(T=>r.jsx("option",{value:T.id,children:T.name},T.id))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Vessel *"}),r.jsxs("select",{value:Q.vesselId,onChange:T=>O(V=>({...V,vesselId:T.target.value})),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white",children:[r.jsx("option",{value:"",children:"Select vessel..."}),n.map(T=>r.jsx("option",{value:T.id,children:T.name},T.id))]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm text-zinc-400 mb-2",children:["Recipe / Media Formula",r.jsx("span",{className:"text-zinc-500 text-xs ml-2",children:"(what's in this container?)"})]}),r.jsxs("select",{value:Q.recipeId,onChange:T=>O(V=>({...V,recipeId:T.target.value})),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white",children:[r.jsx("option",{value:"",children:"Select recipe..."}),a.filter(T=>Q.type==="liquid_culture"?T.category==="liquid_culture":Q.type==="agar"||Q.type==="slant"?T.category==="agar":Q.type==="spore_syringe"?T.category==="liquid_culture"||T.category==="other":!0).map(T=>r.jsx("option",{value:T.id,children:T.name},T.id))]}),Q.recipeId&&r.jsx("p",{className:"text-xs text-zinc-500 mt-1",children:((Gt=p(Q.recipeId))==null?void 0:Gt.description)||"No description"})]}),(Q.type==="liquid_culture"||Q.type==="spore_syringe")&&r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm text-zinc-400 mb-2",children:["Container Capacity (ml)",r.jsx("span",{className:"text-zinc-500 text-xs block",children:"Total vessel volume"})]}),r.jsx("input",{type:"number",value:Q.volumeMl||"",onChange:T=>O(V=>({...V,volumeMl:parseInt(T.target.value)||void 0})),placeholder:"e.g., 1000",className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white"})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm text-zinc-400 mb-2",children:["Fill Amount (ml)",r.jsx("span",{className:"text-zinc-500 text-xs block",children:"Actual media inside"})]}),r.jsx("input",{type:"number",value:Q.fillVolumeMl||"",onChange:T=>O(V=>({...V,fillVolumeMl:parseInt(T.target.value)||void 0})),placeholder:"e.g., 600",className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Prep Date"}),r.jsx("input",{type:"date",value:Q.prepDate||"",onChange:T=>O(V=>({...V,prepDate:T.target.value})),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Cost ($)"}),r.jsx("input",{type:"number",value:Q.cost||"",onChange:T=>O(V=>({...V,cost:parseFloat(T.target.value)||0})),step:"0.01",className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Supplier"}),r.jsxs("select",{value:Q.supplierId,onChange:T=>O(V=>({...V,supplierId:T.target.value})),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white",children:[r.jsx("option",{value:"",children:"Select supplier..."}),i.map(T=>r.jsx("option",{value:T.id,children:T.name},T.id))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Notes"}),r.jsx("textarea",{value:Q.notes,onChange:T=>O(V=>({...V,notes:T.target.value})),rows:3,className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white"})]})]}),r.jsxs("div",{className:"flex gap-3 mt-6",children:[r.jsx("button",{onClick:()=>B(!1),className:"flex-1 py-2 bg-zinc-800 hover:bg-zinc-700 text-white rounded-lg font-medium",children:"Cancel"}),r.jsx("button",{onClick:Er,disabled:!Q.strainId||!Q.locationId||!Q.vesselId,className:"flex-1 py-2 bg-emerald-500 hover:bg-emerald-600 disabled:bg-zinc-700 disabled:text-zinc-500 text-white rounded-lg font-medium",children:"Create"})]})]})}),D&&k&&r.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-zinc-900 border border-zinc-700 rounded-xl p-6 max-w-md w-full",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-white",children:"Log Observation"}),r.jsx("button",{onClick:()=>$(!1),className:"text-zinc-400 hover:text-white",children:r.jsx(Qt.X,{})})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Type"}),r.jsxs("select",{value:U.type,onChange:T=>re(V=>({...V,type:T.target.value})),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white",children:[r.jsx("option",{value:"general",children:"General"}),r.jsx("option",{value:"growth",children:"Growth"}),r.jsx("option",{value:"contamination",children:"Contamination"}),r.jsx("option",{value:"transfer",children:"Transfer"}),r.jsx("option",{value:"harvest",children:"Harvest"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Health Rating"}),r.jsx("div",{className:"flex gap-2",children:[1,2,3,4,5].map(T=>r.jsx("button",{onClick:()=>re(V=>({...V,healthRating:T})),className:`w-10 h-10 rounded-lg font-medium transition-all ${U.healthRating===T?"bg-emerald-500 text-white":"bg-zinc-800 text-zinc-400 hover:bg-zinc-700"}`,children:T},T))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Notes *"}),r.jsx("textarea",{value:U.notes,onChange:T=>re(V=>({...V,notes:T.target.value})),rows:4,className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white"})]})]}),r.jsxs("div",{className:"flex gap-3 mt-6",children:[r.jsx("button",{onClick:()=>$(!1),className:"flex-1 py-2 bg-zinc-800 hover:bg-zinc-700 text-white rounded-lg font-medium",children:"Cancel"}),r.jsx("button",{onClick:ee,disabled:!U.notes,className:"flex-1 py-2 bg-emerald-500 hover:bg-emerald-600 disabled:bg-zinc-700 disabled:text-zinc-500 text-white rounded-lg font-medium",children:"Save"})]})]})}),Y&&k&&r.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-zinc-900 border border-zinc-700 rounded-xl p-6 max-w-md w-full",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-white",children:"Transfer Culture"}),r.jsx("button",{onClick:()=>le(!1),className:"text-zinc-400 hover:text-white",children:r.jsx(Qt.X,{})})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Transfer To"}),r.jsxs("select",{value:pe.toType,onChange:T=>Be(V=>({...V,toType:T.target.value})),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white",children:[r.jsx("option",{value:"agar",children:"Agar Plate"}),r.jsx("option",{value:"liquid_culture",children:"Liquid Culture"}),r.jsx("option",{value:"slant",children:"Slant"}),r.jsx("option",{value:"grain_spawn",children:"Grain Spawn"}),r.jsx("option",{value:"bulk",children:"Bulk Substrate"})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Quantity"}),r.jsx("input",{type:"number",value:pe.quantity,onChange:T=>Be(V=>({...V,quantity:parseInt(T.target.value)||1})),min:"1",className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Unit"}),r.jsxs("select",{value:pe.unit,onChange:T=>Be(V=>({...V,unit:T.target.value})),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white",children:[r.jsx("option",{value:"wedge",children:"Wedge"}),r.jsx("option",{value:"ml",children:"ml"}),r.jsx("option",{value:"cc",children:"cc"}),r.jsx("option",{value:"drop",children:"Drop"})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Notes"}),r.jsx("textarea",{value:pe.notes,onChange:T=>Be(V=>({...V,notes:T.target.value})),rows:2,className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white"})]}),["agar","liquid_culture","slant","spore_syringe"].includes(pe.toType)&&r.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[r.jsx("input",{type:"checkbox",checked:pe.createNewRecord,onChange:T=>Be(V=>({...V,createNewRecord:T.target.checked})),className:"rounded border-zinc-600"}),r.jsx("span",{className:"text-zinc-300",children:"Create new culture record"})]})]}),r.jsxs("div",{className:"flex gap-3 mt-6",children:[r.jsx("button",{onClick:()=>le(!1),className:"flex-1 py-2 bg-zinc-800 hover:bg-zinc-700 text-white rounded-lg font-medium",children:"Cancel"}),r.jsx("button",{onClick:R,className:"flex-1 py-2 bg-emerald-500 hover:bg-emerald-600 text-white rounded-lg font-medium",children:"Transfer"})]})]})})]})},Mn={ZoomIn:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"}),r.jsx("line",{x1:"11",y1:"8",x2:"11",y2:"14"}),r.jsx("line",{x1:"8",y1:"11",x2:"14",y2:"11"})]}),ZoomOut:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"}),r.jsx("line",{x1:"8",y1:"11",x2:"14",y2:"11"})]}),Reset:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"}),r.jsx("path",{d:"M3 3v5h5"})]}),X:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})},Bs={spore_syringe:{icon:"",color:"text-purple-400",bgColor:"bg-purple-950/50 border-purple-700"},liquid_culture:{icon:"",color:"text-blue-400",bgColor:"bg-blue-950/50 border-blue-700"},agar:{icon:"",color:"text-emerald-400",bgColor:"bg-emerald-950/50 border-emerald-700"},slant:{icon:"",color:"text-amber-400",bgColor:"bg-amber-950/50 border-amber-700"},grain_spawn:{icon:"",color:"text-orange-400",bgColor:"bg-orange-950/50 border-orange-700"}},Ow={active:"ring-emerald-500",colonizing:"ring-blue-500",ready:"ring-green-500",contaminated:"ring-red-500",expired:"ring-zinc-500",used:"ring-zinc-600"},Tw=()=>{var J,se,ge;const{state:e,getStrain:t,getCultureLineage:s}=ar(),n=e.cultures,[i,a]=b.useState(null),[o,l]=b.useState(1),[d,c]=b.useState("all"),[p,m]=b.useState("all"),[g,f]=b.useState(new Set),[v,j]=b.useState("tree"),S=b.useMemo(()=>[...new Set(n.map(M=>M.strainId))].map(M=>t(M)).filter(Boolean),[n,t]),u=b.useMemo(()=>n.filter(k=>!k.parentId),[n]),h=b.useCallback((k,M=0)=>{const oe=n.filter(B=>B.parentId===k.id);return{culture:k,x:0,y:M*120,level:M,children:oe.map(B=>h(B,M+1))}},[n]),x=b.useCallback((k,M=0)=>{let D=M;return k.forEach($=>{if($.children.length===0)$.x=D,D+=200;else{x($.children,D);const Y=$.children[0],le=$.children[$.children.length-1];$.x=(Y.x+le.x)/2,D=Math.max(D,$.x+160+40)}}),D},[]),_=b.useMemo(()=>{let k=u;d!=="all"&&(k=k.filter(B=>B.strainId===d)),p!=="all"&&(k=k.filter(B=>B.type===p));const M=k.map(B=>h(B));let oe=0;return M.forEach(B=>{oe=x([B],oe)+80}),M},[u,d,p,h,x]),N=b.useCallback(k=>k.flatMap(M=>[M,...N(M.children)]),[]),w=b.useMemo(()=>N(_),[_,N]),C=b.useMemo(()=>{if(w.length===0)return{width:800,height:400};const k=Math.max(...w.map(oe=>oe.x))+200,M=Math.max(...w.map(oe=>oe.y))+150;return{width:Math.max(800,k),height:Math.max(400,M)}},[w]),y=k=>{a(k);const M=s(k.id),oe=new Set([...M.ancestors.map(B=>B.id),k.id,...M.descendants.map(B=>B.id)]);f(oe)},L=()=>{a(null),f(new Set)},G=()=>{const k=[],M=oe=>{oe.forEach(B=>{B.children.forEach(D=>{const $=g.has(B.culture.id)&&g.has(D.culture.id);k.push(r.jsx("path",{d:`M ${B.x+70} ${B.y+80} 
                  C ${B.x+70} ${B.y+100}, 
                    ${D.x+70} ${D.y-20}, 
                    ${D.x+70} ${D.y}`,fill:"none",stroke:$?"#10b981":"#3f3f46",strokeWidth:$?3:2,className:"transition-all duration-300"},`${B.culture.id}-${D.culture.id}`))}),M(B.children)})};return M(_),k},H=k=>{const{culture:M}=k,oe=Bs[M.type]||Bs.agar,B=t(M.strainId),D=(i==null?void 0:i.id)===M.id,$=g.has(M.id),Y=g.size===0||$?1:.3;return r.jsxs("g",{transform:`translate(${k.x}, ${k.y})`,className:"cursor-pointer",onClick:()=>y(M),style:{opacity:Y},children:[r.jsx("rect",{x:"0",y:"0",width:"140",height:"80",rx:"8",className:`${oe.bgColor} transition-all duration-300 ${D?"stroke-emerald-500 stroke-2":"stroke-zinc-700"}`,fill:"currentColor",stroke:"currentColor"}),r.jsx("circle",{cx:"120",cy:"20",r:"8",className:`${Ow[M.status]} ring-2`,fill:M.status==="contaminated"?"#ef4444":M.status==="ready"?"#22c55e":M.status==="active"?"#10b981":"#52525b"}),r.jsx("text",{x:"15",y:"30",fontSize:"20",children:oe.icon}),r.jsx("text",{x:"40",y:"28",className:"fill-white text-sm font-bold",children:M.label}),r.jsx("text",{x:"15",y:"50",className:"fill-zinc-400 text-xs",children:(B==null?void 0:B.name)||"Unknown"}),r.jsxs("text",{x:"15",y:"68",className:"fill-zinc-500 text-xs",children:["G",M.generation]}),M.healthRating&&r.jsx("g",{transform:"translate(90, 55)",children:[1,2,3,4,5].map(le=>r.jsx("rect",{x:(le-1)*8,y:0,width:"6",height:"12",rx:"1",fill:le<=M.healthRating?"#10b981":"#3f3f46"},le))})]},M.id)};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold text-white",children:"Lineage Visualization"}),r.jsx("p",{className:"text-zinc-400 text-sm",children:"Interactive family tree of your culture library"})]}),r.jsx("div",{className:"flex items-center gap-2",children:r.jsxs("span",{className:"text-sm text-zinc-500",children:[n.length," cultures"]})})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-3 bg-zinc-900/50 border border-zinc-800 rounded-xl p-4",children:[r.jsxs("select",{value:d,onChange:k=>c(k.target.value),className:"bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm",children:[r.jsx("option",{value:"all",children:"All Strains"}),S.map(k=>k&&r.jsx("option",{value:k.id,children:k.name},k.id))]}),r.jsxs("select",{value:p,onChange:k=>m(k.target.value),className:"bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm",children:[r.jsx("option",{value:"all",children:"All Types"}),r.jsx("option",{value:"spore_syringe",children:" Spore Syringe"}),r.jsx("option",{value:"liquid_culture",children:" Liquid Culture"}),r.jsx("option",{value:"agar",children:" Agar"}),r.jsx("option",{value:"slant",children:" Slant"}),r.jsx("option",{value:"grain_spawn",children:" Grain Spawn"})]}),r.jsx("div",{className:"flex-1"}),r.jsxs("div",{className:"flex items-center gap-1 bg-zinc-800 rounded-lg p-1",children:[r.jsx("button",{onClick:()=>l(k=>Math.max(.25,k-.25)),className:"p-2 text-zinc-400 hover:text-white transition-colors",title:"Zoom Out",children:r.jsx(Mn.ZoomOut,{})}),r.jsxs("span",{className:"px-2 text-sm text-zinc-400 min-w-[3rem] text-center",children:[Math.round(o*100),"%"]}),r.jsx("button",{onClick:()=>l(k=>Math.min(2,k+.25)),className:"p-2 text-zinc-400 hover:text-white transition-colors",title:"Zoom In",children:r.jsx(Mn.ZoomIn,{})}),r.jsx("button",{onClick:()=>l(1),className:"p-2 text-zinc-400 hover:text-white transition-colors",title:"Reset Zoom",children:r.jsx(Mn.Reset,{})})]}),g.size>0&&r.jsxs("button",{onClick:L,className:"flex items-center gap-1 px-3 py-2 bg-zinc-800 hover:bg-zinc-700 text-zinc-400 hover:text-white rounded-lg text-sm transition-colors",children:[r.jsx(Mn.X,{}),"Clear Selection"]})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-xs",children:[r.jsx("span",{className:"text-zinc-500",children:"Types:"}),Object.entries(Bs).map(([k,M])=>r.jsxs("span",{className:`flex items-center gap-1 ${M.color}`,children:[r.jsx("span",{children:M.icon}),r.jsx("span",{className:"capitalize",children:k.replace("_"," ")})]},k)),r.jsx("span",{className:"text-zinc-700",children:"|"}),r.jsx("span",{className:"text-zinc-500",children:"Status:"}),r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx("span",{className:"w-2 h-2 rounded-full bg-emerald-500"})," Active"]}),r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx("span",{className:"w-2 h-2 rounded-full bg-blue-500"})," Colonizing"]}),r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx("span",{className:"w-2 h-2 rounded-full bg-green-500"})," Ready"]}),r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx("span",{className:"w-2 h-2 rounded-full bg-red-500"})," Contaminated"]})]}),r.jsxs("div",{className:"flex gap-6",children:[r.jsx("div",{className:"flex-1 bg-zinc-900/50 border border-zinc-800 rounded-xl overflow-hidden",children:r.jsx("div",{className:"overflow-auto",style:{maxHeight:"calc(100vh - 400px)"},children:w.length>0?r.jsxs("svg",{width:C.width*o,height:C.height*o,viewBox:`0 0 ${C.width} ${C.height}`,className:"min-w-full",style:{transform:`scale(${o})`,transformOrigin:"top left"},children:[r.jsx("g",{className:"connections",children:G()}),r.jsx("g",{className:"nodes",children:w.map(k=>H(k))})]}):r.jsx("div",{className:"flex items-center justify-center h-64 text-zinc-500",children:r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-lg mb-2",children:"No cultures to display"}),r.jsx("p",{className:"text-sm",children:"Add cultures to see the lineage tree"})]})})})}),i&&r.jsxs("div",{className:"w-80 bg-zinc-900/50 border border-zinc-800 rounded-xl p-5 h-fit",children:[r.jsxs("div",{className:"flex items-start justify-between mb-4",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-2xl",children:((J=Bs[i.type])==null?void 0:J.icon)||""}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-bold text-white",children:i.label}),r.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${((se=Bs[i.type])==null?void 0:se.bgColor)||"bg-zinc-800"}`,children:i.type.replace("_"," ")})]})]}),r.jsx("button",{onClick:L,className:"text-zinc-400 hover:text-white",children:r.jsx(Mn.X,{})})]}),r.jsxs("div",{className:"space-y-3 text-sm",children:[r.jsxs("div",{className:"flex justify-between py-2 border-b border-zinc-800",children:[r.jsx("span",{className:"text-zinc-500",children:"Strain"}),r.jsx("span",{className:"text-white",children:((ge=t(i.strainId))==null?void 0:ge.name)||"Unknown"})]}),r.jsxs("div",{className:"flex justify-between py-2 border-b border-zinc-800",children:[r.jsx("span",{className:"text-zinc-500",children:"Generation"}),r.jsxs("span",{className:"text-white",children:["G",i.generation]})]}),r.jsxs("div",{className:"flex justify-between py-2 border-b border-zinc-800",children:[r.jsx("span",{className:"text-zinc-500",children:"Status"}),r.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${i.status==="active"?"bg-emerald-950/50 text-emerald-400":i.status==="contaminated"?"bg-red-950/50 text-red-400":i.status==="ready"?"bg-green-950/50 text-green-400":"bg-zinc-800 text-zinc-400"}`,children:i.status})]}),i.healthRating&&r.jsxs("div",{className:"flex justify-between py-2 border-b border-zinc-800",children:[r.jsx("span",{className:"text-zinc-500",children:"Health"}),r.jsx("div",{className:"flex gap-0.5",children:[1,2,3,4,5].map(k=>r.jsx("div",{className:`w-2 h-4 rounded-sm ${k<=i.healthRating?"bg-emerald-500":"bg-zinc-700"}`},k))})]}),r.jsxs("div",{className:"flex justify-between py-2 border-b border-zinc-800",children:[r.jsx("span",{className:"text-zinc-500",children:"Created"}),r.jsx("span",{className:"text-white",children:new Date(i.createdAt).toLocaleDateString()})]}),i.notes&&r.jsxs("div",{className:"pt-2",children:[r.jsx("p",{className:"text-zinc-500 text-xs mb-1",children:"Notes"}),r.jsx("p",{className:"text-zinc-300 text-xs bg-zinc-800/50 rounded p-2",children:i.notes})]})]}),g.size>1&&r.jsxs("div",{className:"mt-4 pt-4 border-t border-zinc-800",children:[r.jsx("p",{className:"text-xs text-zinc-500 mb-2",children:"Lineage"}),r.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[r.jsxs("div",{className:"bg-zinc-800/50 rounded-lg p-2 text-center",children:[r.jsx("p",{className:"text-xs text-zinc-500",children:"Ancestors"}),r.jsx("p",{className:"text-lg font-bold text-white",children:s(i.id).ancestors.length})]}),r.jsxs("div",{className:"bg-zinc-800/50 rounded-lg p-2 text-center",children:[r.jsx("p",{className:"text-xs text-zinc-500",children:"Descendants"}),r.jsx("p",{className:"text-lg font-bold text-white",children:s(i.id).descendants.length})]})]})]})]})]}),r.jsx("div",{className:"grid grid-cols-5 gap-4",children:Object.entries(Bs).map(([k,M])=>{const oe=n.filter(B=>B.type===k).length;return r.jsxs("div",{className:`${M.bgColor} border rounded-xl p-4 text-center`,children:[r.jsx("span",{className:"text-2xl",children:M.icon}),r.jsx("p",{className:"text-2xl font-bold text-white mt-1",children:oe}),r.jsx("p",{className:"text-xs text-zinc-400 capitalize",children:k.replace("_"," ")})]},k)})})]})},zh={X:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),Check:()=>r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:r.jsx("polyline",{points:"20 6 9 17 4 12"})})},la=({value:e,onChange:t,options:s,placeholder:n="Select...",label:i,required:a,disabled:o,className:l="",addLabel:d="Add New",onAdd:c,addFields:p,onAddComplete:m})=>{var N;const[g,f]=b.useState(!1),[v,j]=b.useState(""),[S,u]=b.useState({}),h=()=>{v.trim()&&(c&&c(v.trim()),j(""),f(!1))},x=()=>{var w;m&&((w=S.name)!=null&&w.trim())&&m(S),u({}),f(!1)},_=c||m;return r.jsxs("div",{className:"relative",children:[i&&r.jsxs("label",{className:"block text-sm text-zinc-400 mb-2",children:[i," ",a&&"*"]}),r.jsxs("select",{value:e,onChange:w=>{w.target.value==="__ADD_NEW__"?f(!0):t(w.target.value)},disabled:o,className:`w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white focus:outline-none focus:border-emerald-500 ${l}`,children:[r.jsx("option",{value:"",children:n}),s.map(w=>r.jsx("option",{value:w.id,children:w.name},w.id)),_&&r.jsxs("option",{value:"__ADD_NEW__",className:"text-emerald-400",children:[" ",d,"..."]})]}),g&&r.jsxs("div",{className:"absolute top-full left-0 right-0 mt-1 bg-zinc-800 border border-zinc-600 rounded-lg p-3 shadow-xl z-50",children:[r.jsxs("div",{className:"flex items-center justify-between mb-3",children:[r.jsx("span",{className:"text-sm font-medium text-white",children:d}),r.jsx("button",{onClick:()=>{f(!1),j(""),u({})},className:"text-zinc-400 hover:text-white",children:r.jsx(zh.X,{})})]}),c&&!p&&r.jsxs("div",{className:"flex gap-2",children:[r.jsx("input",{type:"text",value:v,onChange:w=>j(w.target.value),placeholder:"Name...",autoFocus:!0,className:"flex-1 bg-zinc-700 border border-zinc-600 rounded px-3 py-1.5 text-white text-sm focus:outline-none focus:border-emerald-500",onKeyDown:w=>{w.key==="Enter"&&h(),w.key==="Escape"&&(f(!1),j(""))}}),r.jsx("button",{onClick:h,disabled:!v.trim(),className:"px-3 py-1.5 bg-emerald-500 hover:bg-emerald-600 disabled:bg-zinc-700 text-white rounded text-sm font-medium",children:r.jsx(zh.Check,{})})]}),p&&m&&r.jsxs("div",{className:"space-y-2",children:[p.map(w=>{var C;return r.jsxs("div",{children:[r.jsxs("label",{className:"block text-xs text-zinc-400 mb-1",children:[w.label," ",w.required&&"*"]}),w.type==="text"?r.jsx("input",{type:"text",value:S[w.name]||"",onChange:y=>u(L=>({...L,[w.name]:y.target.value})),className:"w-full bg-zinc-700 border border-zinc-600 rounded px-2 py-1 text-white text-sm focus:outline-none focus:border-emerald-500"}):r.jsxs("select",{value:S[w.name]||"",onChange:y=>u(L=>({...L,[w.name]:y.target.value})),className:"w-full bg-zinc-700 border border-zinc-600 rounded px-2 py-1 text-white text-sm",children:[r.jsx("option",{value:"",children:"Select..."}),(C=w.options)==null?void 0:C.map(y=>r.jsx("option",{value:y.value,children:y.label},y.value))]})]},w.name)}),r.jsx("button",{onClick:x,disabled:!((N=S.name)!=null&&N.trim()),className:"w-full mt-2 px-3 py-1.5 bg-emerald-500 hover:bg-emerald-600 disabled:bg-zinc-700 text-white rounded text-sm font-medium",children:"Add"})]})]})]})},$n="mycolab-grow-draft",tn={spawning:{label:"Spawning",icon:"",color:"text-purple-400 bg-purple-950/50"},colonization:{label:"Colonization",icon:"",color:"text-blue-400 bg-blue-950/50"},fruiting:{label:"Fruiting",icon:"",color:"text-emerald-400 bg-emerald-950/50"},harvesting:{label:"Harvesting",icon:"",color:"text-amber-400 bg-amber-950/50"},completed:{label:"Completed",icon:"",color:"text-green-400 bg-green-950/50"},contaminated:{label:"Contaminated",icon:"",color:"text-red-400 bg-red-950/50"},aborted:{label:"Aborted",icon:"",color:"text-zinc-400 bg-zinc-800"}},ao=["spawning","colonization","fruiting","harvesting","completed"],Jt={Search:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),X:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),Trash:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("polyline",{points:"3 6 5 6 21 6"}),r.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]}),Grid:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),r.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),r.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),r.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]}),List:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("line",{x1:"8",y1:"6",x2:"21",y2:"6"}),r.jsx("line",{x1:"8",y1:"12",x2:"21",y2:"12"}),r.jsx("line",{x1:"8",y1:"18",x2:"21",y2:"18"}),r.jsx("line",{x1:"3",y1:"6",x2:"3.01",y2:"6"}),r.jsx("line",{x1:"3",y1:"12",x2:"3.01",y2:"12"}),r.jsx("line",{x1:"3",y1:"18",x2:"3.01",y2:"18"})]}),ChevronRight:()=>r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:r.jsx("polyline",{points:"9 18 15 12 9 6"})}),Clipboard:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"}),r.jsx("rect",{x:"8",y:"2",width:"8",height:"4",rx:"1",ry:"1"})]}),Scale:()=>r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:r.jsx("path",{d:"M12 3v18M3 12h18M5.5 5.5l13 13M18.5 5.5l-13 13"})})},Ah=({currentStage:e})=>{if(e==="contaminated"||e==="aborted"){const s=tn[e];return r.jsxs("div",{className:`inline-flex items-center gap-1 px-2 py-1 rounded text-xs font-medium ${s.color}`,children:[r.jsx("span",{children:s.icon}),r.jsx("span",{children:s.label})]})}const t=ao.indexOf(e);return r.jsx("div",{className:"flex items-center gap-1",children:ao.map((s,n)=>{const i=tn[s],a=n<t,o=n===t;return r.jsxs(Cc.Fragment,{children:[n>0&&r.jsx("div",{className:`w-3 h-0.5 ${a?"bg-emerald-500":"bg-zinc-700"}`}),r.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs ${o?"bg-emerald-500 text-white":a?"bg-emerald-500/30 text-emerald-400":"bg-zinc-800 text-zinc-600"}`,title:i.label,children:o?i.icon:n+1})]},s)})})},hl=(e,t)=>{const s=t?new Date(t):new Date;return Math.floor((s.getTime()-new Date(e).getTime())/(1e3*60*60*24))},Dw=()=>{var he,K,De,st,ht;const{state:e,activeStrains:t,activeLocations:s,activeContainerTypes:n,activeSubstrateTypes:i,getStrain:a,getLocation:o,getContainerType:l,getSubstrateType:d,getCulture:c,addGrow:p,updateGrow:m,deleteGrow:g,advanceGrowStage:f,markGrowContaminated:v,addGrowObservation:j,addFlush:S,addStrain:u,addLocation:h,addContainerType:x,addSubstrateType:_}=ar(),N=e.grows,w=e.cultures,[C,y]=b.useState("grid"),[L,G]=b.useState(""),[H,J]=b.useState("all"),[se,ge]=b.useState("all"),[k,M]=b.useState("all"),[oe,B]=b.useState("date"),[D,$]=b.useState(null),[Y,le]=b.useState("overview"),[Q,O]=b.useState(!1),[U,re]=b.useState(!1),[pe,Be]=b.useState(!1),[or,dt]=b.useState(!1),Vt={name:"",strainId:"",sourceCultureId:"",spawnType:"Oat Groats",spawnWeight:500,substrateTypeId:"",substrateWeight:2e3,containerTypeId:"",containerCount:1,locationId:"",targetTempColonization:24,targetTempFruiting:22,targetHumidity:90,estimatedCost:0,notes:""},Er=()=>{const A=localStorage.getItem($n);if(A)try{return JSON.parse(A)}catch{}return Vt},[ee,R]=b.useState(Er);b.useEffect(()=>{const A=localStorage.getItem($n);dt(!!A)},[]),b.useEffect(()=>{Q&&(ee.strainId||ee.name||ee.substrateTypeId||ee.containerTypeId)&&(localStorage.setItem($n,JSON.stringify(ee)),dt(!0))},[ee,Q]);const ue=()=>{localStorage.removeItem($n),dt(!1)},lr=()=>{const A=localStorage.getItem($n);if(A)try{R(JSON.parse(A)),O(!0)}catch{}},wt=async A=>{const F=await u({name:A,species:"Unknown",difficulty:"intermediate",colonizationDays:{min:14,max:21},fruitingDays:{min:7,max:14},optimalTempColonization:{min:21,max:27},optimalTempFruiting:{min:18,max:24},isActive:!0});R(de=>({...de,strainId:F.id}))},Dt=A=>{const F=_({name:A,code:A.toLowerCase().replace(/\s+/g,"-"),category:"bulk",spawnRateRange:{min:10,optimal:20,max:30},isActive:!0});R(de=>({...de,substrateTypeId:F.id}))},jt=A=>{const F=x({name:A,category:"tub",isActive:!0});R(de=>({...de,containerTypeId:F.id}))},St=async A=>{const F=await h({name:A,type:"fruiting",isActive:!0});R(de=>({...de,locationId:F.id}))},[We,ut]=b.useState({type:"general",title:"",notes:"",colonizationPercent:void 0}),[_e,Oe]=b.useState({wetWeight:0,dryWeight:0,mushroomCount:void 0,quality:"good",notes:""});b.useEffect(()=>{const A=F=>{var de;((de=F.detail)==null?void 0:de.page)==="grows"&&O(!0)};return window.addEventListener("mycolab:create-new",A),()=>window.removeEventListener("mycolab:create-new",A)},[]);const Gt=b.useMemo(()=>!ee.spawnWeight||!ee.substrateWeight?0:Math.round(ee.spawnWeight/(ee.spawnWeight+ee.substrateWeight)*100),[ee.spawnWeight,ee.substrateWeight]),T=b.useMemo(()=>{let A=[...N];if(H!=="all"&&(A=A.filter(F=>F.currentStage===H)),se!=="all"&&(A=A.filter(F=>F.status===se)),k!=="all"&&(A=A.filter(F=>F.strainId===k)),L){const F=L.toLowerCase();A=A.filter(de=>{var Re;return de.name.toLowerCase().includes(F)||((Re=a(de.strainId))==null?void 0:Re.name.toLowerCase().includes(F))||de.notes.toLowerCase().includes(F)})}switch(oe){case"date":A.sort((F,de)=>new Date(de.createdAt).getTime()-new Date(F.createdAt).getTime());break;case"name":A.sort((F,de)=>F.name.localeCompare(de.name));break;case"yield":A.sort((F,de)=>de.totalYield-F.totalYield);break;case"stage":A.sort((F,de)=>ao.indexOf(F.currentStage)-ao.indexOf(de.currentStage));break}return A},[N,H,se,k,L,oe,a]),V=b.useMemo(()=>{const A=N.filter(nt=>nt.status==="active"),F=N.filter(nt=>nt.status==="completed"),de=N.filter(nt=>nt.status==="failed"),Re=N.reduce((nt,Rt)=>nt+Rt.totalYield,0),kt=F.length>0?Re/F.length:0,_t=N.reduce((nt,Rt)=>nt+Rt.estimatedCost,0);return{active:A.length,completed:F.length,failed:de.length,totalYield:Re,avgYield:kt,totalCost:_t}},[N]),xe=b.useMemo(()=>[...new Set(N.map(A=>A.strainId))],[N]),He=b.useMemo(()=>w.filter(A=>["active","ready"].includes(A.status)),[w]),vr=()=>{if(!ee.strainId||!ee.substrateTypeId||!ee.containerTypeId||!ee.locationId)return;const A=a(ee.strainId),F=l(ee.containerTypeId),de=N.filter(kt=>{var _t;return kt.strainId===ee.strainId&&((_t=l(kt.containerTypeId))==null?void 0:_t.id)===ee.containerTypeId}).length,Re=ee.name||`${(A==null?void 0:A.name)||"Unknown"} ${(F==null?void 0:F.name)||"Grow"} #${de+1}`;p({name:Re,strainId:ee.strainId,status:"active",currentStage:"spawning",sourceCultureId:ee.sourceCultureId||void 0,spawnType:ee.spawnType,spawnWeight:ee.spawnWeight,substrateTypeId:ee.substrateTypeId,substrateWeight:ee.substrateWeight,spawnRate:Gt,containerTypeId:ee.containerTypeId,containerCount:ee.containerCount,spawnedAt:new Date,locationId:ee.locationId,targetTempColonization:ee.targetTempColonization,targetTempFruiting:ee.targetTempFruiting,targetHumidity:ee.targetHumidity,estimatedCost:ee.estimatedCost,notes:ee.notes}),O(!1),ue(),R(Vt)},Nt=()=>{D&&(f(D.id),setTimeout(()=>{const A=e.grows.find(F=>F.id===D.id);A&&$(A)},0))},zs=()=>{D&&confirm("Mark this grow as contaminated? This action cannot be undone.")&&(v(D.id),setTimeout(()=>{const A=e.grows.find(F=>F.id===D.id);A&&$(A)},0))},As=()=>{!D||!We.title||(j(D.id,{date:new Date,stage:D.currentStage,type:We.type,title:We.title,notes:We.notes,colonizationPercent:We.colonizationPercent}),setTimeout(()=>{const A=e.grows.find(F=>F.id===D.id);A&&$(A)},0),re(!1),ut({type:"general",title:"",notes:"",colonizationPercent:void 0}))},P=()=>{!D||!_e.wetWeight||(S(D.id,{harvestDate:new Date,wetWeight:_e.wetWeight,dryWeight:_e.dryWeight||Math.round(_e.wetWeight*.1),mushroomCount:_e.mushroomCount,quality:_e.quality,notes:_e.notes}),setTimeout(()=>{const A=e.grows.find(F=>F.id===D.id);A&&$(A)},0),Be(!1),Oe({wetWeight:0,dryWeight:0,mushroomCount:void 0,quality:"good",notes:""}))},ie=A=>{confirm("Are you sure you want to delete this grow?")&&(g(A),(D==null?void 0:D.id)===A&&$(null))};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold text-white",children:"Grow Tracker"}),r.jsx("p",{className:"text-zinc-400 text-sm",children:"Track your cultivation projects from spawn to harvest"})]}),or&&!Q&&r.jsxs("button",{onClick:lr,className:"flex items-center gap-2 px-3 py-2 bg-amber-500/20 hover:bg-amber-500/30 border border-amber-500/50 text-amber-400 rounded-lg text-sm font-medium transition-colors",children:[r.jsx("span",{children:""}),"Continue Draft"]})]}),r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-3",children:[r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-4",children:[r.jsx("p",{className:"text-xs text-zinc-500",children:"Active"}),r.jsx("p",{className:"text-2xl font-bold text-emerald-400",children:V.active})]}),r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-4",children:[r.jsx("p",{className:"text-xs text-zinc-500",children:"Completed"}),r.jsx("p",{className:"text-2xl font-bold text-green-400",children:V.completed})]}),r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-4",children:[r.jsx("p",{className:"text-xs text-zinc-500",children:"Failed"}),r.jsx("p",{className:"text-2xl font-bold text-red-400",children:V.failed})]}),r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-4",children:[r.jsx("p",{className:"text-xs text-zinc-500",children:"Total Yield"}),r.jsxs("p",{className:"text-2xl font-bold text-white",children:[V.totalYield,"g"]})]}),r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-4",children:[r.jsx("p",{className:"text-xs text-zinc-500",children:"Avg Yield"}),r.jsxs("p",{className:"text-2xl font-bold text-white",children:[V.avgYield.toFixed(1),"g"]})]}),r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-4",children:[r.jsx("p",{className:"text-xs text-zinc-500",children:"Total Cost"}),r.jsxs("p",{className:"text-2xl font-bold text-white",children:["$",V.totalCost.toFixed(0)]})]})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[r.jsxs("div",{className:"flex-1 min-w-64 relative",children:[r.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-zinc-500",children:r.jsx(Jt.Search,{})}),r.jsx("input",{type:"text",value:L,onChange:A=>G(A.target.value),placeholder:"Search grows...",className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg pl-10 pr-4 py-2 text-white placeholder-zinc-500 focus:outline-none focus:border-emerald-500"})]}),r.jsxs("select",{value:H,onChange:A=>J(A.target.value),className:"bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm",children:[r.jsx("option",{value:"all",children:"All Stages"}),Object.entries(tn).map(([A,F])=>r.jsxs("option",{value:A,children:[F.icon," ",F.label]},A))]}),r.jsxs("select",{value:se,onChange:A=>ge(A.target.value),className:"bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm",children:[r.jsx("option",{value:"all",children:"All Statuses"}),r.jsx("option",{value:"active",children:"Active"}),r.jsx("option",{value:"paused",children:"Paused"}),r.jsx("option",{value:"completed",children:"Completed"}),r.jsx("option",{value:"failed",children:"Failed"})]}),r.jsxs("select",{value:k,onChange:A=>M(A.target.value),className:"bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm",children:[r.jsx("option",{value:"all",children:"All Strains"}),xe.map(A=>{const F=a(A);return F?r.jsx("option",{value:A,children:F.name},A):null})]}),r.jsxs("select",{value:oe,onChange:A=>B(A.target.value),className:"bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm",children:[r.jsx("option",{value:"date",children:"Sort by Date"}),r.jsx("option",{value:"name",children:"Sort by Name"}),r.jsx("option",{value:"yield",children:"Sort by Yield"}),r.jsx("option",{value:"stage",children:"Sort by Stage"})]}),r.jsxs("div",{className:"flex bg-zinc-800 rounded-lg border border-zinc-700 overflow-hidden",children:[r.jsx("button",{onClick:()=>y("grid"),className:`p-2 transition-colors ${C==="grid"?"bg-emerald-500/20 text-emerald-400":"text-zinc-400 hover:text-white"}`,children:r.jsx(Jt.Grid,{})}),r.jsx("button",{onClick:()=>y("list"),className:`p-2 transition-colors ${C==="list"?"bg-emerald-500/20 text-emerald-400":"text-zinc-400 hover:text-white"}`,children:r.jsx(Jt.List,{})})]})]}),r.jsxs("div",{className:"flex gap-6",children:[r.jsx("div",{className:"flex-1",children:C==="grid"?r.jsx("div",{className:"grid md:grid-cols-2 xl:grid-cols-3 gap-4",children:T.map(A=>{const F=a(A.strainId),de=l(A.containerTypeId),Re=hl(A.spawnedAt,A.completedAt);return r.jsxs("div",{onClick:()=>$(A),className:`bg-zinc-900/50 border rounded-xl p-4 cursor-pointer transition-all hover:border-zinc-600 ${(D==null?void 0:D.id)===A.id?"border-emerald-600":"border-zinc-800"}`,children:[r.jsx("div",{className:"mb-3",children:r.jsx(Ah,{currentStage:A.currentStage})}),r.jsxs("div",{className:"mb-3",children:[r.jsx("p",{className:"font-semibold text-white",children:A.name}),r.jsx("p",{className:"text-xs text-zinc-500",children:F==null?void 0:F.name})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center mb-3",children:[r.jsxs("div",{className:"bg-zinc-800/50 rounded p-2",children:[r.jsx("p",{className:"text-xs text-zinc-500",children:"Days"}),r.jsx("p",{className:"text-sm font-medium text-white",children:Re})]}),r.jsxs("div",{className:"bg-zinc-800/50 rounded p-2",children:[r.jsx("p",{className:"text-xs text-zinc-500",children:"Flushes"}),r.jsx("p",{className:"text-sm font-medium text-white",children:A.flushes.length})]}),r.jsxs("div",{className:"bg-zinc-800/50 rounded p-2",children:[r.jsx("p",{className:"text-xs text-zinc-500",children:"Yield"}),r.jsxs("p",{className:"text-sm font-medium text-emerald-400",children:[A.totalYield,"g"]})]})]}),r.jsxs("div",{className:"flex items-center justify-between text-xs text-zinc-500 pt-3 border-t border-zinc-800",children:[r.jsx("span",{children:de==null?void 0:de.name}),r.jsxs("span",{children:[A.spawnRate,"% spawn rate"]})]})]},A.id)})}):r.jsx("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl overflow-hidden",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b border-zinc-800",children:[r.jsx("th",{className:"text-left p-3 text-sm font-medium text-zinc-400",children:"Grow"}),r.jsx("th",{className:"text-left p-3 text-sm font-medium text-zinc-400",children:"Strain"}),r.jsx("th",{className:"text-left p-3 text-sm font-medium text-zinc-400",children:"Stage"}),r.jsx("th",{className:"text-left p-3 text-sm font-medium text-zinc-400",children:"Days"}),r.jsx("th",{className:"text-left p-3 text-sm font-medium text-zinc-400",children:"Flushes"}),r.jsx("th",{className:"text-left p-3 text-sm font-medium text-zinc-400",children:"Yield"})]})}),r.jsx("tbody",{children:T.map(A=>{const F=a(A.strainId),de=tn[A.currentStage],Re=hl(A.spawnedAt,A.completedAt);return r.jsxs("tr",{onClick:()=>$(A),className:`border-b border-zinc-800/50 cursor-pointer hover:bg-zinc-800/30 ${(D==null?void 0:D.id)===A.id?"bg-emerald-950/20":""}`,children:[r.jsx("td",{className:"p-3 font-medium text-white",children:A.name}),r.jsx("td",{className:"p-3 text-sm text-white",children:F==null?void 0:F.name}),r.jsx("td",{className:"p-3",children:r.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded text-xs font-medium ${de.color}`,children:[r.jsx("span",{children:de.icon}),r.jsx("span",{children:de.label})]})}),r.jsx("td",{className:"p-3 text-sm text-zinc-400",children:Re}),r.jsx("td",{className:"p-3 text-sm text-zinc-400",children:A.flushes.length}),r.jsxs("td",{className:"p-3 text-sm font-medium text-emerald-400",children:[A.totalYield,"g"]})]},A.id)})})]})})}),D&&r.jsxs("div",{className:"w-96 bg-zinc-900/50 border border-zinc-800 rounded-xl p-5 h-fit sticky top-6 max-h-[calc(100vh-200px)] overflow-y-auto",children:[r.jsxs("div",{className:"flex items-start justify-between mb-4",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-bold text-white",children:D.name}),r.jsx("p",{className:"text-sm text-zinc-400",children:(he=a(D.strainId))==null?void 0:he.name})]}),r.jsx("button",{onClick:()=>$(null),className:"text-zinc-400 hover:text-white",children:r.jsx(Jt.X,{})})]}),r.jsx("div",{className:"mb-4",children:r.jsx(Ah,{currentStage:D.currentStage})}),r.jsx("div",{className:"flex gap-1 mb-4 bg-zinc-800 rounded-lg p-1",children:["overview","timeline","harvests"].map(A=>r.jsx("button",{onClick:()=>le(A),className:`flex-1 py-1.5 text-xs font-medium rounded transition-colors ${Y===A?"bg-emerald-500 text-white":"text-zinc-400 hover:text-white"}`,children:A.charAt(0).toUpperCase()+A.slice(1)},A))}),Y==="overview"&&r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{className:"bg-zinc-800/50 rounded-lg p-3 text-center",children:[r.jsx("p",{className:"text-xs text-zinc-500",children:"Days Active"}),r.jsx("p",{className:"text-xl font-bold text-white",children:hl(D.spawnedAt,D.completedAt)})]}),r.jsxs("div",{className:"bg-zinc-800/50 rounded-lg p-3 text-center",children:[r.jsx("p",{className:"text-xs text-zinc-500",children:"Total Yield"}),r.jsxs("p",{className:"text-xl font-bold text-emerald-400",children:[D.totalYield,"g"]})]})]}),r.jsxs("div",{className:"text-sm space-y-2",children:[r.jsxs("div",{className:"flex justify-between py-2 border-b border-zinc-800",children:[r.jsx("span",{className:"text-zinc-500",children:"Container"}),r.jsxs("span",{className:"text-white",children:[(K=l(D.containerTypeId))==null?void 0:K.name," x",D.containerCount]})]}),r.jsxs("div",{className:"flex justify-between py-2 border-b border-zinc-800",children:[r.jsx("span",{className:"text-zinc-500",children:"Substrate"}),r.jsx("span",{className:"text-white",children:(De=d(D.substrateTypeId))==null?void 0:De.name})]}),r.jsxs("div",{className:"flex justify-between py-2 border-b border-zinc-800",children:[r.jsx("span",{className:"text-zinc-500",children:"Spawn Rate"}),r.jsxs("span",{className:"text-white",children:[D.spawnRate,"%"]})]}),r.jsxs("div",{className:"flex justify-between py-2 border-b border-zinc-800",children:[r.jsx("span",{className:"text-zinc-500",children:"Location"}),r.jsx("span",{className:"text-white",children:(st=o(D.locationId))==null?void 0:st.name})]}),r.jsxs("div",{className:"flex justify-between py-2 border-b border-zinc-800",children:[r.jsx("span",{className:"text-zinc-500",children:"Spawned"}),r.jsx("span",{className:"text-white",children:new Date(D.spawnedAt).toLocaleDateString()})]}),D.sourceCultureId&&r.jsxs("div",{className:"flex justify-between py-2 border-b border-zinc-800",children:[r.jsx("span",{className:"text-zinc-500",children:"Source"}),r.jsx("span",{className:"text-white",children:(ht=c(D.sourceCultureId))==null?void 0:ht.label})]}),r.jsxs("div",{className:"flex justify-between py-2 border-b border-zinc-800",children:[r.jsx("span",{className:"text-zinc-500",children:"Est. Cost"}),r.jsxs("span",{className:"text-white",children:["$",D.estimatedCost.toFixed(2)]})]})]}),D.notes&&r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-zinc-500 mb-1",children:"Notes"}),r.jsx("p",{className:"text-sm text-zinc-300 bg-zinc-800/50 rounded p-2",children:D.notes})]})]}),Y==="timeline"&&r.jsxs("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:[D.observations.slice().reverse().map(A=>r.jsxs("div",{className:"bg-zinc-800/50 rounded-lg p-3",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[r.jsx("span",{className:`px-1.5 py-0.5 rounded text-xs ${tn[A.stage].color}`,children:tn[A.stage].icon}),r.jsx("span",{className:"text-sm font-medium text-white",children:A.title})]}),r.jsx("p",{className:"text-xs text-zinc-400 mb-1",children:new Date(A.date).toLocaleDateString()}),A.notes&&r.jsx("p",{className:"text-xs text-zinc-300",children:A.notes}),A.colonizationPercent!==void 0&&r.jsxs("div",{className:"mt-2",children:[r.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[r.jsx("span",{className:"text-zinc-500",children:"Colonization"}),r.jsxs("span",{className:"text-white",children:[A.colonizationPercent,"%"]})]}),r.jsx("div",{className:"h-1.5 bg-zinc-700 rounded-full overflow-hidden",children:r.jsx("div",{className:"h-full bg-blue-500 rounded-full",style:{width:`${A.colonizationPercent}%`}})})]})]},A.id)),D.observations.length===0&&r.jsx("p",{className:"text-sm text-zinc-500 text-center py-4",children:"No observations yet"})]}),Y==="harvests"&&r.jsxs("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:[D.flushes.map(A=>r.jsxs("div",{className:"bg-zinc-800/50 rounded-lg p-3",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsxs("span",{className:"text-sm font-medium text-white",children:["Flush #",A.flushNumber]}),r.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${A.quality==="excellent"?"bg-emerald-950/50 text-emerald-400":A.quality==="good"?"bg-blue-950/50 text-blue-400":A.quality==="fair"?"bg-amber-950/50 text-amber-400":"bg-red-950/50 text-red-400"}`,children:A.quality})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-zinc-500",children:"Wet"}),r.jsxs("p",{className:"text-white font-medium",children:[A.wetWeight,"g"]})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-zinc-500",children:"Dry"}),r.jsxs("p",{className:"text-emerald-400 font-medium",children:[A.dryWeight,"g"]})]}),A.mushroomCount&&r.jsxs("div",{children:[r.jsx("p",{className:"text-zinc-500",children:"Count"}),r.jsx("p",{className:"text-white font-medium",children:A.mushroomCount})]})]}),r.jsx("p",{className:"text-xs text-zinc-500 mt-2",children:new Date(A.harvestDate).toLocaleDateString()})]},A.id)),D.flushes.length===0&&r.jsx("p",{className:"text-sm text-zinc-500 text-center py-4",children:"No harvests yet"})]}),r.jsxs("div",{className:"flex flex-wrap gap-2 pt-4 mt-4 border-t border-zinc-800",children:[!["completed","contaminated","aborted"].includes(D.currentStage)&&r.jsxs("button",{onClick:Nt,className:"flex-1 flex items-center justify-center gap-1 py-2 bg-emerald-500 hover:bg-emerald-600 text-white rounded-lg text-sm font-medium",children:[r.jsx(Jt.ChevronRight,{}),"Advance"]}),["fruiting","harvesting"].includes(D.currentStage)&&r.jsxs("button",{onClick:()=>Be(!0),className:"flex-1 flex items-center justify-center gap-1 py-2 bg-amber-500/20 hover:bg-amber-500/30 text-amber-400 rounded-lg text-sm font-medium",children:[r.jsx(Jt.Scale,{}),"Harvest"]}),r.jsxs("button",{onClick:()=>re(!0),className:"flex-1 flex items-center justify-center gap-1 py-2 bg-zinc-800 hover:bg-zinc-700 text-white rounded-lg text-sm font-medium",children:[r.jsx(Jt.Clipboard,{}),"Log"]}),!["completed","contaminated","aborted"].includes(D.currentStage)&&r.jsx("button",{onClick:zs,className:"p-2 bg-red-950/50 hover:bg-red-950 text-red-400 rounded-lg text-sm",title:"Mark Contaminated",children:""}),r.jsx("button",{onClick:()=>ie(D.id),className:"p-2 bg-red-950/50 hover:bg-red-950 text-red-400 rounded-lg",children:r.jsx(Jt.Trash,{})})]})]})]}),Q&&r.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-zinc-900 border border-zinc-700 rounded-xl p-6 max-w-lg w-full max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-white",children:"New Grow"}),r.jsx("button",{onClick:()=>O(!1),className:"text-zinc-400 hover:text-white",children:r.jsx(Jt.X,{})})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Name (optional)"}),r.jsx("input",{type:"text",value:ee.name,onChange:A=>R(F=>({...F,name:A.target.value})),placeholder:"Auto-generated if blank",className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsx(la,{label:"Strain",required:!0,value:ee.strainId,onChange:A=>R(F=>({...F,strainId:A})),options:t,placeholder:"Select...",addLabel:"Add New Strain",onAdd:wt}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Source Culture"}),r.jsxs("select",{value:ee.sourceCultureId,onChange:A=>R(F=>({...F,sourceCultureId:A.target.value})),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white",children:[r.jsx("option",{value:"",children:"None"}),He.map(A=>{var F;return r.jsxs("option",{value:A.id,children:[A.label," - ",(F=a(A.strainId))==null?void 0:F.name]},A.id)})]})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Spawn Type"}),r.jsxs("select",{value:ee.spawnType,onChange:A=>R(F=>({...F,spawnType:A.target.value})),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white",children:[r.jsx("option",{value:"Oat Groats",children:"Oat Groats"}),r.jsx("option",{value:"Rye Berries",children:"Rye Berries"}),r.jsx("option",{value:"Wheat",children:"Wheat"}),r.jsx("option",{value:"Millet",children:"Millet"}),r.jsx("option",{value:"Popcorn",children:"Popcorn"}),r.jsx("option",{value:"BRF",children:"BRF"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Spawn Weight (g)"}),r.jsx("input",{type:"number",value:ee.spawnWeight,onChange:A=>R(F=>({...F,spawnWeight:parseInt(A.target.value)||0})),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white"})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsx(la,{label:"Substrate",required:!0,value:ee.substrateTypeId,onChange:A=>R(F=>({...F,substrateTypeId:A})),options:i.filter(A=>A.category==="bulk"),placeholder:"Select...",addLabel:"Add New Substrate",onAdd:Dt}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Substrate Weight (g)"}),r.jsx("input",{type:"number",value:ee.substrateWeight,onChange:A=>R(F=>({...F,substrateWeight:parseInt(A.target.value)||0})),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white"})]})]}),Gt>0&&r.jsxs("div",{className:"bg-zinc-800/50 rounded-lg p-3 text-center",children:[r.jsx("p",{className:"text-xs text-zinc-500",children:"Calculated Spawn Rate"}),r.jsxs("p",{className:"text-xl font-bold text-emerald-400",children:[Gt,"%"]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsx(la,{label:"Container",required:!0,value:ee.containerTypeId,onChange:A=>R(F=>({...F,containerTypeId:A})),options:n,placeholder:"Select...",addLabel:"Add New Container",onAdd:jt}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Count"}),r.jsx("input",{type:"number",value:ee.containerCount,onChange:A=>R(F=>({...F,containerCount:parseInt(A.target.value)||1})),min:"1",className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white"})]})]}),r.jsx(la,{label:"Location",required:!0,value:ee.locationId,onChange:A=>R(F=>({...F,locationId:A})),options:s,placeholder:"Select...",addLabel:"Add New Location",onAdd:St}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Estimated Cost ($)"}),r.jsx("input",{type:"number",value:ee.estimatedCost,onChange:A=>R(F=>({...F,estimatedCost:parseFloat(A.target.value)||0})),step:"0.01",className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Notes"}),r.jsx("textarea",{value:ee.notes,onChange:A=>R(F=>({...F,notes:A.target.value})),rows:3,className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white"})]})]}),r.jsxs("div",{className:"flex gap-3 mt-6",children:[r.jsx("button",{onClick:()=>O(!1),className:"flex-1 py-2 bg-zinc-800 hover:bg-zinc-700 text-white rounded-lg font-medium",children:"Cancel"}),r.jsx("button",{onClick:vr,disabled:!ee.strainId||!ee.substrateTypeId||!ee.containerTypeId||!ee.locationId,className:"flex-1 py-2 bg-emerald-500 hover:bg-emerald-600 disabled:bg-zinc-700 disabled:text-zinc-500 text-white rounded-lg font-medium",children:"Create"})]})]})}),U&&D&&r.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-zinc-900 border border-zinc-700 rounded-xl p-6 max-w-md w-full",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-white",children:"Log Observation"}),r.jsx("button",{onClick:()=>re(!1),className:"text-zinc-400 hover:text-white",children:r.jsx(Jt.X,{})})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Type"}),r.jsxs("select",{value:We.type,onChange:A=>ut(F=>({...F,type:A.target.value})),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white",children:[r.jsx("option",{value:"general",children:"General"}),r.jsx("option",{value:"environmental",children:"Environmental"}),r.jsx("option",{value:"contamination",children:"Contamination"}),r.jsx("option",{value:"milestone",children:"Milestone"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Title *"}),r.jsx("input",{type:"text",value:We.title,onChange:A=>ut(F=>({...F,title:A.target.value})),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white"})]}),D.currentStage==="colonization"&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Colonization %"}),r.jsx("input",{type:"number",value:We.colonizationPercent||"",onChange:A=>ut(F=>({...F,colonizationPercent:parseInt(A.target.value)||void 0})),min:"0",max:"100",className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Notes"}),r.jsx("textarea",{value:We.notes,onChange:A=>ut(F=>({...F,notes:A.target.value})),rows:3,className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white"})]})]}),r.jsxs("div",{className:"flex gap-3 mt-6",children:[r.jsx("button",{onClick:()=>re(!1),className:"flex-1 py-2 bg-zinc-800 hover:bg-zinc-700 text-white rounded-lg font-medium",children:"Cancel"}),r.jsx("button",{onClick:As,disabled:!We.title,className:"flex-1 py-2 bg-emerald-500 hover:bg-emerald-600 disabled:bg-zinc-700 disabled:text-zinc-500 text-white rounded-lg font-medium",children:"Save"})]})]})}),pe&&D&&r.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-zinc-900 border border-zinc-700 rounded-xl p-6 max-w-md w-full",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-white",children:"Record Harvest"}),r.jsx("button",{onClick:()=>Be(!1),className:"text-zinc-400 hover:text-white",children:r.jsx(Jt.X,{})})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"bg-zinc-800/50 rounded-lg p-3 text-center",children:[r.jsx("p",{className:"text-xs text-zinc-500",children:"This will be"}),r.jsxs("p",{className:"text-xl font-bold text-white",children:["Flush #",D.flushes.length+1]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Wet Weight (g) *"}),r.jsx("input",{type:"number",value:_e.wetWeight||"",onChange:A=>Oe(F=>({...F,wetWeight:parseFloat(A.target.value)||0})),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Dry Weight (g)"}),r.jsx("input",{type:"number",value:_e.dryWeight||"",onChange:A=>Oe(F=>({...F,dryWeight:parseFloat(A.target.value)||0})),placeholder:_e.wetWeight?`~${Math.round(_e.wetWeight*.1)}`:"",className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Mushroom Count"}),r.jsx("input",{type:"number",value:_e.mushroomCount||"",onChange:A=>Oe(F=>({...F,mushroomCount:parseInt(A.target.value)||void 0})),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Quality"}),r.jsx("div",{className:"grid grid-cols-4 gap-2",children:["excellent","good","fair","poor"].map(A=>r.jsx("button",{onClick:()=>Oe(F=>({...F,quality:A})),className:`py-2 rounded-lg text-xs font-medium transition-all ${_e.quality===A?A==="excellent"?"bg-emerald-500 text-white":A==="good"?"bg-blue-500 text-white":A==="fair"?"bg-amber-500 text-white":"bg-red-500 text-white":"bg-zinc-800 text-zinc-400 hover:bg-zinc-700"}`,children:A.charAt(0).toUpperCase()+A.slice(1)},A))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Notes"}),r.jsx("textarea",{value:_e.notes,onChange:A=>Oe(F=>({...F,notes:A.target.value})),rows:2,className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white"})]})]}),r.jsxs("div",{className:"flex gap-3 mt-6",children:[r.jsx("button",{onClick:()=>Be(!1),className:"flex-1 py-2 bg-zinc-800 hover:bg-zinc-700 text-white rounded-lg font-medium",children:"Cancel"}),r.jsx("button",{onClick:P,disabled:!_e.wetWeight,className:"flex-1 py-2 bg-amber-500 hover:bg-amber-600 disabled:bg-zinc-700 disabled:text-zinc-500 text-white rounded-lg font-medium",children:"Record"})]})]})})]})},os={agar:{label:"Agar Media",icon:"",color:"text-purple-400 bg-purple-950/50"},liquid_culture:{label:"Liquid Culture",icon:"",color:"text-blue-400 bg-blue-950/50"},grain_spawn:{label:"Grain Spawn",icon:"",color:"text-amber-400 bg-amber-950/50"},bulk_substrate:{label:"Bulk Substrate",icon:"",color:"text-emerald-400 bg-emerald-950/50"},casing:{label:"Casing Layer",icon:"",color:"text-orange-400 bg-orange-950/50"},other:{label:"Other",icon:"",color:"text-zinc-400 bg-zinc-800"}},ur={Plus:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),Search:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),X:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),Trash:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("polyline",{points:"3 6 5 6 21 6"}),r.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]}),Edit:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),r.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),Copy:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),r.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]}),Clock:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-4 h-4",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("polyline",{points:"12 6 12 12 16 14"})]})},Rw=()=>{const{state:e,activeInventoryItems:t,getInventoryItem:s,addRecipe:n,updateRecipe:i,deleteRecipe:a,scaleRecipe:o,generateId:l}=ar(),d=e.recipes.filter(O=>O.isActive),[c,p]=b.useState(""),[m,g]=b.useState("all"),[f,v]=b.useState(null),[j,S]=b.useState(!1),[u,h]=b.useState(!1),[x,_]=b.useState(1),[N,w]=b.useState({name:"",category:"agar",description:"",yield:{amount:500,unit:"ml"},prepTime:15,sterilizationTime:45,sterilizationPsi:15,ingredients:[],instructions:[""],tips:[],notes:""}),[C,y]=b.useState({inventoryItemId:"",name:"",quantity:0,unit:"g"});b.useEffect(()=>{const O=U=>{var re;((re=U.detail)==null?void 0:re.page)==="recipes"&&(se(),h(!1),S(!0))};return window.addEventListener("mycolab:create-new",O),()=>window.removeEventListener("mycolab:create-new",O)},[]);const L=b.useMemo(()=>{let O=[...d];if(m!=="all"&&(O=O.filter(U=>U.category===m)),c){const U=c.toLowerCase();O=O.filter(re=>re.name.toLowerCase().includes(U)||re.description.toLowerCase().includes(U))}return O.sort((U,re)=>U.name.localeCompare(re.name))},[d,m,c]),G=b.useMemo(()=>{const O={agar:0,liquid_culture:0,grain_spawn:0,bulk_substrate:0,casing:0,other:0};return d.forEach(U=>O[U.category]++),{total:d.length,byCategory:O}},[d]),H=O=>O.ingredients.reduce((U,re)=>{if(re.inventoryItemId){const pe=s(re.inventoryItemId);if(pe)return U+pe.unitCost*re.quantity}return U},0),J=b.useMemo(()=>f?o(f,x):null,[f,x,o]),se=()=>{w({name:"",category:"agar",description:"",yield:{amount:500,unit:"ml"},prepTime:15,sterilizationTime:45,sterilizationPsi:15,ingredients:[],instructions:[""],tips:[],notes:""}),y({inventoryItemId:"",name:"",quantity:0,unit:"g"})},ge=O=>{w({name:O.name,category:O.category,description:O.description,yield:{...O.yield},prepTime:O.prepTime||0,sterilizationTime:O.sterilizationTime||0,sterilizationPsi:O.sterilizationPsi||15,ingredients:O.ingredients.map(U=>({...U})),instructions:[...O.instructions],tips:O.tips?[...O.tips]:[],notes:O.notes||""}),h(!0),S(!0)},k=()=>{if(!C.name||!C.quantity)return;const O={id:l("ing"),inventoryItemId:C.inventoryItemId||void 0,name:C.name,quantity:C.quantity,unit:C.unit};w(U=>({...U,ingredients:[...U.ingredients,O]})),y({inventoryItemId:"",name:"",quantity:0,unit:"g"})},M=O=>{w(U=>({...U,ingredients:U.ingredients.filter(re=>re.id!==O)}))},oe=()=>{w(O=>({...O,instructions:[...O.instructions,""]}))},B=(O,U)=>{w(re=>({...re,instructions:re.instructions.map((pe,Be)=>Be===O?U:pe)}))},D=O=>{w(U=>({...U,instructions:U.instructions.filter((re,pe)=>pe!==O)}))},$=async()=>{if(!N.name||N.ingredients.length===0)return;const O={name:N.name,category:N.category,description:N.description,yield:N.yield,prepTime:N.prepTime||void 0,sterilizationTime:N.sterilizationTime||void 0,sterilizationPsi:N.sterilizationPsi||void 0,ingredients:N.ingredients,instructions:N.instructions.filter(U=>U.trim()),tips:N.tips.filter(U=>U.trim()),notes:N.notes||void 0,isActive:!0};if(u&&f)await i(f.id,O),v({...f,...O});else{const U=await n(O);v(U)}S(!1),h(!1),se()},Y=async O=>{const U=await n({...O,name:`${O.name} (Copy)`,ingredients:O.ingredients.map(re=>({...re,id:l("ing")}))});v(U)},le=async O=>{confirm("Delete this recipe?")&&(await a(O),(f==null?void 0:f.id)===O&&v(null))},Q=O=>{const U=s(O);U&&y(re=>({...re,inventoryItemId:O,name:U.name,unit:U.unit}))};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold text-white",children:"Recipe Builder"}),r.jsx("p",{className:"text-zinc-400 text-sm",children:"Create and manage recipes with automatic cost calculation"})]}),r.jsxs("button",{onClick:()=>{se(),h(!1),S(!0)},className:"flex items-center gap-2 px-4 py-2 bg-emerald-500 hover:bg-emerald-600 text-white rounded-lg font-medium transition-colors",children:[r.jsx(ur.Plus,{}),"New Recipe"]})]}),r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-3",children:[r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-4",children:[r.jsx("p",{className:"text-xs text-zinc-500",children:"Total"}),r.jsx("p",{className:"text-2xl font-bold text-white",children:G.total})]}),Object.entries(os).map(([O,U])=>r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-4",children:[r.jsxs("p",{className:"text-xs text-zinc-500 flex items-center gap-1",children:[r.jsx("span",{children:U.icon})," ",U.label.split(" ")[0]]}),r.jsx("p",{className:"text-2xl font-bold text-white",children:G.byCategory[O]})]},O))]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[r.jsxs("div",{className:"flex-1 min-w-64 relative",children:[r.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-zinc-500",children:r.jsx(ur.Search,{})}),r.jsx("input",{type:"text",value:c,onChange:O=>p(O.target.value),placeholder:"Search recipes...",className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg pl-10 pr-4 py-2 text-white placeholder-zinc-500 focus:outline-none focus:border-emerald-500"})]}),r.jsxs("select",{value:m,onChange:O=>g(O.target.value),className:"bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white text-sm",children:[r.jsx("option",{value:"all",children:"All Categories"}),Object.entries(os).map(([O,U])=>r.jsxs("option",{value:O,children:[U.icon," ",U.label]},O))]})]}),r.jsxs("div",{className:"flex gap-6",children:[r.jsx("div",{className:"flex-1",children:r.jsxs("div",{className:"grid md:grid-cols-2 xl:grid-cols-3 gap-4",children:[L.map(O=>{const U=os[O.category],re=H(O);return r.jsxs("div",{onClick:()=>{v(O),_(1)},className:`bg-zinc-900/50 border rounded-xl p-4 cursor-pointer transition-all hover:border-zinc-600 ${(f==null?void 0:f.id)===O.id?"border-emerald-600":"border-zinc-800"}`,children:[r.jsx("div",{className:"flex items-start justify-between mb-3",children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-2xl",children:U.icon}),r.jsxs("div",{children:[r.jsx("p",{className:"font-semibold text-white",children:O.name}),r.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${U.color}`,children:U.label})]})]})}),O.description&&r.jsx("p",{className:"text-sm text-zinc-400 mb-3 line-clamp-2",children:O.description}),r.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center mb-3",children:[r.jsxs("div",{className:"bg-zinc-800/50 rounded p-2",children:[r.jsx("p",{className:"text-xs text-zinc-500",children:"Yield"}),r.jsxs("p",{className:"text-sm font-medium text-white",children:[O.yield.amount,O.yield.unit]})]}),r.jsxs("div",{className:"bg-zinc-800/50 rounded p-2",children:[r.jsx("p",{className:"text-xs text-zinc-500",children:"Items"}),r.jsx("p",{className:"text-sm font-medium text-white",children:O.ingredients.length})]}),r.jsxs("div",{className:"bg-zinc-800/50 rounded p-2",children:[r.jsx("p",{className:"text-xs text-zinc-500",children:"Cost"}),r.jsxs("p",{className:"text-sm font-medium text-emerald-400",children:["$",re.toFixed(2)]})]})]}),(O.prepTime||O.sterilizationTime)&&r.jsxs("div",{className:"flex items-center gap-3 text-xs text-zinc-500 pt-3 border-t border-zinc-800",children:[O.prepTime&&r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(ur.Clock,{}),O.prepTime,"min prep"]}),O.sterilizationTime&&r.jsxs("span",{children:[" ",O.sterilizationTime,"min @ ",O.sterilizationPsi,"PSI"]})]})]},O.id)}),L.length===0&&r.jsx("div",{className:"col-span-full text-center py-12 text-zinc-500",children:"No recipes found. Create your first recipe!"})]})}),f&&r.jsxs("div",{className:"w-96 bg-zinc-900/50 border border-zinc-800 rounded-xl p-5 h-fit sticky top-6 max-h-[calc(100vh-200px)] overflow-y-auto",children:[r.jsxs("div",{className:"flex items-start justify-between mb-4",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("span",{className:"text-3xl",children:os[f.category].icon}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-bold text-white",children:f.name}),r.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${os[f.category].color}`,children:os[f.category].label})]})]}),r.jsx("button",{onClick:()=>v(null),className:"text-zinc-400 hover:text-white",children:r.jsx(ur.X,{})})]}),f.description&&r.jsx("p",{className:"text-sm text-zinc-400 mb-4",children:f.description}),r.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-4",children:[r.jsxs("div",{className:"bg-zinc-800/50 rounded-lg p-3 text-center",children:[r.jsx("p",{className:"text-xs text-zinc-500",children:"Yield"}),r.jsxs("p",{className:"text-lg font-bold text-white",children:[(J==null?void 0:J.yield.amount)||f.yield.amount,r.jsx("span",{className:"text-sm text-zinc-400",children:f.yield.unit})]})]}),r.jsxs("div",{className:"bg-zinc-800/50 rounded-lg p-3 text-center",children:[r.jsx("p",{className:"text-xs text-zinc-500",children:"Time"}),r.jsxs("p",{className:"text-lg font-bold text-white",children:[(f.prepTime||0)+(f.sterilizationTime||0),r.jsx("span",{className:"text-sm text-zinc-400",children:"min"})]})]}),r.jsxs("div",{className:"bg-zinc-800/50 rounded-lg p-3 text-center",children:[r.jsx("p",{className:"text-xs text-zinc-500",children:"Cost"}),r.jsxs("p",{className:"text-lg font-bold text-emerald-400",children:["$",(H(f)*x).toFixed(2)]})]})]}),r.jsxs("div",{className:"mb-4",children:[r.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[r.jsx("span",{className:"text-zinc-500",children:"Scale"}),r.jsxs("span",{className:"text-white font-medium",children:[x,"x"]})]}),r.jsx("input",{type:"range",min:"0.5",max:"5",step:"0.5",value:x,onChange:O=>_(parseFloat(O.target.value)),className:"w-full accent-emerald-500"})]}),r.jsxs("div",{className:"mb-4",children:[r.jsx("p",{className:"text-sm font-medium text-white mb-2",children:"Ingredients"}),r.jsx("div",{className:"space-y-2",children:(J||f).ingredients.map(O=>r.jsxs("div",{className:"flex items-center justify-between bg-zinc-800/50 rounded-lg px-3 py-2 text-sm",children:[r.jsx("span",{className:"text-white",children:O.name}),r.jsxs("span",{className:"text-emerald-400 font-medium",children:[O.quantity.toFixed(O.quantity<10?1:0)," ",O.unit]})]},O.id))})]}),f.instructions.length>0&&r.jsxs("div",{className:"mb-4",children:[r.jsx("p",{className:"text-sm font-medium text-white mb-2",children:"Instructions"}),r.jsx("ol",{className:"space-y-2",children:f.instructions.map((O,U)=>r.jsxs("li",{className:"flex gap-3 text-sm",children:[r.jsx("span",{className:"flex-shrink-0 w-5 h-5 rounded-full bg-emerald-500/20 text-emerald-400 flex items-center justify-center text-xs font-medium",children:U+1}),r.jsx("span",{className:"text-zinc-300",children:O})]},U))})]}),f.tips&&f.tips.length>0&&r.jsxs("div",{className:"mb-4",children:[r.jsx("p",{className:"text-sm font-medium text-white mb-2",children:"Tips"}),r.jsx("ul",{className:"space-y-1",children:f.tips.map((O,U)=>r.jsxs("li",{className:"flex gap-2 text-sm text-zinc-400",children:[r.jsx("span",{className:"text-amber-400",children:""}),O]},U))})]}),f.notes&&r.jsxs("div",{className:"mb-4",children:[r.jsx("p",{className:"text-sm font-medium text-white mb-2",children:"Notes"}),r.jsx("p",{className:"text-sm text-zinc-400 bg-zinc-800/50 rounded-lg p-3",children:f.notes})]}),r.jsxs("div",{className:"flex flex-wrap gap-2 pt-4 border-t border-zinc-800",children:[r.jsxs("button",{onClick:()=>ge(f),className:"flex-1 flex items-center justify-center gap-1 py-2 bg-zinc-800 hover:bg-zinc-700 text-white rounded-lg text-sm font-medium",children:[r.jsx(ur.Edit,{}),"Edit"]}),r.jsxs("button",{onClick:()=>Y(f),className:"flex-1 flex items-center justify-center gap-1 py-2 bg-emerald-500/20 hover:bg-emerald-500/30 text-emerald-400 rounded-lg text-sm font-medium",children:[r.jsx(ur.Copy,{}),"Duplicate"]}),r.jsx("button",{onClick:()=>le(f.id),className:"p-2 bg-red-950/50 hover:bg-red-950 text-red-400 rounded-lg",children:r.jsx(ur.Trash,{})})]})]})]}),j&&r.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-zinc-900 border border-zinc-700 rounded-xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-white",children:u?"Edit Recipe":"New Recipe"}),r.jsx("button",{onClick:()=>{S(!1),se()},className:"text-zinc-400 hover:text-white",children:r.jsx(ur.X,{})})]}),r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"col-span-2",children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Name *"}),r.jsx("input",{type:"text",value:N.name,onChange:O=>w(U=>({...U,name:O.target.value})),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white",placeholder:"e.g., Standard MEA"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Category"}),r.jsx("select",{value:N.category,onChange:O=>w(U=>({...U,category:O.target.value})),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white",children:Object.entries(os).map(([O,U])=>r.jsxs("option",{value:O,children:[U.icon," ",U.label]},O))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Yield"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("input",{type:"number",value:N.yield.amount,onChange:O=>w(U=>({...U,yield:{...U.yield,amount:parseFloat(O.target.value)||0}})),className:"flex-1 bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white"}),r.jsxs("select",{value:N.yield.unit,onChange:O=>w(U=>({...U,yield:{...U.yield,unit:O.target.value}})),className:"w-24 bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white",children:[r.jsx("option",{value:"ml",children:"ml"}),r.jsx("option",{value:"L",children:"L"}),r.jsx("option",{value:"g",children:"g"}),r.jsx("option",{value:"kg",children:"kg"}),r.jsx("option",{value:"plates",children:"plates"}),r.jsx("option",{value:"jars",children:"jars"}),r.jsx("option",{value:"quarts",children:"quarts"})]})]})]}),r.jsxs("div",{className:"col-span-2",children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Description"}),r.jsx("textarea",{value:N.description,onChange:O=>w(U=>({...U,description:O.target.value})),rows:2,className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white"})]})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Prep (min)"}),r.jsx("input",{type:"number",value:N.prepTime,onChange:O=>w(U=>({...U,prepTime:parseInt(O.target.value)||0})),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Sterilize (min)"}),r.jsx("input",{type:"number",value:N.sterilizationTime,onChange:O=>w(U=>({...U,sterilizationTime:parseInt(O.target.value)||0})),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"PSI"}),r.jsx("input",{type:"number",value:N.sterilizationPsi,onChange:O=>w(U=>({...U,sterilizationPsi:parseInt(O.target.value)||15})),className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Ingredients *"}),N.ingredients.length>0&&r.jsx("div",{className:"space-y-2 mb-3",children:N.ingredients.map(O=>r.jsxs("div",{className:"flex items-center gap-2 bg-zinc-800/50 rounded-lg px-3 py-2",children:[r.jsx("span",{className:"flex-1 text-white",children:O.name}),r.jsxs("span",{className:"text-emerald-400",children:[O.quantity," ",O.unit]}),r.jsx("button",{onClick:()=>M(O.id),className:"text-red-400 hover:text-red-300",children:r.jsx(ur.X,{})})]},O.id))}),r.jsxs("div",{className:"bg-zinc-800/30 rounded-lg p-3 space-y-3",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs text-zinc-500 mb-1",children:"From Inventory"}),r.jsxs("select",{value:C.inventoryItemId,onChange:O=>Q(O.target.value),className:"w-full bg-zinc-800 border border-zinc-700 rounded px-2 py-1.5 text-sm text-white",children:[r.jsx("option",{value:"",children:"Manual entry..."}),t.map(O=>r.jsx("option",{value:O.id,children:O.name},O.id))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs text-zinc-500 mb-1",children:"Name"}),r.jsx("input",{type:"text",value:C.name,onChange:O=>y(U=>({...U,name:O.target.value})),className:"w-full bg-zinc-800 border border-zinc-700 rounded px-2 py-1.5 text-sm text-white",placeholder:"Ingredient name"})]})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs text-zinc-500 mb-1",children:"Quantity"}),r.jsx("input",{type:"number",value:C.quantity||"",onChange:O=>y(U=>({...U,quantity:parseFloat(O.target.value)||0})),className:"w-full bg-zinc-800 border border-zinc-700 rounded px-2 py-1.5 text-sm text-white"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs text-zinc-500 mb-1",children:"Unit"}),r.jsxs("select",{value:C.unit,onChange:O=>y(U=>({...U,unit:O.target.value})),className:"w-full bg-zinc-800 border border-zinc-700 rounded px-2 py-1.5 text-sm text-white",children:[r.jsx("option",{value:"g",children:"g"}),r.jsx("option",{value:"kg",children:"kg"}),r.jsx("option",{value:"ml",children:"ml"}),r.jsx("option",{value:"L",children:"L"}),r.jsx("option",{value:"tsp",children:"tsp"}),r.jsx("option",{value:"tbsp",children:"tbsp"}),r.jsx("option",{value:"cup",children:"cup"}),r.jsx("option",{value:"lb",children:"lb"}),r.jsx("option",{value:"brick",children:"brick"}),r.jsx("option",{value:"quart",children:"quart"})]})]}),r.jsx("div",{className:"flex items-end",children:r.jsx("button",{onClick:k,disabled:!C.name||!C.quantity,className:"w-full py-1.5 bg-emerald-500 hover:bg-emerald-600 disabled:bg-zinc-700 disabled:text-zinc-500 text-white rounded text-sm font-medium",children:"Add"})})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Instructions"}),r.jsxs("div",{className:"space-y-2",children:[N.instructions.map((O,U)=>r.jsxs("div",{className:"flex gap-2",children:[r.jsxs("span",{className:"flex-shrink-0 w-6 h-9 flex items-center justify-center text-zinc-500 text-sm",children:[U+1,"."]}),r.jsx("input",{type:"text",value:O,onChange:re=>B(U,re.target.value),className:"flex-1 bg-zinc-800 border border-zinc-700 rounded px-3 py-2 text-sm text-white",placeholder:`Step ${U+1}...`}),r.jsx("button",{onClick:()=>D(U),className:"text-zinc-500 hover:text-red-400",children:r.jsx(ur.X,{})})]},U)),r.jsx("button",{onClick:oe,className:"text-sm text-emerald-400 hover:text-emerald-300",children:"+ Add step"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Notes"}),r.jsx("textarea",{value:N.notes,onChange:O=>w(U=>({...U,notes:O.target.value})),rows:2,className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-3 py-2 text-white"})]})]}),r.jsxs("div",{className:"flex gap-3 mt-6",children:[r.jsx("button",{onClick:()=>{S(!1),se()},className:"flex-1 py-2 bg-zinc-800 hover:bg-zinc-700 text-white rounded-lg font-medium",children:"Cancel"}),r.jsx("button",{onClick:$,disabled:!N.name||N.ingredients.length===0,className:"flex-1 py-2 bg-emerald-500 hover:bg-emerald-600 disabled:bg-zinc-700 disabled:text-zinc-500 text-white rounded-lg font-medium",children:u?"Save Changes":"Create Recipe"})]})]})})]})},Pw="modulepreload",Lw=function(e){return"/"+e},Eh={},Mw=function(t,s,n){let i=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(s.map(d=>{if(d=Lw(d),d in Eh)return;Eh[d]=!0;const c=d.endsWith(".css"),p=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${p}`))return;const m=document.createElement("link");if(m.rel=c?"stylesheet":Pw,c||(m.as="script"),m.crossOrigin="",m.href=d,l&&m.setAttribute("nonce",l),document.head.appendChild(m),c)return new Promise((g,f)=>{m.addEventListener("load",g),m.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${d}`)))})}))}function a(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return i.then(o=>{for(const l of o||[])l.status==="rejected"&&a(l.reason);return t().catch(a)})},hr={Check:()=>r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5",children:r.jsx("polyline",{points:"20 6 9 17 4 12"})}),X:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),Database:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5",children:[r.jsx("ellipse",{cx:"12",cy:"5",rx:"9",ry:"3"}),r.jsx("path",{d:"M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"}),r.jsx("path",{d:"M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"})]}),Cloud:()=>r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5",children:r.jsx("path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z"})}),ChevronRight:()=>r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5",children:r.jsx("polyline",{points:"9 18 15 12 9 6"})})},$w=({onComplete:e,onSkip:t})=>{const[s,n]=b.useState(1),[i,a]=b.useState(""),[o,l]=b.useState(""),[d,c]=b.useState(!1),[p,m]=b.useState(null),[g,f]=b.useState("");b.useEffect(()=>{const S=localStorage.getItem("mycolab-supabase-url"),u=localStorage.getItem("mycolab-supabase-key");S&&a(S),u&&l(u)},[]);const v=async()=>{if(!i||!o){m("error"),f("Please enter both URL and API key");return}c(!0),m(null),f("");try{const{createClient:S}=await Mw(async()=>{const{createClient:x}=await Promise.resolve().then(()=>Zb);return{createClient:x}},void 0),u=S(i,o),{error:h}=await u.from("strains").select("count").limit(1);if(h&&!h.message.includes("does not exist"))throw h;localStorage.setItem("mycolab-supabase-url",i),localStorage.setItem("mycolab-supabase-key",o),m("success")}catch(S){m("error"),f(S.message||"Connection failed")}finally{c(!1)}},j=()=>{localStorage.setItem("mycolab-setup-complete","true"),window.location.reload()};return r.jsx("div",{className:"fixed inset-0 bg-zinc-950 flex items-center justify-center p-4 z-50",children:r.jsxs("div",{className:"w-full max-w-2xl bg-zinc-900 border border-zinc-800 rounded-2xl overflow-hidden",children:[r.jsx("div",{className:"p-6 border-b border-zinc-800 bg-gradient-to-r from-emerald-950/50 to-teal-950/50",children:r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-emerald-500 to-teal-600 flex items-center justify-center shadow-lg shadow-emerald-500/20",children:r.jsx("span",{className:"text-2xl",children:""})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl font-bold text-white",children:"MycoLab Setup"}),r.jsx("p",{className:"text-sm text-zinc-400",children:"Configure cloud storage for your data"})]})]})}),r.jsxs("div",{className:"px-6 py-4 border-b border-zinc-800",children:[r.jsx("div",{className:"flex items-center gap-2",children:[1,2,3].map(S=>r.jsxs(Cc.Fragment,{children:[r.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium transition-colors ${S<s?"bg-emerald-500 text-white":S===s?"bg-emerald-500/20 text-emerald-400 border border-emerald-500":"bg-zinc-800 text-zinc-500"}`,children:S<s?r.jsx(hr.Check,{}):S}),S<3&&r.jsx("div",{className:`flex-1 h-0.5 ${S<s?"bg-emerald-500":"bg-zinc-800"}`})]},S))}),r.jsxs("div",{className:"flex justify-between mt-2 text-xs text-zinc-500",children:[r.jsx("span",{children:"Welcome"}),r.jsx("span",{children:"Connect"}),r.jsx("span",{children:"Complete"})]})]}),r.jsxs("div",{className:"p-6 min-h-[300px]",children:[s===1&&r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"text-center space-y-4",children:[r.jsx("div",{className:"w-16 h-16 mx-auto rounded-full bg-gradient-to-br from-emerald-500/20 to-teal-500/20 flex items-center justify-center",children:r.jsx(hr.Cloud,{})}),r.jsx("h2",{className:"text-lg font-semibold text-white",children:"Welcome to MycoLab!"}),r.jsx("p",{className:"text-zinc-400 max-w-md mx-auto",children:"MycoLab can work offline or sync your data to the cloud using Supabase. Cloud sync lets you access your lab from any device."})]}),r.jsxs("div",{className:"grid gap-4 mt-8",children:[r.jsxs("div",{className:"bg-zinc-800/50 rounded-xl p-4 border border-zinc-700",children:[r.jsxs("h3",{className:"font-medium text-white flex items-center gap-2",children:[r.jsx(hr.Database,{}),"Offline Mode"]}),r.jsx("p",{className:"text-sm text-zinc-400 mt-1",children:"Data stored locally in your browser. Free, no account needed. Data stays on this device only."})]}),r.jsxs("div",{className:"bg-emerald-950/30 rounded-xl p-4 border border-emerald-800/50",children:[r.jsxs("h3",{className:"font-medium text-emerald-400 flex items-center gap-2",children:[r.jsx(hr.Cloud,{}),"Cloud Sync (Recommended)"]}),r.jsx("p",{className:"text-sm text-zinc-400 mt-1",children:"Data synced to Supabase. Access from any device, automatic backups. Free tier includes 500MB storage."})]})]})]}),s===2&&r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-lg font-semibold text-white",children:"Connect to Supabase"}),r.jsxs("p",{className:"text-sm text-zinc-400 mt-1",children:["Enter your Supabase project credentials. You can find these in your"," ",r.jsx("a",{href:"https://app.supabase.com",target:"_blank",rel:"noopener noreferrer",className:"text-emerald-400 hover:underline",children:"Supabase dashboard"})," ","under Settings  API."]})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Project URL"}),r.jsx("input",{type:"url",value:i,onChange:S=>a(S.target.value),placeholder:"https://your-project.supabase.co",className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-4 py-2.5 text-white placeholder-zinc-500 focus:outline-none focus:border-emerald-500"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-zinc-400 mb-2",children:"Anon (Public) Key"}),r.jsx("input",{type:"password",value:o,onChange:S=>l(S.target.value),placeholder:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-4 py-2.5 text-white placeholder-zinc-500 focus:outline-none focus:border-emerald-500 font-mono text-sm"}),r.jsx("p",{className:"text-xs text-zinc-500 mt-1",children:'Use the "anon public" key, not the secret key.'})]})]}),p&&r.jsxs("div",{className:`p-4 rounded-lg ${p==="success"?"bg-emerald-950/50 border border-emerald-800":"bg-red-950/50 border border-red-800"}`,children:[r.jsx("div",{className:"flex items-center gap-2",children:p==="success"?r.jsxs(r.Fragment,{children:[r.jsx(hr.Check,{}),r.jsx("span",{className:"text-emerald-400 font-medium",children:"Connection successful!"})]}):r.jsxs(r.Fragment,{children:[r.jsx(hr.X,{}),r.jsx("span",{className:"text-red-400 font-medium",children:"Connection failed"})]})}),g&&r.jsx("p",{className:"text-sm text-zinc-400 mt-2",children:g})]}),r.jsx("button",{onClick:v,disabled:d||!i||!o,className:"w-full py-2.5 bg-zinc-800 hover:bg-zinc-700 disabled:bg-zinc-800/50 disabled:text-zinc-500 text-white rounded-lg font-medium transition-colors",children:d?r.jsxs("span",{className:"flex items-center justify-center gap-2",children:[r.jsx("div",{className:"w-4 h-4 border-2 border-zinc-600 border-t-white rounded-full animate-spin"}),"Testing..."]}):"Test Connection"}),r.jsxs("div",{className:"bg-zinc-800/50 rounded-lg p-4 text-sm",children:[r.jsx("h4",{className:"font-medium text-white mb-2",children:"Quick Setup Guide:"}),r.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-zinc-400",children:[r.jsxs("li",{children:["Go to ",r.jsx("a",{href:"https://supabase.com",target:"_blank",rel:"noopener noreferrer",className:"text-emerald-400 hover:underline",children:"supabase.com"})," and create a free account"]}),r.jsx("li",{children:"Create a new project (any name, any region)"}),r.jsx("li",{children:"Go to Settings  API"}),r.jsx("li",{children:"Copy the Project URL and anon key"}),r.jsx("li",{children:"Run the SQL schema in SQL Editor (see schema file in download)"})]})]})]}),s===3&&r.jsxs("div",{className:"space-y-6 text-center",children:[r.jsx("div",{className:"w-20 h-20 mx-auto rounded-full bg-gradient-to-br from-emerald-500 to-teal-600 flex items-center justify-center",children:r.jsx(hr.Check,{})}),r.jsx("h2",{className:"text-xl font-semibold text-white",children:"You're All Set!"}),r.jsx("p",{className:"text-zinc-400 max-w-md mx-auto",children:p==="success"?"Your MycoLab is connected to the cloud. Your data will sync automatically across all your devices.":"MycoLab is set up in offline mode. Your data will be stored locally in your browser."}),r.jsxs("div",{className:"bg-zinc-800/50 rounded-xl p-4 text-left",children:[r.jsx("h3",{className:"font-medium text-white mb-3",children:"Next Steps:"}),r.jsxs("ul",{className:"space-y-2 text-sm text-zinc-400",children:[r.jsxs("li",{className:"flex items-start gap-2",children:[r.jsx("span",{className:"text-emerald-400",children:""}),"Add your strains and cultures in the Culture Library"]}),r.jsxs("li",{className:"flex items-start gap-2",children:[r.jsx("span",{className:"text-emerald-400",children:""}),"Create recipes for your agar, LC, and substrate mixes"]}),r.jsxs("li",{className:"flex items-start gap-2",children:[r.jsx("span",{className:"text-emerald-400",children:""}),"Start tracking your grows from spawn to harvest"]}),p!=="success"&&r.jsxs("li",{className:"flex items-start gap-2",children:[r.jsx("span",{className:"text-amber-400",children:""}),"You can set up cloud sync later in Settings"]})]})]})]})]}),r.jsxs("div",{className:"p-6 border-t border-zinc-800 flex justify-between",children:[s===1&&r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:t,className:"px-4 py-2 text-zinc-400 hover:text-white transition-colors",children:"Skip for now"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:()=>{localStorage.setItem("mycolab-setup-complete","true"),t()},className:"px-4 py-2 bg-zinc-800 hover:bg-zinc-700 text-white rounded-lg font-medium transition-colors",children:"Use Offline"}),r.jsxs("button",{onClick:()=>n(2),className:"flex items-center gap-2 px-4 py-2 bg-emerald-500 hover:bg-emerald-600 text-white rounded-lg font-medium transition-colors",children:["Set Up Cloud",r.jsx(hr.ChevronRight,{})]})]})]}),s===2&&r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>n(1),className:"px-4 py-2 text-zinc-400 hover:text-white transition-colors",children:"Back"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:()=>n(3),className:"px-4 py-2 bg-zinc-800 hover:bg-zinc-700 text-white rounded-lg font-medium transition-colors",children:"Skip"}),r.jsxs("button",{onClick:()=>n(3),disabled:p!=="success",className:"flex items-center gap-2 px-4 py-2 bg-emerald-500 hover:bg-emerald-600 disabled:bg-zinc-700 disabled:text-zinc-500 text-white rounded-lg font-medium transition-colors",children:["Continue",r.jsx(hr.ChevronRight,{})]})]})]}),s===3&&r.jsxs(r.Fragment,{children:[r.jsx("div",{}),r.jsxs("button",{onClick:j,className:"flex items-center gap-2 px-6 py-2 bg-emerald-500 hover:bg-emerald-600 text-white rounded-lg font-medium transition-colors",children:["Get Started",r.jsx(hr.ChevronRight,{})]})]})]})]})})},Bw=b.createContext(null),Fw={cultures:[],grows:[],strains:uw,vendors:hw,locations:mw,vesselTypes:pw,ingredients:fw,tools:[],procedures:[],recipes:[],labelTemplates:[],inventory:[],wishlist:[],ideas:[],environmentalReadings:[],dailyChecks:[],roomStatuses:[],media:[],qrLabels:[],notifications:[],notificationRules:[],devLog:gw,preferences:dw},Le={Dashboard:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-5 h-5",children:[r.jsx("rect",{x:"3",y:"3",width:"7",height:"7",rx:"1"}),r.jsx("rect",{x:"14",y:"3",width:"7",height:"7",rx:"1"}),r.jsx("rect",{x:"3",y:"14",width:"7",height:"7",rx:"1"}),r.jsx("rect",{x:"14",y:"14",width:"7",height:"7",rx:"1"})]}),Culture:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-5 h-5",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"M12 6v6l4 2"})]}),Grow:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-5 h-5",children:[r.jsx("path",{d:"M12 2L12 22"}),r.jsx("path",{d:"M17 7C17 7 13 9 12 14"}),r.jsx("path",{d:"M7 7C7 7 11 9 12 14"}),r.jsx("path",{d:"M19 12C19 12 15 13 12 17"}),r.jsx("path",{d:"M5 12C5 12 9 13 12 17"})]}),Inventory:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-5 h-5",children:[r.jsx("path",{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"}),r.jsx("polyline",{points:"3.27 6.96 12 12.01 20.73 6.96"}),r.jsx("line",{x1:"12",y1:"22.08",x2:"12",y2:"12"})]}),Settings:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-5 h-5",children:[r.jsx("circle",{cx:"12",cy:"12",r:"3"}),r.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]}),DevLog:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-5 h-5",children:[r.jsx("polyline",{points:"16 18 22 12 16 6"}),r.jsx("polyline",{points:"8 6 2 12 8 18"})]}),Plus:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-5 h-5",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),Bell:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-5 h-5",children:[r.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),r.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),Recipe:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-5 h-5",children:[r.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),r.jsx("polyline",{points:"14 2 14 8 20 8"}),r.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),r.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),r.jsx("polyline",{points:"10 9 9 9 8 9"})]}),Chart:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-5 h-5",children:[r.jsx("line",{x1:"18",y1:"20",x2:"18",y2:"10"}),r.jsx("line",{x1:"12",y1:"20",x2:"12",y2:"4"}),r.jsx("line",{x1:"6",y1:"20",x2:"6",y2:"14"})]}),Calculator:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-5 h-5",children:[r.jsx("rect",{x:"4",y:"2",width:"16",height:"20",rx:"2"}),r.jsx("line",{x1:"8",y1:"6",x2:"16",y2:"6"}),r.jsx("line",{x1:"8",y1:"10",x2:"8",y2:"10.01"}),r.jsx("line",{x1:"12",y1:"10",x2:"12",y2:"10.01"}),r.jsx("line",{x1:"16",y1:"10",x2:"16",y2:"10.01"}),r.jsx("line",{x1:"8",y1:"14",x2:"8",y2:"14.01"}),r.jsx("line",{x1:"12",y1:"14",x2:"12",y2:"14.01"}),r.jsx("line",{x1:"16",y1:"14",x2:"16",y2:"14.01"}),r.jsx("line",{x1:"8",y1:"18",x2:"8",y2:"18.01"}),r.jsx("line",{x1:"12",y1:"18",x2:"16",y2:"18"})]}),AlertTriangle:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-5 h-5",children:[r.jsx("path",{d:"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"}),r.jsx("line",{x1:"12",y1:"9",x2:"12",y2:"13"}),r.jsx("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]}),TrendingUp:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-5 h-5",children:[r.jsx("polyline",{points:"23 6 13.5 15.5 8.5 10.5 1 18"}),r.jsx("polyline",{points:"17 6 23 6 23 12"})]}),Layers:()=>r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-5 h-5",children:[r.jsx("polygon",{points:"12 2 2 7 12 12 22 7 12 2"}),r.jsx("polyline",{points:"2 17 12 22 22 17"}),r.jsx("polyline",{points:"2 12 12 17 22 12"})]}),Thermometer:()=>r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-5 h-5",children:r.jsx("path",{d:"M14 14.76V3.5a2.5 2.5 0 0 0-5 0v11.26a4.5 4.5 0 1 0 5 0z"})})},Uw=[{id:"dashboard",label:"Dashboard",icon:Le.Dashboard},{id:"inventory",label:"Lab Inventory",icon:Le.Inventory},{id:"cultures",label:"Cultures",icon:Le.Culture},{id:"lineage",label:"Lineage",icon:Le.Culture},{id:"grows",label:"Grows",icon:Le.Grow},{id:"recipes",label:"Recipes",icon:Le.Recipe},{id:"calculator",label:"Substrate Calc",icon:Le.Calculator},{id:"spawnrate",label:"Spawn Rate",icon:Le.Layers},{id:"pressure",label:"Pressure Cook",icon:Le.Thermometer},{id:"contamination",label:"Contamination",icon:Le.AlertTriangle},{id:"efficiency",label:"BE Calculator",icon:Le.TrendingUp},{id:"analytics",label:"Analytics",icon:Le.Chart},{id:"settings",label:"Settings",icon:Le.Settings},{id:"devlog",label:"Roadmap",icon:Le.DevLog}],Ww=({currentPage:e,onNavigate:t,isOpen:s,onClose:n,cultureCount:i,activeGrowCount:a})=>{const o=l=>{t(l),n()};return r.jsxs(r.Fragment,{children:[s&&r.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:n}),r.jsxs("aside",{className:`
        fixed lg:static inset-y-0 left-0 z-50
        w-64 bg-zinc-900 border-r border-zinc-800 
        flex flex-col h-full
        transform transition-transform duration-300 ease-in-out
        ${s?"translate-x-0":"-translate-x-full lg:translate-x-0"}
      `,children:[r.jsx("div",{className:"p-4 border-b border-zinc-800 flex-shrink-0",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-emerald-500 to-teal-600 flex items-center justify-center shadow-lg shadow-emerald-500/20",children:r.jsx("span",{className:"text-xl",children:""})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-lg font-semibold text-white tracking-tight",children:"MycoLab"}),r.jsx("p",{className:"text-xs text-zinc-500",children:"Laboratory Manager"})]})]})}),r.jsx("nav",{className:"flex-1 p-3 space-y-1 overflow-y-auto",children:Uw.map(l=>{const d=e===l.id,c=l.icon;return r.jsxs("button",{onClick:()=>o(l.id),className:`
                  w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium
                  transition-all duration-200 group
                  ${d?"bg-emerald-500/10 text-emerald-400 border border-emerald-500/20":"text-zinc-400 hover:bg-zinc-800/50 hover:text-white border border-transparent"}
                `,children:[r.jsx(c,{}),r.jsx("span",{className:"truncate",children:l.label}),d&&r.jsx("span",{className:"ml-auto w-1.5 h-1.5 rounded-full bg-emerald-400 flex-shrink-0"})]},l.id)})}),r.jsx("div",{className:"p-3 border-t border-zinc-800 flex-shrink-0 hidden sm:block",children:r.jsxs("div",{className:"bg-zinc-800/50 rounded-lg p-3 space-y-2",children:[r.jsx("p",{className:"text-xs font-medium text-zinc-500 uppercase tracking-wider",children:"Quick Stats"}),r.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-lg font-semibold text-white",children:i}),r.jsx("p",{className:"text-xs text-zinc-500",children:"Cultures"})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-lg font-semibold text-emerald-400",children:a}),r.jsx("p",{className:"text-xs text-zinc-500",children:"Active Grows"})]})]})]})})]})]})},Hw={dashboard:{label:"New Culture",page:"cultures"},cultures:{label:"New Culture",page:"cultures"},grows:{label:"New Grow",page:"grows"},recipes:{label:"New Recipe",page:"recipes"},inventory:{label:"New Culture",page:"cultures"}},Vw=({title:e,subtitle:t,currentPage:s,onNavigate:n,onMenuClick:i})=>{const a=Hw[s];return r.jsxs("header",{className:"h-14 border-b border-zinc-800 flex items-center justify-between px-4 bg-zinc-900/30 flex-shrink-0",children:[r.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[r.jsx("button",{onClick:i,className:"lg:hidden p-2 -ml-2 rounded-lg text-zinc-400 hover:text-white hover:bg-zinc-800 transition-colors",children:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5",children:[r.jsx("line",{x1:"3",y1:"12",x2:"21",y2:"12"}),r.jsx("line",{x1:"3",y1:"6",x2:"21",y2:"6"}),r.jsx("line",{x1:"3",y1:"18",x2:"21",y2:"18"})]})}),r.jsxs("div",{className:"min-w-0",children:[r.jsx("h2",{className:"text-lg font-semibold text-white truncate",children:e}),t&&r.jsx("p",{className:"text-xs text-zinc-500 truncate hidden sm:block",children:t})]})]}),r.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[r.jsx("button",{className:"p-2 rounded-lg text-zinc-400 hover:text-white hover:bg-zinc-800 transition-colors relative",title:"Notifications coming soon",children:r.jsx(Le.Bell,{})}),a&&r.jsxs("button",{className:"flex items-center gap-2 px-3 py-2 bg-emerald-500 hover:bg-emerald-600 text-white rounded-lg text-sm font-medium transition-colors",onClick:()=>n(a.page),children:[r.jsx(Le.Plus,{}),r.jsx("span",{className:"hidden sm:inline",children:a.label})]})]})]})},Ih=({onNavigate:e})=>{const{state:t,isLoading:s,isConnected:n,activeStrains:i}=ar(),a=t.cultures.filter(c=>c.status==="active"),o=t.grows.filter(c=>c.status==="active"),l=t.grows.slice(0,3),d=[{label:"Active Cultures",value:a.length.toString(),change:n?"Synced":"Local",color:"emerald"},{label:"Active Grows",value:o.length.toString(),change:`${o.filter(c=>c.currentStage==="fruiting").length} fruiting`,color:"blue"},{label:"Strains",value:i.length.toString(),change:"In library",color:"purple"},{label:"Recipes",value:t.recipes.filter(c=>c.isActive).length.toString(),change:"Available",color:"amber"}];return s?r.jsx("div",{className:"p-6 flex items-center justify-center h-64",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"w-8 h-8 border-2 border-emerald-500 border-t-transparent rounded-full animate-spin mx-auto mb-3"}),r.jsx("p",{className:"text-zinc-400",children:"Loading data..."})]})}):r.jsxs("div",{className:"p-6 space-y-6",children:[!n&&r.jsxs("div",{className:"bg-amber-950/30 border border-amber-800 rounded-lg p-4 flex items-center gap-3",children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"w-5 h-5 text-amber-400",children:[r.jsx("path",{d:"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"}),r.jsx("line",{x1:"12",y1:"9",x2:"12",y2:"13"}),r.jsx("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]}),r.jsxs("div",{className:"flex-1",children:[r.jsx("p",{className:"text-amber-400 font-medium",children:"Database not connected"}),r.jsx("p",{className:"text-sm text-zinc-400",children:"Go to Settings  Database to configure Supabase"})]}),r.jsx("button",{onClick:()=>e("settings"),className:"px-3 py-1.5 bg-amber-600 hover:bg-amber-500 text-white text-sm rounded-lg",children:"Configure"})]}),r.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:d.map(c=>r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-5",children:[r.jsx("p",{className:"text-sm text-zinc-500 mb-1",children:c.label}),r.jsx("p",{className:"text-3xl font-semibold text-white mb-1",children:c.value}),r.jsx("p",{className:`text-xs text-${c.color}-400`,children:c.change})]},c.label))}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[r.jsxs("div",{className:"lg:col-span-2 bg-zinc-900/50 border border-zinc-800 rounded-xl",children:[r.jsxs("div",{className:"p-5 border-b border-zinc-800 flex items-center justify-between",children:[r.jsx("h3",{className:"font-semibold text-white",children:"Active Grows"}),r.jsx("button",{onClick:()=>e("grows"),className:"text-sm text-emerald-400 hover:text-emerald-300",children:"View all"})]}),r.jsx("div",{className:"p-5 space-y-4",children:l.length===0?r.jsxs("div",{className:"text-center py-8",children:[r.jsx("p",{className:"text-zinc-500 mb-3",children:"No grows yet"}),r.jsx("button",{onClick:()=>e("grows"),className:"px-4 py-2 bg-emerald-500 hover:bg-emerald-600 text-white rounded-lg text-sm",children:"Start Your First Grow"})]}):l.map(c=>{const p=i.find(v=>v.id===c.strainId),m=Math.floor((Date.now()-new Date(c.spawnedAt).getTime())/(1e3*60*60*24)),f={spawning:10,colonization:40,fruiting:70,harvesting:90,completed:100}[c.currentStage]||0;return r.jsxs("div",{className:"bg-zinc-800/50 rounded-lg p-4",children:[r.jsxs("div",{className:"flex items-center justify-between mb-3",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium text-white",children:c.name}),r.jsxs("p",{className:"text-sm text-zinc-500",children:[(p==null?void 0:p.name)||"Unknown","  Day ",m]})]}),r.jsx("span",{className:"px-3 py-1 text-xs font-medium bg-blue-950/50 text-blue-400 rounded-full border border-blue-800 capitalize",children:c.currentStage.replace("_"," ")})]}),r.jsx("div",{className:"relative h-2 bg-zinc-700 rounded-full overflow-hidden",children:r.jsx("div",{className:"absolute inset-y-0 left-0 bg-gradient-to-r from-emerald-500 to-teal-500 rounded-full",style:{width:`${f}%`}})}),r.jsxs("p",{className:"text-xs text-zinc-500 mt-2",children:[f,"% complete"]})]},c.id)})})]}),r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl",children:[r.jsxs("div",{className:"p-5 border-b border-zinc-800 flex items-center justify-between",children:[r.jsx("h3",{className:"font-semibold text-white",children:"Recent Cultures"}),r.jsx("button",{onClick:()=>e("cultures"),className:"text-sm text-emerald-400 hover:text-emerald-300",children:"View all"})]}),r.jsx("div",{className:"p-3 space-y-2 max-h-[400px] overflow-y-auto",children:t.cultures.length===0?r.jsxs("div",{className:"text-center py-6",children:[r.jsx("p",{className:"text-zinc-500 text-sm mb-3",children:"No cultures yet"}),r.jsx("button",{onClick:()=>e("cultures"),className:"px-3 py-1.5 bg-emerald-500 hover:bg-emerald-600 text-white rounded-lg text-xs",children:"Add Culture"})]}):t.cultures.slice(0,5).map(c=>{const p=i.find(g=>g.id===c.strainId),m={spore_syringe:"bg-purple-950/50 border-purple-800 text-purple-400",liquid_culture:"bg-blue-950/50 border-blue-800 text-blue-400",agar:"bg-pink-950/50 border-pink-800 text-pink-400",slant:"bg-orange-950/50 border-orange-800 text-orange-400"};return r.jsx("div",{className:"p-3 rounded-lg bg-zinc-800/30 border border-zinc-800",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-white",children:c.label}),r.jsx("p",{className:"text-xs text-zinc-500",children:(p==null?void 0:p.name)||"Unknown strain"})]}),r.jsx("span",{className:`px-2 py-0.5 text-xs rounded-full border ${m[c.type]||"bg-zinc-800 border-zinc-700 text-zinc-400"}`,children:c.type.replace("_"," ")})]})},c.id)})})]})]}),r.jsxs("div",{className:"bg-zinc-900/50 border border-zinc-800 rounded-xl p-5",children:[r.jsx("h3",{className:"font-semibold text-white mb-4",children:"Quick Actions"}),r.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[r.jsxs("button",{onClick:()=>e("cultures"),className:"p-4 bg-zinc-800/50 hover:bg-zinc-800 border border-zinc-700 rounded-lg text-center transition-colors",children:[r.jsx("div",{className:"w-10 h-10 mx-auto mb-2 rounded-lg bg-blue-950/50 border border-blue-800 flex items-center justify-center",children:r.jsx(Le.Culture,{})}),r.jsx("p",{className:"text-sm text-white",children:"New Culture"})]}),r.jsxs("button",{onClick:()=>e("grows"),className:"p-4 bg-zinc-800/50 hover:bg-zinc-800 border border-zinc-700 rounded-lg text-center transition-colors",children:[r.jsx("div",{className:"w-10 h-10 mx-auto mb-2 rounded-lg bg-emerald-950/50 border border-emerald-800 flex items-center justify-center",children:r.jsx(Le.Grow,{})}),r.jsx("p",{className:"text-sm text-white",children:"New Grow"})]}),r.jsxs("button",{onClick:()=>e("recipes"),className:"p-4 bg-zinc-800/50 hover:bg-zinc-800 border border-zinc-700 rounded-lg text-center transition-colors",children:[r.jsx("div",{className:"w-10 h-10 mx-auto mb-2 rounded-lg bg-purple-950/50 border border-purple-800 flex items-center justify-center",children:r.jsx(Le.Recipe,{})}),r.jsx("p",{className:"text-sm text-white",children:"New Recipe"})]}),r.jsxs("button",{onClick:()=>e("settings"),className:"p-4 bg-zinc-800/50 hover:bg-zinc-800 border border-zinc-700 rounded-lg text-center transition-colors",children:[r.jsx("div",{className:"w-10 h-10 mx-auto mb-2 rounded-lg bg-zinc-800 border border-zinc-700 flex items-center justify-center",children:r.jsx(Le.Settings,{})}),r.jsx("p",{className:"text-sm text-white",children:"Settings"})]})]})]})]})},Gw=()=>{const[e,t]=b.useState("dashboard"),[s,n]=b.useState(Fw),[i,a]=b.useState(!1),[o,l]=b.useState(()=>!localStorage.getItem("mycolab-setup-complete"));b.useEffect(()=>{const v=localStorage.getItem("mycolab-state");if(v)try{const j=JSON.parse(v);n(S=>({...S,...j}))}catch{console.error("Failed to load saved state")}},[]),b.useEffect(()=>{localStorage.setItem("mycolab-state",JSON.stringify(s))},[s]);const d=v=>{n(j=>({...j,devLog:v}))},c=v=>{const j={...v,id:`dev-${Date.now()}`,status:"backlog",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};n(S=>({...S,devLog:[...S.devLog,j]}))},p=(v,j)=>{n(S=>({...S,devLog:S.devLog.map(u=>u.id===v?{...u,status:j,updatedAt:new Date().toISOString(),completedAt:j==="completed"?new Date().toISOString():void 0}:u)}))},m={state:s,updateDevLog:d,addDevLogFeature:c,updateFeatureStatus:p},g={dashboard:{title:"Dashboard",subtitle:"Overview of your mycology lab"},inventory:{title:"Lab Inventory",subtitle:"All cultures, spawn, and grows"},cultures:{title:"Culture Library",subtitle:"Manage your cultures and genetics"},lineage:{title:"Lineage Visualization",subtitle:"Interactive family tree of your cultures"},grows:{title:"Grow Tracking",subtitle:"Track your active and completed grows"},recipes:{title:"Recipes",subtitle:"Agar, LC, substrate formulations"},calculator:{title:"Substrate Calculator",subtitle:"Hydration ratio calculations"},spawnrate:{title:"Spawn Rate Calculator",subtitle:"Calculate spawn-to-substrate ratios"},pressure:{title:"Pressure Cooking Calculator",subtitle:"Sterilization times with altitude adjustment"},contamination:{title:"Contamination Analysis",subtitle:"Track and analyze contamination patterns"},efficiency:{title:"Biological Efficiency",subtitle:"Calculate and compare BE% across grows"},analytics:{title:"Analytics",subtitle:"Data visualization and insights"},settings:{title:"Settings",subtitle:"Configure lookups and preferences"},devlog:{title:"Dev Roadmap",subtitle:"Feature tracker with intelligent prioritization"}},f=()=>{switch(e){case"dashboard":return r.jsx(Ih,{onNavigate:t});case"devlog":return r.jsx(cw,{features:s.devLog,onUpdateStatus:p,onAddFeature:c});case"inventory":return r.jsx(yw,{});case"calculator":return r.jsx("div",{className:"p-6",children:r.jsx(vw,{})});case"contamination":return r.jsx("div",{className:"p-6",children:r.jsx(bw,{})});case"efficiency":return r.jsx("div",{className:"p-6",children:r.jsx(ww,{})});case"cultures":return r.jsx("div",{className:"p-6",children:r.jsx(Iw,{})});case"lineage":return r.jsx("div",{className:"p-6",children:r.jsx(Tw,{})});case"grows":return r.jsx("div",{className:"p-6",children:r.jsx(Dw,{})});case"recipes":return r.jsx("div",{className:"p-6",children:r.jsx(Rw,{})});case"analytics":return r.jsx("div",{className:"p-6",children:r.jsx(_w,{})});case"spawnrate":return r.jsx("div",{className:"p-6",children:r.jsx(Aw,{})});case"pressure":return r.jsx("div",{className:"p-6",children:r.jsx(Ew,{})});case"settings":return r.jsx("div",{className:"p-6",children:r.jsx(zw,{})});default:return r.jsx(Ih,{onNavigate:t})}};return r.jsx(rw,{children:r.jsx(Bw.Provider,{value:m,children:r.jsx(qw,{showSetup:o,setShowSetup:l,currentPage:e,setCurrentPage:t,sidebarOpen:i,setSidebarOpen:a,renderPage:f,pageConfig:g})})})},qw=({showSetup:e,setShowSetup:t,currentPage:s,setCurrentPage:n,sidebarOpen:i,setSidebarOpen:a,renderPage:o,pageConfig:l})=>{const{state:d}=ar(),c=d.cultures.length,p=d.grows.filter(m=>m.status==="active").length;return r.jsxs(r.Fragment,{children:[e&&r.jsx($w,{onComplete:()=>t(!1),onSkip:()=>{localStorage.setItem("mycolab-setup-complete","true"),t(!1)}}),r.jsxs("div",{className:"h-screen flex bg-zinc-950 text-white overflow-hidden",children:[r.jsx(Ww,{currentPage:s,onNavigate:n,isOpen:i,onClose:()=>a(!1),cultureCount:c,activeGrowCount:p}),r.jsxs("main",{className:"flex-1 flex flex-col min-w-0 overflow-hidden lg:ml-0",children:[r.jsx(Vw,{...l[s],currentPage:s,onNavigate:n,onMenuClick:()=>a(!0)}),r.jsx("div",{className:"flex-1 overflow-y-auto overflow-x-hidden bg-gradient-to-br from-zinc-950 via-zinc-900 to-zinc-950",children:o()})]})]})]})};ml.createRoot(document.getElementById("root")).render(r.jsx(Cc.StrictMode,{children:r.jsx(Gw,{})}));
//# sourceMappingURL=index-2tQq-Mf-.js.map
